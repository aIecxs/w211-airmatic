(function(){var C=this,q=C._,n={},c=Array.prototype,m=Object.prototype,r=c.push,f=c.slice,l=c.concat,t=m.toString,y=m.hasOwnProperty,w=c.forEach,x=c.map,u=c.reduce,s=c.reduceRight,k=c.filter,D=c.every,E=c.some,v=c.indexOf,A=c.lastIndexOf,m=Array.isArray,z=Object.keys,F=Function.prototype.bind,a=function(d){if(d instanceof a)return d;if(!(this instanceof a))return new a(d);this._wrapped=d};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=a),exports._=
a):C._=a;a.VERSION="1.5.1";var b=a.each=a.forEach=function(d,g,p){if(null!=d)if(w&&d.forEach===w)d.forEach(g,p);else if(d.length===+d.length)for(var b=0,e=d.length;b<e&&g.call(p,d[b],b,d)!==n;b++);else for(b in d)if(a.has(d,b)&&g.call(p,d[b],b,d)===n)break};a.map=a.collect=function(a,g,p){var e=[];if(null==a)return e;if(x&&a.map===x)return a.map(g,p);b(a,function(a,d,b){e.push(g.call(p,a,d,b))});return e};a.reduce=a.foldl=a.inject=function(d,g,p,e){var h=2<arguments.length;null==d&&(d=[]);if(u&&d.reduce===
u)return e&&(g=a.bind(g,e)),h?d.reduce(g,p):d.reduce(g);b(d,function(a,d,b){h?p=g.call(e,p,a,d,b):(p=a,h=!0)});if(!h)throw new TypeError("Reduce of empty array with no initial value");return p};a.reduceRight=a.foldr=function(d,g,p,e){var h=2<arguments.length;null==d&&(d=[]);if(s&&d.reduceRight===s)return e&&(g=a.bind(g,e)),h?d.reduceRight(g,p):d.reduceRight(g);var k=d.length;if(k!==+k)var t=a.keys(d),k=t.length;b(d,function(a,b,c){b=t?t[--k]:--k;h?p=g.call(e,p,d[b],b,c):(p=d[b],h=!0)});if(!h)throw new TypeError("Reduce of empty array with no initial value");
return p};a.find=a.detect=function(a,g,p){var b;h(a,function(a,d,e){if(g.call(p,a,d,e))return b=a,!0});return b};a.filter=a.select=function(a,g,p){var e=[];if(null==a)return e;if(k&&a.filter===k)return a.filter(g,p);b(a,function(a,d,b){g.call(p,a,d,b)&&e.push(a)});return e};a.reject=function(d,g,p){return a.filter(d,function(a,d,b){return!g.call(p,a,d,b)},p)};a.every=a.all=function(d,g,p){g||(g=a.identity);var e=!0;if(null==d)return e;if(D&&d.every===D)return d.every(g,p);b(d,function(a,d,b){if(!(e=
e&&g.call(p,a,d,b)))return n});return!!e};var h=a.some=a.any=function(d,g,p){g||(g=a.identity);var e=!1;if(null==d)return e;if(E&&d.some===E)return d.some(g,p);b(d,function(a,d,b){if(e||(e=g.call(p,a,d,b)))return n});return!!e};a.contains=a.include=function(a,g){return null==a?!1:v&&a.indexOf===v?-1!=a.indexOf(g):h(a,function(a){return a===g})};a.invoke=function(d,g){var p=f.call(arguments,2),b=a.isFunction(g);return a.map(d,function(a){return(b?g:a[g]).apply(a,p)})};a.pluck=function(d,g){return a.map(d,
function(a){return a[g]})};a.where=function(d,g,p){return a.isEmpty(g)?p?void 0:[]:a[p?"find":"filter"](d,function(a){for(var d in g)if(g[d]!==a[d])return!1;return!0})};a.findWhere=function(d,g){return a.where(d,g,!0)};a.max=function(d,g,p){if(!g&&a.isArray(d)&&d[0]===+d[0]&&65535>d.length)return Math.max.apply(Math,d);if(!g&&a.isEmpty(d))return-Infinity;var e={computed:-Infinity,value:-Infinity};b(d,function(a,d,b){d=g?g.call(p,a,d,b):a;d>e.computed&&(e={value:a,computed:d})});return e.value};a.min=
function(d,g,p){if(!g&&a.isArray(d)&&d[0]===+d[0]&&65535>d.length)return Math.min.apply(Math,d);if(!g&&a.isEmpty(d))return Infinity;var e={computed:Infinity,value:Infinity};b(d,function(a,d,b){d=g?g.call(p,a,d,b):a;d<e.computed&&(e={value:a,computed:d})});return e.value};a.shuffle=function(d){var g,p=0,e=[];b(d,function(d){g=a.random(p++);e[p-1]=e[g];e[g]=d});return e};var e=function(d){return a.isFunction(d)?d:function(a){return a[d]}};a.sortBy=function(d,g,p){var b=e(g);return a.pluck(a.map(d,function(a,
d,g){return{value:a,index:d,criteria:b.call(p,a,d,g)}}).sort(function(a,d){var g=a.criteria,p=d.criteria;if(g!==p){if(g>p||void 0===g)return 1;if(g<p||void 0===p)return-1}return a.index<d.index?-1:1}),"value")};var H=function(d,g,p,h){var k={},t=e(null==g?a.identity:g);b(d,function(a,g){var b=t.call(p,a,g,d);h(k,b,a)});return k};a.groupBy=function(d,g,p){return H(d,g,p,function(d,g,p){(a.has(d,g)?d[g]:d[g]=[]).push(p)})};a.countBy=function(d,g,p){return H(d,g,p,function(d,g){a.has(d,g)||(d[g]=0);
d[g]++})};a.sortedIndex=function(d,g,p,b){p=null==p?a.identity:e(p);g=p.call(b,g);for(var h=0,k=d.length;h<k;){var t=h+k>>>1;p.call(b,d[t])<g?h=t+1:k=t}return h};a.toArray=function(d){return d?a.isArray(d)?f.call(d):d.length===+d.length?a.map(d,a.identity):a.values(d):[]};a.size=function(d){return null==d?0:d.length===+d.length?d.length:a.keys(d).length};a.first=a.head=a.take=function(a,g,p){return null==a?void 0:null==g||p?a[0]:f.call(a,0,g)};a.initial=function(a,g,p){return f.call(a,0,a.length-
(null==g||p?1:g))};a.last=function(a,g,p){return null==a?void 0:null==g||p?a[a.length-1]:f.call(a,Math.max(a.length-g,0))};a.rest=a.tail=a.drop=function(a,g,p){return f.call(a,null==g||p?1:g)};a.compact=function(d){return a.filter(d,a.identity)};var B=function(d,g,p){if(g&&a.every(d,a.isArray))return l.apply(p,d);b(d,function(d){a.isArray(d)||a.isArguments(d)?g?r.apply(p,d):B(d,g,p):p.push(d)});return p};a.flatten=function(a,g){return B(a,g,[])};a.without=function(d){return a.difference(d,f.call(arguments,
1))};a.uniq=a.unique=function(d,g,p,e){a.isFunction(g)&&(e=p,p=g,g=!1);p=p?a.map(d,p,e):d;var h=[],k=[];b(p,function(p,b){(g?b&&k[k.length-1]===p:a.contains(k,p))||(k.push(p),h.push(d[b]))});return h};a.union=function(){return a.uniq(a.flatten(arguments,!0))};a.intersection=function(d){var g=f.call(arguments,1);return a.filter(a.uniq(d),function(d){return a.every(g,function(g){return 0<=a.indexOf(g,d)})})};a.difference=function(d){var g=l.apply(c,f.call(arguments,1));return a.filter(d,function(d){return!a.contains(g,
d)})};a.zip=function(){for(var d=a.max(a.pluck(arguments,"length").concat(0)),g=Array(d),p=0;p<d;p++)g[p]=a.pluck(arguments,""+p);return g};a.object=function(a,g){if(null==a)return{};for(var p={},b=0,e=a.length;b<e;b++)g?p[a[b]]=g[b]:p[a[b][0]]=a[b][1];return p};a.indexOf=function(d,g,b){if(null==d)return-1;var e=0,h=d.length;if(b)if("number"==typeof b)e=0>b?Math.max(0,h+b):b;else return e=a.sortedIndex(d,g),d[e]===g?e:-1;if(v&&d.indexOf===v)return d.indexOf(g,b);for(;e<h;e++)if(d[e]===g)return e;
return-1};a.lastIndexOf=function(a,g,b){if(null==a)return-1;var e=null!=b;if(A&&a.lastIndexOf===A)return e?a.lastIndexOf(g,b):a.lastIndexOf(g);for(b=e?b:a.length;b--;)if(a[b]===g)return b;return-1};a.range=function(a,g,b){1>=arguments.length&&(g=a||0,a=0);b=arguments[2]||1;for(var e=Math.max(Math.ceil((g-a)/b),0),h=0,k=Array(e);h<e;)k[h++]=a,a+=b;return k};var G=function(){};a.bind=function(d,g){var b,e;if(F&&d.bind===F)return F.apply(d,f.call(arguments,1));if(!a.isFunction(d))throw new TypeError;
b=f.call(arguments,2);return e=function(){if(!(this instanceof e))return d.apply(g,b.concat(f.call(arguments)));G.prototype=d.prototype;var a=new G;G.prototype=null;var h=d.apply(a,b.concat(f.call(arguments)));return Object(h)===h?h:a}};a.partial=function(a){var g=f.call(arguments,1);return function(){return a.apply(this,g.concat(f.call(arguments)))}};a.bindAll=function(d){var g=f.call(arguments,1);if(0===g.length)throw Error("bindAll must be passed function names");b(g,function(g){d[g]=a.bind(d[g],
d)});return d};a.memoize=function(d,g){var b={};g||(g=a.identity);return function(){var e=g.apply(this,arguments);return a.has(b,e)?b[e]:b[e]=d.apply(this,arguments)}};a.delay=function(a,g){var b=f.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},g)};a.defer=function(d){return a.delay.apply(a,[d,1].concat(f.call(arguments,1)))};a.throttle=function(a,g,b){var e,h,k,t=null,c=0;b||(b={});var f=function(){c=!1===b.leading?0:new Date;t=null;k=a.apply(e,h)};return function(){var B=
new Date;c||!1!==b.leading||(c=B);var H=g-(B-c);e=this;h=arguments;0>=H?(clearTimeout(t),t=null,c=B,k=a.apply(e,h)):t||!1===b.trailing||(t=setTimeout(f,H));return k}};a.debounce=function(a,g,b){var e,h=null;return function(){var k=this,t=arguments,c=b&&!h;clearTimeout(h);h=setTimeout(function(){h=null;b||(e=a.apply(k,t))},g);c&&(e=a.apply(k,t));return e}};a.once=function(a){var g=!1,b;return function(){if(g)return b;g=!0;b=a.apply(this,arguments);a=null;return b}};a.wrap=function(a,g){return function(){var b=
[a];r.apply(b,arguments);return g.apply(this,b)}};a.compose=function(){var a=arguments;return function(){for(var g=arguments,b=a.length-1;0<=b;b--)g=[a[b].apply(this,g)];return g[0]}};a.after=function(a,g){return function(){if(1>--a)return g.apply(this,arguments)}};a.keys=z||function(d){if(d!==Object(d))throw new TypeError("Invalid object");var g=[],b;for(b in d)a.has(d,b)&&g.push(b);return g};a.values=function(d){var g=[],b;for(b in d)a.has(d,b)&&g.push(d[b]);return g};a.pairs=function(d){var b=
[],e;for(e in d)a.has(d,e)&&b.push([e,d[e]]);return b};a.invert=function(d){var b={},e;for(e in d)a.has(d,e)&&(b[d[e]]=e);return b};a.functions=a.methods=function(d){var b=[],e;for(e in d)a.isFunction(d[e])&&b.push(e);return b.sort()};a.extend=function(a){b(f.call(arguments,1),function(b){if(b)for(var e in b)a[e]=b[e]});return a};a.pick=function(a){var g={},e=l.apply(c,f.call(arguments,1));b(e,function(b){b in a&&(g[b]=a[b])});return g};a.omit=function(d){var b={},e=l.apply(c,f.call(arguments,1)),
h;for(h in d)a.contains(e,h)||(b[h]=d[h]);return b};a.defaults=function(a){b(f.call(arguments,1),function(b){if(b)for(var e in b)void 0===a[e]&&(a[e]=b[e])});return a};a.clone=function(d){return a.isObject(d)?a.isArray(d)?d.slice():a.extend({},d):d};a.tap=function(a,b){b(a);return a};var I=function(d,b,e,h){if(d===b)return 0!==d||1/d==1/b;if(null==d||null==b)return d===b;d instanceof a&&(d=d._wrapped);b instanceof a&&(b=b._wrapped);var k=t.call(d);if(k!=t.call(b))return!1;switch(k){case "[object String]":return d==
String(b);case "[object Number]":return d!=+d?b!=+b:0==d?1/d==1/b:d==+b;case "[object Date]":case "[object Boolean]":return+d==+b;case "[object RegExp]":return d.source==b.source&&d.global==b.global&&d.multiline==b.multiline&&d.ignoreCase==b.ignoreCase}if("object"!=typeof d||"object"!=typeof b)return!1;for(var c=e.length;c--;)if(e[c]==d)return h[c]==b;var c=d.constructor,f=b.constructor;if(c!==f&&!(a.isFunction(c)&&c instanceof c&&a.isFunction(f)&&f instanceof f))return!1;e.push(d);h.push(b);c=0;
f=!0;if("[object Array]"==k){if(c=d.length,f=c==b.length)for(;c--&&(f=I(d[c],b[c],e,h)););}else{for(var B in d)if(a.has(d,B)&&(c++,!(f=a.has(b,B)&&I(d[B],b[B],e,h))))break;if(f){for(B in b)if(a.has(b,B)&&!c--)break;f=!c}}e.pop();h.pop();return f};a.isEqual=function(a,b){return I(a,b,[],[])};a.isEmpty=function(b){if(null==b)return!0;if(a.isArray(b)||a.isString(b))return 0===b.length;for(var e in b)if(a.has(b,e))return!1;return!0};a.isElement=function(a){return!(!a||1!==a.nodeType)};a.isArray=m||function(a){return"[object Array]"==
t.call(a)};a.isObject=function(a){return a===Object(a)};b("Arguments Function String Number Date RegExp".split(" "),function(b){a["is"+b]=function(a){return t.call(a)=="[object "+b+"]"}});a.isArguments(arguments)||(a.isArguments=function(b){return!(!b||!a.has(b,"callee"))});"function"!==typeof/./&&(a.isFunction=function(a){return"function"===typeof a});a.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};a.isNaN=function(b){return a.isNumber(b)&&b!=+b};a.isBoolean=function(a){return!0===
a||!1===a||"[object Boolean]"==t.call(a)};a.isNull=function(a){return null===a};a.isUndefined=function(a){return void 0===a};a.has=function(a,b){return y.call(a,b)};a.noConflict=function(){C._=q;return this};a.identity=function(a){return a};a.times=function(a,b,e){for(var h=Array(Math.max(0,a)),k=0;k<a;k++)h[k]=b.call(e,k);return h};a.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var J={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
J.unescape=a.invert(J.escape);var M={escape:RegExp("["+a.keys(J.escape).join("")+"]","g"),unescape:RegExp("("+a.keys(J.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(b){a[b]=function(a){return null==a?"":(""+a).replace(M[b],function(a){return J[b][a]})}});a.result=function(b,e){if(null!=b){var h=b[e];return a.isFunction(h)?h.call(b):h}};a.mixin=function(d){b(a.functions(d),function(b){var e=a[b]=d[b];a.prototype[b]=function(){var b=[this._wrapped];r.apply(b,arguments);b=e.apply(a,
b);return this._chain?a(b).chain():b}})};var Q=0;a.uniqueId=function(a){var b=++Q+"";return a?a+b:b};a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},S=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(b,e,h){var k;h=a.defaults({},h,a.templateSettings);var c=RegExp([(h.escape||N).source,(h.interpolate||N).source,(h.evaluate||N).source].join("|")+
"|$","g"),t=0,f="__p+='";b.replace(c,function(a,e,g,h,k){f+=b.slice(t,k).replace(S,function(a){return"\\"+R[a]});e&&(f+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'");g&&(f+="'+\n((__t=("+g+"))==null?'':__t)+\n'");h&&(f+="';\n"+h+"\n__p+='");t=k+a.length;return a});f+="';\n";h.variable||(f="with(obj||{}){\n"+f+"}\n");f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{k=new Function(h.variable||"obj","_",f)}catch(B){throw B.source=
f,B;}if(e)return k(e,a);e=function(b){return k.call(this,b,a)};e.source="function("+(h.variable||"obj")+"){\n"+f+"}";return e};a.chain=function(b){return a(b).chain()};a.mixin(a);b("pop push reverse shift sort splice unshift".split(" "),function(b){var e=c[b];a.prototype[b]=function(){var h=this._wrapped;e.apply(h,arguments);"shift"!=b&&"splice"!=b||0!==h.length||delete h[0];return this._chain?a(h).chain():h}});b(["concat","join","slice"],function(b){var e=c[b];a.prototype[b]=function(){var b=e.apply(this._wrapped,
arguments);return this._chain?a(b).chain():b}});a.extend(a.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var C=[].slice,q=function(c,m,r){var f;c=-1;var l=m.length;switch(r.length){case 0:for(;++c<l;)(f=m[c]).callback.call(f.ctx);break;case 1:for(;++c<l;)(f=m[c]).callback.call(f.ctx,r[0]);break;case 2:for(;++c<l;)(f=m[c]).callback.call(f.ctx,r[0],r[1]);break;case 3:for(;++c<l;)(f=m[c]).callback.call(f.ctx,r[0],r[1],r[2]);break;default:for(;++c<l;)(f=m[c]).callback.apply(f.ctx,r)}},n=Backbone.Events={on:function(c,m,r){this._events||(this._events={});(this._events[c]||(this._events[c]=[])).push({callback:m,
context:r,ctx:r||this});return this},once:function(c,m,r){var f=this,l=_.once(function(){f.off(c,l);m.apply(this,arguments)});l._callback=m;this.on(c,l,r);return this},off:function(c,m,r){var f,l,t,n,q,x,u,s;if(!this._events)return this;if(!c&&!m&&!r)return this._events={},this;n=c?[c]:_.keys(this._events);q=0;for(x=n.length;q<x;q++)if(c=n[q],f=this._events[c]){t=[];if(m||r)for(u=0,s=f.length;u<s;u++)l=f[u],(m&&m!==(l.callback._callback||l.callback)||r&&r!==l.context)&&t.push(l);this._events[c]=t}return this},
trigger:function(c){if(!this._events)return this;var m=C.call(arguments,1),r=this._events[c],f=this._events.all;r&&q(this,r,m);f&&q(this,f,arguments);return this},listenTo:function(c,m,r){var f=this._listeners||(this._listeners={}),l=c._listenerId||(c._listenerId=_.uniqueId("l"));f[l]=c;c.on(m,r||this,this);return this},stopListening:function(c,m,r){var f=this._listeners;if(f){if(c)c.off(m,r,this),m||r||delete f[c._listenerId];else{for(var l in f)f[l].off(null,null,this);this._listeners={}}return this}}};
n.bind=n.on;n.unbind=n.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=n),exports.Backbone=exports.Backbone||Backbone)})();(function(){function C(c,f){var l=(new Date).getTime(),t=Math.max(0,16-(l-n)),m=q.setTimeout(function(){c(l+t)},t);n=l+t;return m}var q=this,n=0,c=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=C),exports.requestAnimationFrame=C;else{for(var m=0;m<c.length&&!q.requestAnimationFrame;++m)q.requestAnimationFrame=q[c[m]+"RequestAnimationFrame"],q.cancelAnimationFrame=q[c[m]+"CancelAnimationFrame"]||q[c[m]+"CancelRequestAnimationFrame"];
q.requestAnimationFrame||(q.requestAnimationFrame=C);q.cancelAnimationFrame||(q.cancelAnimationFrame=function(c){clearTimeout(c)})}})();(function(){function C(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a,this.ratio);this.trigger(k.Events.resize,b,a)}var q=this,n=q.Two||{},c=Math.sin,m=Math.cos,r=Math.atan2,f=Math.sqrt,l=Math.abs,t=Math.PI,y=2*t,w=t/2,x=Math.pow,u=0,s={hasEventListeners:_.isFunction(q.addEventListener),bind:function(a,b,h,e){this.hasEventListeners?a.addEventListener(b,h,!!e):a.attachEvent("on"+b,h);return this},unbind:function(a,b,h,e){this.hasEventListeners?
a.removeEventListeners(b,h,!!e):a.detachEvent("on"+b,h);return this}},k=q.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:k.Types.svg,autostart:!1});_.each(a,function(a,h){"fullscreen"!==h&&("width"!==h&&"height"!==h&&"autostart"!==h)&&(this[h]=a)},this);_.isElement(a.domElement)&&(this.type=k.Types[a.domElement.tagName.toLowerCase()]);this.renderer=new k[this.type](this);k.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(C,this),_.extend(document.body.style,
{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),s.bind(q,"resize",a),a()):_.isElement(a.domElement)||(this.renderer.setSize(a.width,a.height,this.ratio),this.width=a.width,this.height=a.height);this.scene=this.renderer.scene;k.Instances.push(this)};_.extend(k,{Array:q.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},
Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){q.Two=n;return this},uniqueId:function(){var a=u;u++;return a},Utils:{Curve:{CollinearityEpsilon:x(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},
devicePixelRatio:q.devicePixelRatio||1,getBackingStoreRatio:function(a){return a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1},getRatio:function(a){return k.Utils.devicePixelRatio/F(a)},setPlaying:function(a){this.playing=!!a;return this},getComputedMatrix:function(a,b){b=b&&b.identity()||new k.Matrix;for(var h=a;h&&h._matrix;){var e=h._matrix.elements;b.multiply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],
e[8],e[9]);h=h.parent}return b},getComputedScale:function(a){for(var b=1;a&&a._scale;)b*=a._scale,a=a.parent;return b},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";_.each(a.attributes,function(a,e){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=
a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});return b},read:{svg:function(){return k.Utils.read.g.apply(this,arguments)},g:function(a){var b=new k.Group;this.add(b);_.each(a.childNodes,function(a){var e=a.nodeName;e&&(e=e.replace(/svg\:/ig,"").toLowerCase(),e in k.Utils.read&&(a=k.Utils.read[e].call(this,a),b.add(a)))},this);return k.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var h=[];a.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,
function(a,b,e){h.push(new k.Anchor(parseFloat(b),parseFloat(e)))});var e=(new k.Polygon(h,!b)).noStroke();return k.Utils.applySvgAttributes(a,e)},polyline:function(a){return k.Utils.read.polygon(a,!0)},path:function(a){var b,h,e,c=!1,t=!1,f=a.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),r=f.length-1,f=_.flatten(_.map(f,function(a,f){var l,m,n=a[0],y=n.toLowerCase();e=a.slice(1).trim();e=e.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,e){return parseFloat(b)*Math.pow(10,e)});e=e.split(/[\s,]+|(?=\s?[+\-])/);
c=n===y;var d,g,p,q;switch(y){case "z":f>=r?t=!0:(m=b.x,l=b.y,l=new k.Anchor(m,l,void 0,void 0,void 0,void 0,k.Commands.close));break;case "m":case "l":m=parseFloat(e[0]);l=parseFloat(e[1]);l=new k.Anchor(m,l,void 0,void 0,void 0,void 0,"m"===y?k.Commands.move:k.Commands.line);c&&l.addSelf(b);b=l;break;case "h":case "v":m="h"===y?"x":"y";n="x"===m?"y":"x";l=new k.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,k.Commands.line);l[m]=parseFloat(e[0]);l[n]=b[n];c&&(l[m]+=b[m]);b=l;break;case "s":case "c":l=
b.x;n=b.y;h||(h=(new k.Vector).copy(b));"c"===y?(d=parseFloat(e[0]),m=parseFloat(e[1]),y=parseFloat(e[2]),g=parseFloat(e[3]),p=parseFloat(e[4]),q=parseFloat(e[5])):(g=k.Utils.getReflection(b,h,c),d=g.x,m=g.y,y=parseFloat(e[0]),g=parseFloat(e[1]),p=parseFloat(e[2]),q=parseFloat(e[3]));c&&(d+=l,m+=n,y+=l,g+=n,p+=l,q+=n);_.isObject(b.controls)||k.Anchor.AppendCurveProperties(b);b.controls.right.set(d,m);b=l=new k.Anchor(p,q,y,g,void 0,void 0,k.Commands.curve);h=l.controls.left;break;case "t":case "q":l=
b.x;n=b.y;h||(h=(new k.Vector).copy(b));h.isZero()?(d=l,m=n):(d=h.x,n=h.y);"q"===y?(y=parseFloat(e[0]),g=parseFloat(e[1]),p=parseFloat(e[1]),q=parseFloat(e[2])):(g=k.Utils.getReflection(b,h,c),y=g.x,g=g.y,p=parseFloat(e[0]),q=parseFloat(e[1]));c&&(d+=l,m+=n,y+=l,g+=n,p+=l,q+=n);_.isObject(b.controls)||k.Anchor.AppendCurveProperties(b);b.controls.right.set(d,m);b=l=new k.Anchor(p,q,y,g,void 0,void 0,k.Commands.curve);h=l.controls.left;break;case "a":throw new k.Utils.Error("not yet able to interpret Elliptical Arcs.");
}return l}));if(!(1>=f.length))return f=_.compact(f),f=(new k.Polygon(f,t,void 0,!0)).noStroke(),k.Utils.applySvgAttributes(a,f)},circle:function(a){var b=parseFloat(a.getAttribute("cx")),h=parseFloat(a.getAttribute("cy")),e=parseFloat(a.getAttribute("r")),f=k.Resolution,t=_.map(_.range(f),function(a){var b=a/f*y;a=e*m(b);b=e*c(b);return new k.Anchor(a,b)},this),t=(new k.Polygon(t,!0,!0)).noStroke();t.translation.set(b,h);return k.Utils.applySvgAttributes(a,t)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),
h=parseFloat(a.getAttribute("cy")),e=parseFloat(a.getAttribute("rx")),f=parseFloat(a.getAttribute("ry")),t=k.Resolution,l=_.map(_.range(t),function(a){var b=a/t*y;a=e*m(b);b=f*c(b);return new k.Anchor(a,b)},this),l=(new k.Polygon(l,!0,!0)).noStroke();l.translation.set(b,h);return k.Utils.applySvgAttributes(a,l)},rect:function(a){var b=parseFloat(a.getAttribute("x")),h=parseFloat(a.getAttribute("y")),e=parseFloat(a.getAttribute("width")),f=parseFloat(a.getAttribute("height")),e=e/2,f=f/2,c=[new k.Anchor(e,
f),new k.Anchor(-e,f),new k.Anchor(-e,-f),new k.Anchor(e,-f)],c=(new k.Polygon(c,!0)).noStroke();c.translation.set(b+e,h+f);return k.Utils.applySvgAttributes(a,c)},line:function(a){var b=parseFloat(a.getAttribute("x1")),h=parseFloat(a.getAttribute("y1")),e=parseFloat(a.getAttribute("x2")),f=parseFloat(a.getAttribute("y2")),e=(e-b)/2,f=(f-h)/2,c=[new k.Anchor(-e,-f),new k.Anchor(e,f)],c=(new k.Polygon(c)).noFill();c.translation.set(b+e,h+f);return k.Utils.applySvgAttributes(a,c)}},subdivide:function(a,
b,h,e,f,c,m,n,q){var s=k.Utils.Curve.CollinearityEpsilon,u=k.Utils.Curve.RecursionLimit,v=k.Utils.Curve.CuspLimit,x=k.Utils.Curve.Tolerance,w;q=q||0;if(q>u)return[];var u=(a+h)/2,d=(b+e)/2,g=(h+f)/2,p=(e+c)/2,A=(f+m)/2,C=(c+n)/2,D=(u+g)/2,E=(d+p)/2,g=(g+A)/2,p=(p+C)/2,z=(D+g)/2,F=(E+p)/2;w=m-a;var L=n-b,O=l((h-m)*L-(e-n)*w),P=l((f-m)*L-(c-n)*w);if(0<q){if(O>s&&P>s&&(O+P)*(O+P)<=x.distance*(w*w+L*L)){if(x.angle<x.epsilon)return[new k.Anchor(z,F)];w=r(c-e,f-h);s=l(w-r(e-b,h-a));w=l(r(n-c,m-f)-w);s>=
t&&(s=y-s);w>=t&&(w=y-w);if(s+w<x.angle)return[new k.Anchor(z,F)];if(0!==v){if(s>v)return[new k.Anchor(h,e)];if(w>v)return[new k.Anchor(f,c)]}}}else if(O>s)if(O*O<=x.distance*(w*w+L*L)){if(x.angle<x.epsilon)return[new k.Anchor(z,F)];s=l(r(c-e,f-h)-r(e-b,h-a));s>=t&&(s=y-s);if(s<x.angle)return[new k.Anchor(h,e),new k.Anchor(f,c)];if(0!==v&&s>v)return[new k.Anchor(h,e)]}else if(P>s){if(P*P<=x.distance*(w*w+L*L)){if(x.angle<x.epsilon)return[new k.Anchor(z,F)];s=l(r(n-c,m-f)-r(c-e,f-h));s>=t&&(s=y-s);
if(s<x.angle)return[new k.Anchor(h,e),new k.Anchor(f,c)];if(0!==v&&s>v)return[new k.Anchor(f,c)]}}else if(w=z-(a+m)/2,L=F-(b+n)/2,w*w+L*L<=x.distance)return[new k.Anchor(z,F)];return k.Utils.subdivide(a,b,u,d,D,E,z,F,q+1).concat(k.Utils.subdivide(z,F,g,p,A,C,m,n,q+1))},getCurveFromPoints:function(a,b){for(var h=a.length,e=h-1,f=0;f<h;f++){var c=a[f];_.isObject(c.controls)||k.Anchor.AppendCurveProperties(c);var t=b?z(f-1,h):Math.max(f-1,0),l=b?z(f+1,h):Math.min(f+1,e);A(a[t],c,a[l]);c._command=0===
f?k.Commands.move:k.Commands.curve;c.controls.left.x=_.isNumber(c.controls.left.x)?c.controls.left.x:c.x;c.controls.left.y=_.isNumber(c.controls.left.y)?c.controls.left.y:c.y;c.controls.right.x=_.isNumber(c.controls.right.x)?c.controls.right.x:c.x;c.controls.right.y=_.isNumber(c.controls.right.y)?c.controls.right.y:c.y}},getControlPoints:function(a,b,h){var e=v(a,b),f=v(h,b);a=D(a,b);h=D(h,b);var l=(e+f)/2;b.u=_.isObject(b.controls.left)?b.controls.left:new k.Vector(b.x,b.y);b.v=_.isObject(b.controls.right)?
b.controls.right:new k.Vector(b.x,b.y);if(1E-4>a||1E-4>h)return b.controls.left.copy(b),b.controls.right.copy(b),b;a*=0.33;h*=0.33;l=f<e?l+w:l-w;b.controls.left.x=b.x+m(l)*a;b.controls.left.y=b.y+c(l)*a;l-=t;b.controls.right.x=b.x+m(l)*h;b.controls.right.y=b.y+c(l)*h;return b},getReflection:function(a,b,h){var e=a.distanceTo(b);if(1E-4>=e)return h?new k.Vector:a.clone();b=v(a,b);return new k.Vector(e*Math.cos(b)+(h?0:a.x),e*Math.sin(b)+(h?0:a.y))},angleBetween:function(a,b){return r(a.y-b.y,a.x-b.x)},
distanceBetweenSquared:function(a,b){var h=a.x-b.x,e=a.y-b.y;return h*h+e*e},distanceBetween:function(a,b){return f(E(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=a}}});k.Utils.Error.prototype=Error();k.Utils.Error.prototype.constructor=k.Utils.Error;k.Utils.Collection.prototype=
[];k.Utils.Collection.constructor=k.Utils.Collection;_.extend(k.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(k.Events.remove,[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(k.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);this.trigger(k.Events.insert,arguments);return a},unshift:function(){var a=Array.prototype.unshift.apply(this,
arguments);this.trigger(k.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,arguments),b;this.trigger(k.Events.remove,a);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(k.Events.insert,b));return a}});var D=k.Utils.distanceBetween,E=k.Utils.distanceBetweenSquared,v=k.Utils.angleBetween,A=k.Utils.getControlPoints,z=k.Utils.mod,F=k.Utils.getBackingStoreRatio;_.extend(k.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);
return this},play:function(){k.Utils.setPlaying.call(this,!0);return this.trigger(k.Events.play)},pause:function(){this.playing=!1;return this.trigger(k.Events.pause)},update:function(){var a=!!this._lastFrame,b=(q.performance&&q.performance.now?q.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,h=this.renderer;a===h.width&&b===h.height||h.setSize(a,b,this.ratio);this.trigger(k.Events.update,this.frameCount,
this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(k.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));return this},makeLine:function(a,b,h,e){h=(h-a)/2;e=(e-b)/2;var c=[new k.Anchor(-h,-e),new k.Anchor(h,e)],c=
(new k.Polygon(c)).noFill();c.translation.set(a+h,b+e);this.scene.add(c);return c},makeRectangle:function(a,b,h,e){h/=2;e/=2;e=[new k.Anchor(h,e),new k.Anchor(-h,e),new k.Anchor(-h,-e),new k.Anchor(h,-e)];e=new k.Polygon(e,!0);e.translation.set(a,b);this.scene.add(e);return e},makeCircle:function(a,b,h){return this.makeEllipse(a,b,h,h)},makeEllipse:function(a,b,h,e){var f=k.Resolution,t=_.map(_.range(f),function(a){var b=a/f*y;a=h*m(b);b=e*c(b);return new k.Anchor(a,b)},this),t=new k.Polygon(t,!0,
!0);t.translation.set(a,b);this.scene.add(t);return t},makeCurve:function(a){var b=arguments.length,h=a;if(!_.isArray(a))for(var h=[],e=0;e<b;e+=2){var c=arguments[e];if(!_.isNumber(c))break;h.push(new k.Anchor(c,arguments[e+1]))}var b=arguments[b-1],h=new k.Polygon(h,!(_.isBoolean(b)&&b),!0),b=h.getBoundingClientRect(),f=b.left+b.width/2,t=b.top+b.height/2;_.each(h.vertices,function(a){a.x-=f;a.y-=t});h.translation.set(f,t);this.scene.add(h);return h},makePolygon:function(a){var b=arguments.length,
h=a;if(!_.isArray(a))for(var h=[],e=0;e<b;e+=2){var c=arguments[e];if(!_.isNumber(c))break;h.push(new k.Anchor(c,arguments[e+1]))}b=arguments[b-1];h=new k.Polygon(h,!(_.isBoolean(b)&&b));b=h.getBoundingClientRect();h.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(h);return h},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var h=new k.Group;this.scene.add(h);h.add(b);return h},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in k.Utils.read))return null;
a=k.Utils.read[b].call(this,a);this.add(a);return a}});(function(){requestAnimationFrame(arguments.callee);_.each(k.Instances,function(a){a.playing&&a.update()})})();"function"===typeof define&&define.amd?define(function(){return k}):"undefined"!=typeof module&&module.exports&&(module.exports=k)})();(function(){var C,q,n,c,m=Two.Vector=function(c,f){this.x=c||0;this.y=f||0};_.extend(m.prototype,Backbone.Events,{set:function(c,f){this.x=c;this.y=f;return this},copy:function(c){this.x=c.x;this.y=c.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new m(this.x,this.y)},add:function(c,f){this.x=c.x+f.x;this.y=c.y+f.y;return this},addSelf:function(c){this.x+=c.x;this.y+=c.y;return this},sub:function(c,f){this.x=c.x-f.x;this.y=c.y-f.y;return this},subSelf:function(c){this.x-=
c.x;this.y-=c.y;return this},multiplySelf:function(c){this.x*=c.x;this.y*=c.y;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;return this},divideScalar:function(c){c?(this.x/=c,this.y/=c):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this.x*c.x+this.y*c.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(f){n=this.x-f.x;c=this.y-f.y;return n*n+c*c},setLength:function(c){return this.normalize().multiplyScalar(c)},equals:function(c){return 1E-4>this.distanceTo(c)},lerp:function(c,f){C=(c.x-this.x)*f+this.x;q=(c.y-this.y)*f+this.y;return this.set(C,q)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var r={set:function(c,
f){this._x=c;this._y=f;return this.trigger(Two.Events.change)},copy:function(c){this._x=c.x;this._y=c.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new m(this._x,this._y)},add:function(c,f){this._x=c.x+f.x;this._y=c.y+f.y;return this.trigger(Two.Events.change)},addSelf:function(c){this._x+=c.x;this._y+=c.y;return this.trigger(Two.Events.change)},sub:function(c,f){this._x=c.x-f.x;this._y=c.y-f.y;return this.trigger(Two.Events.change)},
subSelf:function(c){this._x-=c.x;this._y-=c.y;return this.trigger(Two.Events.change)},multiplySelf:function(c){this._x*=c.x;this._y*=c.y;return this.trigger(Two.Events.change)},multiplyScalar:function(c){this._x*=c;this._y*=c;return this.trigger(Two.Events.change)},divideScalar:function(c){return c?(this._x/=c,this._y/=c,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this._x*c.x+this._y*c.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(f){n=this._x-f.x;c=this._y-f.y;return n*n+c*c},setLength:function(c){return this.normalize().multiplyScalar(c)},equals:function(c){return 1E-4>this.distanceTo(c)},lerp:function(c,f){C=(c.x-this._x)*f+this._x;q=(c.y-this._y)*f+this._y;return this.set(C,q)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},f={get:function(){return this._x},set:function(c){this._x=c;this.trigger(Two.Events.change,"x")}},l={get:function(){return this._y},set:function(c){this._y=c;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",f),Object.defineProperty(this,"y",l),_.extend(this,r),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var C=Two.Commands,q,n,c,m=Two.Anchor=function(c,f,l,n,q,w,x){Two.Vector.call(this,c,f);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(c){this._command=c;this._command!==C.curve||_.isObject(this.controls)||m.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=x||C.move;if(!x)return this;m.AppendCurveProperties(this);_.isNumber(l)&&(this.controls.left.x=
l);_.isNumber(n)&&(this.controls.left.y=n);_.isNumber(q)&&(this.controls.right.x=q);_.isNumber(w)&&(this.controls.right.y=w)};_.extend(m,{AppendCurveProperties:function(c){q=c._x||c.x;n=c._y||c.y;c.controls={left:new Two.Vector(q,n),right:new Two.Vector(q,n)}}});_.extend(m.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||m.AppendCurveProperties(this);_.each(this.controls,function(c){c.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(c){c.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){c=this.controls;return new Two.Anchor(this.x,this.y,c&&c.left.x,c&&c.left.y,c&&c.right.x,c&&c.right.y,this.command)}})})();(function(){_.range(6);var C=Math.cos,q=Math.sin,n=Math.tan,c,m,r,f,l,t,y,w,x,u,s,k,D,E,v,A,z,F,a,b,h,e,H,B,G,I,J,M,Q,N,R,S,d,g,p,ea,V,W,$,ba,X,L,O,P,aa,ca,da,Y,T,Z=[],fa=Two.Matrix=function(a,b,c,e,d,g){this.elements=new Two.Array(9);var f=a;_.isArray(f)||(f=_.toArray(arguments));this.identity().set(f)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(d,f,g){if(3>=f.length)return k,D,E,c=f[0]||0,m=f[1]||0,r=f[2]||0,l=d,k=l[0]*c+l[1]*m+l[2]*r,D=l[3]*c+l[4]*m+l[5]*r,E=l[6]*c+l[7]*m+l[8]*
r,{x:k,y:D,z:E};v=d[0];A=d[1];z=d[2];F=d[3];a=d[4];b=d[5];h=d[6];e=d[7];H=d[8];B=f[0];G=f[1];I=f[2];J=f[3];M=f[4];Q=f[5];N=f[6];R=f[7];S=f[8];g=g||new Two.Array(9);g[0]=v*B+A*J+z*N;g[1]=v*G+A*M+z*R;g[2]=v*I+A*Q+z*S;g[3]=F*B+a*J+b*N;g[4]=F*G+a*M+b*R;g[5]=F*I+a*Q+b*S;g[6]=h*B+e*J+H*N;g[7]=h*G+e*M+H*R;g[8]=h*I+e*Q+H*S;return g}});_.extend(fa.prototype,Backbone.Events,{set:function(a,b,c,e,d,f){s=a;p=arguments.length;_.isArray(s)||(s=_.toArray(arguments));_.each(s,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(c,f,l,m,n,q,t,r,ma){s=arguments;p=s.length;if(1>=p)return _.each(this.elements,function(a,b){this.elements[b]=a*c},this),this.trigger(Two.Events.change);if(3>=p)return k,D,E,c=c||0,f=f||0,l=l||0,n=this.elements,k=n[0]*c+n[1]*f+n[2]*l,D=n[3]*c+n[4]*f+n[5]*l,E=n[6]*c+n[7]*f+n[8]*l,{x:k,y:D,z:E};d=this.elements;g=s;v=d[0];A=d[1];z=d[2];F=d[3];a=d[4];b=d[5];h=d[6];e=d[7];H=d[8];B=
g[0];G=g[1];I=g[2];J=g[3];M=g[4];Q=g[5];N=g[6];R=g[7];S=g[8];this.elements[0]=v*B+A*J+z*N;this.elements[1]=v*G+A*M+z*R;this.elements[2]=v*I+A*Q+z*S;this.elements[3]=F*B+a*J+b*N;this.elements[4]=F*G+a*M+b*R;this.elements[5]=F*I+a*Q+b*S;this.elements[6]=h*B+e*J+H*N;this.elements[7]=h*G+e*M+H*R;this.elements[8]=h*I+e*Q+H*S;return this.trigger(Two.Events.change)},inverse:function(a){c=this.elements;a=a||new Two.Matrix;V=c[0];W=c[1];$=c[2];ba=c[3];X=c[4];L=c[5];O=c[6];P=c[7];aa=c[8];ca=aa*X-L*P;da=-aa*
ba+L*O;Y=P*ba-X*O;T=V*ca+W*da+$*Y;if(!T)return null;T=1/T;a.elements[0]=ca*T;a.elements[1]=(-aa*W+$*P)*T;a.elements[2]=(L*W-$*X)*T;a.elements[3]=da*T;a.elements[4]=(aa*V-$*O)*T;a.elements[5]=(-L*V+$*ba)*T;a.elements[6]=Y*T;a.elements[7]=(-P*V+W*O)*T;a.elements[8]=(X*V-W*ba)*T;return a},scale:function(a,b){p=arguments.length;1>=p&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){r=C(a);ea=q(a);return this.multiply(r,-ea,0,ea,r,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){c=n(a);return this.multiply(1,c,0,0,1,0,0,0,1)},skewY:function(a){c=n(a);return this.multiply(1,0,0,c,1,0,0,0,1)},toString:function(a){this.toArray(a,Z);return Z.join(" ")},toArray:function(a,b){s=this.elements;u=!!b;c=parseFloat(s[0].toFixed(3));m=parseFloat(s[1].toFixed(3));r=parseFloat(s[2].toFixed(3));f=parseFloat(s[3].toFixed(3));l=parseFloat(s[4].toFixed(3));t=parseFloat(s[5].toFixed(3));if(a){y=parseFloat(s[6].toFixed(3));w=parseFloat(s[7].toFixed(3));x=
parseFloat(s[8].toFixed(3));if(u){b[0]=c;b[1]=f;b[2]=y;b[3]=m;b[4]=l;b[5]=w;b[6]=r;b[7]=t;b[8]=x;return}return[c,f,y,m,l,w,r,t,x]}if(u)b[0]=c,b[1]=f,b[2]=m,b[3]=l,b[4]=r,b[5]=t;else return[c,f,m,l,r,t]},clone:function(){c=this.elements[0];m=this.elements[1];r=this.elements[2];f=this.elements[3];l=this.elements[4];t=this.elements[5];y=this.elements[6];w=this.elements[7];x=this.elements[8];return new Two.Matrix(c,m,r,f,l,t,y,w,x)}})})();(function(){var C=Two.Utils.mod,q,n,c,m={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(f,l){c=f;n=document.createElementNS(this.ns,c);"svg"===c&&(l=_.defaults(l||{},{version:this.version}));_.isObject(l)&&m.setAttributes(n,l);return n},setAttribute:function(c,l){this.setAttribute(l,c)},setAttributes:function(c,l){_.each(l,m.setAttribute,c);return this},removeAttribute:function(c,l){this.removeAttribute(l)},removeAttributes:function(c,l){_.each(l,
m.removeAttribute,c);return this},toString:function(c,l){var m=c.length,n=m-1;return _.map(c,function(q,r){var u,s=l?C(r-1,m):Math.max(r-1,0),k=l?C(r+1,m):Math.min(r+1,n),s=c[s],k=c[k],D,E,v,A,z;z=q.x.toFixed(3);A=q.y.toFixed(3);switch(q._command){case Two.Commands.close:u=Two.Commands.close;break;case Two.Commands.curve:D=s.controls&&s.controls.right||s;u=q.controls&&q.controls.left||q;s=D.x.toFixed(3);D=D.y.toFixed(3);E=u.x.toFixed(3);v=u.y.toFixed(3);u=(0===r?Two.Commands.move:Two.Commands.curve)+
" "+s+" "+D+" "+E+" "+v+" "+z+" "+A;break;default:u=(0===r?Two.Commands.move:q._command)+" "+z+" "+A}r>=n&&l&&(q._command===Two.Commands.curve&&(A=q.controls&&q.controls.right||q,z=k.controls&&k.controls.left||k,s=A.x.toFixed(3),D=A.y.toFixed(3),E=z.x.toFixed(3),v=z.y.toFixed(3),z=k.x.toFixed(3),A=k.y.toFixed(3),u+=" C "+s+" "+D+" "+E+" "+v+" "+z+" "+A),u+=" Z");return u}).join(" ")},group:{appendChild:function(c){(n=this.domElement.querySelector("#"+Two.Identifier+c))&&this.elem.appendChild(n)},
removeChild:function(c){(n=this.domElement.querySelector("#"+Two.Identifier+c))&&this.elem.removeChild(n)},renderChild:function(c){m[c._renderer.type].render.call(c,this)},render:function(c){this.update();this._renderer.elem||(this._renderer.elem=m.createElement("g",{id:Two.Identifier+this.id}),c.appendChild(this._renderer.elem));q=this._matrix.manual||this._flagMatrix;var l={domElement:c,elem:this._renderer.elem};q&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");
_.each(this.children,m.group.renderChild,c);this._flagAdditions&&_.each(this.additions,m.group.appendChild,l);this._flagSubtractions&&_.each(this.subtractions,m.group.removeChild,l);return this.flagReset()}},polygon:{render:function(c){this.update();this._renderer.elem||(this._renderer.elem=m.createElement("path",{id:Two.Identifier+this.id}),c.appendChild(this._renderer.elem));n=this._renderer.elem;(q=this._matrix.manual||this._flagMatrix)&&n.setAttribute("transform","matrix("+this._matrix.toString()+
")");this._flagVertices&&(vertices=m.toString(this._vertices,this._closed),n.setAttribute("d",vertices));this._flagFill&&n.setAttribute("fill",this._fill);this._flagStroke&&n.setAttribute("stroke",this._stroke);this._flagLinewidth&&n.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(n.setAttribute("stroke-opacity",this._opacity),n.setAttribute("fill-opacity",this._opacity));this._flagVisible&&n.setAttribute("visibility",this._visible?"visible":"hidden");this._flagCap&&n.setAttribute("stroke-linecap",
this._cap);this._flagJoin&&n.setAttribute("stroke-linejoin",this._join);this._flagMiter&&n.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},r=Two[Two.Types.svg]=function(c){this.domElement=c.domElement||m.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(r,{Utils:m});_.extend(r.prototype,Backbone.Events,{setSize:function(c,l){this.width=c;this.height=l;m.setAttributes(this.domElement,{width:c,height:l});return this},render:function(){m.group.render.call(this.scene,
this.domElement);return this}})})();(function(){var C=Two.Utils.mod,q=Two.Utils.getRatio,n,c,m,r,f,l,t,y,w,x,u,s,k,D,E,v,A,z,F,a,b,h,e,H,B,G,I,J={group:{renderChild:function(a){J[a._renderer.type].render.call(a,this)},render:function(a){this.update();n=this._matrix.elements;a.save();a.transform(n[0],n[3],n[1],n[4],n[2],n[5]);_.each(this.children,J.group.renderChild,a);a.restore();return this.flagReset()}},polygon:{render:function(q){this.update();n=this._matrix.elements;c=this.stroke;m=this.linewidth;r=this.fill;f=this.opacity;l=this.visible;
t=this.cap;y=this.join;w=this.miter;x=this.closed;u=this._vertices;s=u.length;k=s-1;if(!l)return this;q.save();n&&q.transform(n[0],n[3],n[1],n[4],n[2],n[5]);r&&(q.fillStyle=r);c&&(q.strokeStyle=c);m&&(q.lineWidth=m);w&&(q.miterLimit=w);y&&(q.lineJoin=y);t&&(q.lineCap=t);_.isNumber(f)&&(q.globalAlpha=f);q.beginPath();_.each(u,function(c,f){G=c.x.toFixed(3);I=c.y.toFixed(3);switch(c._command){case Two.Commands.close:q.closePath();break;case Two.Commands.curve:E=x?C(f-1,s):Math.max(f-1,0);D=x?C(f+1,
s):Math.min(f+1,k);v=u[E];A=u[D];h=v.controls&&v.controls.right||v;e=c.controls&&c.controls.left||c;a=h.x.toFixed(3);b=h.y.toFixed(3);z=e.x.toFixed(3);F=e.y.toFixed(3);q.bezierCurveTo(a,b,z,F,G,I);f>=k&&x&&(H=c.controls&&c.controls.right||c,B=A.controls&&A.controls.left||A,a=H.x.toFixed(3),b=H.y.toFixed(3),z=B.x.toFixed(3),F=B.y.toFixed(3),G=A.x.toFixed(3),I=A.y.toFixed(3),q.bezierCurveTo(a,b,z,F,G,I));break;case Two.Commands.line:q.lineTo(G,I);break;case Two.Commands.move:q.moveTo(G,I)}});x&&q.closePath();
q.fill();q.stroke();q.restore();return this.flagReset()}}},M=Two[Two.Types.canvas]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.scene=new Two.Group;this.scene.parent=this};_.extend(M,{Utils:J});_.extend(M.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?q(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=b*this.ratio;_.extend(this.domElement.style,
{width:a+"px",height:b+"px"});return this},render:function(){var a=1===this.ratio;a||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);J.group.render.call(this.scene,this.ctx);a||this.ctx.restore();return this}})})();(function(){var C=Two.Matrix.Multiply,q=Two.Utils.mod,n=[1,0,0,0,1,0,0,0,1],c=new Two.Array(9),m=Two.Utils.getRatio,r,f,l,t,y,w,x,u,s,k,D,E,v,A,z,F,a,b,h,e,H,B,G,I,J,M,Q,N,R,S,d,g,p,ea,V,W,$,ba,X,L,O,P,aa,ca,da,Y,T,Z,fa,ga,K,ia,ja,ka,ha,U={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){U[a._renderer.type].render.call(a,this.gl,this.program)},render:function(a,b){this.update();r=this.parent;f=r._matrix&&r._matrix.manual||r._flagMatrix;
l=this._matrix.manual||this._flagMatrix;if(f||l)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,c),C(c,r._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*r._renderer.scale,f&&(this._flagMatrix=!0);_.each(this.children,U.group.renderChild,{gl:a,program:b});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;r=this.parent;f=r._matrix.manual||r._flagMatrix;l=this._matrix.manual||this._flagMatrix;
t=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this.update();if(f||l)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,c),C(c,r._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*r._renderer.scale;t&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),
U.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),U.getTriangles(this._renderer.rect,this._renderer.triangles),U.updateBuffer(a,this,b),U.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,
!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(c,e,d){y=Infinity;w=-Infinity;x=Infinity;u=-Infinity;_.each(c,function(b,c){s=b.x;k=b.y;D;E;v;A;z=b.controls;x=Math.min(k,x);y=Math.min(s,y);w=Math.max(s,w);u=Math.max(k,u);b.controls&&(F=z.left,a=z.right,F&&a&&(D=F.x,E=F.y,v=a.x,A=a.y,D&&(E&&v&&A)&&(x=Math.min(E,A,x),y=Math.min(D,v,y),w=Math.max(D,v,w),u=Math.max(E,A,u))))});_.isNumber(e)&&(x-=e,y-=e,w+=e,u+=e);b=w-y;h=u-x;d.top=x;d.left=y;d.right=w;d.bottom=
u;d.width=b;d.height=h;d.centroid||(d.centroid={});d.centroid.x=-y;d.centroid.y=-x},getTriangles:function(a,b){x=a.top;y=a.left;w=a.right;u=a.bottom;b[0]=y;b[1]=x;b[2]=w;b[3]=x;b[4]=y;b[5]=u;b[6]=y;b[7]=u;b[8]=w;b[9]=x;b[10]=w;b[11]=u},updateCanvas:function(a){e=a._vertices;H=this.canvas;B=this.ctx;G=a._renderer.scale;I=a._stroke;J=a._linewidth*G;M=a._fill;Q=a._opacity;N=a._cap;R=a._join;S=a._miter;d=a._closed;g=e.length;p=g-1;H.width=Math.max(Math.ceil(a._renderer.rect.width*G),1);H.height=Math.max(Math.ceil(a._renderer.rect.height*
G),1);ea=a._renderer.rect.centroid;V=ea.x*G;W=ea.y*G;B.clearRect(0,0,H.width,H.height);M&&(B.fillStyle=M);I&&(B.strokeStyle=I);J&&(B.lineWidth=J);S&&(B.miterLimit=S);R&&(B.lineJoin=R);N&&(B.lineCap=N);_.isNumber(Q)&&(B.globalAlpha=Q);B.beginPath();_.each(e,function(a,b){$;ba;D;v;X;L;O;P;aa;ca;da;F;s=(a.x*G+V).toFixed(3);k=(a.y*G+W).toFixed(3);switch(a._command){case Two.Commands.close:B.closePath();break;case Two.Commands.curve:ba=d?q(b-1,g):Math.max(b-1,0);$=d?q(b+1,g):Math.min(b+1,p);D=e[ba];v=
e[$];aa=D.controls&&D.controls.right||D;ca=a.controls&&a.controls.left||a;O=(aa.x*G+V).toFixed(3);P=(aa.y*G+W).toFixed(3);X=(ca.x*G+V).toFixed(3);L=(ca.y*G+W).toFixed(3);B.bezierCurveTo(O,P,X,L,s,k);b>=p&&d&&(da=a.controls&&a.controls.right||a,F=v.controls&&v.controls.left||v,O=(da.x*G+V).toFixed(3),P=(da.y*G+W).toFixed(3),X=(F.x*G+V).toFixed(3),L=(F.y*G+W).toFixed(3),s=(v.x*G+V).toFixed(3),k=(v.y*G+W).toFixed(3),B.bezierCurveTo(O,P,X,L,s,k));break;case Two.Commands.line:B.lineTo(s,k);break;case Two.Commands.move:B.moveTo(s,
k)}});d&&B.closePath();B.fill();B.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||
0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=
a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){Y=a.createProgram();_.each(b,function(b){a.attachShader(Y,b)});a.linkProgram(Y);T=a.getProgramParameter(Y,a.LINK_STATUS);if(!T)throw ga=a.getProgramInfoLog(Y),a.deleteProgram(Y),new Two.Utils.Error("unable to link program: "+ga);return Y}},shaders:{create:function(a,b,c){Z=a.createShader(a[c]);a.shaderSource(Z,
b);a.compileShader(Z);fa=a.getShaderParameter(Z,a.COMPILE_STATUS);if(!fa)throw ga=a.getShaderInfoLog(Z),a.deleteShader(Z),new Two.Utils.Error("unable to compile shader "+Z+": "+ga);return Z},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};U.ctx=U.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(n),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;K=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=U.shaders.create(K,U.shaders.vertex,U.shaders.types.vertex);ja=U.shaders.create(K,U.shaders.fragment,U.shaders.types.fragment);this.program=U.program.create(K,[ka,ja]);K.useProgram(this.program);this.program.position=K.getAttribLocation(this.program,
"a_position");this.program.matrix=K.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=K.getAttribLocation(this.program,"a_textureCoords");K.disable(K.DEPTH_TEST);K.enable(K.BLEND);K.blendEquationSeparate(K.FUNC_ADD,K.FUNC_ADD);K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?m(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){K=this.ctx;this.overdraw||K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT);U.group.render.call(this.scene,K,this.program);this._flagMatrix=!1;return this}})})();(function(){new Two.Vector;var C,q=Two.Shape=function(n){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(q.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(q,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(n){Object.defineProperty(n,"rotation",{get:function(){return this._rotation},set:function(c){this._rotation=c;this._flagMatrix=!0}});Object.defineProperty(n,
"scale",{get:function(){return this._scale},set:function(c){this._scale=c;this._flagScale=this._flagMatrix=!0}})}});_.extend(q.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(n){n.add(this);return this},clone:function(){C=new q;C.translation.copy(this.translation);C.rotation=this.rotation;C.scale=this.scale;_.each(q.Properties,function(n){C[n]=this[n]},this);return C.update()},update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});q.MakeObservable(q.prototype)})();(function(){var C=Math.min,q=Math.max,n=Math.round,c=Two.Utils.getComputedMatrix,m,r,f,l,t,y,w,x,u,s,k,D,E,v,A,z,F,a,b,h,e,H,B,G,I,J,M,Q,N,R,S,d=Two.Polygon=function(a,b,c,e){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!c;this._automatic=!e;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4;this._vertices=[];this.vertices=a};_.extend(d,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),
FlagVertices:function(){this._flagVertices=!0},MakeObservable:function(a){Two.Shape.MakeObservable(a);_.each(d.Properties.slice(0,8),function(b){var c="_"+b,e="_flag"+b.charAt(0).toUpperCase()+b.slice(1);Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a;this[e]=!0}})});Object.defineProperty(a,"closed",{get:function(){return this._closed},set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(a,"curved",{get:function(){return this._curved},
set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(a,"automatic",{get:function(){return this._automatic},set:function(a){a!==this._automatic&&(this._automatic=!!a)}});Object.defineProperty(a,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=C(q(a,0),1);this._flagVertices=!0}});Object.defineProperty(a,"ending",{get:function(){return this._ending},set:function(a){this._ending=C(q(a,0),1);this._flagVertices=!0}});Object.defineProperty(a,
"vertices",{get:function(){return this._collection},set:function(a){var b=_.bind(d.FlagVertices,this),c=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,b)},this);b()},this),e=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,b)},this);b()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(a.slice(0));this._collection.bind(Two.Events.insert,c);this._collection.bind(Two.Events.remove,e);verticesChanged=!0;c(this._collection)}})}});
_.extend(d.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;x=_.map(this.vertices,function(a){return a.clone()});u=new d(x,this.closed,this.curved,!this.automatic);_.each(Two.Shape.Properties,
function(a){u[a]=this[a]},this);u.translation.copy(this.translation);u.rotation=this.rotation;u.scale=this.scale;a.add(u);return u},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){s=this.getBoundingClientRect(!0);k={x:s.left,y:s.top};_.each(this.vertices,function(a){a.subSelf(k)});return this},center:function(){s=this.getBoundingClientRect(!0);s.centroid={x:s.left+s.width/2,y:s.top+s.height/2};_.each(this.vertices,
function(a){a.subSelf(s.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(d){this.update();D=this.linewidth/2;void 0;E=Infinity;v=-Infinity;A=Infinity;z=-Infinity;_.each(this._vertices,function(b){F=b.x;a=b.y;A=C(a,A);E=C(F,E);v=q(F,v);z=q(a,z)});A-=D;E-=D;v+=D;z+=D;B=d?this._matrix:c(this);b=B.multiply(E,A,1);h=B.multiply(v,A,1);e=B.multiply(v,z,1);H=B.multiply(E,z,1);A=C(b.y,h.y,e.y,H.y);E=C(b.x,h.x,e.x,H.x);
v=q(b.x,h.x,e.x,H.x);z=q(b.y,h.y,e.y,H.y);return{top:A,left:E,right:v,bottom:z,width:v-E,height:z-A}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this.vertices,this.closed),this;_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(){l=this.vertices.length-1;t=this._closed||this.vertices[l].command===Two.Commands.close;x=[];_.each(this.vertices,function(a,b){0>=b&&!t||(v=h.controls&&h.controls.right,E=
a.controls&&a.controls.left,G=h.x,I=h.y,J=(v||h).x,M=(v||h).y,Q=(E||a).x,N=(E||a).y,R=a.x,S=a.y,x.push(Two.Utils.subdivide(G,I,J,M,Q,N,R,S)));h=a},this);this._curved=this._automatic=!1;this.vertices=_.flatten(x);this.plot();return this},update:function(){if(this._flagVertices)for(this._automatic&&this.plot(),m=this.vertices.length,l=m-1,r=n(this._beginning*l),f=n(this._ending*l),this._vertices.length=0,w=r;w<f+1;w++)y=this.vertices[w],this._vertices.push(y);Two.Shape.prototype.update.call(this);return this},
flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});d.MakeObservable(d.prototype)})();(function(){var C=Math.min,q=Math.max,n,c,m,r,f,l,t,y,w,x,u,s,k,D,E,v,A,z,F,a,b,h=Two.Group=function(a){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(h,{MakeObservable:function(a){Two.Shape.MakeObservable(a);h.MakeGetterSetter(a,Two.Polygon.Properties)},MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]);_.each(b,function(b){n="_"+b;Object.defineProperty(a,b,{get:function(){return this[n]},set:function(a){this[n]=a;_.each(this.children,
function(c){c[b]=a})}})})}});_.extend(h.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;m=_.map(this.children,function(a){return a.clone()});r=new h;a.add(r);r.add(m);r.translation.copy(this.translation);r.rotation=this.rotation;r.scale=this.scale;return r},corner:function(){f=this.getBoundingClientRect(!0);
l={x:f.left,y:f.top};_.each(this.children,function(a){a.translation.subSelf(l)});return this},center:function(){f=this.getBoundingClientRect(!0);f.centroid={x:f.left+f.width/2,y:f.top+f.height/2};_.each(this.children,function(a){a.translation.subSelf(f.centroid)});return this},add:function(a){t=arguments.length;y=a;m=this.children;w=this.parent;x=this.additions;_.isArray(a)||(y=_.toArray(arguments));_.each(y,function(a){a&&(u=a.id,c=a.parent,_.isUndefined(m[u])&&(c&&(delete c.children[u],b=_.indexOf(c.additions,
u),0<=b&&c.additions.splice(b,1)),m[u]=a,a.parent=this,x.push(u),this._flagAdditions=!0))},this);return this},remove:function(a){t=arguments.length;y=a;m=this.children;w=this.parent;x=this.subtractions;if(0>=t&&w)return w.remove(this),this;_.isArray(a)||(y=_.toArray(arguments));_.each(y,function(a){u=a.id;grandchildren=a.children;c=a.parent;u in m&&(delete m[u],delete a.parent,b=_.indexOf(c.additions,u),0<=b&&c.additions.splice(b,1),x.push(u),this._flagSubtractions=!0)});return this},getBoundingClientRect:function(b){this.update();
s=Infinity;k=-Infinity;D=Infinity;E=-Infinity;_.each(this.children,function(a){f=a.getBoundingClientRect(!0);_.isNumber(f.top)&&(_.isNumber(f.left)&&_.isNumber(f.right)&&_.isNumber(f.bottom))&&(D=C(f.top,D),s=C(f.left,s),k=q(f.right,k),E=q(f.bottom,E))},this);v=b?this._matrix:Two.Utils.getComputedMatrix(this);A=v.multiply(s,D,1);z=v.multiply(k,D,1);F=v.multiply(k,E,1);a=v.multiply(s,E,1);D=C(A.y,z.y,F.y,a.y);s=C(A.x,z.x,F.x,a.x);k=q(A.x,z.x,F.x,a.x);E=q(A.y,z.y,F.y,a.y);return{top:D,left:s,right:k,
bottom:E,width:k-s,height:E-D}},noFill:function(){_.each(this.children,function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this},subdivide:function(){_.each(this.children,function(a){a.subdivide()});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);return this}});h.MakeObservable(h.prototype)})();
