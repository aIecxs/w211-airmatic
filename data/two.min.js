(function(){var D=this,p=D._,m={},e=Array.prototype,q=Object.prototype,k=e.push,l=e.slice,s=e.concat,d=q.toString,x=q.hasOwnProperty,B=e.forEach,w=e.map,y=e.reduce,v=e.reduceRight,g=e.filter,E=e.every,C=e.some,t=e.indexOf,F=e.lastIndexOf,q=Array.isArray,z=Object.keys,A=Function.prototype.bind,a=function(f){if(f instanceof a)return f;if(!(this instanceof a))return new a(f);this._wrapped=f};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=a),exports._=
a):D._=a;a.VERSION="1.5.1";var b=a.each=a.forEach=function(f,h,u){if(null!=f)if(B&&f.forEach===B)f.forEach(h,u);else if(f.length===+f.length)for(var b=0,c=f.length;b<c&&h.call(u,f[b],b,f)!==m;b++);else for(b in f)if(a.has(f,b)&&h.call(u,f[b],b,f)===m)break};a.map=a.collect=function(a,h,u){var c=[];if(null==a)return c;if(w&&a.map===w)return a.map(h,u);b(a,function(a,f,b){c.push(h.call(u,a,f,b))});return c};a.reduce=a.foldl=a.inject=function(f,h,u,c){var g=2<arguments.length;null==f&&(f=[]);if(y&&f.reduce===
y)return c&&(h=a.bind(h,c)),g?f.reduce(h,u):f.reduce(h);b(f,function(a,f,b){g?u=h.call(c,u,a,f,b):(u=a,g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");return u};a.reduceRight=a.foldr=function(f,h,u,c){var g=2<arguments.length;null==f&&(f=[]);if(v&&f.reduceRight===v)return c&&(h=a.bind(h,c)),g?f.reduceRight(h,u):f.reduceRight(h);var n=f.length;if(n!==+n)var d=a.keys(f),n=d.length;b(f,function(a,b,e){b=d?d[--n]:--n;g?u=h.call(c,u,f[b],b,e):(u=f[b],g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");
return u};a.find=a.detect=function(a,h,u){var b;c(a,function(a,f,c){if(h.call(u,a,f,c))return b=a,!0});return b};a.filter=a.select=function(a,h,u){var c=[];if(null==a)return c;if(g&&a.filter===g)return a.filter(h,u);b(a,function(a,f,b){h.call(u,a,f,b)&&c.push(a)});return c};a.reject=function(f,h,u){return a.filter(f,function(a,f,b){return!h.call(u,a,f,b)},u)};a.every=a.all=function(f,h,u){h||(h=a.identity);var c=!0;if(null==f)return c;if(E&&f.every===E)return f.every(h,u);b(f,function(a,f,b){if(!(c=
c&&h.call(u,a,f,b)))return m});return!!c};var c=a.some=a.any=function(f,h,u){h||(h=a.identity);var c=!1;if(null==f)return c;if(C&&f.some===C)return f.some(h,u);b(f,function(a,f,b){if(c||(c=h.call(u,a,f,b)))return m});return!!c};a.contains=a.include=function(a,h){return null==a?!1:t&&a.indexOf===t?-1!=a.indexOf(h):c(a,function(a){return a===h})};a.invoke=function(f,h){var u=l.call(arguments,2),b=a.isFunction(h);return a.map(f,function(a){return(b?h:a[h]).apply(a,u)})};a.pluck=function(f,h){return a.map(f,
function(a){return a[h]})};a.where=function(f,h,u){return a.isEmpty(h)?u?void 0:[]:a[u?"find":"filter"](f,function(a){for(var f in h)if(h[f]!==a[f])return!1;return!0})};a.findWhere=function(f,h){return a.where(f,h,!0)};a.max=function(f,h,u){if(!h&&a.isArray(f)&&f[0]===+f[0]&&65535>f.length)return Math.max.apply(Math,f);if(!h&&a.isEmpty(f))return-Infinity;var c={computed:-Infinity,value:-Infinity};b(f,function(a,f,b){f=h?h.call(u,a,f,b):a;f>c.computed&&(c={value:a,computed:f})});return c.value};a.min=
function(f,h,u){if(!h&&a.isArray(f)&&f[0]===+f[0]&&65535>f.length)return Math.min.apply(Math,f);if(!h&&a.isEmpty(f))return Infinity;var c={computed:Infinity,value:Infinity};b(f,function(a,f,b){f=h?h.call(u,a,f,b):a;f<c.computed&&(c={value:a,computed:f})});return c.value};a.shuffle=function(f){var h,u=0,c=[];b(f,function(f){h=a.random(u++);c[u-1]=c[h];c[h]=f});return c};var n=function(f){return a.isFunction(f)?f:function(a){return a[f]}};a.sortBy=function(f,h,b){var c=n(h);return a.pluck(a.map(f,function(a,
f,h){return{value:a,index:f,criteria:c.call(b,a,f,h)}}).sort(function(a,f){var h=a.criteria,b=f.criteria;if(h!==b){if(h>b||void 0===h)return 1;if(h<b||void 0===b)return-1}return a.index<f.index?-1:1}),"value")};var H=function(f,h,u,c){var g={},d=n(null==h?a.identity:h);b(f,function(a,h){var b=d.call(u,a,h,f);c(g,b,a)});return g};a.groupBy=function(f,h,b){return H(f,h,b,function(f,h,b){(a.has(f,h)?f[h]:f[h]=[]).push(b)})};a.countBy=function(f,h,b){return H(f,h,b,function(f,h){a.has(f,h)||(f[h]=0);
f[h]++})};a.sortedIndex=function(f,h,b,c){b=null==b?a.identity:n(b);h=b.call(c,h);for(var g=0,d=f.length;g<d;){var e=g+d>>>1;b.call(c,f[e])<h?g=e+1:d=e}return g};a.toArray=function(f){return f?a.isArray(f)?l.call(f):f.length===+f.length?a.map(f,a.identity):a.values(f):[]};a.size=function(f){return null==f?0:f.length===+f.length?f.length:a.keys(f).length};a.first=a.head=a.take=function(a,h,b){return null==a?void 0:null==h||b?a[0]:l.call(a,0,h)};a.initial=function(a,h,b){return l.call(a,0,a.length-
(null==h||b?1:h))};a.last=function(a,h,b){return null==a?void 0:null==h||b?a[a.length-1]:l.call(a,Math.max(a.length-h,0))};a.rest=a.tail=a.drop=function(a,h,b){return l.call(a,null==h||b?1:h)};a.compact=function(f){return a.filter(f,a.identity)};var r=function(f,h,c){if(h&&a.every(f,a.isArray))return s.apply(c,f);b(f,function(f){a.isArray(f)||a.isArguments(f)?h?k.apply(c,f):r(f,h,c):c.push(f)});return c};a.flatten=function(a,h){return r(a,h,[])};a.without=function(f){return a.difference(f,l.call(arguments,
1))};a.uniq=a.unique=function(f,h,c,g){a.isFunction(h)&&(g=c,c=h,h=!1);c=c?a.map(f,c,g):f;var n=[],d=[];b(c,function(b,c){(h?c&&d[d.length-1]===b:a.contains(d,b))||(d.push(b),n.push(f[c]))});return n};a.union=function(){return a.uniq(a.flatten(arguments,!0))};a.intersection=function(f){var h=l.call(arguments,1);return a.filter(a.uniq(f),function(f){return a.every(h,function(h){return 0<=a.indexOf(h,f)})})};a.difference=function(f){var h=s.apply(e,l.call(arguments,1));return a.filter(f,function(f){return!a.contains(h,
f)})};a.zip=function(){for(var f=a.max(a.pluck(arguments,"length").concat(0)),h=Array(f),b=0;b<f;b++)h[b]=a.pluck(arguments,""+b);return h};a.object=function(a,h){if(null==a)return{};for(var b={},c=0,g=a.length;c<g;c++)h?b[a[c]]=h[c]:b[a[c][0]]=a[c][1];return b};a.indexOf=function(f,h,b){if(null==f)return-1;var c=0,g=f.length;if(b)if("number"==typeof b)c=0>b?Math.max(0,g+b):b;else return c=a.sortedIndex(f,h),f[c]===h?c:-1;if(t&&f.indexOf===t)return f.indexOf(h,b);for(;c<g;c++)if(f[c]===h)return c;
return-1};a.lastIndexOf=function(a,h,b){if(null==a)return-1;var c=null!=b;if(F&&a.lastIndexOf===F)return c?a.lastIndexOf(h,b):a.lastIndexOf(h);for(b=c?b:a.length;b--;)if(a[b]===h)return b;return-1};a.range=function(a,h,b){1>=arguments.length&&(h=a||0,a=0);b=arguments[2]||1;for(var c=Math.max(Math.ceil((h-a)/b),0),g=0,n=Array(c);g<c;)n[g++]=a,a+=b;return n};var G=function(){};a.bind=function(f,h){var b,c;if(A&&f.bind===A)return A.apply(f,l.call(arguments,1));if(!a.isFunction(f))throw new TypeError;
b=l.call(arguments,2);return c=function(){if(!(this instanceof c))return f.apply(h,b.concat(l.call(arguments)));G.prototype=f.prototype;var a=new G;G.prototype=null;var g=f.apply(a,b.concat(l.call(arguments)));return Object(g)===g?g:a}};a.partial=function(a){var h=l.call(arguments,1);return function(){return a.apply(this,h.concat(l.call(arguments)))}};a.bindAll=function(f){var h=l.call(arguments,1);if(0===h.length)throw Error("bindAll must be passed function names");b(h,function(h){f[h]=a.bind(f[h],
f)});return f};a.memoize=function(f,h){var b={};h||(h=a.identity);return function(){var c=h.apply(this,arguments);return a.has(b,c)?b[c]:b[c]=f.apply(this,arguments)}};a.delay=function(a,h){var b=l.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},h)};a.defer=function(f){return a.delay.apply(a,[f,1].concat(l.call(arguments,1)))};a.throttle=function(a,h,b){var c,g,n,d=null,e=0;b||(b={});var r=function(){e=!1===b.leading?0:new Date;d=null;n=a.apply(c,g)};return function(){var k=
new Date;e||!1!==b.leading||(e=k);var s=h-(k-e);c=this;g=arguments;0>=s?(clearTimeout(d),d=null,e=k,n=a.apply(c,g)):d||!1===b.trailing||(d=setTimeout(r,s));return n}};a.debounce=function(a,h,b){var c,g=null;return function(){var n=this,d=arguments,e=b&&!g;clearTimeout(g);g=setTimeout(function(){g=null;b||(c=a.apply(n,d))},h);e&&(c=a.apply(n,d));return c}};a.once=function(a){var h=!1,b;return function(){if(h)return b;h=!0;b=a.apply(this,arguments);a=null;return b}};a.wrap=function(a,b){return function(){var c=
[a];k.apply(c,arguments);return b.apply(this,c)}};a.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};a.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};a.keys=z||function(f){if(f!==Object(f))throw new TypeError("Invalid object");var b=[],c;for(c in f)a.has(f,c)&&b.push(c);return b};a.values=function(f){var b=[],c;for(c in f)a.has(f,c)&&b.push(f[c]);return b};a.pairs=function(f){var b=
[],c;for(c in f)a.has(f,c)&&b.push([c,f[c]]);return b};a.invert=function(f){var b={},c;for(c in f)a.has(f,c)&&(b[f[c]]=c);return b};a.functions=a.methods=function(f){var b=[],c;for(c in f)a.isFunction(f[c])&&b.push(c);return b.sort()};a.extend=function(a){b(l.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};a.pick=function(a){var c={},g=s.apply(e,l.call(arguments,1));b(g,function(b){b in a&&(c[b]=a[b])});return c};a.omit=function(f){var b={},c=s.apply(e,l.call(arguments,1)),
g;for(g in f)a.contains(c,g)||(b[g]=f[g]);return b};a.defaults=function(a){b(l.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])});return a};a.clone=function(b){return a.isObject(b)?a.isArray(b)?b.slice():a.extend({},b):b};a.tap=function(a,b){b(a);return a};var I=function(b,c,g,n){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b instanceof a&&(b=b._wrapped);c instanceof a&&(c=c._wrapped);var e=d.call(b);if(e!=d.call(c))return!1;switch(e){case "[object String]":return b==
String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==+c;case "[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var r=g.length;r--;)if(g[r]==b)return n[r]==c;var r=b.constructor,k=c.constructor;if(r!==k&&!(a.isFunction(r)&&r instanceof r&&a.isFunction(k)&&k instanceof k))return!1;g.push(b);n.push(c);r=0;
k=!0;if("[object Array]"==e){if(r=b.length,k=r==c.length)for(;r--&&(k=I(b[r],c[r],g,n)););}else{for(var s in b)if(a.has(b,s)&&(r++,!(k=a.has(c,s)&&I(b[s],c[s],g,n))))break;if(k){for(s in c)if(a.has(c,s)&&!r--)break;k=!r}}g.pop();n.pop();return k};a.isEqual=function(a,b){return I(a,b,[],[])};a.isEmpty=function(b){if(null==b)return!0;if(a.isArray(b)||a.isString(b))return 0===b.length;for(var c in b)if(a.has(b,c))return!1;return!0};a.isElement=function(a){return!(!a||1!==a.nodeType)};a.isArray=q||function(a){return"[object Array]"==
d.call(a)};a.isObject=function(a){return a===Object(a)};b("Arguments Function String Number Date RegExp".split(" "),function(b){a["is"+b]=function(a){return d.call(a)=="[object "+b+"]"}});a.isArguments(arguments)||(a.isArguments=function(b){return!(!b||!a.has(b,"callee"))});"function"!==typeof/./&&(a.isFunction=function(a){return"function"===typeof a});a.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};a.isNaN=function(b){return a.isNumber(b)&&b!=+b};a.isBoolean=function(a){return!0===
a||!1===a||"[object Boolean]"==d.call(a)};a.isNull=function(a){return null===a};a.isUndefined=function(a){return void 0===a};a.has=function(a,b){return x.call(a,b)};a.noConflict=function(){D._=p;return this};a.identity=function(a){return a};a.times=function(a,b,c){for(var g=Array(Math.max(0,a)),n=0;n<a;n++)g[n]=b.call(c,n);return g};a.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var J={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
J.unescape=a.invert(J.escape);var L={escape:RegExp("["+a.keys(J.escape).join("")+"]","g"),unescape:RegExp("("+a.keys(J.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(b){a[b]=function(a){return null==a?"":(""+a).replace(L[b],function(a){return J[b][a]})}});a.result=function(b,c){if(null!=b){var g=b[c];return a.isFunction(g)?g.call(b):g}};a.mixin=function(c){b(a.functions(c),function(b){var g=a[b]=c[b];a.prototype[b]=function(){var b=[this._wrapped];k.apply(b,arguments);b=g.apply(a,
b);return this._chain?a(b).chain():b}})};var P=0;a.uniqueId=function(a){var b=++P+"";return a?a+b:b};a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,Q={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(b,c,g){var n;g=a.defaults({},g,a.templateSettings);var d=RegExp([(g.escape||M).source,(g.interpolate||M).source,(g.evaluate||M).source].join("|")+
"|$","g"),e=0,r="__p+='";b.replace(d,function(a,c,g,h,n){r+=b.slice(e,n).replace(R,function(a){return"\\"+Q[a]});c&&(r+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");g&&(r+="'+\n((__t=("+g+"))==null?'':__t)+\n'");h&&(r+="';\n"+h+"\n__p+='");e=n+a.length;return a});r+="';\n";g.variable||(r="with(obj||{}){\n"+r+"}\n");r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{n=new Function(g.variable||"obj","_",r)}catch(k){throw k.source=
r,k;}if(c)return n(c,a);c=function(b){return n.call(this,b,a)};c.source="function("+(g.variable||"obj")+"){\n"+r+"}";return c};a.chain=function(b){return a(b).chain()};a.mixin(a);b("pop push reverse shift sort splice unshift".split(" "),function(b){var c=e[b];a.prototype[b]=function(){var g=this._wrapped;c.apply(g,arguments);"shift"!=b&&"splice"!=b||0!==g.length||delete g[0];return this._chain?a(g).chain():g}});b(["concat","join","slice"],function(b){var c=e[b];a.prototype[b]=function(){var b=c.apply(this._wrapped,
arguments);return this._chain?a(b).chain():b}});a.extend(a.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var D=[].slice,p=function(e,q,k){var l;e=-1;var s=q.length;switch(k.length){case 0:for(;++e<s;)(l=q[e]).callback.call(l.ctx);break;case 1:for(;++e<s;)(l=q[e]).callback.call(l.ctx,k[0]);break;case 2:for(;++e<s;)(l=q[e]).callback.call(l.ctx,k[0],k[1]);break;case 3:for(;++e<s;)(l=q[e]).callback.call(l.ctx,k[0],k[1],k[2]);break;default:for(;++e<s;)(l=q[e]).callback.apply(l.ctx,k)}},m=Backbone.Events={on:function(e,q,k){this._events||(this._events={});(this._events[e]||(this._events[e]=[])).push({callback:q,
context:k,ctx:k||this});return this},once:function(e,q,k){var l=this,s=_.once(function(){l.off(e,s);q.apply(this,arguments)});s._callback=q;this.on(e,s,k);return this},off:function(e,q,k){var l,s,d,m,p,w,y,v;if(!this._events)return this;if(!e&&!q&&!k)return this._events={},this;m=e?[e]:_.keys(this._events);p=0;for(w=m.length;p<w;p++)if(e=m[p],l=this._events[e]){d=[];if(q||k)for(y=0,v=l.length;y<v;y++)s=l[y],(q&&q!==(s.callback._callback||s.callback)||k&&k!==s.context)&&d.push(s);this._events[e]=d}return this},
trigger:function(e){if(!this._events)return this;var m=D.call(arguments,1),k=this._events[e],l=this._events.all;k&&p(this,k,m);l&&p(this,l,arguments);return this},listenTo:function(e,m,k){var l=this._listeners||(this._listeners={}),s=e._listenerId||(e._listenerId=_.uniqueId("l"));l[s]=e;e.on(m,k||this,this);return this},stopListening:function(e,m,k){var l=this._listeners;if(l){if(e)e.off(m,k,this),m||k||delete l[e._listenerId];else{for(var s in l)l[s].off(null,null,this);this._listeners={}}return this}}};
m.bind=m.on;m.unbind=m.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=m),exports.Backbone=exports.Backbone||Backbone)})();(function(){function D(e,l){var s=(new Date).getTime(),d=Math.max(0,16-(s-m)),q=p.setTimeout(function(){e(s+d)},d);m=s+d;return q}var p=this,m=0,e=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=D),exports.requestAnimationFrame=D;else{for(var q=0;q<e.length&&!p.requestAnimationFrame;++q)p.requestAnimationFrame=p[e[q]+"RequestAnimationFrame"],p.cancelAnimationFrame=p[e[q]+"CancelAnimationFrame"]||p[e[q]+"CancelRequestAnimationFrame"];
p.requestAnimationFrame||(p.requestAnimationFrame=D);p.cancelAnimationFrame||(p.cancelAnimationFrame=function(e){clearTimeout(e)})}})();(function(){function D(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a,this.ratio);this.trigger(g.Events.resize,b,a)}var p=this,m=p.Two||{},e=Math.sin,q=Math.cos,k=Math.atan2,l=Math.sqrt,s=Math.abs,d=Math.PI,x=2*d,B=d/2,w=Math.pow,y=0,v={hasEventListeners:_.isFunction(p.addEventListener),bind:function(a,b,c,g){this.hasEventListeners?a.addEventListener(b,c,!!g):a.attachEvent("on"+b,c);return this},unbind:function(a,b,c,g){this.hasEventListeners?
a.removeEventListeners(b,c,!!g):a.detachEvent("on"+b,c);return this}},g=p.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:g.Types.svg,autostart:!1});_.each(a,function(a,c){"fullscreen"!==c&&("width"!==c&&"height"!==c&&"autostart"!==c)&&(this[c]=a)},this);_.isElement(a.domElement)&&(this.type=g.Types[a.domElement.tagName.toLowerCase()]);this.renderer=new g[this.type](this);g.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(D,this),_.extend(document.body.style,
{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),v.bind(p,"resize",a),a()):_.isElement(a.domElement)||(this.renderer.setSize(a.width,a.height,this.ratio),this.width=a.width,this.height=a.height);this.scene=this.renderer.scene;g.Instances.push(this)};_.extend(g,{Array:p.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},
Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){p.Two=m;return this},uniqueId:function(){var a=y;y++;return a},Utils:{Curve:{CollinearityEpsilon:w(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},
devicePixelRatio:p.devicePixelRatio||1,getBackingStoreRatio:function(a){return a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1},getRatio:function(a){return g.Utils.devicePixelRatio/A(a)},setPlaying:function(a){this.playing=!!a;return this},getComputedMatrix:function(a,b){b=b&&b.identity()||new g.Matrix;for(var c=a;c&&c._matrix;){var n=c._matrix.elements;b.multiply(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],
n[8],n[9]);c=c.parent}return b},getComputedScale:function(a){for(var b=1;a&&a._scale;)b*=a._scale,a=a.parent;return b},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";_.each(a.attributes,function(a,g){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=
a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});return b},read:{svg:function(){return g.Utils.read.g.apply(this,arguments)},g:function(a){var b=new g.Group;this.add(b);_.each(a.childNodes,function(a){var n=a.nodeName;n&&(n=n.replace(/svg\:/ig,"").toLowerCase(),n in g.Utils.read&&(a=g.Utils.read[n].call(this,a),b.add(a)))},this);return g.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var c=[];a.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,
function(a,b,n){c.push(new g.Anchor(parseFloat(b),parseFloat(n)))});var n=(new g.Polygon(c,!b)).noStroke();return g.Utils.applySvgAttributes(a,n)},polyline:function(a){return g.Utils.read.polygon(a,!0)},path:function(a){var b,c,n,d=!1,e=!1,k=a.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),s=k.length-1,k=_.flatten(_.map(k,function(a,k){var l,m,q=a[0],x=q.toLowerCase();n=a.slice(1).trim();n=n.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,c){return parseFloat(b)*Math.pow(10,c)});n=n.split(/[\s,]+|(?=\s?[+\-])/);
d=q===x;var f,h,u,p;switch(x){case "z":k>=s?e=!0:(m=b.x,l=b.y,l=new g.Anchor(m,l,void 0,void 0,void 0,void 0,g.Commands.close));break;case "m":case "l":m=parseFloat(n[0]);l=parseFloat(n[1]);l=new g.Anchor(m,l,void 0,void 0,void 0,void 0,"m"===x?g.Commands.move:g.Commands.line);d&&l.addSelf(b);b=l;break;case "h":case "v":m="h"===x?"x":"y";q="x"===m?"y":"x";l=new g.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,g.Commands.line);l[m]=parseFloat(n[0]);l[q]=b[q];d&&(l[m]+=b[m]);b=l;break;case "s":case "c":l=
b.x;q=b.y;c||(c=(new g.Vector).copy(b));"c"===x?(f=parseFloat(n[0]),m=parseFloat(n[1]),x=parseFloat(n[2]),h=parseFloat(n[3]),u=parseFloat(n[4]),p=parseFloat(n[5])):(h=g.Utils.getReflection(b,c,d),f=h.x,m=h.y,x=parseFloat(n[0]),h=parseFloat(n[1]),u=parseFloat(n[2]),p=parseFloat(n[3]));d&&(f+=l,m+=q,x+=l,h+=q,u+=l,p+=q);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(f,m);b=l=new g.Anchor(u,p,x,h,void 0,void 0,g.Commands.curve);c=l.controls.left;break;case "t":case "q":l=
b.x;q=b.y;c||(c=(new g.Vector).copy(b));c.isZero()?(f=l,m=q):(f=c.x,q=c.y);"q"===x?(x=parseFloat(n[0]),h=parseFloat(n[1]),u=parseFloat(n[1]),p=parseFloat(n[2])):(h=g.Utils.getReflection(b,c,d),x=h.x,h=h.y,u=parseFloat(n[0]),p=parseFloat(n[1]));d&&(f+=l,m+=q,x+=l,h+=q,u+=l,p+=q);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(f,m);b=l=new g.Anchor(u,p,x,h,void 0,void 0,g.Commands.curve);c=l.controls.left;break;case "a":throw new g.Utils.Error("not yet able to interpret Elliptical Arcs.");
}return l}));if(!(1>=k.length))return k=_.compact(k),k=(new g.Polygon(k,e,void 0,!0)).noStroke(),g.Utils.applySvgAttributes(a,k)},circle:function(a){var b=parseFloat(a.getAttribute("cx")),c=parseFloat(a.getAttribute("cy")),n=parseFloat(a.getAttribute("r")),d=g.Resolution,r=_.map(_.range(d),function(a){var b=a/d*x;a=n*q(b);b=n*e(b);return new g.Anchor(a,b)},this),r=(new g.Polygon(r,!0,!0)).noStroke();r.translation.set(b,c);return g.Utils.applySvgAttributes(a,r)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),
c=parseFloat(a.getAttribute("cy")),n=parseFloat(a.getAttribute("rx")),d=parseFloat(a.getAttribute("ry")),r=g.Resolution,k=_.map(_.range(r),function(a){var b=a/r*x;a=n*q(b);b=d*e(b);return new g.Anchor(a,b)},this),k=(new g.Polygon(k,!0,!0)).noStroke();k.translation.set(b,c);return g.Utils.applySvgAttributes(a,k)},rect:function(a){var b=parseFloat(a.getAttribute("x")),c=parseFloat(a.getAttribute("y")),n=parseFloat(a.getAttribute("width")),d=parseFloat(a.getAttribute("height")),n=n/2,d=d/2,e=[new g.Anchor(n,
d),new g.Anchor(-n,d),new g.Anchor(-n,-d),new g.Anchor(n,-d)],e=(new g.Polygon(e,!0)).noStroke();e.translation.set(b+n,c+d);return g.Utils.applySvgAttributes(a,e)},line:function(a){var b=parseFloat(a.getAttribute("x1")),c=parseFloat(a.getAttribute("y1")),n=parseFloat(a.getAttribute("x2")),d=parseFloat(a.getAttribute("y2")),n=(n-b)/2,d=(d-c)/2,e=[new g.Anchor(-n,-d),new g.Anchor(n,d)],e=(new g.Polygon(e)).noFill();e.translation.set(b+n,c+d);return g.Utils.applySvgAttributes(a,e)}},subdivide:function(a,
b,c,n,e,r,l,m,q){var p=g.Utils.Curve.CollinearityEpsilon,v=g.Utils.Curve.RecursionLimit,y=g.Utils.Curve.CuspLimit,w=g.Utils.Curve.Tolerance,t;q=q||0;if(q>v)return[];var v=(a+c)/2,f=(b+n)/2,h=(c+e)/2,u=(n+r)/2,C=(e+l)/2,D=(r+m)/2,E=(v+h)/2,F=(f+u)/2,h=(h+C)/2,u=(u+D)/2,z=(E+h)/2,A=(F+u)/2;t=l-a;var B=m-b,N=s((c-l)*B-(n-m)*t),O=s((e-l)*B-(r-m)*t);if(0<q){if(N>p&&O>p&&(N+O)*(N+O)<=w.distance*(t*t+B*B)){if(w.angle<w.epsilon)return[new g.Anchor(z,A)];t=k(r-n,e-c);p=s(t-k(n-b,c-a));t=s(k(m-r,l-e)-t);p>=
d&&(p=x-p);t>=d&&(t=x-t);if(p+t<w.angle)return[new g.Anchor(z,A)];if(0!==y){if(p>y)return[new g.Anchor(c,n)];if(t>y)return[new g.Anchor(e,r)]}}}else if(N>p)if(N*N<=w.distance*(t*t+B*B)){if(w.angle<w.epsilon)return[new g.Anchor(z,A)];p=s(k(r-n,e-c)-k(n-b,c-a));p>=d&&(p=x-p);if(p<w.angle)return[new g.Anchor(c,n),new g.Anchor(e,r)];if(0!==y&&p>y)return[new g.Anchor(c,n)]}else if(O>p){if(O*O<=w.distance*(t*t+B*B)){if(w.angle<w.epsilon)return[new g.Anchor(z,A)];p=s(k(m-r,l-e)-k(r-n,e-c));p>=d&&(p=x-p);
if(p<w.angle)return[new g.Anchor(c,n),new g.Anchor(e,r)];if(0!==y&&p>y)return[new g.Anchor(e,r)]}}else if(t=z-(a+l)/2,B=A-(b+m)/2,t*t+B*B<=w.distance)return[new g.Anchor(z,A)];return g.Utils.subdivide(a,b,v,f,E,F,z,A,q+1).concat(g.Utils.subdivide(z,A,h,u,C,D,l,m,q+1))},getCurveFromPoints:function(a,b){for(var c=a.length,d=c-1,e=0;e<c;e++){var k=a[e];_.isObject(k.controls)||g.Anchor.AppendCurveProperties(k);var l=b?z(e-1,c):Math.max(e-1,0),m=b?z(e+1,c):Math.min(e+1,d);F(a[l],k,a[m]);k._command=0===
e?g.Commands.move:g.Commands.curve;k.controls.left.x=_.isNumber(k.controls.left.x)?k.controls.left.x:k.x;k.controls.left.y=_.isNumber(k.controls.left.y)?k.controls.left.y:k.y;k.controls.right.x=_.isNumber(k.controls.right.x)?k.controls.right.x:k.x;k.controls.right.y=_.isNumber(k.controls.right.y)?k.controls.right.y:k.y}},getControlPoints:function(a,b,c){var n=t(a,b),k=t(c,b);a=E(a,b);c=E(c,b);var l=(n+k)/2;b.u=_.isObject(b.controls.left)?b.controls.left:new g.Vector(b.x,b.y);b.v=_.isObject(b.controls.right)?
b.controls.right:new g.Vector(b.x,b.y);if(1E-4>a||1E-4>c)return b.controls.left.copy(b),b.controls.right.copy(b),b;a*=0.33;c*=0.33;l=k<n?l+B:l-B;b.controls.left.x=b.x+q(l)*a;b.controls.left.y=b.y+e(l)*a;l-=d;b.controls.right.x=b.x+q(l)*c;b.controls.right.y=b.y+e(l)*c;return b},getReflection:function(a,b,c){var d=a.distanceTo(b);if(1E-4>=d)return c?new g.Vector:a.clone();b=t(a,b);return new g.Vector(d*Math.cos(b)+(c?0:a.x),d*Math.sin(b)+(c?0:a.y))},angleBetween:function(a,b){return k(a.y-b.y,a.x-b.x)},
distanceBetweenSquared:function(a,b){var c=a.x-b.x,g=a.y-b.y;return c*c+g*g},distanceBetween:function(a,b){return l(C(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=a}}});g.Utils.Error.prototype=Error();g.Utils.Error.prototype.constructor=g.Utils.Error;g.Utils.Collection.prototype=
[];g.Utils.Collection.constructor=g.Utils.Collection;_.extend(g.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(g.Events.remove,[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(g.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);this.trigger(g.Events.insert,arguments);return a},unshift:function(){var a=Array.prototype.unshift.apply(this,
arguments);this.trigger(g.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,arguments),b;this.trigger(g.Events.remove,a);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(g.Events.insert,b));return a}});var E=g.Utils.distanceBetween,C=g.Utils.distanceBetweenSquared,t=g.Utils.angleBetween,F=g.Utils.getControlPoints,z=g.Utils.mod,A=g.Utils.getBackingStoreRatio;_.extend(g.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);
return this},play:function(){g.Utils.setPlaying.call(this,!0);return this.trigger(g.Events.play)},pause:function(){this.playing=!1;return this.trigger(g.Events.pause)},update:function(){var a=!!this._lastFrame,b=(p.performance&&p.performance.now?p.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,c=this.renderer;a===c.width&&b===c.height||c.setSize(a,b,this.ratio);return this.trigger(g.Events.update,
this.frameCount,this.timeDelta)},render:function(){this.renderer.render();return this.trigger(g.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));return this},makeLine:function(a,b,c,d){c=(c-a)/2;d=(d-b)/2;var e=[new g.Anchor(-c,-d),new g.Anchor(c,d)],e=(new g.Polygon(e)).noFill();
e.translation.set(a+c,b+d);this.scene.add(e);return e},makeRectangle:function(a,b,c,d){c/=2;d/=2;d=[new g.Anchor(c,d),new g.Anchor(-c,d),new g.Anchor(-c,-d),new g.Anchor(c,-d)];d=new g.Polygon(d,!0);d.translation.set(a,b);this.scene.add(d);return d},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,c,d){var k=g.Resolution,l=_.map(_.range(k),function(a){var b=a/k*x;a=c*q(b);b=d*e(b);return new g.Anchor(a,b)},this),l=new g.Polygon(l,!0,!0);l.translation.set(a,b);
this.scene.add(l);return l},makeCurve:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],d=0;d<b;d+=2){var e=arguments[d];if(!_.isNumber(e))break;c.push(new g.Anchor(e,arguments[d+1]))}var b=arguments[b-1],c=new g.Polygon(c,!(_.isBoolean(b)&&b),!0),b=c.getBoundingClientRect(),k=b.left+b.width/2,l=b.top+b.height/2;_.each(c.vertices,function(a){a.x-=k;a.y-=l});c.translation.set(k,l);this.scene.add(c);return c},makePolygon:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=
[],d=0;d<b;d+=2){var e=arguments[d];if(!_.isNumber(e))break;c.push(new g.Anchor(e,arguments[d+1]))}b=arguments[b-1];c=new g.Polygon(c,!(_.isBoolean(b)&&b));b=c.getBoundingClientRect();c.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new g.Group;this.scene.add(c);c.add(b);return c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in g.Utils.read))return null;a=g.Utils.read[b].call(this,
a);this.add(a);return a}});(function(){requestAnimationFrame(arguments.callee);_.each(g.Instances,function(a){a.playing&&a.update().render()})})();"function"===typeof define&&define.amd?define(function(){return g}):"undefined"!=typeof module&&module.exports&&(module.exports=g)})();(function(){var D,p,m,e,q=Two.Vector=function(d,e){this.x=d||0;this.y=e||0};_.extend(q.prototype,Backbone.Events,{set:function(d,e){this.x=d;this.y=e;return this},copy:function(d){this.x=d.x;this.y=d.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new q(this.x,this.y)},add:function(d,e){this.x=d.x+e.x;this.y=d.y+e.y;return this},addSelf:function(d){this.x+=d.x;this.y+=d.y;return this},sub:function(d,e){this.x=d.x-e.x;this.y=d.y-e.y;return this},subSelf:function(d){this.x-=
d.x;this.y-=d.y;return this},multiplySelf:function(d){this.x*=d.x;this.y*=d.y;return this},multiplyScalar:function(d){this.x*=d;this.y*=d;return this},divideScalar:function(d){d?(this.x/=d,this.y/=d):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(d){return this.x*d.x+this.y*d.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(d){m=this.x-d.x;e=this.y-d.y;return m*m+e*e},setLength:function(d){return this.normalize().multiplyScalar(d)},equals:function(d){return 1E-4>this.distanceTo(d)},lerp:function(d,e){D=(d.x-this.x)*e+this.x;p=(d.y-this.y)*e+this.y;return this.set(D,p)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var k={set:function(d,
e){this._x=d;this._y=e;return this.trigger(Two.Events.change)},copy:function(d){this._x=d.x;this._y=d.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new q(this._x,this._y)},add:function(d,e){this._x=d.x+e.x;this._y=d.y+e.y;return this.trigger(Two.Events.change)},addSelf:function(d){this._x+=d.x;this._y+=d.y;return this.trigger(Two.Events.change)},sub:function(d,e){this._x=d.x-e.x;this._y=d.y-e.y;return this.trigger(Two.Events.change)},
subSelf:function(d){this._x-=d.x;this._y-=d.y;return this.trigger(Two.Events.change)},multiplySelf:function(d){this._x*=d.x;this._y*=d.y;return this.trigger(Two.Events.change)},multiplyScalar:function(d){this._x*=d;this._y*=d;return this.trigger(Two.Events.change)},divideScalar:function(d){return d?(this._x/=d,this._y/=d,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(d){return this._x*d.x+this._y*d.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(d){m=this._x-d.x;e=this._y-d.y;return m*m+e*e},setLength:function(d){return this.normalize().multiplyScalar(d)},equals:function(d){return 1E-4>this.distanceTo(d)},lerp:function(d,e){D=(d.x-this._x)*e+this._x;p=(d.y-this._y)*e+this._y;return this.set(D,p)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},l={get:function(){return this._x},set:function(d){this._x=d;this.trigger(Two.Events.change,"x")}},s={get:function(){return this._y},set:function(d){this._y=d;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",l),Object.defineProperty(this,"y",s),_.extend(this,k),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var D=Two.Commands,p,m,e,q=Two.Anchor=function(e,l,m,d,p,B,w){Two.Vector.call(this,e,l);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(d){this._command=d;this._command!==D.curve||_.isObject(this.controls)||q.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=w||D.move;if(!w)return this;q.AppendCurveProperties(this);_.isNumber(m)&&(this.controls.left.x=
m);_.isNumber(d)&&(this.controls.left.y=d);_.isNumber(p)&&(this.controls.right.x=p);_.isNumber(B)&&(this.controls.right.y=B)};_.extend(q,{AppendCurveProperties:function(e){p=e._x||e.x;m=e._y||e.y;e.controls={left:new Two.Vector(p,m),right:new Two.Vector(p,m)}}});_.extend(q.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||q.AppendCurveProperties(this);_.each(this.controls,function(e){e.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(e){e.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){e=this.controls;return new Two.Anchor(this.x,this.y,e&&e.left.x,e&&e.left.y,e&&e.right.x,e&&e.right.y,this.command)}})})();(function(){_.range(6);var D=Math.cos,p=Math.sin,m=Math.tan,e,q,k,l,s,d,x,B,w,y,v,g,E,C,t,F,z,A,a,b,c,n,H,r,G,I,J,L,P,M,Q,R,f,h,u,ea,U,V,$,ba,W,X,N,O,aa,ca,da,Y,S,Z=[],fa=Two.Matrix=function(a,b,c,f,g,d){this.elements=new Two.Array(9);var h=a;_.isArray(h)||(h=_.toArray(arguments));this.identity().set(h)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(f,d,h){if(3>=d.length)return g,E,C,e=d[0]||0,q=d[1]||0,k=d[2]||0,s=f,g=s[0]*e+s[1]*q+s[2]*k,E=s[3]*e+s[4]*q+s[5]*k,C=s[6]*e+s[7]*q+s[8]*
k,{x:g,y:E,z:C};t=f[0];F=f[1];z=f[2];A=f[3];a=f[4];b=f[5];c=f[6];n=f[7];H=f[8];r=d[0];G=d[1];I=d[2];J=d[3];L=d[4];P=d[5];M=d[6];Q=d[7];R=d[8];h=h||new Two.Array(9);h[0]=t*r+F*J+z*M;h[1]=t*G+F*L+z*Q;h[2]=t*I+F*P+z*R;h[3]=A*r+a*J+b*M;h[4]=A*G+a*L+b*Q;h[5]=A*I+a*P+b*R;h[6]=c*r+n*J+H*M;h[7]=c*G+n*L+H*Q;h[8]=c*I+n*P+H*R;return h}});_.extend(fa.prototype,Backbone.Events,{set:function(a,b,c,f,g,d){v=a;u=arguments.length;_.isArray(v)||(v=_.toArray(arguments));_.each(v,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(d,e,k,l,m,s,p,q,ma){v=arguments;u=v.length;if(1>=u)return _.each(this.elements,function(a,b){this.elements[b]=a*d},this),this.trigger(Two.Events.change);if(3>=u)return g,E,C,d=d||0,e=e||0,k=k||0,m=this.elements,g=m[0]*d+m[1]*e+m[2]*k,E=m[3]*d+m[4]*e+m[5]*k,C=m[6]*d+m[7]*e+m[8]*k,{x:g,y:E,z:C};f=this.elements;h=v;t=f[0];F=f[1];z=f[2];A=f[3];a=f[4];b=f[5];c=f[6];n=f[7];H=f[8];r=
h[0];G=h[1];I=h[2];J=h[3];L=h[4];P=h[5];M=h[6];Q=h[7];R=h[8];this.elements[0]=t*r+F*J+z*M;this.elements[1]=t*G+F*L+z*Q;this.elements[2]=t*I+F*P+z*R;this.elements[3]=A*r+a*J+b*M;this.elements[4]=A*G+a*L+b*Q;this.elements[5]=A*I+a*P+b*R;this.elements[6]=c*r+n*J+H*M;this.elements[7]=c*G+n*L+H*Q;this.elements[8]=c*I+n*P+H*R;return this.trigger(Two.Events.change)},inverse:function(a){e=this.elements;a=a||new Two.Matrix;U=e[0];V=e[1];$=e[2];ba=e[3];W=e[4];X=e[5];N=e[6];O=e[7];aa=e[8];ca=aa*W-X*O;da=-aa*
ba+X*N;Y=O*ba-W*N;S=U*ca+V*da+$*Y;if(!S)return null;S=1/S;a.elements[0]=ca*S;a.elements[1]=(-aa*V+$*O)*S;a.elements[2]=(X*V-$*W)*S;a.elements[3]=da*S;a.elements[4]=(aa*U-$*N)*S;a.elements[5]=(-X*U+$*ba)*S;a.elements[6]=Y*S;a.elements[7]=(-O*U+V*N)*S;a.elements[8]=(W*U-V*ba)*S;return a},scale:function(a,b){u=arguments.length;1>=u&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){k=D(a);ea=p(a);return this.multiply(k,-ea,0,ea,k,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){e=m(a);return this.multiply(1,e,0,0,1,0,0,0,1)},skewY:function(a){e=m(a);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(a){this.toArray(a,Z);return Z.join(" ")},toArray:function(a,b){v=this.elements;y=!!b;e=parseFloat(v[0].toFixed(3));q=parseFloat(v[1].toFixed(3));k=parseFloat(v[2].toFixed(3));l=parseFloat(v[3].toFixed(3));s=parseFloat(v[4].toFixed(3));d=parseFloat(v[5].toFixed(3));if(a){x=parseFloat(v[6].toFixed(3));B=parseFloat(v[7].toFixed(3));w=
parseFloat(v[8].toFixed(3));if(y){b[0]=e;b[1]=l;b[2]=x;b[3]=q;b[4]=s;b[5]=B;b[6]=k;b[7]=d;b[8]=w;return}return[e,l,x,q,s,B,k,d,w]}if(y)b[0]=e,b[1]=l,b[2]=q,b[3]=s,b[4]=k,b[5]=d;else return[e,l,q,s,k,d]},clone:function(){e=this.elements[0];q=this.elements[1];k=this.elements[2];l=this.elements[3];s=this.elements[4];d=this.elements[5];x=this.elements[6];B=this.elements[7];w=this.elements[8];return new Two.Matrix(e,q,k,l,s,d,x,B,w)}})})();(function(){var D=Two.Utils.mod,p,m,e,q={},k={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(l,d){e=l;m=document.createElementNS(this.ns,e);"svg"===e&&(d=_.defaults(d||{},{version:this.version}));_.isObject(d)&&k.setAttributes(m,d);return m},setAttribute:function(e,d){this.setAttribute(d,e)},setAttributes:function(e,d){_.each(d,k.setAttribute,e);return this},removeAttribute:function(e,d){this.removeAttribute(d)},removeAttributes:function(e,
d){_.each(d,k.removeAttribute,e);return this},toString:function(e,d){var k=e.length,l=k-1;return _.map(e,function(m,p){var q,g=d?D(p-1,k):Math.max(p-1,0),E=d?D(p+1,k):Math.min(p+1,l),g=e[g],E=e[E],C,t,F,z,A;A=m.x.toFixed(3);z=m.y.toFixed(3);switch(m._command){case Two.Commands.close:q=Two.Commands.close;break;case Two.Commands.curve:C=g.controls&&g.controls.right||g;q=m.controls&&m.controls.left||m;g=C.x.toFixed(3);C=C.y.toFixed(3);t=q.x.toFixed(3);F=q.y.toFixed(3);q=(0===p?Two.Commands.move:Two.Commands.curve)+
" "+g+" "+C+" "+t+" "+F+" "+A+" "+z;break;default:q=(0===p?Two.Commands.move:m._command)+" "+A+" "+z}p>=l&&d&&(m._command===Two.Commands.curve&&(z=m.controls&&m.controls.right||m,A=E.controls&&E.controls.left||E,g=z.x.toFixed(3),C=z.y.toFixed(3),t=A.x.toFixed(3),F=A.y.toFixed(3),A=E.x.toFixed(3),z=E.y.toFixed(3),q+=" C "+g+" "+C+" "+t+" "+F+" "+A+" "+z),q+=" Z");return q}).join(" ")},group:{appendChild:function(e){(m=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.appendChild(m)},
removeChild:function(e){(m=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.removeChild(m)},renderChild:function(e){k[e._renderer.type].render.call(e,this)},render:function(e){this.update();this._renderer.elem||(this._renderer.elem=k.createElement("g",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));p=this._matrix.manual||this._flagMatrix;q.domElement=e;q.elem=this._renderer.elem;p&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");
_.each(this.children,k.group.renderChild,e);this._flagAdditions&&_.each(this.additions,k.group.appendChild,q);this._flagSubtractions&&_.each(this.subtractions,k.group.removeChild,q);return this.flagReset()}},polygon:{render:function(e){this.update();this._renderer.elem||(this._renderer.elem=k.createElement("path",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));m=this._renderer.elem;(p=this._matrix.manual||this._flagMatrix)&&m.setAttribute("transform","matrix("+this._matrix.toString()+
")");this._flagVertices&&(vertices=k.toString(this._vertices,this._closed),m.setAttribute("d",vertices));this._flagFill&&m.setAttribute("fill",this._fill);this._flagStroke&&m.setAttribute("stroke",this._stroke);this._flagLinewidth&&m.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(m.setAttribute("stroke-opacity",this._opacity),m.setAttribute("fill-opacity",this._opacity));this._flagVisible&&m.setAttribute("visible",this._visible);this._flagCap&&m.setAttribute("stroke-linecap",this._cap);
this._flagJoin&&m.setAttribute("stroke-linejoin",this._join);this._flagMiter&&m.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},l=Two[Two.Types.svg]=function(e){this.domElement=e.domElement||k.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(l,{Utils:k});_.extend(l.prototype,Backbone.Events,{setSize:function(e,d){this.width=e;this.height=d;k.setAttributes(this.domElement,{width:e,height:d});return this},render:function(){k.group.render.call(this.scene,
this.domElement);return this}})})();(function(){var D=Two.Utils.mod,p=Two.Utils.getRatio,m,e,q,k,l,s,d,x,B,w,y,v,g,E,C,t,F,z,A,a,b,c,n,H,r,G,I,J={group:{render:function(a){this.update();m=this._matrix.elements;a.save();a.transform(m[0],m[3],m[1],m[4],m[2],m[5]);_.each(this.children,function(b){J[b._renderer.type].render.call(b,a)});a.restore();return this.flagReset()}},polygon:{render:function(p){this.update();m=this._matrix.elements;e=this.stroke;q=this.linewidth;k=this.fill;l=this.opacity;s=this.visible;d=this.cap;x=this.join;B=this.miter;
w=this.closed;y=this._vertices;v=y.length;g=v-1;if(!s)return this;p.save();m&&p.transform(m[0],m[3],m[1],m[4],m[2],m[5]);k&&(p.fillStyle=k);e&&(p.strokeStyle=e);q&&(p.lineWidth=q);B&&(p.miterLimit=B);x&&(p.lineJoin=x);d&&(p.lineCap=d);_.isNumber(l)&&(p.globalAlpha=l);p.beginPath();_.each(y,function(e,d){G=e.x.toFixed(3);I=e.y.toFixed(3);switch(e._command){case Two.Commands.close:p.closePath();break;case Two.Commands.curve:C=w?D(d-1,v):Math.max(d-1,0);E=w?D(d+1,v):Math.min(d+1,g);t=y[C];F=y[E];c=t.controls&&
t.controls.right||t;n=e.controls&&e.controls.left||e;a=c.x.toFixed(3);b=c.y.toFixed(3);z=n.x.toFixed(3);A=n.y.toFixed(3);p.bezierCurveTo(a,b,z,A,G,I);d>=g&&w&&(H=e.controls&&e.controls.right||e,r=F.controls&&F.controls.left||F,a=H.x.toFixed(3),b=H.y.toFixed(3),z=r.x.toFixed(3),A=r.y.toFixed(3),G=F.x.toFixed(3),I=F.y.toFixed(3),p.bezierCurveTo(a,b,z,A,G,I));break;case Two.Commands.line:p.lineTo(G,I);break;case Two.Commands.move:p.moveTo(G,I)}});w&&p.closePath();p.fill();p.stroke();p.restore();return this.flagReset()}}},
L=Two[Two.Types.canvas]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.scene=new Two.Group;this.scene.parent=this};_.extend(L,{Utils:J});_.extend(L.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?p(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});return this},
render:function(){var a=1===this.ratio;a||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);J.group.render.call(this.scene,this.ctx);a||this.ctx.restore();return this}})})();(function(){var D=Two.Matrix.Multiply,p=Two.Utils.mod,m=[1,0,0,0,1,0,0,0,1],e=new Two.Array(9),q=Two.Utils.getRatio,k,l,s,d,x,B,w,y,v,g,E,C,t,F,z,A,a,b,c,n,H,r,G,I,J,L,P,M,Q,R,f,h,u,ea,U,V,$,ba,W,X,N,O,aa,ca,da,Y,S,Z,fa,ga,K,ia,ja,ka,ha,T={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{render:function(a,b){this.update();k=this.parent;l=k._matrix&&k._matrix.manual||k._flagMatrix;s=this._matrix.manual||this._flagMatrix;if(l||s)this._renderer.matrix||(this._renderer.matrix=
new Two.Array(9)),this._matrix.toArray(!0,e),D(e,k._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*k._renderer.scale,l&&(this._flagMatrix=!0);_.each(this.children,function(c){T[c._renderer.type].render.call(c,a,b)});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;k=this.parent;l=k._matrix.manual||k._flagMatrix;s=this._matrix.manual||this._flagMatrix;d=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||
this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this.update();if(l||s)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,e),D(e,k._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*k._renderer.scale;d&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),T.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),
T.getTriangles(this._renderer.rect,this._renderer.triangles),T.updateBuffer(a,this,b),T.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(e,
f,d){x=Infinity;B=-Infinity;w=Infinity;y=-Infinity;_.each(e,function(b,c){v=b.x;g=b.y;E;C;t;F;z=b.controls;w=Math.min(g,w);x=Math.min(v,x);B=Math.max(v,B);y=Math.max(g,y);b.controls&&(A=z.left,a=z.right,A&&a&&(E=A.x,C=A.y,t=a.x,F=a.y,E&&(C&&t&&F)&&(w=Math.min(C,F,w),x=Math.min(E,t,x),B=Math.max(E,t,B),y=Math.max(C,F,y))))});_.isNumber(f)&&(w-=f,x-=f,B+=f,y+=f);b=B-x;c=y-w;d.top=w;d.left=x;d.right=B;d.bottom=y;d.width=b;d.height=c;d.centroid||(d.centroid={});d.centroid.x=-x;d.centroid.y=-w},getTriangles:function(a,
b){w=a.top;x=a.left;B=a.right;y=a.bottom;b[0]=x;b[1]=w;b[2]=B;b[3]=w;b[4]=x;b[5]=y;b[6]=x;b[7]=y;b[8]=B;b[9]=w;b[10]=B;b[11]=y},updateCanvas:function(a){n=a._vertices;H=this.canvas;r=this.ctx;G=a._renderer.scale;I=a._stroke;J=a._linewidth*G;L=a._fill;P=a._opacity;M=a._cap;Q=a._join;R=a._miter;f=a._closed;h=n.length;u=h-1;H.width=Math.max(Math.ceil(a._renderer.rect.width*G),1);H.height=Math.max(Math.ceil(a._renderer.rect.height*G),1);ea=a._renderer.rect.centroid;U=ea.x*G;V=ea.y*G;r.clearRect(0,0,H.width,
H.height);L&&(r.fillStyle=L);I&&(r.strokeStyle=I);J&&(r.lineWidth=J);R&&(r.miterLimit=R);Q&&(r.lineJoin=Q);M&&(r.lineCap=M);_.isNumber(P)&&(r.globalAlpha=P);r.beginPath();_.each(n,function(a,b){$;ba;E;t;W;X;N;O;aa;ca;da;A;v=(a.x*G+U).toFixed(3);g=(a.y*G+V).toFixed(3);switch(a._command){case Two.Commands.close:r.closePath();break;case Two.Commands.curve:ba=f?p(b-1,h):Math.max(b-1,0);$=f?p(b+1,h):Math.min(b+1,u);E=n[ba];t=n[$];aa=E.controls&&E.controls.right||E;ca=a.controls&&a.controls.left||a;N=(aa.x*
G+U).toFixed(3);O=(aa.y*G+V).toFixed(3);W=(ca.x*G+U).toFixed(3);X=(ca.y*G+V).toFixed(3);r.bezierCurveTo(N,O,W,X,v,g);b>=u&&f&&(da=a.controls&&a.controls.right||a,A=t.controls&&t.controls.left||t,N=(da.x*G+U).toFixed(3),O=(da.y*G+V).toFixed(3),W=(A.x*G+U).toFixed(3),X=(A.y*G+V).toFixed(3),v=(t.x*G+U).toFixed(3),g=(t.y*G+V).toFixed(3),r.bezierCurveTo(N,O,W,X,v,g));break;case Two.Commands.line:r.lineTo(v,g);break;case Two.Commands.move:r.moveTo(v,g)}});f&&r.closePath();r.fill();r.stroke()},updateTexture:function(a,
b){this.updateCanvas(b);b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,
a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);
a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){Y=a.createProgram();_.each(b,function(b){a.attachShader(Y,b)});a.linkProgram(Y);S=a.getProgramParameter(Y,a.LINK_STATUS);if(!S)throw ga=a.getProgramInfoLog(Y),a.deleteProgram(Y),new Two.Utils.Error("unable to link program: "+ga);return Y}},shaders:{create:function(a,b,c){Z=a.createShader(a[c]);a.shaderSource(Z,b);a.compileShader(Z);fa=a.getShaderParameter(Z,a.COMPILE_STATUS);
if(!fa)throw ga=a.getShaderInfoLog(Z),a.deleteShader(Z),new Two.Utils.Error("unable to compile shader "+Z+": "+ga);return Z},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};T.ctx=T.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(m),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;K=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=T.shaders.create(K,T.shaders.vertex,T.shaders.types.vertex);ja=T.shaders.create(K,T.shaders.fragment,T.shaders.types.fragment);this.program=T.program.create(K,[ka,ja]);K.useProgram(this.program);this.program.position=K.getAttribLocation(this.program,
"a_position");this.program.matrix=K.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=K.getAttribLocation(this.program,"a_textureCoords");K.disable(K.DEPTH_TEST);K.enable(K.BLEND);K.blendEquationSeparate(K.FUNC_ADD,K.FUNC_ADD);K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?q(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){K=this.ctx;this.overdraw||K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT);T.group.render.call(this.scene,K,this.program);this._flagMatrix=!1;return this}})})();(function(){new Two.Vector;var D,p=Two.Shape=function(m){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(p.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(p,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeGetterSetter:function(m){Object.defineProperty(m,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e;this._flagMatrix=!0}});Object.defineProperty(m,
"scale",{get:function(){return this._scale},set:function(e){this._scale=e;this._flagScale=this._flagMatrix=!0}})}});_.extend(p.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(m){m.add(this);return this},clone:function(){D=new p;D.translation.copy(this.translation);D.rotation=this.rotation;D.scale=this.scale;_.each(p.Properties,function(m){D[m]=this[m]},this);return D.update()},update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});p.MakeGetterSetter(p.prototype)})();(function(){var D=Math.min,p=Math.max,m=Math.round,e=Two.Utils.getComputedMatrix,q,k,l,s,d,x,B,w,y,v,g,E,C,t,F,z,A,a,b,c,n,H,r,G,I,J,L,P,M,Q,R,f=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!c;this._automatic=!d;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4;this._vertices=[];this.vertices=a};_.extend(f,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),
FlagVertices:function(){this._flagVertices=!0}});_.extend(f.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;w=_.map(this.vertices,function(a){return a.clone()});y=new f(w,this.closed,this.curved,
!this.automatic);_.each(Two.Shape.Properties,function(a){y[a]=this[a]},this);y.translation.copy(this.translation);y.rotation=this.rotation;y.scale=this.scale;a.add(y);return y},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){v=this.getBoundingClientRect(!0);g={x:v.left,y:v.top};_.each(this.vertices,function(a){a.subSelf(g)});return this},center:function(){v=this.getBoundingClientRect(!0);v.centroid={x:v.left+v.width/
2,y:v.top+v.height/2};_.each(this.vertices,function(a){a.subSelf(v.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(d){E=this.linewidth/2;void 0;C=Infinity;t=-Infinity;F=Infinity;z=-Infinity;_.each(this.vertices,function(b){A=b.x;a=b.y;F=D(a,F);C=D(A,C);t=p(A,t);z=p(a,z)});F-=E;C-=E;t+=E;z+=E;r=d?this._matrix:e(this);b=r.multiply(C,F,1);c=r.multiply(t,F,1);n=r.multiply(t,z,1);H=r.multiply(C,z,1);F=D(b.y,c.y,
n.y,H.y);C=D(b.x,c.x,n.x,H.x);t=p(b.x,c.x,n.x,H.x);z=p(b.y,c.y,n.y,H.y);return{top:F,left:C,right:t,bottom:z,width:t-C,height:z-F}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this.vertices,this.closed),this;_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(){s=this.vertices.length-1;d=this._closed||this.vertices[s].command===Two.Commands.close;w=[];_.each(this.vertices,function(a,b){0>=b&&!d||(t=c.controls&&
c.controls.right,C=a.controls&&a.controls.left,G=c.x,I=c.y,J=(t||c).x,L=(t||c).y,P=(C||a).x,M=(C||a).y,Q=a.x,R=a.y,w.push(Two.Utils.subdivide(G,I,J,L,P,M,Q,R)));c=a},this);this._curved=this._automatic=!1;this.vertices=_.flatten(w);this.plot();return this},update:function(){if(this._flagVertices)for(this._automatic&&this.plot(),q=this.vertices.length,s=q-1,k=m(this._beginning*s),l=m(this._ending*s),this._vertices.length=0,B=k;B<l+1;B++)x=this.vertices[B],this._vertices.push(x);Two.Shape.prototype.update.call(this);
return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});_.each(f.Properties.slice(0,8),function(a){var b="_"+a,c="_flag"+a.charAt(0).toUpperCase()+a.slice(1);Object.defineProperty(f.prototype,a,{get:function(){return this[b]},set:function(a){this[b]=a;this[c]=!0}})});Object.defineProperty(f.prototype,"closed",{get:function(){return this._closed},
set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(f.prototype,"curved",{get:function(){return this._curved},set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(f.prototype,"automatic",{get:function(){return this._automatic},set:function(a){a!==this._automatic&&(this._automatic=!!a)}});Object.defineProperty(f.prototype,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=D(p(a,0),1);this._flagVertices=!0}});Object.defineProperty(f.prototype,
"ending",{get:function(){return this._ending},set:function(a){this._ending=D(p(a,0),1);this._flagVertices=!0}});Object.defineProperty(f.prototype,"vertices",{get:function(){return this._collection},set:function(a){var b=_.bind(f.FlagVertices,this),c=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,b)},this);b()},this),d=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,b)},this);b()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(a.slice(0));
this._collection.bind(Two.Events.insert,c);this._collection.bind(Two.Events.remove,d);verticesChanged=!0;c(this._collection)}});Two.Shape.MakeGetterSetter(f.prototype)})();(function(){var D=Math.min,p=Math.max,m,e,q,k,l,s,d,x,B,w,y,v,g,E,C,t,F,z,A,a,b=Two.Group=function(a){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(b,{MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]);_.each(b,function(b){m="_"+b;Object.defineProperty(a,b,{get:function(){return this[m]},set:function(a){this[m]=a;_.each(this.children,function(c){c[b]=a})}})})}});_.extend(b.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,
_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;q=_.map(this.children,function(a){return a.clone()});k=new b;a.add(k);k.add(q);k.translation.copy(this.translation);k.rotation=this.rotation;k.scale=this.scale;return k},corner:function(){l=this.getBoundingClientRect(!0);s={x:l.left,y:l.top};_.each(this.children,function(a){a.translation.subSelf(s)});return this},
center:function(){l=this.getBoundingClientRect(!0);l.centroid={x:l.left+l.width/2,y:l.top+l.height/2};_.each(this.children,function(a){a.translation.subSelf(l.centroid)});return this},add:function(a){d=arguments.length;x=a;q=this.children;B=this.parent;w=this.additions;_.isArray(a)||(x=_.toArray(arguments));_.each(x,function(a){a&&(y=a.id,e=a.parent,_.isUndefined(q[y])&&(e&&delete e.children[y],q[y]=a,a.parent=this,w.push(y),this._flagAdditions=!0))},this);return this},remove:function(a){d=arguments.length;
x=a;q=this.children;B=this.parent;w=this.subtractions;if(0>=d&&B)return B.remove(this),this;_.isArray(a)||(x=_.toArray(arguments));_.each(x,function(a){y=a.id;grandchildren=a.children;y in q&&(delete q[y],delete a.parent,w.push(y),this._flagSubtractions=!0)});return this},getBoundingClientRect:function(b){v=Infinity;g=-Infinity;E=Infinity;C=-Infinity;_.each(this.children,function(a){l=a.getBoundingClientRect(!0);_.isNumber(l.top)&&(_.isNumber(l.left)&&_.isNumber(l.right)&&_.isNumber(l.bottom))&&(E=
D(l.top,E),v=D(l.left,v),g=p(l.right,g),C=p(l.bottom,C))},this);t=b?this._matrix:Two.Utils.getComputedMatrix(this);F=t.multiply(v,E,1);z=t.multiply(g,E,1);A=t.multiply(g,C,1);a=t.multiply(v,C,1);E=D(F.y,z.y,A.y,a.y);v=D(F.x,z.x,A.x,a.x);g=p(F.x,z.x,A.x,a.x);C=p(F.y,z.y,A.y,a.y);return{top:E,left:v,right:g,bottom:C,width:g-v,height:C-E}},noFill:function(){_.each(this.children,function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this},subdivide:function(){_.each(this.children,
function(a){a.subdivide()});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);return this}});b.MakeGetterSetter(b.prototype,Two.Polygon.Properties);Two.Shape.MakeGetterSetter(b.prototype)})();
