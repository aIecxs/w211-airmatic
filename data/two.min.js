(function(){var D=this,q=D._,m={},h=Array.prototype,p=Object.prototype,r=h.push,e=h.slice,n=h.concat,f=p.toString,A=p.hasOwnProperty,F=h.forEach,u=h.map,B=h.reduce,t=h.reduceRight,E=h.filter,g=h.every,v=h.some,w=h.indexOf,y=h.lastIndexOf,p=Array.isArray,x=Object.keys,H=Function.prototype.bind,c=function(b){if(b instanceof c)return b;if(!(this instanceof c))return new c(b);this._wrapped=b};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=c),exports._=
c):D._=c;c.VERSION="1.5.1";var C=c.each=c.forEach=function(b,l,z){if(null!=b)if(F&&b.forEach===F)b.forEach(l,z);else if(b.length===+b.length)for(var a=0,d=b.length;a<d&&l.call(z,b[a],a,b)!==m;a++);else for(a in b)if(c.has(b,a)&&l.call(z,b[a],a,b)===m)break};c.map=c.collect=function(b,l,z){var a=[];if(null==b)return a;if(u&&b.map===u)return b.map(l,z);C(b,function(b,c,d){a.push(l.call(z,b,c,d))});return a};c.reduce=c.foldl=c.inject=function(b,l,z,a){var d=2<arguments.length;null==b&&(b=[]);if(B&&b.reduce===
B)return a&&(l=c.bind(l,a)),d?b.reduce(l,z):b.reduce(l);C(b,function(b,c,s){d?z=l.call(a,z,b,c,s):(z=b,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return z};c.reduceRight=c.foldr=function(b,l,z,a){var d=2<arguments.length;null==b&&(b=[]);if(t&&b.reduceRight===t)return a&&(l=c.bind(l,a)),d?b.reduceRight(l,z):b.reduceRight(l);var s=b.length;if(s!==+s)var k=c.keys(b),s=k.length;C(b,function(c,g,f){g=k?k[--s]:--s;d?z=l.call(a,z,b[g],g,f):(z=b[g],d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");
return z};c.find=c.detect=function(b,l,z){var a;d(b,function(b,c,d){if(l.call(z,b,c,d))return a=b,!0});return a};c.filter=c.select=function(b,l,z){var a=[];if(null==b)return a;if(E&&b.filter===E)return b.filter(l,z);C(b,function(b,c,d){l.call(z,b,c,d)&&a.push(b)});return a};c.reject=function(b,l,z){return c.filter(b,function(b,a,c){return!l.call(z,b,a,c)},z)};c.every=c.all=function(b,l,z){l||(l=c.identity);var a=!0;if(null==b)return a;if(g&&b.every===g)return b.every(l,z);C(b,function(b,c,d){if(!(a=
a&&l.call(z,b,c,d)))return m});return!!a};var d=c.some=c.any=function(b,l,z){l||(l=c.identity);var a=!1;if(null==b)return a;if(v&&b.some===v)return b.some(l,z);C(b,function(b,c,d){if(a||(a=l.call(z,b,c,d)))return m});return!!a};c.contains=c.include=function(b,l){return null==b?!1:w&&b.indexOf===w?-1!=b.indexOf(l):d(b,function(b){return b===l})};c.invoke=function(b,l){var a=e.call(arguments,2),d=c.isFunction(l);return c.map(b,function(b){return(d?l:b[l]).apply(b,a)})};c.pluck=function(b,l){return c.map(b,
function(b){return b[l]})};c.where=function(b,l,a){return c.isEmpty(l)?a?void 0:[]:c[a?"find":"filter"](b,function(b){for(var a in l)if(l[a]!==b[a])return!1;return!0})};c.findWhere=function(b,l){return c.where(b,l,!0)};c.max=function(b,l,a){if(!l&&c.isArray(b)&&b[0]===+b[0]&&65535>b.length)return Math.max.apply(Math,b);if(!l&&c.isEmpty(b))return-Infinity;var d={computed:-Infinity,value:-Infinity};C(b,function(b,c,s){c=l?l.call(a,b,c,s):b;c>d.computed&&(d={value:b,computed:c})});return d.value};c.min=
function(b,l,a){if(!l&&c.isArray(b)&&b[0]===+b[0]&&65535>b.length)return Math.min.apply(Math,b);if(!l&&c.isEmpty(b))return Infinity;var d={computed:Infinity,value:Infinity};C(b,function(b,c,s){c=l?l.call(a,b,c,s):b;c<d.computed&&(d={value:b,computed:c})});return d.value};c.shuffle=function(b){var l,a=0,d=[];C(b,function(b){l=c.random(a++);d[a-1]=d[l];d[l]=b});return d};var a=function(b){return c.isFunction(b)?b:function(l){return l[b]}};c.sortBy=function(b,l,d){var s=a(l);return c.pluck(c.map(b,function(b,
l,a){return{value:b,index:l,criteria:s.call(d,b,l,a)}}).sort(function(b,l){var a=b.criteria,c=l.criteria;if(a!==c){if(a>c||void 0===a)return 1;if(a<c||void 0===c)return-1}return b.index<l.index?-1:1}),"value")};var s=function(b,l,d,s){var k={},g=a(null==l?c.identity:l);C(b,function(l,a){var c=g.call(d,l,a,b);s(k,c,l)});return k};c.groupBy=function(b,l,a){return s(b,l,a,function(b,l,a){(c.has(b,l)?b[l]:b[l]=[]).push(a)})};c.countBy=function(b,l,a){return s(b,l,a,function(b,l){c.has(b,l)||(b[l]=0);
b[l]++})};c.sortedIndex=function(b,l,d,s){d=null==d?c.identity:a(d);l=d.call(s,l);for(var k=0,g=b.length;k<g;){var f=k+g>>>1;d.call(s,b[f])<l?k=f+1:g=f}return k};c.toArray=function(b){return b?c.isArray(b)?e.call(b):b.length===+b.length?c.map(b,c.identity):c.values(b):[]};c.size=function(b){return null==b?0:b.length===+b.length?b.length:c.keys(b).length};c.first=c.head=c.take=function(b,l,a){return null==b?void 0:null==l||a?b[0]:e.call(b,0,l)};c.initial=function(b,l,a){return e.call(b,0,b.length-
(null==l||a?1:l))};c.last=function(b,l,a){return null==b?void 0:null==l||a?b[b.length-1]:e.call(b,Math.max(b.length-l,0))};c.rest=c.tail=c.drop=function(b,l,a){return e.call(b,null==l||a?1:l)};c.compact=function(b){return c.filter(b,c.identity)};var k=function(b,l,a){if(l&&c.every(b,c.isArray))return n.apply(a,b);C(b,function(b){c.isArray(b)||c.isArguments(b)?l?r.apply(a,b):k(b,l,a):a.push(b)});return a};c.flatten=function(b,l){return k(b,l,[])};c.without=function(b){return c.difference(b,e.call(arguments,
1))};c.uniq=c.unique=function(b,l,a,d){c.isFunction(l)&&(d=a,a=l,l=!1);a=a?c.map(b,a,d):b;var s=[],k=[];C(a,function(a,d){(l?d&&k[k.length-1]===a:c.contains(k,a))||(k.push(a),s.push(b[d]))});return s};c.union=function(){return c.uniq(c.flatten(arguments,!0))};c.intersection=function(b){var l=e.call(arguments,1);return c.filter(c.uniq(b),function(b){return c.every(l,function(l){return 0<=c.indexOf(l,b)})})};c.difference=function(b){var l=n.apply(h,e.call(arguments,1));return c.filter(b,function(b){return!c.contains(l,
b)})};c.zip=function(){for(var b=c.max(c.pluck(arguments,"length").concat(0)),l=Array(b),a=0;a<b;a++)l[a]=c.pluck(arguments,""+a);return l};c.object=function(b,a){if(null==b)return{};for(var d={},c=0,s=b.length;c<s;c++)a?d[b[c]]=a[c]:d[b[c][0]]=b[c][1];return d};c.indexOf=function(b,a,d){if(null==b)return-1;var s=0,k=b.length;if(d)if("number"==typeof d)s=0>d?Math.max(0,k+d):d;else return s=c.sortedIndex(b,a),b[s]===a?s:-1;if(w&&b.indexOf===w)return b.indexOf(a,d);for(;s<k;s++)if(b[s]===a)return s;
return-1};c.lastIndexOf=function(b,a,d){if(null==b)return-1;var c=null!=d;if(y&&b.lastIndexOf===y)return c?b.lastIndexOf(a,d):b.lastIndexOf(a);for(d=c?d:b.length;d--;)if(b[d]===a)return d;return-1};c.range=function(b,a,d){1>=arguments.length&&(a=b||0,b=0);d=arguments[2]||1;for(var c=Math.max(Math.ceil((a-b)/d),0),s=0,k=Array(c);s<c;)k[s++]=b,b+=d;return k};var G=function(){};c.bind=function(b,a){var d,s;if(H&&b.bind===H)return H.apply(b,e.call(arguments,1));if(!c.isFunction(b))throw new TypeError;
d=e.call(arguments,2);return s=function(){if(!(this instanceof s))return b.apply(a,d.concat(e.call(arguments)));G.prototype=b.prototype;var c=new G;G.prototype=null;var k=b.apply(c,d.concat(e.call(arguments)));return Object(k)===k?k:c}};c.partial=function(b){var a=e.call(arguments,1);return function(){return b.apply(this,a.concat(e.call(arguments)))}};c.bindAll=function(b){var a=e.call(arguments,1);if(0===a.length)throw Error("bindAll must be passed function names");C(a,function(a){b[a]=c.bind(b[a],
b)});return b};c.memoize=function(b,a){var d={};a||(a=c.identity);return function(){var s=a.apply(this,arguments);return c.has(d,s)?d[s]:d[s]=b.apply(this,arguments)}};c.delay=function(b,a){var d=e.call(arguments,2);return setTimeout(function(){return b.apply(null,d)},a)};c.defer=function(b){return c.delay.apply(c,[b,1].concat(e.call(arguments,1)))};c.throttle=function(b,a,d){var c,s,k,g=null,f=0;d||(d={});var h=function(){f=!1===d.leading?0:new Date;g=null;k=b.apply(c,s)};return function(){var e=
new Date;f||!1!==d.leading||(f=e);var G=a-(e-f);c=this;s=arguments;0>=G?(clearTimeout(g),g=null,f=e,k=b.apply(c,s)):g||!1===d.trailing||(g=setTimeout(h,G));return k}};c.debounce=function(b,a,d){var c,s=null;return function(){var k=this,g=arguments,f=d&&!s;clearTimeout(s);s=setTimeout(function(){s=null;d||(c=b.apply(k,g))},a);f&&(c=b.apply(k,g));return c}};c.once=function(b){var a=!1,d;return function(){if(a)return d;a=!0;d=b.apply(this,arguments);b=null;return d}};c.wrap=function(b,a){return function(){var d=
[b];r.apply(d,arguments);return a.apply(this,d)}};c.compose=function(){var b=arguments;return function(){for(var a=arguments,d=b.length-1;0<=d;d--)a=[b[d].apply(this,a)];return a[0]}};c.after=function(b,a){return function(){if(1>--b)return a.apply(this,arguments)}};c.keys=x||function(b){if(b!==Object(b))throw new TypeError("Invalid object");var a=[],d;for(d in b)c.has(b,d)&&a.push(d);return a};c.values=function(b){var a=[],d;for(d in b)c.has(b,d)&&a.push(b[d]);return a};c.pairs=function(b){var a=
[],d;for(d in b)c.has(b,d)&&a.push([d,b[d]]);return a};c.invert=function(b){var a={},d;for(d in b)c.has(b,d)&&(a[b[d]]=d);return a};c.functions=c.methods=function(b){var a=[],d;for(d in b)c.isFunction(b[d])&&a.push(d);return a.sort()};c.extend=function(b){C(e.call(arguments,1),function(a){if(a)for(var d in a)b[d]=a[d]});return b};c.pick=function(b){var a={},d=n.apply(h,e.call(arguments,1));C(d,function(d){d in b&&(a[d]=b[d])});return a};c.omit=function(b){var a={},d=n.apply(h,e.call(arguments,1)),
s;for(s in b)c.contains(d,s)||(a[s]=b[s]);return a};c.defaults=function(b){C(e.call(arguments,1),function(a){if(a)for(var d in a)void 0===b[d]&&(b[d]=a[d])});return b};c.clone=function(b){return c.isObject(b)?c.isArray(b)?b.slice():c.extend({},b):b};c.tap=function(b,a){a(b);return b};var J=function(b,a,d,s){if(b===a)return 0!==b||1/b==1/a;if(null==b||null==a)return b===a;b instanceof c&&(b=b._wrapped);a instanceof c&&(a=a._wrapped);var k=f.call(b);if(k!=f.call(a))return!1;switch(k){case "[object String]":return b==
String(a);case "[object Number]":return b!=+b?a!=+a:0==b?1/b==1/a:b==+a;case "[object Date]":case "[object Boolean]":return+b==+a;case "[object RegExp]":return b.source==a.source&&b.global==a.global&&b.multiline==a.multiline&&b.ignoreCase==a.ignoreCase}if("object"!=typeof b||"object"!=typeof a)return!1;for(var g=d.length;g--;)if(d[g]==b)return s[g]==a;var g=b.constructor,h=a.constructor;if(g!==h&&!(c.isFunction(g)&&g instanceof g&&c.isFunction(h)&&h instanceof h))return!1;d.push(b);s.push(a);g=0;
h=!0;if("[object Array]"==k){if(g=b.length,h=g==a.length)for(;g--&&(h=J(b[g],a[g],d,s)););}else{for(var e in b)if(c.has(b,e)&&(g++,!(h=c.has(a,e)&&J(b[e],a[e],d,s))))break;if(h){for(e in a)if(c.has(a,e)&&!g--)break;h=!g}}d.pop();s.pop();return h};c.isEqual=function(b,a){return J(b,a,[],[])};c.isEmpty=function(b){if(null==b)return!0;if(c.isArray(b)||c.isString(b))return 0===b.length;for(var a in b)if(c.has(b,a))return!1;return!0};c.isElement=function(b){return!(!b||1!==b.nodeType)};c.isArray=p||function(b){return"[object Array]"==
f.call(b)};c.isObject=function(b){return b===Object(b)};C("Arguments Function String Number Date RegExp".split(" "),function(b){c["is"+b]=function(a){return f.call(a)=="[object "+b+"]"}});c.isArguments(arguments)||(c.isArguments=function(b){return!(!b||!c.has(b,"callee"))});"function"!==typeof/./&&(c.isFunction=function(b){return"function"===typeof b});c.isFinite=function(b){return isFinite(b)&&!isNaN(parseFloat(b))};c.isNaN=function(b){return c.isNumber(b)&&b!=+b};c.isBoolean=function(b){return!0===
b||!1===b||"[object Boolean]"==f.call(b)};c.isNull=function(b){return null===b};c.isUndefined=function(b){return void 0===b};c.has=function(b,a){return A.call(b,a)};c.noConflict=function(){D._=q;return this};c.identity=function(b){return b};c.times=function(b,a,d){for(var c=Array(Math.max(0,b)),s=0;s<b;s++)c[s]=a.call(d,s);return c};c.random=function(b,a){null==a&&(a=b,b=0);return b+Math.floor(Math.random()*(a-b+1))};var K={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
K.unescape=c.invert(K.escape);var N={escape:RegExp("["+c.keys(K.escape).join("")+"]","g"),unescape:RegExp("("+c.keys(K.unescape).join("|")+")","g")};c.each(["escape","unescape"],function(b){c[b]=function(a){return null==a?"":(""+a).replace(N[b],function(a){return K[b][a]})}});c.result=function(b,a){if(null!=b){var d=b[a];return c.isFunction(d)?d.call(b):d}};c.mixin=function(b){C(c.functions(b),function(a){var d=c[a]=b[a];c.prototype[a]=function(){var b=[this._wrapped];r.apply(b,arguments);b=d.apply(c,
b);return this._chain?c(b).chain():b}})};var I=0;c.uniqueId=function(b){var a=++I+"";return b?b+a:a};c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,T={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\t|\u2028|\u2029/g;c.template=function(b,a,d){var s;d=c.defaults({},d,c.templateSettings);var k=RegExp([(d.escape||P).source,(d.interpolate||P).source,(d.evaluate||P).source].join("|")+
"|$","g"),g=0,f="__p+='";b.replace(k,function(a,d,c,s,k){f+=b.slice(g,k).replace(U,function(b){return"\\"+T[b]});d&&(f+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'");c&&(f+="'+\n((__t=("+c+"))==null?'':__t)+\n'");s&&(f+="';\n"+s+"\n__p+='");g=k+a.length;return a});f+="';\n";d.variable||(f="with(obj||{}){\n"+f+"}\n");f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{s=new Function(d.variable||"obj","_",f)}catch(h){throw h.source=
f,h;}if(a)return s(a,c);a=function(b){return s.call(this,b,c)};a.source="function("+(d.variable||"obj")+"){\n"+f+"}";return a};c.chain=function(b){return c(b).chain()};c.mixin(c);C("pop push reverse shift sort splice unshift".split(" "),function(b){var a=h[b];c.prototype[b]=function(){var d=this._wrapped;a.apply(d,arguments);"shift"!=b&&"splice"!=b||0!==d.length||delete d[0];return this._chain?c(d).chain():d}});C(["concat","join","slice"],function(b){var a=h[b];c.prototype[b]=function(){var b=a.apply(this._wrapped,
arguments);return this._chain?c(b).chain():b}});c.extend(c.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var D=[].slice,q=function(h,p,r){var e;h=-1;var n=p.length;switch(r.length){case 0:for(;++h<n;)(e=p[h]).callback.call(e.ctx);break;case 1:for(;++h<n;)(e=p[h]).callback.call(e.ctx,r[0]);break;case 2:for(;++h<n;)(e=p[h]).callback.call(e.ctx,r[0],r[1]);break;case 3:for(;++h<n;)(e=p[h]).callback.call(e.ctx,r[0],r[1],r[2]);break;default:for(;++h<n;)(e=p[h]).callback.apply(e.ctx,r)}},m=Backbone.Events={on:function(h,p,r){this._events||(this._events={});(this._events[h]||(this._events[h]=[])).push({callback:p,
context:r,ctx:r||this});return this},once:function(h,p,r){var e=this,n=_.once(function(){e.off(h,n);p.apply(this,arguments)});n._callback=p;this.on(h,n,r);return this},off:function(h,p,r){var e,n,f,m,q,u,B,t;if(!this._events)return this;if(!h&&!p&&!r)return this._events={},this;m=h?[h]:_.keys(this._events);q=0;for(u=m.length;q<u;q++)if(h=m[q],e=this._events[h]){f=[];if(p||r)for(B=0,t=e.length;B<t;B++)n=e[B],(p&&p!==(n.callback._callback||n.callback)||r&&r!==n.context)&&f.push(n);this._events[h]=f}return this},
trigger:function(h){if(!this._events)return this;var p=D.call(arguments,1),r=this._events[h],e=this._events.all;r&&q(this,r,p);e&&q(this,e,arguments);return this},listenTo:function(h,p,r){var e=this._listeners||(this._listeners={}),n=h._listenerId||(h._listenerId=_.uniqueId("l"));e[n]=h;h.on(p,r||this,this);return this},stopListening:function(h,p,r){var e=this._listeners;if(e){if(h)h.off(p,r,this),p||r||delete e[h._listenerId];else{for(var n in e)e[n].off(null,null,this);this._listeners={}}return this}}};
m.bind=m.on;m.unbind=m.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=m),exports.Backbone=exports.Backbone||Backbone)})();(function(){function D(h,e){var n=(new Date).getTime(),f=Math.max(0,16-(n-m)),p=q.setTimeout(function(){h(n+f)},f);m=n+f;return p}var q=this,m=0,h=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=D),exports.requestAnimationFrame=D;else{for(var p=0;p<h.length&&!q.requestAnimationFrame;++p)q.requestAnimationFrame=q[h[p]+"RequestAnimationFrame"],q.cancelAnimationFrame=q[h[p]+"CancelAnimationFrame"]||q[h[p]+"CancelRequestAnimationFrame"];
q.requestAnimationFrame||(q.requestAnimationFrame=D);q.cancelAnimationFrame||(q.cancelAnimationFrame=function(h){clearTimeout(h)})}})();(function(){function D(){var d=document.body.getBoundingClientRect(),a=this.width=d.width,d=this.height=d.height;this.renderer.setSize(a,d,this.ratio);this.trigger(g.Events.resize,a,d)}var q=this,m=q.Two||{},h=Math.sin,p=Math.cos,r=Math.atan2,e=Math.sqrt,n=Math.abs,f=Math.PI,A=2*f,F=f/2,u=Math.pow,B=Math.max,t=0,E={hasEventListeners:_.isFunction(q.addEventListener),bind:function(d,a,c,k){this.hasEventListeners?d.addEventListener(a,c,!!k):d.attachEvent("on"+a,c);return this},unbind:function(d,a,c,
k){this.hasEventListeners?d.removeEventListeners(a,c,!!k):d.detachEvent("on"+a,c);return this}},g=q.Two=function(d){d=_.defaults(d||{},{fullscreen:!1,width:640,height:480,type:g.Types.svg,autostart:!1});_.each(d,function(a,d){"fullscreen"!==d&&("width"!==d&&"height"!==d&&"autostart"!==d)&&(this[d]=a)},this);_.isElement(d.domElement)&&(this.type=g.Types[d.domElement.tagName.toLowerCase()]);this.renderer=new g[this.type](this);g.Utils.setPlaying.call(this,d.autostart);this.frameCount=0;d.fullscreen?
(d=_.bind(D,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),E.bind(q,"resize",d),d()):_.isElement(d.domElement)||(this.renderer.setSize(d.width,d.height,this.ratio),this.width=d.width,this.height=d.height);this.scene=this.renderer.scene;g.Instances.push(this)};_.extend(g,{Array:q.Float32Array||Array,Types:{webgl:"WebGLRenderer",
svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){q.Two=m;return this},uniqueId:function(){var d=t;t++;return d},Utils:{Curve:{CollinearityEpsilon:u(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,
angle:0,epsilon:0.01}},devicePixelRatio:q.devicePixelRatio||1,getBackingStoreRatio:function(d){return d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1},getRatio:function(d){return g.Utils.devicePixelRatio/c(d)},setPlaying:function(d){this.playing=!!d;return this},getComputedMatrix:function(d,a){a=a&&a.identity()||new g.Matrix;for(var c=d;c&&c._matrix;){var k=c._matrix.elements;a.multiply(k[0],k[1],k[2],
k[3],k[4],k[5],k[6],k[7],k[8],k[9]);c=c.parent}return a},getComputedScale:function(d){for(var a=1;d&&d._scale;)a*=d._scale,d=d.parent;return a},applySvgAttributes:function(d,a){a.cap="butt";a.join="bevel";_.each(d.attributes,function(d,c){switch(d.nodeName){case "visibility":a.visible=!!d.nodeValue;break;case "stroke-linecap":a.cap=d.nodeValue;break;case "stroke-linejoin":a.join=d.nodeValue;break;case "stroke-miterlimit":a.miter=d.nodeValue;break;case "stroke-width":a.linewidth=parseFloat(d.nodeValue);
break;case "stroke-opacity":case "fill-opacity":a.opacity=d.nodeValue;break;case "fill":a.fill=d.nodeValue;break;case "stroke":a.stroke=d.nodeValue}});return a},read:{svg:function(){return g.Utils.read.g.apply(this,arguments)},g:function(d){var a=new g.Group;this.add(a);_.each(d.childNodes,function(d){var c=d.nodeName;c&&(c=c.replace(/svg\:/ig,"").toLowerCase(),c in g.Utils.read&&(d=g.Utils.read[c].call(this,d),a.add(d)))},this);return g.Utils.applySvgAttributes(d,a)},polygon:function(d,a){var c=
[];d.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,function(a,d,k){c.push(new g.Anchor(parseFloat(d),parseFloat(k)))});var k=(new g.Polygon(c,!a)).noStroke();return g.Utils.applySvgAttributes(d,k)},polyline:function(d){return g.Utils.read.polygon(d,!0)},path:function(d){var a,c,k,f=!1,h=!1,e=d.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),r=e.length-1,e=_.flatten(_.map(e,function(d,e){var n,p,b=d[0],l=b.toLowerCase();k=d.slice(1).trim();k=k.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,
function(b,a,d){return parseFloat(a)*Math.pow(10,d)});k=k.split(/[\s,]+|(?=\s?[+\-])/);f=b===l;var z,m,A,q;switch(l){case "z":e>=r?h=!0:(p=a.x,n=a.y,n=new g.Anchor(p,n,void 0,void 0,void 0,void 0,g.Commands.close));break;case "m":case "l":p=parseFloat(k[0]);n=parseFloat(k[1]);n=new g.Anchor(p,n,void 0,void 0,void 0,void 0,"m"===l?g.Commands.move:g.Commands.line);f&&n.addSelf(a);a=n;break;case "h":case "v":p="h"===l?"x":"y";b="x"===p?"y":"x";n=new g.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,
g.Commands.line);n[p]=parseFloat(k[0]);n[b]=a[b];f&&(n[p]+=a[p]);a=n;break;case "s":case "c":n=a.x;b=a.y;c||(c=(new g.Vector).copy(a));"c"===l?(z=parseFloat(k[0]),p=parseFloat(k[1]),l=parseFloat(k[2]),m=parseFloat(k[3]),A=parseFloat(k[4]),q=parseFloat(k[5])):(m=g.Utils.getReflection(a,c,f),z=m.x,p=m.y,l=parseFloat(k[0]),m=parseFloat(k[1]),A=parseFloat(k[2]),q=parseFloat(k[3]));f&&(z+=n,p+=b,l+=n,m+=b,A+=n,q+=b);_.isObject(a.controls)||g.Anchor.AppendCurveProperties(a);a.controls.right.set(z,p);a=
n=new g.Anchor(A,q,l,m,void 0,void 0,g.Commands.curve);c=n.controls.left;break;case "t":case "q":n=a.x;b=a.y;c||(c=(new g.Vector).copy(a));c.isZero()?(z=n,p=b):(z=c.x,b=c.y);"q"===l?(l=parseFloat(k[0]),m=parseFloat(k[1]),A=parseFloat(k[1]),q=parseFloat(k[2])):(m=g.Utils.getReflection(a,c,f),l=m.x,m=m.y,A=parseFloat(k[0]),q=parseFloat(k[1]));f&&(z+=n,p+=b,l+=n,m+=b,A+=n,q+=b);_.isObject(a.controls)||g.Anchor.AppendCurveProperties(a);a.controls.right.set(z,p);a=n=new g.Anchor(A,q,l,m,void 0,void 0,
g.Commands.curve);c=n.controls.left;break;case "a":throw new g.Utils.Error("not yet able to interpret Elliptical Arcs.");}return n}));if(!(1>=e.length))return e=_.compact(e),e=(new g.Polygon(e,h,void 0,!0)).noStroke(),g.Utils.applySvgAttributes(d,e)},circle:function(d){var a=parseFloat(d.getAttribute("cx")),c=parseFloat(d.getAttribute("cy")),k=parseFloat(d.getAttribute("r")),f=g.Resolution,e=_.map(_.range(f),function(a){var d=a/f*A;a=k*p(d);d=k*h(d);return new g.Anchor(a,d)},this),e=(new g.Polygon(e,
!0,!0)).noStroke();e.translation.set(a,c);return g.Utils.applySvgAttributes(d,e)},ellipse:function(d){var a=parseFloat(d.getAttribute("cx")),c=parseFloat(d.getAttribute("cy")),k=parseFloat(d.getAttribute("rx")),f=parseFloat(d.getAttribute("ry")),e=g.Resolution,n=_.map(_.range(e),function(a){var d=a/e*A;a=k*p(d);d=f*h(d);return new g.Anchor(a,d)},this),n=(new g.Polygon(n,!0,!0)).noStroke();n.translation.set(a,c);return g.Utils.applySvgAttributes(d,n)},rect:function(d){var a=parseFloat(d.getAttribute("x")),
c=parseFloat(d.getAttribute("y")),k=parseFloat(d.getAttribute("width")),f=parseFloat(d.getAttribute("height")),k=k/2,f=f/2,h=[new g.Anchor(k,f),new g.Anchor(-k,f),new g.Anchor(-k,-f),new g.Anchor(k,-f)],h=(new g.Polygon(h,!0)).noStroke();h.translation.set(a+k,c+f);return g.Utils.applySvgAttributes(d,h)},line:function(d){var a=parseFloat(d.getAttribute("x1")),c=parseFloat(d.getAttribute("y1")),k=parseFloat(d.getAttribute("x2")),f=parseFloat(d.getAttribute("y2")),k=(k-a)/2,f=(f-c)/2,h=[new g.Anchor(-k,
-f),new g.Anchor(k,f)],h=(new g.Polygon(h)).noFill();h.translation.set(a+k,c+f);return g.Utils.applySvgAttributes(d,h)}},subdivide:function(d,a,c,k,e,m,q,t,I,w){var u=g.Utils.Curve.CollinearityEpsilon;w=w||g.Utils.Curve.RecursionLimit;var F=g.Utils.Curve.CuspLimit,b=g.Utils.Curve.Tolerance,l,z,y,D,v,x;I=I||0;if(I>w)return[];if(C(c,k,d,a,q,t)&&C(e,m,d,a,q,t)){v=q-d;x=t-a;c=r(x,v);I=B(w-I,1);for(z=I-1;0>c;)c+=f;y=p(c);D=h(c);return _.map(_.range(I),function(b){b/=z;return new g.Anchor(v*b*y+d,x*b*D+
a)})}var E=(d+c)/2,H=(a+k)/2,R=(c+e)/2,S=(k+m)/2,Y=(e+q)/2,Z=(m+t)/2,aa=(E+R)/2,ba=(H+S)/2,R=(R+Y)/2,S=(S+Z)/2,O=(aa+R)/2,L=(ba+S)/2;v=q-d;x=t-a;l=n((c-q)*x-(k-t)*v);var Q=n((e-q)*x-(m-t)*v);if(0<I){if(l>u&&Q>u&&(l+Q)*(l+Q)<=b.distance*(v*v+x*x)){if(b.angle<b.epsilon)return[new g.Anchor(O,L)];l=r(m-k,e-c);u=n(l-r(k-a,c-d));l=n(r(t-m,q-e)-l);u>=f&&(u=A-u);l>=f&&(l=A-l);if(u+l<b.angle)return[new g.Anchor(O,L)];if(0!==F){if(u>F)return[new g.Anchor(c,k)];if(l>F)return[new g.Anchor(e,m)]}}}else if(l>u)if(l*
l<=b.distance*(v*v+x*x)){if(b.angle<b.epsilon)return[new g.Anchor(O,L)];u=n(r(m-k,e-c)-r(k-a,c-d));u>=f&&(u=A-u);if(u<b.angle)return[new g.Anchor(c,k),new g.Anchor(e,m)];if(0!==F&&u>F)return[new g.Anchor(c,k)]}else if(Q>u){if(Q*Q<=b.distance*(v*v+x*x)){if(b.angle<b.epsilon)return[new g.Anchor(O,L)];u=n(r(t-m,q-e)-r(m-k,e-c));u>=f&&(u=A-u);if(u<b.angle)return[new g.Anchor(c,k),new g.Anchor(e,m)];if(0!==F&&u>F)return[new g.Anchor(e,m)]}}else if(v=O-(d+q)/2,x=L-(a+t)/2,v*v+x*x<=b.distance)return[new g.Anchor(O,
L)];return g.Utils.subdivide(d,a,E,H,aa,ba,O,L,I+1,w).concat(g.Utils.subdivide(O,L,R,S,Y,Z,q,t,I+1,w))},pointOnLine:function(d,a,c,k,f,e){var h=g.Utils.Curve.Tolerance.epsilon;if(n((a-k)*(f-c)-(d-c)*(e-k))>h)return!1;d=(d-c)*(f-c)+(a-k)*(e-k);return 0>d||d>(f-c)*(f-c)+(e-k)*(e-k)?!1:!0},getCurveFromPoints:function(d,a){for(var c=d.length,k=c-1,f=0;f<c;f++){var e=d[f];_.isObject(e.controls)||g.Anchor.AppendCurveProperties(e);var h=a?H(f-1,c):Math.max(f-1,0),n=a?H(f+1,c):Math.min(f+1,k);x(d[h],e,d[n]);
e._command=0===f?g.Commands.move:g.Commands.curve;e.controls.left.x=_.isNumber(e.controls.left.x)?e.controls.left.x:e.x;e.controls.left.y=_.isNumber(e.controls.left.y)?e.controls.left.y:e.y;e.controls.right.x=_.isNumber(e.controls.right.x)?e.controls.right.x:e.x;e.controls.right.y=_.isNumber(e.controls.right.y)?e.controls.right.y:e.y}},getControlPoints:function(d,a,c){var k=y(d,a),e=y(c,a);d=v(d,a);c=v(c,a);var n=(k+e)/2;a.u=_.isObject(a.controls.left)?a.controls.left:new g.Vector(a.x,a.y);a.v=_.isObject(a.controls.right)?
a.controls.right:new g.Vector(a.x,a.y);if(1E-4>d||1E-4>c)return a.controls.left.copy(a),a.controls.right.copy(a),a;d*=0.33;c*=0.33;n=e<k?n+F:n-F;a.controls.left.x=a.x+p(n)*d;a.controls.left.y=a.y+h(n)*d;n-=f;a.controls.right.x=a.x+p(n)*c;a.controls.right.y=a.y+h(n)*c;return a},getReflection:function(d,a,c){var k=d.distanceTo(a);if(1E-4>=k)return c?new g.Vector:d.clone();a=y(d,a);return new g.Vector(k*Math.cos(a)+(c?0:d.x),k*Math.sin(a)+(c?0:d.y))},angleBetween:function(d,a){var c,k;if(4<=arguments.length)return c=
arguments[0]-arguments[2],k=arguments[1]-arguments[3],r(k,c);c=d.x-a.x;k=d.y-a.y;return r(k,c)},distanceBetweenSquared:function(d,a){var c=d.x-a.x,k=d.y-a.y;return c*c+k*k},distanceBetween:function(d,a){return e(w(d,a))},mod:function(d,a){for(;0>d;)d+=a;return d%a},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(d){this.name="two.js";this.message=
d}}});g.Utils.Error.prototype=Error();g.Utils.Error.prototype.constructor=g.Utils.Error;g.Utils.Collection.prototype=[];g.Utils.Collection.constructor=g.Utils.Collection;_.extend(g.Utils.Collection.prototype,Backbone.Events,{pop:function(){var d=Array.prototype.pop.apply(this,arguments);this.trigger(g.Events.remove,[d]);return d},shift:function(){var d=Array.prototype.shift.apply(this,arguments);this.trigger(g.Events.remove,[d]);return d},push:function(){var d=Array.prototype.push.apply(this,arguments);
this.trigger(g.Events.insert,arguments);return d},unshift:function(){var d=Array.prototype.unshift.apply(this,arguments);this.trigger(g.Events.insert,arguments);return d},splice:function(){var d=Array.prototype.splice.apply(this,arguments),a;this.trigger(g.Events.remove,d);2<arguments.length&&(a=this.slice(arguments[0],arguments.length-2),this.trigger(g.Events.insert,a));return d}});var v=g.Utils.distanceBetween,w=g.Utils.distanceBetweenSquared,y=g.Utils.angleBetween,x=g.Utils.getControlPoints,H=
g.Utils.mod,c=g.Utils.getBackingStoreRatio,C=g.Utils.pointOnLine;_.extend(g.prototype,Backbone.Events,{appendTo:function(d){d.appendChild(this.renderer.domElement);return this},play:function(){g.Utils.setPlaying.call(this,!0);return this.trigger(g.Events.play)},pause:function(){this.playing=!1;return this.trigger(g.Events.pause)},update:function(){var d=!!this._lastFrame,a=(q.performance&&q.performance.now?q.performance:Date).now();this.frameCount++;d&&(this.timeDelta=parseFloat((a-this._lastFrame).toFixed(3)));
this._lastFrame=a;var d=this.width,a=this.height,c=this.renderer;d===c.width&&a===c.height||c.setSize(d,a,this.ratio);this.trigger(g.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(g.Events.render,this.frameCount)},add:function(d){var a=d;_.isArray(d)||(a=_.toArray(arguments));this.scene.add(a);return this},remove:function(d){var a=d;_.isArray(d)||(a=_.toArray(arguments));this.scene.remove(a);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));
return this},makeLine:function(d,a,c,k){c=(c-d)/2;k=(k-a)/2;var f=[new g.Anchor(-c,-k),new g.Anchor(c,k)],f=(new g.Polygon(f)).noFill();f.translation.set(d+c,a+k);this.scene.add(f);return f},makeRectangle:function(d,a,c,k){c/=2;k/=2;k=[new g.Anchor(c,k),new g.Anchor(-c,k),new g.Anchor(-c,-k),new g.Anchor(c,-k)];k=new g.Polygon(k,!0);k.translation.set(d,a);this.scene.add(k);return k},makeCircle:function(d,a,c){return this.makeEllipse(d,a,c,c)},makeEllipse:function(d,a,c,k){var f=g.Resolution,e=_.map(_.range(f),
function(a){var d=a/f*A;a=c*p(d);d=k*h(d);return new g.Anchor(a,d)},this),e=new g.Polygon(e,!0,!0);e.translation.set(d,a);this.scene.add(e);return e},makeCurve:function(d){var a=arguments.length,c=d;if(!_.isArray(d))for(var c=[],f=0;f<a;f+=2){var e=arguments[f];if(!_.isNumber(e))break;c.push(new g.Anchor(e,arguments[f+1]))}var a=arguments[a-1],c=new g.Polygon(c,!(_.isBoolean(a)&&a),!0),a=c.getBoundingClientRect(),h=a.left+a.width/2,n=a.top+a.height/2;_.each(c.vertices,function(a){a.x-=h;a.y-=n});
c.translation.set(h,n);this.scene.add(c);return c},makePolygon:function(d){var a=arguments.length,c=d;if(!_.isArray(d))for(var c=[],f=0;f<a;f+=2){var e=arguments[f];if(!_.isNumber(e))break;c.push(new g.Anchor(e,arguments[f+1]))}a=arguments[a-1];c=new g.Polygon(c,!(_.isBoolean(a)&&a));a=c.getBoundingClientRect();c.center().translation.set(a.left+a.width/2,a.top+a.height/2);this.scene.add(c);return c},makeGroup:function(d){var a=d;_.isArray(d)||(a=_.toArray(arguments));var c=new g.Group;this.scene.add(c);
c.add(a);return c},interpret:function(c){var a=c.tagName.toLowerCase();if(!(a in g.Utils.read))return null;c=g.Utils.read[a].call(this,c);this.add(c);return c}});(function(){requestAnimationFrame(arguments.callee);_.each(g.Instances,function(c){c.playing&&c.update()})})();"function"===typeof define&&define.amd?define(function(){return g}):"undefined"!=typeof module&&module.exports&&(module.exports=g)})();(function(){var D,q,m,h,p=Two.Vector=function(f,e){this.x=f||0;this.y=e||0};_.extend(p.prototype,Backbone.Events,{set:function(f,e){this.x=f;this.y=e;return this},copy:function(f){this.x=f.x;this.y=f.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new p(this.x,this.y)},add:function(f,e){this.x=f.x+e.x;this.y=f.y+e.y;return this},addSelf:function(f){this.x+=f.x;this.y+=f.y;return this},sub:function(f,e){this.x=f.x-e.x;this.y=f.y-e.y;return this},subSelf:function(f){this.x-=
f.x;this.y-=f.y;return this},multiplySelf:function(f){this.x*=f.x;this.y*=f.y;return this},multiplyScalar:function(f){this.x*=f;this.y*=f;return this},divideScalar:function(f){f?(this.x/=f,this.y/=f):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(f){return this.x*f.x+this.y*f.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(f){return Math.sqrt(this.distanceToSquared(f))},distanceToSquared:function(f){m=this.x-f.x;h=this.y-f.y;return m*m+h*h},setLength:function(f){return this.normalize().multiplyScalar(f)},equals:function(f){return 1E-4>this.distanceTo(f)},lerp:function(f,e){D=(f.x-this.x)*e+this.x;q=(f.y-this.y)*e+this.y;return this.set(D,q)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var r={set:function(f,
e){this._x=f;this._y=e;return this.trigger(Two.Events.change)},copy:function(f){this._x=f.x;this._y=f.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new p(this._x,this._y)},add:function(f,e){this._x=f.x+e.x;this._y=f.y+e.y;return this.trigger(Two.Events.change)},addSelf:function(f){this._x+=f.x;this._y+=f.y;return this.trigger(Two.Events.change)},sub:function(f,e){this._x=f.x-e.x;this._y=f.y-e.y;return this.trigger(Two.Events.change)},
subSelf:function(e){this._x-=e.x;this._y-=e.y;return this.trigger(Two.Events.change)},multiplySelf:function(e){this._x*=e.x;this._y*=e.y;return this.trigger(Two.Events.change)},multiplyScalar:function(e){this._x*=e;this._y*=e;return this.trigger(Two.Events.change)},divideScalar:function(e){return e?(this._x/=e,this._y/=e,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this._x*e.x+this._y*e.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){m=this._x-e.x;h=this._y-e.y;return m*m+h*h},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,h){D=(e.x-this._x)*h+this._x;q=(e.y-this._y)*h+this._y;return this.set(D,q)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},e={get:function(){return this._x},set:function(e){this._x=e;this.trigger(Two.Events.change,"x")}},n={get:function(){return this._y},set:function(e){this._y=e;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",e),Object.defineProperty(this,"y",n),_.extend(this,r),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var D=Two.Commands,q,m,h,p=Two.Anchor=function(h,e,n,f,m,q,u){Two.Vector.call(this,h,e);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(e){this._command=e;this._command!==D.curve||_.isObject(this.controls)||p.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=u||D.move;if(!u)return this;p.AppendCurveProperties(this);_.isNumber(n)&&(this.controls.left.x=
n);_.isNumber(f)&&(this.controls.left.y=f);_.isNumber(m)&&(this.controls.right.x=m);_.isNumber(q)&&(this.controls.right.y=q)};_.extend(p,{AppendCurveProperties:function(h){q=h._x||h.x;m=h._y||h.y;h.controls={left:new Two.Vector(q,m),right:new Two.Vector(q,m)}}});_.extend(p.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||p.AppendCurveProperties(this);_.each(this.controls,function(h){h.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(h){h.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){h=this.controls;return new Two.Anchor(this.x,this.y,h&&h.left.x,h&&h.left.y,h&&h.right.x,h&&h.right.y,this.command)}})})();(function(){_.range(6);var D=Math.cos,q=Math.sin,m=Math.tan,h,p,r,e,n,f,A,F,u,B,t,E,g,v,w,y,x,H,c,C,d,a,s,k,G,J,K,N,I,P,T,U,b,l,z,ea,W,X,ca,da,$,R,S,Y,Z,aa,ba,O,L,Q=[],fa=Two.Matrix=function(a,b,c,d,e,g){this.elements=new Two.Array(9);var k=a;_.isArray(k)||(k=_.toArray(arguments));this.identity().set(k)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(b,e,f){if(3>=e.length)return E,g,v,h=e[0]||0,p=e[1]||0,r=e[2]||0,n=b,E=n[0]*h+n[1]*p+n[2]*r,g=n[3]*h+n[4]*p+n[5]*r,v=n[6]*h+n[7]*p+n[8]*
r,{x:E,y:g,z:v};w=b[0];y=b[1];x=b[2];H=b[3];c=b[4];C=b[5];d=b[6];a=b[7];s=b[8];k=e[0];G=e[1];J=e[2];K=e[3];N=e[4];I=e[5];P=e[6];T=e[7];U=e[8];f=f||new Two.Array(9);f[0]=w*k+y*K+x*P;f[1]=w*G+y*N+x*T;f[2]=w*J+y*I+x*U;f[3]=H*k+c*K+C*P;f[4]=H*G+c*N+C*T;f[5]=H*J+c*I+C*U;f[6]=d*k+a*K+s*P;f[7]=d*G+a*N+s*T;f[8]=d*J+a*I+s*U;return f}});_.extend(fa.prototype,Backbone.Events,{set:function(b,a,c,d,e,g){t=b;z=arguments.length;_.isArray(t)||(t=_.toArray(arguments));_.each(t,function(b,a){_.isNumber(b)&&(this.elements[a]=
b)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(e,f,h,n,m,p,q,r,ma){t=arguments;z=t.length;if(1>=z)return _.each(this.elements,function(b,a){this.elements[a]=b*e},this),this.trigger(Two.Events.change);if(3>=z)return E,g,v,e=e||0,f=f||0,h=h||0,m=this.elements,E=m[0]*e+m[1]*f+m[2]*h,g=m[3]*e+m[4]*f+m[5]*h,v=m[6]*e+m[7]*f+m[8]*h,{x:E,y:g,z:v};b=this.elements;l=t;w=b[0];y=b[1];x=b[2];H=b[3];c=b[4];C=b[5];d=b[6];a=b[7];s=b[8];k=
l[0];G=l[1];J=l[2];K=l[3];N=l[4];I=l[5];P=l[6];T=l[7];U=l[8];this.elements[0]=w*k+y*K+x*P;this.elements[1]=w*G+y*N+x*T;this.elements[2]=w*J+y*I+x*U;this.elements[3]=H*k+c*K+C*P;this.elements[4]=H*G+c*N+C*T;this.elements[5]=H*J+c*I+C*U;this.elements[6]=d*k+a*K+s*P;this.elements[7]=d*G+a*N+s*T;this.elements[8]=d*J+a*I+s*U;return this.trigger(Two.Events.change)},inverse:function(b){h=this.elements;b=b||new Two.Matrix;W=h[0];X=h[1];ca=h[2];da=h[3];$=h[4];R=h[5];S=h[6];Y=h[7];Z=h[8];aa=Z*$-R*Y;ba=-Z*da+
R*S;O=Y*da-$*S;L=W*aa+X*ba+ca*O;if(!L)return null;L=1/L;b.elements[0]=aa*L;b.elements[1]=(-Z*X+ca*Y)*L;b.elements[2]=(R*X-ca*$)*L;b.elements[3]=ba*L;b.elements[4]=(Z*W-ca*S)*L;b.elements[5]=(-R*W+ca*da)*L;b.elements[6]=O*L;b.elements[7]=(-Y*W+X*S)*L;b.elements[8]=($*W-X*da)*L;return b},scale:function(b,a){z=arguments.length;1>=z&&(a=b);return this.multiply(b,0,0,0,a,0,0,0,1)},rotate:function(b){r=D(b);ea=q(b);return this.multiply(r,-ea,0,ea,r,0,0,0,1)},translate:function(b,a){return this.multiply(1,
0,b,0,1,a,0,0,1)},skewX:function(b){h=m(b);return this.multiply(1,h,0,0,1,0,0,0,1)},skewY:function(b){h=m(b);return this.multiply(1,0,0,h,1,0,0,0,1)},toString:function(b){this.toArray(b,Q);return Q.join(" ")},toArray:function(b,a){t=this.elements;B=!!a;h=parseFloat(t[0].toFixed(3));p=parseFloat(t[1].toFixed(3));r=parseFloat(t[2].toFixed(3));e=parseFloat(t[3].toFixed(3));n=parseFloat(t[4].toFixed(3));f=parseFloat(t[5].toFixed(3));if(b){A=parseFloat(t[6].toFixed(3));F=parseFloat(t[7].toFixed(3));u=
parseFloat(t[8].toFixed(3));if(B){a[0]=h;a[1]=e;a[2]=A;a[3]=p;a[4]=n;a[5]=F;a[6]=r;a[7]=f;a[8]=u;return}return[h,e,A,p,n,F,r,f,u]}if(B)a[0]=h,a[1]=e,a[2]=p,a[3]=n,a[4]=r,a[5]=f;else return[h,e,p,n,r,f]},clone:function(){h=this.elements[0];p=this.elements[1];r=this.elements[2];e=this.elements[3];n=this.elements[4];f=this.elements[5];A=this.elements[6];F=this.elements[7];u=this.elements[8];return new Two.Matrix(h,p,r,e,n,f,A,F,u)}})})();(function(){var D=Two.Utils.mod,q,m,h,p={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(e,n){h=e;m=document.createElementNS(this.ns,h);"svg"===h&&(n=_.defaults(n||{},{version:this.version}));_.isObject(n)&&p.setAttributes(m,n);return m},setAttribute:function(e,h){this.setAttribute(h,e)},setAttributes:function(e,h){_.each(h,p.setAttribute,e);return this},removeAttribute:function(e,h){this.removeAttribute(h)},removeAttributes:function(e,h){_.each(h,
p.removeAttribute,e);return this},toString:function(e,h){var f=e.length,m=f-1;return _.map(e,function(p,q){var r,t=h?D(q-1,f):Math.max(q-1,0),E=h?D(q+1,f):Math.min(q+1,m),t=e[t],E=e[E],g,v,w,y,x;x=p.x.toFixed(3);y=p.y.toFixed(3);switch(p._command){case Two.Commands.close:r=Two.Commands.close;break;case Two.Commands.curve:g=t.controls&&t.controls.right||t;r=p.controls&&p.controls.left||p;t=g.x.toFixed(3);g=g.y.toFixed(3);v=r.x.toFixed(3);w=r.y.toFixed(3);r=(0===q?Two.Commands.move:Two.Commands.curve)+
" "+t+" "+g+" "+v+" "+w+" "+x+" "+y;break;default:r=(0===q?Two.Commands.move:p._command)+" "+x+" "+y}q>=m&&h&&(p._command===Two.Commands.curve&&(y=p.controls&&p.controls.right||p,x=E.controls&&E.controls.left||E,t=y.x.toFixed(3),g=y.y.toFixed(3),v=x.x.toFixed(3),w=x.y.toFixed(3),x=E.x.toFixed(3),y=E.y.toFixed(3),r+=" C "+t+" "+g+" "+v+" "+w+" "+x+" "+y),r+=" Z");return r}).join(" ")},group:{appendChild:function(e){(m=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.appendChild(m)},
removeChild:function(e){(m=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.removeChild(m)},renderChild:function(e){p[e._renderer.type].render.call(e,this)},render:function(e){this.update();this._renderer.elem||(this._renderer.elem=p.createElement("g",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));q=this._matrix.manual||this._flagMatrix;var h={domElement:e,elem:this._renderer.elem};q&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");
_.each(this.children,p.group.renderChild,e);this._flagAdditions&&_.each(this.additions,p.group.appendChild,h);this._flagSubtractions&&_.each(this.subtractions,p.group.removeChild,h);return this.flagReset()}},polygon:{render:function(e){this.update();this._renderer.elem||(this._renderer.elem=p.createElement("path",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));m=this._renderer.elem;(q=this._matrix.manual||this._flagMatrix)&&m.setAttribute("transform","matrix("+this._matrix.toString()+
")");this._flagVertices&&(vertices=p.toString(this._vertices,this._closed),m.setAttribute("d",vertices));this._flagFill&&m.setAttribute("fill",this._fill);this._flagStroke&&m.setAttribute("stroke",this._stroke);this._flagLinewidth&&m.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(m.setAttribute("stroke-opacity",this._opacity),m.setAttribute("fill-opacity",this._opacity));this._flagVisible&&m.setAttribute("visibility",this._visible?"visible":"hidden");this._flagCap&&m.setAttribute("stroke-linecap",
this._cap);this._flagJoin&&m.setAttribute("stroke-linejoin",this._join);this._flagMiter&&m.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},r=Two[Two.Types.svg]=function(e){this.domElement=e.domElement||p.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(r,{Utils:p});_.extend(r.prototype,Backbone.Events,{setSize:function(e,h){this.width=e;this.height=h;p.setAttributes(this.domElement,{width:e,height:h});return this},render:function(){p.group.render.call(this.scene,
this.domElement);return this}})})();(function(){var D=Two.Utils.mod,q=Two.Utils.getRatio,m,h,p,r,e,n,f,A,F,u,B,t,E,g,v,w,y,x,H,c,C,d,a,s,k,G,J,K={group:{renderChild:function(a){K[a._renderer.type].render.call(a,this)},render:function(a){this.update();m=this._matrix.elements;a.save();a.transform(m[0],m[3],m[1],m[4],m[2],m[5]);_.each(this.children,K.group.renderChild,a);a.restore();return this.flagReset()}},polygon:{render:function(q){this.update();m=this._matrix.elements;h=this.stroke;p=this.linewidth;r=this.fill;e=this.opacity;n=this.visible;
f=this.cap;A=this.join;F=this.miter;u=this.closed;B=this._vertices;t=B.length;E=t-1;if(!n)return this;q.save();m&&q.transform(m[0],m[3],m[1],m[4],m[2],m[5]);r&&(q.fillStyle=r);h&&(q.strokeStyle=h);p&&(q.lineWidth=p);F&&(q.miterLimit=F);A&&(q.lineJoin=A);f&&(q.lineCap=f);_.isNumber(e)&&(q.globalAlpha=e);q.beginPath();_.each(B,function(e,f){G=e.x.toFixed(3);J=e.y.toFixed(3);switch(e._command){case Two.Commands.close:q.closePath();break;case Two.Commands.curve:v=u?D(f-1,t):Math.max(f-1,0);g=u?D(f+1,
t):Math.min(f+1,E);w=B[v];y=B[g];d=w.controls&&w.controls.right||w;a=e.controls&&e.controls.left||e;c=d.x.toFixed(3);C=d.y.toFixed(3);x=a.x.toFixed(3);H=a.y.toFixed(3);q.bezierCurveTo(c,C,x,H,G,J);f>=E&&u&&(s=e.controls&&e.controls.right||e,k=y.controls&&y.controls.left||y,c=s.x.toFixed(3),C=s.y.toFixed(3),x=k.x.toFixed(3),H=k.y.toFixed(3),G=y.x.toFixed(3),J=y.y.toFixed(3),q.bezierCurveTo(c,C,x,H,G,J));break;case Two.Commands.line:q.lineTo(G,J);break;case Two.Commands.move:q.moveTo(G,J)}});u&&q.closePath();
q.fill();q.stroke();q.restore();return this.flagReset()}}},N=Two[Two.Types.canvas]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.scene=new Two.Group;this.scene.parent=this};_.extend(N,{Utils:K});_.extend(N.prototype,Backbone.Events,{setSize:function(a,c,d){this.width=a;this.height=c;this.ratio=_.isUndefined(d)?q(this.ctx):d;this.domElement.width=a*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,
{width:a+"px",height:c+"px"});return this},render:function(){var a=1===this.ratio;a||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);K.group.render.call(this.scene,this.ctx);a||this.ctx.restore();return this}})})();(function(){var D=Two.Matrix.Multiply,q=Two.Utils.mod,m=[1,0,0,0,1,0,0,0,1],h=new Two.Array(9),p=Two.Utils.getRatio,r,e,n,f,A,F,u,B,t,E,g,v,w,y,x,H,c,C,d,a,s,k,G,J,K,N,I,P,T,U,b,l,z,ea,W,X,ca,da,$,R,S,Y,Z,aa,ba,O,L,Q,fa,ga,M,ia,ja,ka,ha,V={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){V[a._renderer.type].render.call(a,this.gl,this.program)},render:function(a,b){this.update();r=this.parent;e=r._matrix&&r._matrix.manual||r._flagMatrix;
n=this._matrix.manual||this._flagMatrix;if(e||n)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,h),D(h,r._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*r._renderer.scale,e&&(this._flagMatrix=!0);_.each(this.children,V.group.renderChild,{gl:a,program:b});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;r=this.parent;e=r._matrix.manual||r._flagMatrix;n=this._matrix.manual||this._flagMatrix;
f=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this.update();if(e||n)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,h),D(h,r._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*r._renderer.scale;f&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),
V.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),V.getTriangles(this._renderer.rect,this._renderer.triangles),V.updateBuffer(a,this,b),V.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,
!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(a,b,e){A=Infinity;F=-Infinity;u=Infinity;B=-Infinity;_.each(a,function(a,b){t=a.x;E=a.y;g;v;w;y;x=a.controls;u=Math.min(E,u);A=Math.min(t,A);F=Math.max(t,F);B=Math.max(E,B);a.controls&&(H=x.left,c=x.right,H&&c&&(g=H.x,v=H.y,w=c.x,y=c.y,g&&(v&&w&&y)&&(u=Math.min(v,y,u),A=Math.min(g,w,A),F=Math.max(g,w,F),B=Math.max(v,y,B))))});_.isNumber(b)&&(u-=b,A-=b,F+=b,B+=b);C=F-A;d=B-u;e.top=u;e.left=A;e.right=F;e.bottom=
B;e.width=C;e.height=d;e.centroid||(e.centroid={});e.centroid.x=-A;e.centroid.y=-u},getTriangles:function(a,b){u=a.top;A=a.left;F=a.right;B=a.bottom;b[0]=A;b[1]=u;b[2]=F;b[3]=u;b[4]=A;b[5]=B;b[6]=A;b[7]=B;b[8]=F;b[9]=u;b[10]=F;b[11]=B},updateCanvas:function(c){a=c._vertices;s=this.canvas;k=this.ctx;G=c._renderer.scale;J=c._stroke;K=c._linewidth*G;N=c._fill;I=c._opacity;P=c._cap;T=c._join;U=c._miter;b=c._closed;l=a.length;z=l-1;s.width=Math.max(Math.ceil(c._renderer.rect.width*G),1);s.height=Math.max(Math.ceil(c._renderer.rect.height*
G),1);ea=c._renderer.rect.centroid;W=ea.x*G;X=ea.y*G;k.clearRect(0,0,s.width,s.height);N&&(k.fillStyle=N);J&&(k.strokeStyle=J);K&&(k.lineWidth=K);U&&(k.miterLimit=U);T&&(k.lineJoin=T);P&&(k.lineCap=P);_.isNumber(I)&&(k.globalAlpha=I);k.beginPath();_.each(a,function(c,d){ca;da;g;w;$;R;S;Y;Z;aa;ba;H;t=(c.x*G+W).toFixed(3);E=(c.y*G+X).toFixed(3);switch(c._command){case Two.Commands.close:k.closePath();break;case Two.Commands.curve:da=b?q(d-1,l):Math.max(d-1,0);ca=b?q(d+1,l):Math.min(d+1,z);g=a[da];w=
a[ca];Z=g.controls&&g.controls.right||g;aa=c.controls&&c.controls.left||c;S=(Z.x*G+W).toFixed(3);Y=(Z.y*G+X).toFixed(3);$=(aa.x*G+W).toFixed(3);R=(aa.y*G+X).toFixed(3);k.bezierCurveTo(S,Y,$,R,t,E);d>=z&&b&&(ba=c.controls&&c.controls.right||c,H=w.controls&&w.controls.left||w,S=(ba.x*G+W).toFixed(3),Y=(ba.y*G+X).toFixed(3),$=(H.x*G+W).toFixed(3),R=(H.y*G+X).toFixed(3),t=(w.x*G+W).toFixed(3),E=(w.y*G+X).toFixed(3),k.bezierCurveTo(S,Y,$,R,t,E));break;case Two.Commands.line:k.lineTo(t,E);break;case Two.Commands.move:k.moveTo(t,
E)}});b&&k.closePath();k.fill();k.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||
0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=
a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){O=a.createProgram();_.each(b,function(b){a.attachShader(O,b)});a.linkProgram(O);L=a.getProgramParameter(O,a.LINK_STATUS);if(!L)throw ga=a.getProgramInfoLog(O),a.deleteProgram(O),new Two.Utils.Error("unable to link program: "+ga);return O}},shaders:{create:function(a,b,c){Q=a.createShader(a[c]);a.shaderSource(Q,
b);a.compileShader(Q);fa=a.getShaderParameter(Q,a.COMPILE_STATUS);if(!fa)throw ga=a.getShaderInfoLog(Q),a.deleteShader(Q),new Two.Utils.Error("unable to compile shader "+Q+": "+ga);return Q},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};V.ctx=V.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(m),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;M=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=V.shaders.create(M,V.shaders.vertex,V.shaders.types.vertex);ja=V.shaders.create(M,V.shaders.fragment,V.shaders.types.fragment);this.program=V.program.create(M,[ka,ja]);M.useProgram(this.program);this.program.position=M.getAttribLocation(this.program,
"a_position");this.program.matrix=M.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=M.getAttribLocation(this.program,"a_textureCoords");M.disable(M.DEPTH_TEST);M.enable(M.BLEND);M.blendEquationSeparate(M.FUNC_ADD,M.FUNC_ADD);M.blendFuncSeparate(M.SRC_ALPHA,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?p(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){M=this.ctx;this.overdraw||M.clear(M.COLOR_BUFFER_BIT|M.DEPTH_BUFFER_BIT);V.group.render.call(this.scene,M,this.program);this._flagMatrix=!1;return this}})})();(function(){new Two.Vector;var D,q=Two.Shape=function(m){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(q.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(q,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(m){Object.defineProperty(m,"rotation",{get:function(){return this._rotation},set:function(h){this._rotation=h;this._flagMatrix=!0}});Object.defineProperty(m,
"scale",{get:function(){return this._scale},set:function(h){this._scale=h;this._flagScale=this._flagMatrix=!0}})}});_.extend(q.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(m){m.add(this);return this},clone:function(){D=new q;D.translation.copy(this.translation);D.rotation=this.rotation;D.scale=this.scale;_.each(q.Properties,function(m){D[m]=this[m]},this);return D.update()},update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});q.MakeObservable(q.prototype)})();(function(){var D=Math.min,q=Math.max,m=Math.round,h=Two.Utils.getComputedMatrix,p,r,e,n,f,A,F,u,B,t,E,g,v,w,y,x,H,c,C,d,a,s,k,G,J,K,N,I,P,T,U,b=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!c;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4;this._vertices=[];this.vertices=a;this.automatic=!d};_.extend(b,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),
FlagVertices:function(){this._flagVertices=!0},MakeObservable:function(a){Two.Shape.MakeObservable(a);_.each(b.Properties.slice(0,8),function(b){var c="_"+b,d="_flag"+b.charAt(0).toUpperCase()+b.slice(1);Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a;this[d]=!0}})});Object.defineProperty(a,"closed",{get:function(){return this._closed},set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(a,"curved",{get:function(){return this._curved},
set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(b.prototype,"automatic",{get:function(){return this._automatic},set:function(a){a!==this._automatic&&(method=(this._automatic=!!a)?"ignore":"listen",_.each(this.vertices,function(a){a[method]()}))}});Object.defineProperty(a,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=D(q(a,0),1);this._flagVertices=!0}});Object.defineProperty(a,"ending",{get:function(){return this._ending},set:function(a){this._ending=
D(q(a,0),1);this._flagVertices=!0}});Object.defineProperty(a,"vertices",{get:function(){return this._collection},set:function(a){var c=_.bind(b.FlagVertices,this),d=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,c)},this);c()},this),e=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,c)},this);c()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(a.slice(0));this._collection.bind(Two.Events.insert,d);this._collection.bind(Two.Events.remove,
e);verticesChanged=!0;d(this._collection)}})}});_.extend(b.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;u=_.map(this.vertices,function(a){return a.clone()});B=new b(u,this.closed,this.curved,
!this.automatic);_.each(Two.Shape.Properties,function(a){B[a]=this[a]},this);B.translation.copy(this.translation);B.rotation=this.rotation;B.scale=this.scale;a.add(B);return B},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){t=this.getBoundingClientRect(!0);E={x:t.left,y:t.top};_.each(this.vertices,function(a){a.subSelf(E)});return this},center:function(){t=this.getBoundingClientRect(!0);t.centroid={x:t.left+t.width/
2,y:t.top+t.height/2};_.each(this.vertices,function(a){a.subSelf(t.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(b){this.update();g=this.linewidth/2;void 0;v=Infinity;w=-Infinity;y=Infinity;x=-Infinity;_.each(this._vertices,function(a){H=a.x;c=a.y;y=D(c,y);v=D(H,v);w=q(H,w);x=q(c,x)});y-=g;v-=g;w+=g;x+=g;k=b?this._matrix:h(this);C=k.multiply(v,y,1);d=k.multiply(w,y,1);a=k.multiply(w,x,1);s=k.multiply(v,x,
1);y=D(C.y,d.y,a.y,s.y);v=D(C.x,d.x,a.x,s.x);w=q(C.x,d.x,a.x,s.x);x=q(C.y,d.y,a.y,s.y);return{top:y,left:v,right:w,bottom:x,width:w-v,height:x-y}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this.vertices,this.closed),this;_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(a){n=this.vertices.length-1;d=this.vertices[n];f=this._closed||this.vertices[n].command===Two.Commands.close;u=[];_.each(this.vertices,
function(b,c){0>=c&&!f||(w=d.controls&&d.controls.right,v=b.controls&&b.controls.left,G=d.x,J=d.y,K=(w||d).x,N=(w||d).y,I=(v||b).x,P=(v||b).y,T=b.x,U=b.y,u.push(Two.Utils.subdivide(G,J,K,N,I,P,T,U,0,a)));d=b},this);this._curved=this._automatic=!1;this.vertices=_.flatten(u);this.plot();return this},update:function(){if(this._flagVertices)for(this._automatic&&this.plot(),p=this.vertices.length,n=p-1,r=m(this._beginning*n),e=m(this._ending*n),this._vertices.length=0,F=r;F<e+1;F++)A=this.vertices[F],
this._vertices.push(A);Two.Shape.prototype.update.call(this);return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});b.MakeObservable(b.prototype)})();(function(){var D=Math.min,q=Math.max,m,h,p,r,e,n,f,A,F,u,B,t,E,g,v,w,y,x,H,c,C,d=Two.Group=function(a){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(d,{MakeObservable:function(a){Two.Shape.MakeObservable(a);d.MakeGetterSetter(a,Two.Polygon.Properties)},MakeGetterSetter:function(a,c){_.isArray(c)||(c=[c]);_.each(c,function(c){m="_"+c;Object.defineProperty(a,c,{get:function(){return this[m]},set:function(a){this[m]=a;_.each(this.children,
function(d){d[c]=a})}})})}});_.extend(d.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;p=_.map(this.children,function(a){return a.clone()});r=new d;a.add(r);r.add(p);r.translation.copy(this.translation);r.rotation=this.rotation;r.scale=this.scale;return r},corner:function(){e=this.getBoundingClientRect(!0);
n={x:e.left,y:e.top};_.each(this.children,function(a){a.translation.subSelf(n)});return this},center:function(){e=this.getBoundingClientRect(!0);e.centroid={x:e.left+e.width/2,y:e.top+e.height/2};_.each(this.children,function(a){a.translation.subSelf(e.centroid)});return this},add:function(a){f=arguments.length;A=a;p=this.children;F=this.parent;u=this.additions;_.isArray(a)||(A=_.toArray(arguments));_.each(A,function(a){a&&(B=a.id,h=a.parent,_.isUndefined(p[B])&&(h&&(delete h.children[B],C=_.indexOf(h.additions,
B),0<=C&&h.additions.splice(C,1)),p[B]=a,a.parent=this,u.push(B),this._flagAdditions=!0))},this);return this},remove:function(a){f=arguments.length;A=a;p=this.children;F=this.parent;u=this.subtractions;if(0>=f&&F)return F.remove(this),this;_.isArray(a)||(A=_.toArray(arguments));_.each(A,function(a){B=a.id;grandchildren=a.children;h=a.parent;B in p&&(delete p[B],delete a.parent,C=_.indexOf(h.additions,B),0<=C&&h.additions.splice(C,1),u.push(B),this._flagSubtractions=!0)});return this},getBoundingClientRect:function(a){this.update();
t=Infinity;E=-Infinity;g=Infinity;v=-Infinity;_.each(this.children,function(a){e=a.getBoundingClientRect(!0);_.isNumber(e.top)&&(_.isNumber(e.left)&&_.isNumber(e.right)&&_.isNumber(e.bottom))&&(g=D(e.top,g),t=D(e.left,t),E=q(e.right,E),v=q(e.bottom,v))},this);w=a?this._matrix:Two.Utils.getComputedMatrix(this);y=w.multiply(t,g,1);x=w.multiply(E,g,1);H=w.multiply(E,v,1);c=w.multiply(t,v,1);g=D(y.y,x.y,H.y,c.y);t=D(y.x,x.x,H.x,c.x);E=q(y.x,x.x,H.x,c.x);v=q(y.y,x.y,H.y,c.y);return{top:g,left:t,right:E,
bottom:v,width:E-t,height:v-g}},noFill:function(){_.each(this.children,function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this},subdivide:function(){var a=arguments;_.each(this.children,function(c){c.subdivide.apply(c,a)});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);
return this}});d.MakeObservable(d.prototype)})();
