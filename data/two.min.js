(function(){var C=this,p=C._,n={},e=Array.prototype,m=Object.prototype,q=e.push,c=e.slice,l=e.concat,t=m.toString,y=m.hasOwnProperty,w=e.forEach,x=e.map,u=e.reduce,r=e.reduceRight,k=e.filter,D=e.every,E=e.some,v=e.indexOf,A=e.lastIndexOf,m=Array.isArray,z=Object.keys,F=Function.prototype.bind,a=function(f){if(f instanceof a)return f;if(!(this instanceof a))return new a(f);this._wrapped=f};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=a),exports._=
a):C._=a;a.VERSION="1.5.1";var b=a.each=a.forEach=function(f,g,s){if(null!=f)if(w&&f.forEach===w)f.forEach(g,s);else if(f.length===+f.length)for(var b=0,d=f.length;b<d&&g.call(s,f[b],b,f)!==n;b++);else for(b in f)if(a.has(f,b)&&g.call(s,f[b],b,f)===n)break};a.map=a.collect=function(a,g,s){var d=[];if(null==a)return d;if(x&&a.map===x)return a.map(g,s);b(a,function(a,f,b){d.push(g.call(s,a,f,b))});return d};a.reduce=a.foldl=a.inject=function(f,g,s,d){var h=2<arguments.length;null==f&&(f=[]);if(u&&f.reduce===
u)return d&&(g=a.bind(g,d)),h?f.reduce(g,s):f.reduce(g);b(f,function(a,f,b){h?s=g.call(d,s,a,f,b):(s=a,h=!0)});if(!h)throw new TypeError("Reduce of empty array with no initial value");return s};a.reduceRight=a.foldr=function(f,g,s,d){var h=2<arguments.length;null==f&&(f=[]);if(r&&f.reduceRight===r)return d&&(g=a.bind(g,d)),h?f.reduceRight(g,s):f.reduceRight(g);var k=f.length;if(k!==+k)var t=a.keys(f),k=t.length;b(f,function(a,b,e){b=t?t[--k]:--k;h?s=g.call(d,s,f[b],b,e):(s=f[b],h=!0)});if(!h)throw new TypeError("Reduce of empty array with no initial value");
return s};a.find=a.detect=function(a,g,s){var b;h(a,function(a,f,d){if(g.call(s,a,f,d))return b=a,!0});return b};a.filter=a.select=function(a,g,s){var d=[];if(null==a)return d;if(k&&a.filter===k)return a.filter(g,s);b(a,function(a,f,b){g.call(s,a,f,b)&&d.push(a)});return d};a.reject=function(f,g,s){return a.filter(f,function(a,f,b){return!g.call(s,a,f,b)},s)};a.every=a.all=function(f,g,s){g||(g=a.identity);var d=!0;if(null==f)return d;if(D&&f.every===D)return f.every(g,s);b(f,function(a,f,b){if(!(d=
d&&g.call(s,a,f,b)))return n});return!!d};var h=a.some=a.any=function(f,g,s){g||(g=a.identity);var d=!1;if(null==f)return d;if(E&&f.some===E)return f.some(g,s);b(f,function(a,f,b){if(d||(d=g.call(s,a,f,b)))return n});return!!d};a.contains=a.include=function(a,g){return null==a?!1:v&&a.indexOf===v?-1!=a.indexOf(g):h(a,function(a){return a===g})};a.invoke=function(f,g){var s=c.call(arguments,2),b=a.isFunction(g);return a.map(f,function(a){return(b?g:a[g]).apply(a,s)})};a.pluck=function(f,g){return a.map(f,
function(a){return a[g]})};a.where=function(f,g,s){return a.isEmpty(g)?s?void 0:[]:a[s?"find":"filter"](f,function(a){for(var f in g)if(g[f]!==a[f])return!1;return!0})};a.findWhere=function(f,g){return a.where(f,g,!0)};a.max=function(f,g,s){if(!g&&a.isArray(f)&&f[0]===+f[0]&&65535>f.length)return Math.max.apply(Math,f);if(!g&&a.isEmpty(f))return-Infinity;var d={computed:-Infinity,value:-Infinity};b(f,function(a,f,b){f=g?g.call(s,a,f,b):a;f>d.computed&&(d={value:a,computed:f})});return d.value};a.min=
function(f,g,s){if(!g&&a.isArray(f)&&f[0]===+f[0]&&65535>f.length)return Math.min.apply(Math,f);if(!g&&a.isEmpty(f))return Infinity;var d={computed:Infinity,value:Infinity};b(f,function(a,f,b){f=g?g.call(s,a,f,b):a;f<d.computed&&(d={value:a,computed:f})});return d.value};a.shuffle=function(f){var g,s=0,d=[];b(f,function(f){g=a.random(s++);d[s-1]=d[g];d[g]=f});return d};var d=function(f){return a.isFunction(f)?f:function(a){return a[f]}};a.sortBy=function(f,g,b){var h=d(g);return a.pluck(a.map(f,function(a,
f,g){return{value:a,index:f,criteria:h.call(b,a,f,g)}}).sort(function(a,f){var g=a.criteria,b=f.criteria;if(g!==b){if(g>b||void 0===g)return 1;if(g<b||void 0===b)return-1}return a.index<f.index?-1:1}),"value")};var H=function(f,g,s,h){var k={},t=d(null==g?a.identity:g);b(f,function(a,g){var b=t.call(s,a,g,f);h(k,b,a)});return k};a.groupBy=function(f,g,b){return H(f,g,b,function(f,g,b){(a.has(f,g)?f[g]:f[g]=[]).push(b)})};a.countBy=function(f,g,b){return H(f,g,b,function(f,g){a.has(f,g)||(f[g]=0);
f[g]++})};a.sortedIndex=function(f,g,b,h){b=null==b?a.identity:d(b);g=b.call(h,g);for(var k=0,t=f.length;k<t;){var e=k+t>>>1;b.call(h,f[e])<g?k=e+1:t=e}return k};a.toArray=function(f){return f?a.isArray(f)?c.call(f):f.length===+f.length?a.map(f,a.identity):a.values(f):[]};a.size=function(f){return null==f?0:f.length===+f.length?f.length:a.keys(f).length};a.first=a.head=a.take=function(a,g,b){return null==a?void 0:null==g||b?a[0]:c.call(a,0,g)};a.initial=function(a,g,b){return c.call(a,0,a.length-
(null==g||b?1:g))};a.last=function(a,g,b){return null==a?void 0:null==g||b?a[a.length-1]:c.call(a,Math.max(a.length-g,0))};a.rest=a.tail=a.drop=function(a,g,b){return c.call(a,null==g||b?1:g)};a.compact=function(f){return a.filter(f,a.identity)};var B=function(f,g,s){if(g&&a.every(f,a.isArray))return l.apply(s,f);b(f,function(f){a.isArray(f)||a.isArguments(f)?g?q.apply(s,f):B(f,g,s):s.push(f)});return s};a.flatten=function(a,g){return B(a,g,[])};a.without=function(f){return a.difference(f,c.call(arguments,
1))};a.uniq=a.unique=function(f,g,s,d){a.isFunction(g)&&(d=s,s=g,g=!1);s=s?a.map(f,s,d):f;var h=[],k=[];b(s,function(b,s){(g?s&&k[k.length-1]===b:a.contains(k,b))||(k.push(b),h.push(f[s]))});return h};a.union=function(){return a.uniq(a.flatten(arguments,!0))};a.intersection=function(f){var g=c.call(arguments,1);return a.filter(a.uniq(f),function(f){return a.every(g,function(g){return 0<=a.indexOf(g,f)})})};a.difference=function(f){var g=l.apply(e,c.call(arguments,1));return a.filter(f,function(f){return!a.contains(g,
f)})};a.zip=function(){for(var f=a.max(a.pluck(arguments,"length").concat(0)),g=Array(f),b=0;b<f;b++)g[b]=a.pluck(arguments,""+b);return g};a.object=function(a,g){if(null==a)return{};for(var b={},d=0,h=a.length;d<h;d++)g?b[a[d]]=g[d]:b[a[d][0]]=a[d][1];return b};a.indexOf=function(f,g,b){if(null==f)return-1;var d=0,h=f.length;if(b)if("number"==typeof b)d=0>b?Math.max(0,h+b):b;else return d=a.sortedIndex(f,g),f[d]===g?d:-1;if(v&&f.indexOf===v)return f.indexOf(g,b);for(;d<h;d++)if(f[d]===g)return d;
return-1};a.lastIndexOf=function(a,g,b){if(null==a)return-1;var d=null!=b;if(A&&a.lastIndexOf===A)return d?a.lastIndexOf(g,b):a.lastIndexOf(g);for(b=d?b:a.length;b--;)if(a[b]===g)return b;return-1};a.range=function(a,g,b){1>=arguments.length&&(g=a||0,a=0);b=arguments[2]||1;for(var d=Math.max(Math.ceil((g-a)/b),0),h=0,k=Array(d);h<d;)k[h++]=a,a+=b;return k};var G=function(){};a.bind=function(f,g){var b,d;if(F&&f.bind===F)return F.apply(f,c.call(arguments,1));if(!a.isFunction(f))throw new TypeError;
b=c.call(arguments,2);return d=function(){if(!(this instanceof d))return f.apply(g,b.concat(c.call(arguments)));G.prototype=f.prototype;var a=new G;G.prototype=null;var h=f.apply(a,b.concat(c.call(arguments)));return Object(h)===h?h:a}};a.partial=function(a){var g=c.call(arguments,1);return function(){return a.apply(this,g.concat(c.call(arguments)))}};a.bindAll=function(f){var g=c.call(arguments,1);if(0===g.length)throw Error("bindAll must be passed function names");b(g,function(g){f[g]=a.bind(f[g],
f)});return f};a.memoize=function(f,g){var b={};g||(g=a.identity);return function(){var d=g.apply(this,arguments);return a.has(b,d)?b[d]:b[d]=f.apply(this,arguments)}};a.delay=function(a,g){var b=c.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},g)};a.defer=function(f){return a.delay.apply(a,[f,1].concat(c.call(arguments,1)))};a.throttle=function(a,g,b){var d,h,k,t=null,e=0;b||(b={});var c=function(){e=!1===b.leading?0:new Date;t=null;k=a.apply(d,h)};return function(){var B=
new Date;e||!1!==b.leading||(e=B);var H=g-(B-e);d=this;h=arguments;0>=H?(clearTimeout(t),t=null,e=B,k=a.apply(d,h)):t||!1===b.trailing||(t=setTimeout(c,H));return k}};a.debounce=function(a,g,b){var d,h=null;return function(){var k=this,t=arguments,e=b&&!h;clearTimeout(h);h=setTimeout(function(){h=null;b||(d=a.apply(k,t))},g);e&&(d=a.apply(k,t));return d}};a.once=function(a){var g=!1,b;return function(){if(g)return b;g=!0;b=a.apply(this,arguments);a=null;return b}};a.wrap=function(a,b){return function(){var d=
[a];q.apply(d,arguments);return b.apply(this,d)}};a.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,b)];return b[0]}};a.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};a.keys=z||function(f){if(f!==Object(f))throw new TypeError("Invalid object");var b=[],d;for(d in f)a.has(f,d)&&b.push(d);return b};a.values=function(f){var b=[],d;for(d in f)a.has(f,d)&&b.push(f[d]);return b};a.pairs=function(f){var b=
[],d;for(d in f)a.has(f,d)&&b.push([d,f[d]]);return b};a.invert=function(f){var b={},d;for(d in f)a.has(f,d)&&(b[f[d]]=d);return b};a.functions=a.methods=function(f){var b=[],d;for(d in f)a.isFunction(f[d])&&b.push(d);return b.sort()};a.extend=function(a){b(c.call(arguments,1),function(b){if(b)for(var d in b)a[d]=b[d]});return a};a.pick=function(a){var g={},d=l.apply(e,c.call(arguments,1));b(d,function(b){b in a&&(g[b]=a[b])});return g};a.omit=function(f){var b={},d=l.apply(e,c.call(arguments,1)),
h;for(h in f)a.contains(d,h)||(b[h]=f[h]);return b};a.defaults=function(a){b(c.call(arguments,1),function(b){if(b)for(var d in b)void 0===a[d]&&(a[d]=b[d])});return a};a.clone=function(b){return a.isObject(b)?a.isArray(b)?b.slice():a.extend({},b):b};a.tap=function(a,b){b(a);return a};var I=function(b,g,d,h){if(b===g)return 0!==b||1/b==1/g;if(null==b||null==g)return b===g;b instanceof a&&(b=b._wrapped);g instanceof a&&(g=g._wrapped);var k=t.call(b);if(k!=t.call(g))return!1;switch(k){case "[object String]":return b==
String(g);case "[object Number]":return b!=+b?g!=+g:0==b?1/b==1/g:b==+g;case "[object Date]":case "[object Boolean]":return+b==+g;case "[object RegExp]":return b.source==g.source&&b.global==g.global&&b.multiline==g.multiline&&b.ignoreCase==g.ignoreCase}if("object"!=typeof b||"object"!=typeof g)return!1;for(var e=d.length;e--;)if(d[e]==b)return h[e]==g;var e=b.constructor,c=g.constructor;if(e!==c&&!(a.isFunction(e)&&e instanceof e&&a.isFunction(c)&&c instanceof c))return!1;d.push(b);h.push(g);e=0;
c=!0;if("[object Array]"==k){if(e=b.length,c=e==g.length)for(;e--&&(c=I(b[e],g[e],d,h)););}else{for(var B in b)if(a.has(b,B)&&(e++,!(c=a.has(g,B)&&I(b[B],g[B],d,h))))break;if(c){for(B in g)if(a.has(g,B)&&!e--)break;c=!e}}d.pop();h.pop();return c};a.isEqual=function(a,b){return I(a,b,[],[])};a.isEmpty=function(b){if(null==b)return!0;if(a.isArray(b)||a.isString(b))return 0===b.length;for(var d in b)if(a.has(b,d))return!1;return!0};a.isElement=function(a){return!(!a||1!==a.nodeType)};a.isArray=m||function(a){return"[object Array]"==
t.call(a)};a.isObject=function(a){return a===Object(a)};b("Arguments Function String Number Date RegExp".split(" "),function(b){a["is"+b]=function(a){return t.call(a)=="[object "+b+"]"}});a.isArguments(arguments)||(a.isArguments=function(b){return!(!b||!a.has(b,"callee"))});"function"!==typeof/./&&(a.isFunction=function(a){return"function"===typeof a});a.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};a.isNaN=function(b){return a.isNumber(b)&&b!=+b};a.isBoolean=function(a){return!0===
a||!1===a||"[object Boolean]"==t.call(a)};a.isNull=function(a){return null===a};a.isUndefined=function(a){return void 0===a};a.has=function(a,b){return y.call(a,b)};a.noConflict=function(){C._=p;return this};a.identity=function(a){return a};a.times=function(a,b,d){for(var h=Array(Math.max(0,a)),k=0;k<a;k++)h[k]=b.call(d,k);return h};a.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var J={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
J.unescape=a.invert(J.escape);var M={escape:RegExp("["+a.keys(J.escape).join("")+"]","g"),unescape:RegExp("("+a.keys(J.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(b){a[b]=function(a){return null==a?"":(""+a).replace(M[b],function(a){return J[b][a]})}});a.result=function(b,d){if(null!=b){var h=b[d];return a.isFunction(h)?h.call(b):h}};a.mixin=function(d){b(a.functions(d),function(b){var h=a[b]=d[b];a.prototype[b]=function(){var b=[this._wrapped];q.apply(b,arguments);b=h.apply(a,
b);return this._chain?a(b).chain():b}})};var Q=0;a.uniqueId=function(a){var b=++Q+"";return a?a+b:b};a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},S=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(b,d,h){var k;h=a.defaults({},h,a.templateSettings);var e=RegExp([(h.escape||N).source,(h.interpolate||N).source,(h.evaluate||N).source].join("|")+
"|$","g"),t=0,c="__p+='";b.replace(e,function(a,d,g,h,k){c+=b.slice(t,k).replace(S,function(a){return"\\"+R[a]});d&&(c+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'");g&&(c+="'+\n((__t=("+g+"))==null?'':__t)+\n'");h&&(c+="';\n"+h+"\n__p+='");t=k+a.length;return a});c+="';\n";h.variable||(c="with(obj||{}){\n"+c+"}\n");c="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+c+"return __p;\n";try{k=new Function(h.variable||"obj","_",c)}catch(B){throw B.source=
c,B;}if(d)return k(d,a);d=function(b){return k.call(this,b,a)};d.source="function("+(h.variable||"obj")+"){\n"+c+"}";return d};a.chain=function(b){return a(b).chain()};a.mixin(a);b("pop push reverse shift sort splice unshift".split(" "),function(b){var d=e[b];a.prototype[b]=function(){var h=this._wrapped;d.apply(h,arguments);"shift"!=b&&"splice"!=b||0!==h.length||delete h[0];return this._chain?a(h).chain():h}});b(["concat","join","slice"],function(b){var d=e[b];a.prototype[b]=function(){var b=d.apply(this._wrapped,
arguments);return this._chain?a(b).chain():b}});a.extend(a.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var C=[].slice,p=function(e,m,q){var c;e=-1;var l=m.length;switch(q.length){case 0:for(;++e<l;)(c=m[e]).callback.call(c.ctx);break;case 1:for(;++e<l;)(c=m[e]).callback.call(c.ctx,q[0]);break;case 2:for(;++e<l;)(c=m[e]).callback.call(c.ctx,q[0],q[1]);break;case 3:for(;++e<l;)(c=m[e]).callback.call(c.ctx,q[0],q[1],q[2]);break;default:for(;++e<l;)(c=m[e]).callback.apply(c.ctx,q)}},n=Backbone.Events={on:function(e,m,q){this._events||(this._events={});(this._events[e]||(this._events[e]=[])).push({callback:m,
context:q,ctx:q||this});return this},once:function(e,m,q){var c=this,l=_.once(function(){c.off(e,l);m.apply(this,arguments)});l._callback=m;this.on(e,l,q);return this},off:function(e,m,q){var c,l,t,n,p,x,u,r;if(!this._events)return this;if(!e&&!m&&!q)return this._events={},this;n=e?[e]:_.keys(this._events);p=0;for(x=n.length;p<x;p++)if(e=n[p],c=this._events[e]){t=[];if(m||q)for(u=0,r=c.length;u<r;u++)l=c[u],(m&&m!==(l.callback._callback||l.callback)||q&&q!==l.context)&&t.push(l);this._events[e]=t}return this},
trigger:function(e){if(!this._events)return this;var m=C.call(arguments,1),q=this._events[e],c=this._events.all;q&&p(this,q,m);c&&p(this,c,arguments);return this},listenTo:function(e,m,q){var c=this._listeners||(this._listeners={}),l=e._listenerId||(e._listenerId=_.uniqueId("l"));c[l]=e;e.on(m,q||this,this);return this},stopListening:function(e,m,q){var c=this._listeners;if(c){if(e)e.off(m,q,this),m||q||delete c[e._listenerId];else{for(var l in c)c[l].off(null,null,this);this._listeners={}}return this}}};
n.bind=n.on;n.unbind=n.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=n),exports.Backbone=exports.Backbone||Backbone)})();(function(){function C(e,c){var l=(new Date).getTime(),t=Math.max(0,16-(l-n)),m=p.setTimeout(function(){e(l+t)},t);n=l+t;return m}var p=this,n=0,e=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=C),exports.requestAnimationFrame=C;else{for(var m=0;m<e.length&&!p.requestAnimationFrame;++m)p.requestAnimationFrame=p[e[m]+"RequestAnimationFrame"],p.cancelAnimationFrame=p[e[m]+"CancelAnimationFrame"]||p[e[m]+"CancelRequestAnimationFrame"];
p.requestAnimationFrame||(p.requestAnimationFrame=C);p.cancelAnimationFrame||(p.cancelAnimationFrame=function(e){clearTimeout(e)})}})();(function(){function C(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a,this.ratio);this.trigger(k.Events.resize,b,a)}var p=this,n=p.Two||{},e=Math.sin,m=Math.cos,q=Math.atan2,c=Math.sqrt,l=Math.abs,t=Math.PI,y=2*t,w=t/2,x=Math.pow,u=0,r={hasEventListeners:_.isFunction(p.addEventListener),bind:function(a,b,h,d){this.hasEventListeners?a.addEventListener(b,h,!!d):a.attachEvent("on"+b,h);return this},unbind:function(a,b,h,d){this.hasEventListeners?
a.removeEventListeners(b,h,!!d):a.detachEvent("on"+b,h);return this}},k=p.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:k.Types.svg,autostart:!1});_.each(a,function(a,h){"fullscreen"!==h&&("width"!==h&&"height"!==h&&"autostart"!==h)&&(this[h]=a)},this);_.isElement(a.domElement)&&(this.type=k.Types[a.domElement.tagName.toLowerCase()]);this.renderer=new k[this.type](this);k.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(C,this),_.extend(document.body.style,
{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),r.bind(p,"resize",a),a()):_.isElement(a.domElement)||(this.renderer.setSize(a.width,a.height,this.ratio),this.width=a.width,this.height=a.height);this.scene=this.renderer.scene;k.Instances.push(this)};_.extend(k,{Array:p.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},
Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){p.Two=n;return this},uniqueId:function(){var a=u;u++;return a},Utils:{Curve:{CollinearityEpsilon:x(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},
devicePixelRatio:p.devicePixelRatio||1,getBackingStoreRatio:function(a){return a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1},getRatio:function(a){return k.Utils.devicePixelRatio/F(a)},setPlaying:function(a){this.playing=!!a;return this},getComputedMatrix:function(a,b){b=b&&b.identity()||new k.Matrix;for(var h=a;h&&h._matrix;){var d=h._matrix.elements;b.multiply(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],
d[8],d[9]);h=h.parent}return b},getComputedScale:function(a){for(var b=1;a&&a._scale;)b*=a._scale,a=a.parent;return b},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";_.each(a.attributes,function(a,d){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=
a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});return b},read:{svg:function(){return k.Utils.read.g.apply(this,arguments)},g:function(a){var b=new k.Group;this.add(b);_.each(a.childNodes,function(a){var d=a.nodeName;d&&(d=d.replace(/svg\:/ig,"").toLowerCase(),d in k.Utils.read&&(a=k.Utils.read[d].call(this,a),b.add(a)))},this);return k.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var h=[];a.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,
function(a,b,d){h.push(new k.Anchor(parseFloat(b),parseFloat(d)))});var d=(new k.Polygon(h,!b)).noStroke();return k.Utils.applySvgAttributes(a,d)},polyline:function(a){return k.Utils.read.polygon(a,!0)},path:function(a){var b,h,d,e=!1,t=!1,c=a.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),q=c.length-1,c=_.flatten(_.map(c,function(a,c){var l,m,n=a[0],y=n.toLowerCase();d=a.slice(1).trim();d=d.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,d){return parseFloat(b)*Math.pow(10,d)});d=d.split(/[\s,]+|(?=\s?[+\-])/);
e=n===y;var f,g,s,p;switch(y){case "z":c>=q?t=!0:(m=b.x,l=b.y,l=new k.Anchor(m,l,void 0,void 0,void 0,void 0,k.Commands.close));break;case "m":case "l":m=parseFloat(d[0]);l=parseFloat(d[1]);l=new k.Anchor(m,l,void 0,void 0,void 0,void 0,"m"===y?k.Commands.move:k.Commands.line);e&&l.addSelf(b);b=l;break;case "h":case "v":m="h"===y?"x":"y";n="x"===m?"y":"x";l=new k.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,k.Commands.line);l[m]=parseFloat(d[0]);l[n]=b[n];e&&(l[m]+=b[m]);b=l;break;case "s":case "c":l=
b.x;n=b.y;h||(h=(new k.Vector).copy(b));"c"===y?(f=parseFloat(d[0]),m=parseFloat(d[1]),y=parseFloat(d[2]),g=parseFloat(d[3]),s=parseFloat(d[4]),p=parseFloat(d[5])):(g=k.Utils.getReflection(b,h,e),f=g.x,m=g.y,y=parseFloat(d[0]),g=parseFloat(d[1]),s=parseFloat(d[2]),p=parseFloat(d[3]));e&&(f+=l,m+=n,y+=l,g+=n,s+=l,p+=n);_.isObject(b.controls)||k.Anchor.AppendCurveProperties(b);b.controls.right.set(f,m);b=l=new k.Anchor(s,p,y,g,void 0,void 0,k.Commands.curve);h=l.controls.left;break;case "t":case "q":l=
b.x;n=b.y;h||(h=(new k.Vector).copy(b));h.isZero()?(f=l,m=n):(f=h.x,n=h.y);"q"===y?(y=parseFloat(d[0]),g=parseFloat(d[1]),s=parseFloat(d[1]),p=parseFloat(d[2])):(g=k.Utils.getReflection(b,h,e),y=g.x,g=g.y,s=parseFloat(d[0]),p=parseFloat(d[1]));e&&(f+=l,m+=n,y+=l,g+=n,s+=l,p+=n);_.isObject(b.controls)||k.Anchor.AppendCurveProperties(b);b.controls.right.set(f,m);b=l=new k.Anchor(s,p,y,g,void 0,void 0,k.Commands.curve);h=l.controls.left;break;case "a":throw new k.Utils.Error("not yet able to interpret Elliptical Arcs.");
}return l}));if(!(1>=c.length))return c=_.compact(c),c=(new k.Polygon(c,t,void 0,!0)).noStroke(),k.Utils.applySvgAttributes(a,c)},circle:function(a){var b=parseFloat(a.getAttribute("cx")),h=parseFloat(a.getAttribute("cy")),d=parseFloat(a.getAttribute("r")),c=k.Resolution,t=_.map(_.range(c),function(a){var b=a/c*y;a=d*m(b);b=d*e(b);return new k.Anchor(a,b)},this),t=(new k.Polygon(t,!0,!0)).noStroke();t.translation.set(b,h);return k.Utils.applySvgAttributes(a,t)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),
h=parseFloat(a.getAttribute("cy")),d=parseFloat(a.getAttribute("rx")),c=parseFloat(a.getAttribute("ry")),t=k.Resolution,l=_.map(_.range(t),function(a){var b=a/t*y;a=d*m(b);b=c*e(b);return new k.Anchor(a,b)},this),l=(new k.Polygon(l,!0,!0)).noStroke();l.translation.set(b,h);return k.Utils.applySvgAttributes(a,l)},rect:function(a){var b=parseFloat(a.getAttribute("x")),h=parseFloat(a.getAttribute("y")),d=parseFloat(a.getAttribute("width")),e=parseFloat(a.getAttribute("height")),d=d/2,e=e/2,c=[new k.Anchor(d,
e),new k.Anchor(-d,e),new k.Anchor(-d,-e),new k.Anchor(d,-e)],c=(new k.Polygon(c,!0)).noStroke();c.translation.set(b+d,h+e);return k.Utils.applySvgAttributes(a,c)},line:function(a){var b=parseFloat(a.getAttribute("x1")),h=parseFloat(a.getAttribute("y1")),d=parseFloat(a.getAttribute("x2")),e=parseFloat(a.getAttribute("y2")),d=(d-b)/2,e=(e-h)/2,c=[new k.Anchor(-d,-e),new k.Anchor(d,e)],c=(new k.Polygon(c)).noFill();c.translation.set(b+d,h+e);return k.Utils.applySvgAttributes(a,c)}},subdivide:function(a,
b,h,d,e,c,m,n,p){var r=k.Utils.Curve.CollinearityEpsilon,u=k.Utils.Curve.RecursionLimit,v=k.Utils.Curve.CuspLimit,x=k.Utils.Curve.Tolerance,w;p=p||0;if(p>u)return[];var u=(a+h)/2,f=(b+d)/2,g=(h+e)/2,s=(d+c)/2,A=(e+m)/2,C=(c+n)/2,D=(u+g)/2,E=(f+s)/2,g=(g+A)/2,s=(s+C)/2,z=(D+g)/2,F=(E+s)/2;w=m-a;var L=n-b,O=l((h-m)*L-(d-n)*w),P=l((e-m)*L-(c-n)*w);if(0<p){if(O>r&&P>r&&(O+P)*(O+P)<=x.distance*(w*w+L*L)){if(x.angle<x.epsilon)return[new k.Anchor(z,F)];w=q(c-d,e-h);r=l(w-q(d-b,h-a));w=l(q(n-c,m-e)-w);r>=
t&&(r=y-r);w>=t&&(w=y-w);if(r+w<x.angle)return[new k.Anchor(z,F)];if(0!==v){if(r>v)return[new k.Anchor(h,d)];if(w>v)return[new k.Anchor(e,c)]}}}else if(O>r)if(O*O<=x.distance*(w*w+L*L)){if(x.angle<x.epsilon)return[new k.Anchor(z,F)];r=l(q(c-d,e-h)-q(d-b,h-a));r>=t&&(r=y-r);if(r<x.angle)return[new k.Anchor(h,d),new k.Anchor(e,c)];if(0!==v&&r>v)return[new k.Anchor(h,d)]}else if(P>r){if(P*P<=x.distance*(w*w+L*L)){if(x.angle<x.epsilon)return[new k.Anchor(z,F)];r=l(q(n-c,m-e)-q(c-d,e-h));r>=t&&(r=y-r);
if(r<x.angle)return[new k.Anchor(h,d),new k.Anchor(e,c)];if(0!==v&&r>v)return[new k.Anchor(e,c)]}}else if(w=z-(a+m)/2,L=F-(b+n)/2,w*w+L*L<=x.distance)return[new k.Anchor(z,F)];return k.Utils.subdivide(a,b,u,f,D,E,z,F,p+1).concat(k.Utils.subdivide(z,F,g,s,A,C,m,n,p+1))},getCurveFromPoints:function(a,b){for(var h=a.length,d=h-1,e=0;e<h;e++){var c=a[e];_.isObject(c.controls)||k.Anchor.AppendCurveProperties(c);var t=b?z(e-1,h):Math.max(e-1,0),l=b?z(e+1,h):Math.min(e+1,d);A(a[t],c,a[l]);c._command=0===
e?k.Commands.move:k.Commands.curve;c.controls.left.x=_.isNumber(c.controls.left.x)?c.controls.left.x:c.x;c.controls.left.y=_.isNumber(c.controls.left.y)?c.controls.left.y:c.y;c.controls.right.x=_.isNumber(c.controls.right.x)?c.controls.right.x:c.x;c.controls.right.y=_.isNumber(c.controls.right.y)?c.controls.right.y:c.y}},getControlPoints:function(a,b,h){var d=v(a,b),c=v(h,b);a=D(a,b);h=D(h,b);var l=(d+c)/2;b.u=_.isObject(b.controls.left)?b.controls.left:new k.Vector(b.x,b.y);b.v=_.isObject(b.controls.right)?
b.controls.right:new k.Vector(b.x,b.y);if(1E-4>a||1E-4>h)return b.controls.left.copy(b),b.controls.right.copy(b),b;a*=0.33;h*=0.33;l=c<d?l+w:l-w;b.controls.left.x=b.x+m(l)*a;b.controls.left.y=b.y+e(l)*a;l-=t;b.controls.right.x=b.x+m(l)*h;b.controls.right.y=b.y+e(l)*h;return b},getReflection:function(a,b,h){var d=a.distanceTo(b);if(1E-4>=d)return h?new k.Vector:a.clone();b=v(a,b);return new k.Vector(d*Math.cos(b)+(h?0:a.x),d*Math.sin(b)+(h?0:a.y))},angleBetween:function(a,b){return q(a.y-b.y,a.x-b.x)},
distanceBetweenSquared:function(a,b){var h=a.x-b.x,d=a.y-b.y;return h*h+d*d},distanceBetween:function(a,b){return c(E(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=a}}});k.Utils.Error.prototype=Error();k.Utils.Error.prototype.constructor=k.Utils.Error;k.Utils.Collection.prototype=
[];k.Utils.Collection.constructor=k.Utils.Collection;_.extend(k.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(k.Events.remove,[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(k.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);this.trigger(k.Events.insert,arguments);return a},unshift:function(){var a=Array.prototype.unshift.apply(this,
arguments);this.trigger(k.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,arguments),b;this.trigger(k.Events.remove,a);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(k.Events.insert,b));return a}});var D=k.Utils.distanceBetween,E=k.Utils.distanceBetweenSquared,v=k.Utils.angleBetween,A=k.Utils.getControlPoints,z=k.Utils.mod,F=k.Utils.getBackingStoreRatio;_.extend(k.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);
return this},play:function(){k.Utils.setPlaying.call(this,!0);return this.trigger(k.Events.play)},pause:function(){this.playing=!1;return this.trigger(k.Events.pause)},update:function(){var a=!!this._lastFrame,b=(p.performance&&p.performance.now?p.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,h=this.renderer;a===h.width&&b===h.height||h.setSize(a,b,this.ratio);this.trigger(k.Events.update,this.frameCount,
this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(k.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));return this},makeLine:function(a,b,h,d){h=(h-a)/2;d=(d-b)/2;var c=[new k.Anchor(-h,-d),new k.Anchor(h,d)],c=
(new k.Polygon(c)).noFill();c.translation.set(a+h,b+d);this.scene.add(c);return c},makeRectangle:function(a,b,h,d){h/=2;d/=2;d=[new k.Anchor(h,d),new k.Anchor(-h,d),new k.Anchor(-h,-d),new k.Anchor(h,-d)];d=new k.Polygon(d,!0);d.translation.set(a,b);this.scene.add(d);return d},makeCircle:function(a,b,h){return this.makeEllipse(a,b,h,h)},makeEllipse:function(a,b,h,d){var c=k.Resolution,t=_.map(_.range(c),function(a){var b=a/c*y;a=h*m(b);b=d*e(b);return new k.Anchor(a,b)},this),t=new k.Polygon(t,!0,
!0);t.translation.set(a,b);this.scene.add(t);return t},makeCurve:function(a){var b=arguments.length,h=a;if(!_.isArray(a))for(var h=[],d=0;d<b;d+=2){var c=arguments[d];if(!_.isNumber(c))break;h.push(new k.Anchor(c,arguments[d+1]))}var b=arguments[b-1],h=new k.Polygon(h,!(_.isBoolean(b)&&b),!0),b=h.getBoundingClientRect(),e=b.left+b.width/2,t=b.top+b.height/2;_.each(h.vertices,function(a){a.x-=e;a.y-=t});h.translation.set(e,t);this.scene.add(h);return h},makePolygon:function(a){var b=arguments.length,
h=a;if(!_.isArray(a))for(var h=[],d=0;d<b;d+=2){var c=arguments[d];if(!_.isNumber(c))break;h.push(new k.Anchor(c,arguments[d+1]))}b=arguments[b-1];h=new k.Polygon(h,!(_.isBoolean(b)&&b));b=h.getBoundingClientRect();h.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(h);return h},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new k.Group;this.scene.add(c);c.add(b);return c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in k.Utils.read))return null;
a=k.Utils.read[b].call(this,a);this.add(a);return a}});(function(){requestAnimationFrame(arguments.callee);_.each(k.Instances,function(a){a.playing&&a.update()})})();"function"===typeof define&&define.amd?define(function(){return k}):"undefined"!=typeof module&&module.exports&&(module.exports=k)})();(function(){var C,p,n,e,m=Two.Vector=function(c,e){this.x=c||0;this.y=e||0};_.extend(m.prototype,Backbone.Events,{set:function(c,e){this.x=c;this.y=e;return this},copy:function(c){this.x=c.x;this.y=c.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new m(this.x,this.y)},add:function(c,e){this.x=c.x+e.x;this.y=c.y+e.y;return this},addSelf:function(c){this.x+=c.x;this.y+=c.y;return this},sub:function(c,e){this.x=c.x-e.x;this.y=c.y-e.y;return this},subSelf:function(c){this.x-=
c.x;this.y-=c.y;return this},multiplySelf:function(c){this.x*=c.x;this.y*=c.y;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;return this},divideScalar:function(c){c?(this.x/=c,this.y/=c):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this.x*c.x+this.y*c.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(c){n=this.x-c.x;e=this.y-c.y;return n*n+e*e},setLength:function(c){return this.normalize().multiplyScalar(c)},equals:function(c){return 1E-4>this.distanceTo(c)},lerp:function(c,e){C=(c.x-this.x)*e+this.x;p=(c.y-this.y)*e+this.y;return this.set(C,p)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var q={set:function(c,
e){this._x=c;this._y=e;return this.trigger(Two.Events.change)},copy:function(c){this._x=c.x;this._y=c.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new m(this._x,this._y)},add:function(c,e){this._x=c.x+e.x;this._y=c.y+e.y;return this.trigger(Two.Events.change)},addSelf:function(c){this._x+=c.x;this._y+=c.y;return this.trigger(Two.Events.change)},sub:function(c,e){this._x=c.x-e.x;this._y=c.y-e.y;return this.trigger(Two.Events.change)},
subSelf:function(c){this._x-=c.x;this._y-=c.y;return this.trigger(Two.Events.change)},multiplySelf:function(c){this._x*=c.x;this._y*=c.y;return this.trigger(Two.Events.change)},multiplyScalar:function(c){this._x*=c;this._y*=c;return this.trigger(Two.Events.change)},divideScalar:function(c){return c?(this._x/=c,this._y/=c,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this._x*c.x+this._y*c.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(c){n=this._x-c.x;e=this._y-c.y;return n*n+e*e},setLength:function(c){return this.normalize().multiplyScalar(c)},equals:function(c){return 1E-4>this.distanceTo(c)},lerp:function(c,e){C=(c.x-this._x)*e+this._x;p=(c.y-this._y)*e+this._y;return this.set(C,p)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},c={get:function(){return this._x},set:function(c){this._x=c;this.trigger(Two.Events.change,"x")}},l={get:function(){return this._y},set:function(c){this._y=c;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",c),Object.defineProperty(this,"y",l),_.extend(this,q),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var C=Two.Commands,p,n,e,m=Two.Anchor=function(e,c,l,n,p,w,x){Two.Vector.call(this,e,c);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(c){this._command=c;this._command!==C.curve||_.isObject(this.controls)||m.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=x||C.move;if(!x)return this;m.AppendCurveProperties(this);_.isNumber(l)&&(this.controls.left.x=
l);_.isNumber(n)&&(this.controls.left.y=n);_.isNumber(p)&&(this.controls.right.x=p);_.isNumber(w)&&(this.controls.right.y=w)};_.extend(m,{AppendCurveProperties:function(e){p=e._x||e.x;n=e._y||e.y;e.controls={left:new Two.Vector(p,n),right:new Two.Vector(p,n)}}});_.extend(m.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||m.AppendCurveProperties(this);_.each(this.controls,function(e){e.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(e){e.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){e=this.controls;return new Two.Anchor(this.x,this.y,e&&e.left.x,e&&e.left.y,e&&e.right.x,e&&e.right.y,this.command)}})})();(function(){_.range(6);var C=Math.cos,p=Math.sin,n=Math.tan,e,m,q,c,l,t,y,w,x,u,r,k,D,E,v,A,z,F,a,b,h,d,H,B,G,I,J,M,Q,N,R,S,f,g,s,ea,V,W,$,ba,X,L,O,P,aa,ca,da,Y,T,Z=[],fa=Two.Matrix=function(a,b,c,d,g,f){this.elements=new Two.Array(9);var e=a;_.isArray(e)||(e=_.toArray(arguments));this.identity().set(e)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(c,g,f){if(3>=g.length)return k,D,E,e=g[0]||0,m=g[1]||0,q=g[2]||0,l=c,k=l[0]*e+l[1]*m+l[2]*q,D=l[3]*e+l[4]*m+l[5]*q,E=l[6]*e+l[7]*m+l[8]*
q,{x:k,y:D,z:E};v=c[0];A=c[1];z=c[2];F=c[3];a=c[4];b=c[5];h=c[6];d=c[7];H=c[8];B=g[0];G=g[1];I=g[2];J=g[3];M=g[4];Q=g[5];N=g[6];R=g[7];S=g[8];f=f||new Two.Array(9);f[0]=v*B+A*J+z*N;f[1]=v*G+A*M+z*R;f[2]=v*I+A*Q+z*S;f[3]=F*B+a*J+b*N;f[4]=F*G+a*M+b*R;f[5]=F*I+a*Q+b*S;f[6]=h*B+d*J+H*N;f[7]=h*G+d*M+H*R;f[8]=h*I+d*Q+H*S;return f}});_.extend(fa.prototype,Backbone.Events,{set:function(a,b,c,d,g,f){r=a;s=arguments.length;_.isArray(r)||(r=_.toArray(arguments));_.each(r,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(c,e,l,m,n,p,t,q,ma){r=arguments;s=r.length;if(1>=s)return _.each(this.elements,function(a,b){this.elements[b]=a*c},this),this.trigger(Two.Events.change);if(3>=s)return k,D,E,c=c||0,e=e||0,l=l||0,n=this.elements,k=n[0]*c+n[1]*e+n[2]*l,D=n[3]*c+n[4]*e+n[5]*l,E=n[6]*c+n[7]*e+n[8]*l,{x:k,y:D,z:E};f=this.elements;g=r;v=f[0];A=f[1];z=f[2];F=f[3];a=f[4];b=f[5];h=f[6];d=f[7];H=f[8];B=
g[0];G=g[1];I=g[2];J=g[3];M=g[4];Q=g[5];N=g[6];R=g[7];S=g[8];this.elements[0]=v*B+A*J+z*N;this.elements[1]=v*G+A*M+z*R;this.elements[2]=v*I+A*Q+z*S;this.elements[3]=F*B+a*J+b*N;this.elements[4]=F*G+a*M+b*R;this.elements[5]=F*I+a*Q+b*S;this.elements[6]=h*B+d*J+H*N;this.elements[7]=h*G+d*M+H*R;this.elements[8]=h*I+d*Q+H*S;return this.trigger(Two.Events.change)},inverse:function(a){e=this.elements;a=a||new Two.Matrix;V=e[0];W=e[1];$=e[2];ba=e[3];X=e[4];L=e[5];O=e[6];P=e[7];aa=e[8];ca=aa*X-L*P;da=-aa*
ba+L*O;Y=P*ba-X*O;T=V*ca+W*da+$*Y;if(!T)return null;T=1/T;a.elements[0]=ca*T;a.elements[1]=(-aa*W+$*P)*T;a.elements[2]=(L*W-$*X)*T;a.elements[3]=da*T;a.elements[4]=(aa*V-$*O)*T;a.elements[5]=(-L*V+$*ba)*T;a.elements[6]=Y*T;a.elements[7]=(-P*V+W*O)*T;a.elements[8]=(X*V-W*ba)*T;return a},scale:function(a,b){s=arguments.length;1>=s&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){q=C(a);ea=p(a);return this.multiply(q,-ea,0,ea,q,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){e=n(a);return this.multiply(1,e,0,0,1,0,0,0,1)},skewY:function(a){e=n(a);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(a){this.toArray(a,Z);return Z.join(" ")},toArray:function(a,b){r=this.elements;u=!!b;e=parseFloat(r[0].toFixed(3));m=parseFloat(r[1].toFixed(3));q=parseFloat(r[2].toFixed(3));c=parseFloat(r[3].toFixed(3));l=parseFloat(r[4].toFixed(3));t=parseFloat(r[5].toFixed(3));if(a){y=parseFloat(r[6].toFixed(3));w=parseFloat(r[7].toFixed(3));x=
parseFloat(r[8].toFixed(3));if(u){b[0]=e;b[1]=c;b[2]=y;b[3]=m;b[4]=l;b[5]=w;b[6]=q;b[7]=t;b[8]=x;return}return[e,c,y,m,l,w,q,t,x]}if(u)b[0]=e,b[1]=c,b[2]=m,b[3]=l,b[4]=q,b[5]=t;else return[e,c,m,l,q,t]},clone:function(){e=this.elements[0];m=this.elements[1];q=this.elements[2];c=this.elements[3];l=this.elements[4];t=this.elements[5];y=this.elements[6];w=this.elements[7];x=this.elements[8];return new Two.Matrix(e,m,q,c,l,t,y,w,x)}})})();(function(){var C=Two.Utils.mod,p,n,e,m={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(c,l){e=c;n=document.createElementNS(this.ns,e);"svg"===e&&(l=_.defaults(l||{},{version:this.version}));_.isObject(l)&&m.setAttributes(n,l);return n},setAttribute:function(c,e){this.setAttribute(e,c)},setAttributes:function(c,e){_.each(e,m.setAttribute,c);return this},removeAttribute:function(c,e){this.removeAttribute(e)},removeAttributes:function(c,e){_.each(e,
m.removeAttribute,c);return this},toString:function(c,e){var m=c.length,n=m-1;return _.map(c,function(p,q){var u,r=e?C(q-1,m):Math.max(q-1,0),k=e?C(q+1,m):Math.min(q+1,n),r=c[r],k=c[k],D,E,v,A,z;z=p.x.toFixed(3);A=p.y.toFixed(3);switch(p._command){case Two.Commands.close:u=Two.Commands.close;break;case Two.Commands.curve:D=r.controls&&r.controls.right||r;u=p.controls&&p.controls.left||p;r=D.x.toFixed(3);D=D.y.toFixed(3);E=u.x.toFixed(3);v=u.y.toFixed(3);u=(0===q?Two.Commands.move:Two.Commands.curve)+
" "+r+" "+D+" "+E+" "+v+" "+z+" "+A;break;default:u=(0===q?Two.Commands.move:p._command)+" "+z+" "+A}q>=n&&e&&(p._command===Two.Commands.curve&&(A=p.controls&&p.controls.right||p,z=k.controls&&k.controls.left||k,r=A.x.toFixed(3),D=A.y.toFixed(3),E=z.x.toFixed(3),v=z.y.toFixed(3),z=k.x.toFixed(3),A=k.y.toFixed(3),u+=" C "+r+" "+D+" "+E+" "+v+" "+z+" "+A),u+=" Z");return u}).join(" ")},group:{appendChild:function(c){(n=this.domElement.querySelector("#"+Two.Identifier+c))&&this.elem.appendChild(n)},
removeChild:function(c){(n=this.domElement.querySelector("#"+Two.Identifier+c))&&this.elem.removeChild(n)},renderChild:function(c){m[c._renderer.type].render.call(c,this)},render:function(c){this.update();this._renderer.elem||(this._renderer.elem=m.createElement("g",{id:Two.Identifier+this.id}),c.appendChild(this._renderer.elem));p=this._matrix.manual||this._flagMatrix;var e={domElement:c,elem:this._renderer.elem};p&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");
_.each(this.children,m.group.renderChild,c);this._flagAdditions&&_.each(this.additions,m.group.appendChild,e);this._flagSubtractions&&_.each(this.subtractions,m.group.removeChild,e);return this.flagReset()}},polygon:{render:function(c){this.update();this._renderer.elem||(this._renderer.elem=m.createElement("path",{id:Two.Identifier+this.id}),c.appendChild(this._renderer.elem));n=this._renderer.elem;(p=this._matrix.manual||this._flagMatrix)&&n.setAttribute("transform","matrix("+this._matrix.toString()+
")");this._flagVertices&&(vertices=m.toString(this._vertices,this._closed),n.setAttribute("d",vertices));this._flagFill&&n.setAttribute("fill",this._fill);this._flagStroke&&n.setAttribute("stroke",this._stroke);this._flagLinewidth&&n.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(n.setAttribute("stroke-opacity",this._opacity),n.setAttribute("fill-opacity",this._opacity));this._flagVisible&&n.setAttribute("visibility",this._visible?"visible":"hidden");this._flagCap&&n.setAttribute("stroke-linecap",
this._cap);this._flagJoin&&n.setAttribute("stroke-linejoin",this._join);this._flagMiter&&n.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},q=Two[Two.Types.svg]=function(c){this.domElement=c.domElement||m.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(q,{Utils:m});_.extend(q.prototype,Backbone.Events,{setSize:function(c,e){this.width=c;this.height=e;m.setAttributes(this.domElement,{width:c,height:e});return this},render:function(){m.group.render.call(this.scene,
this.domElement);return this}})})();(function(){var C=Two.Utils.mod,p=Two.Utils.getRatio,n,e,m,q,c,l,t,y,w,x,u,r,k,D,E,v,A,z,F,a,b,h,d,H,B,G,I,J={group:{renderChild:function(a){J[a._renderer.type].render.call(a,this)},render:function(a){this.update();n=this._matrix.elements;a.save();a.transform(n[0],n[3],n[1],n[4],n[2],n[5]);_.each(this.children,J.group.renderChild,a);a.restore();return this.flagReset()}},polygon:{render:function(p){this.update();n=this._matrix.elements;e=this.stroke;m=this.linewidth;q=this.fill;c=this.opacity;l=this.visible;
t=this.cap;y=this.join;w=this.miter;x=this.closed;u=this._vertices;r=u.length;k=r-1;if(!l)return this;p.save();n&&p.transform(n[0],n[3],n[1],n[4],n[2],n[5]);q&&(p.fillStyle=q);e&&(p.strokeStyle=e);m&&(p.lineWidth=m);w&&(p.miterLimit=w);y&&(p.lineJoin=y);t&&(p.lineCap=t);_.isNumber(c)&&(p.globalAlpha=c);p.beginPath();_.each(u,function(c,e){G=c.x.toFixed(3);I=c.y.toFixed(3);switch(c._command){case Two.Commands.close:p.closePath();break;case Two.Commands.curve:E=x?C(e-1,r):Math.max(e-1,0);D=x?C(e+1,
r):Math.min(e+1,k);v=u[E];A=u[D];h=v.controls&&v.controls.right||v;d=c.controls&&c.controls.left||c;a=h.x.toFixed(3);b=h.y.toFixed(3);z=d.x.toFixed(3);F=d.y.toFixed(3);p.bezierCurveTo(a,b,z,F,G,I);e>=k&&x&&(H=c.controls&&c.controls.right||c,B=A.controls&&A.controls.left||A,a=H.x.toFixed(3),b=H.y.toFixed(3),z=B.x.toFixed(3),F=B.y.toFixed(3),G=A.x.toFixed(3),I=A.y.toFixed(3),p.bezierCurveTo(a,b,z,F,G,I));break;case Two.Commands.line:p.lineTo(G,I);break;case Two.Commands.move:p.moveTo(G,I)}});x&&p.closePath();
p.fill();p.stroke();p.restore();return this.flagReset()}}},M=Two[Two.Types.canvas]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.scene=new Two.Group;this.scene.parent=this};_.extend(M,{Utils:J});_.extend(M.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?p(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=b*this.ratio;_.extend(this.domElement.style,
{width:a+"px",height:b+"px"});return this},render:function(){var a=1===this.ratio;a||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);J.group.render.call(this.scene,this.ctx);a||this.ctx.restore();return this}})})();(function(){var C=Two.Matrix.Multiply,p=Two.Utils.mod,n=[1,0,0,0,1,0,0,0,1],e=new Two.Array(9),m=Two.Utils.getRatio,q,c,l,t,y,w,x,u,r,k,D,E,v,A,z,F,a,b,h,d,H,B,G,I,J,M,Q,N,R,S,f,g,s,ea,V,W,$,ba,X,L,O,P,aa,ca,da,Y,T,Z,fa,ga,K,ia,ja,ka,ha,U={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){U[a._renderer.type].render.call(a,this.gl,this.program)},render:function(a,b){this.update();q=this.parent;c=q._matrix&&q._matrix.manual||q._flagMatrix;
l=this._matrix.manual||this._flagMatrix;if(c||l)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,e),C(e,q._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*q._renderer.scale,c&&(this._flagMatrix=!0);_.each(this.children,U.group.renderChild,{gl:a,program:b});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;q=this.parent;c=q._matrix.manual||q._flagMatrix;l=this._matrix.manual||this._flagMatrix;
t=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this.update();if(c||l)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,e),C(e,q._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*q._renderer.scale;t&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),
U.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),U.getTriangles(this._renderer.rect,this._renderer.triangles),U.updateBuffer(a,this,b),U.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,
!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(c,d,g){y=Infinity;w=-Infinity;x=Infinity;u=-Infinity;_.each(c,function(b,c){r=b.x;k=b.y;D;E;v;A;z=b.controls;x=Math.min(k,x);y=Math.min(r,y);w=Math.max(r,w);u=Math.max(k,u);b.controls&&(F=z.left,a=z.right,F&&a&&(D=F.x,E=F.y,v=a.x,A=a.y,D&&(E&&v&&A)&&(x=Math.min(E,A,x),y=Math.min(D,v,y),w=Math.max(D,v,w),u=Math.max(E,A,u))))});_.isNumber(d)&&(x-=d,y-=d,w+=d,u+=d);b=w-y;h=u-x;g.top=x;g.left=y;g.right=w;g.bottom=
u;g.width=b;g.height=h;g.centroid||(g.centroid={});g.centroid.x=-y;g.centroid.y=-x},getTriangles:function(a,b){x=a.top;y=a.left;w=a.right;u=a.bottom;b[0]=y;b[1]=x;b[2]=w;b[3]=x;b[4]=y;b[5]=u;b[6]=y;b[7]=u;b[8]=w;b[9]=x;b[10]=w;b[11]=u},updateCanvas:function(a){d=a._vertices;H=this.canvas;B=this.ctx;G=a._renderer.scale;I=a._stroke;J=a._linewidth*G;M=a._fill;Q=a._opacity;N=a._cap;R=a._join;S=a._miter;f=a._closed;g=d.length;s=g-1;H.width=Math.max(Math.ceil(a._renderer.rect.width*G),1);H.height=Math.max(Math.ceil(a._renderer.rect.height*
G),1);ea=a._renderer.rect.centroid;V=ea.x*G;W=ea.y*G;B.clearRect(0,0,H.width,H.height);M&&(B.fillStyle=M);I&&(B.strokeStyle=I);J&&(B.lineWidth=J);S&&(B.miterLimit=S);R&&(B.lineJoin=R);N&&(B.lineCap=N);_.isNumber(Q)&&(B.globalAlpha=Q);B.beginPath();_.each(d,function(a,b){$;ba;D;v;X;L;O;P;aa;ca;da;F;r=(a.x*G+V).toFixed(3);k=(a.y*G+W).toFixed(3);switch(a._command){case Two.Commands.close:B.closePath();break;case Two.Commands.curve:ba=f?p(b-1,g):Math.max(b-1,0);$=f?p(b+1,g):Math.min(b+1,s);D=d[ba];v=
d[$];aa=D.controls&&D.controls.right||D;ca=a.controls&&a.controls.left||a;O=(aa.x*G+V).toFixed(3);P=(aa.y*G+W).toFixed(3);X=(ca.x*G+V).toFixed(3);L=(ca.y*G+W).toFixed(3);B.bezierCurveTo(O,P,X,L,r,k);b>=s&&f&&(da=a.controls&&a.controls.right||a,F=v.controls&&v.controls.left||v,O=(da.x*G+V).toFixed(3),P=(da.y*G+W).toFixed(3),X=(F.x*G+V).toFixed(3),L=(F.y*G+W).toFixed(3),r=(v.x*G+V).toFixed(3),k=(v.y*G+W).toFixed(3),B.bezierCurveTo(O,P,X,L,r,k));break;case Two.Commands.line:B.lineTo(r,k);break;case Two.Commands.move:B.moveTo(r,
k)}});f&&B.closePath();B.fill();B.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||
0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=
a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){Y=a.createProgram();_.each(b,function(b){a.attachShader(Y,b)});a.linkProgram(Y);T=a.getProgramParameter(Y,a.LINK_STATUS);if(!T)throw ga=a.getProgramInfoLog(Y),a.deleteProgram(Y),new Two.Utils.Error("unable to link program: "+ga);return Y}},shaders:{create:function(a,b,c){Z=a.createShader(a[c]);a.shaderSource(Z,
b);a.compileShader(Z);fa=a.getShaderParameter(Z,a.COMPILE_STATUS);if(!fa)throw ga=a.getShaderInfoLog(Z),a.deleteShader(Z),new Two.Utils.Error("unable to compile shader "+Z+": "+ga);return Z},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};U.ctx=U.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(n),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;K=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=U.shaders.create(K,U.shaders.vertex,U.shaders.types.vertex);ja=U.shaders.create(K,U.shaders.fragment,U.shaders.types.fragment);this.program=U.program.create(K,[ka,ja]);K.useProgram(this.program);this.program.position=K.getAttribLocation(this.program,
"a_position");this.program.matrix=K.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=K.getAttribLocation(this.program,"a_textureCoords");K.disable(K.DEPTH_TEST);K.enable(K.BLEND);K.blendEquationSeparate(K.FUNC_ADD,K.FUNC_ADD);K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?m(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){K=this.ctx;this.overdraw||K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT);U.group.render.call(this.scene,K,this.program);this._flagMatrix=!1;return this}})})();(function(){new Two.Vector;var C,p=Two.Shape=function(n){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(p.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(p,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeGetterSetter:function(n){Object.defineProperty(n,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e;this._flagMatrix=!0}});Object.defineProperty(n,
"scale",{get:function(){return this._scale},set:function(e){this._scale=e;this._flagScale=this._flagMatrix=!0}})}});_.extend(p.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(n){n.add(this);return this},clone:function(){C=new p;C.translation.copy(this.translation);C.rotation=this.rotation;C.scale=this.scale;_.each(p.Properties,function(n){C[n]=this[n]},this);return C.update()},update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});p.MakeGetterSetter(p.prototype)})();(function(){var C=Math.min,p=Math.max,n=Math.round,e=Two.Utils.getComputedMatrix,m,q,c,l,t,y,w,x,u,r,k,D,E,v,A,z,F,a,b,h,d,H,B,G,I,J,M,Q,N,R,S,f=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!c;this._automatic=!d;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4;this._vertices=[];this.vertices=a};_.extend(f,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),
FlagVertices:function(){this._flagVertices=!0}});_.extend(f.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;x=_.map(this.vertices,function(a){return a.clone()});u=new f(x,this.closed,this.curved,
!this.automatic);_.each(Two.Shape.Properties,function(a){u[a]=this[a]},this);u.translation.copy(this.translation);u.rotation=this.rotation;u.scale=this.scale;a.add(u);return u},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){r=this.getBoundingClientRect(!0);k={x:r.left,y:r.top};_.each(this.vertices,function(a){a.subSelf(k)});return this},center:function(){r=this.getBoundingClientRect(!0);r.centroid={x:r.left+r.width/
2,y:r.top+r.height/2};_.each(this.vertices,function(a){a.subSelf(r.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(c){D=this.linewidth/2;void 0;E=Infinity;v=-Infinity;A=Infinity;z=-Infinity;_.each(this.vertices,function(b){F=b.x;a=b.y;A=C(a,A);E=C(F,E);v=p(F,v);z=p(a,z)});A-=D;E-=D;v+=D;z+=D;B=c?this._matrix:e(this);b=B.multiply(E,A,1);h=B.multiply(v,A,1);d=B.multiply(v,z,1);H=B.multiply(E,z,1);A=C(b.y,h.y,
d.y,H.y);E=C(b.x,h.x,d.x,H.x);v=p(b.x,h.x,d.x,H.x);z=p(b.y,h.y,d.y,H.y);return{top:A,left:E,right:v,bottom:z,width:v-E,height:z-A}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this.vertices,this.closed),this;_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(){l=this.vertices.length-1;t=this._closed||this.vertices[l].command===Two.Commands.close;x=[];_.each(this.vertices,function(a,b){0>=b&&!t||(v=h.controls&&
h.controls.right,E=a.controls&&a.controls.left,G=h.x,I=h.y,J=(v||h).x,M=(v||h).y,Q=(E||a).x,N=(E||a).y,R=a.x,S=a.y,x.push(Two.Utils.subdivide(G,I,J,M,Q,N,R,S)));h=a},this);this._curved=this._automatic=!1;this.vertices=_.flatten(x);this.plot();return this},update:function(){if(this._flagVertices)for(this._automatic&&this.plot(),m=this.vertices.length,l=m-1,q=n(this._beginning*l),c=n(this._ending*l),this._vertices.length=0,w=q;w<c+1;w++)y=this.vertices[w],this._vertices.push(y);Two.Shape.prototype.update.call(this);
return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});_.each(f.Properties.slice(0,8),function(a){var b="_"+a,c="_flag"+a.charAt(0).toUpperCase()+a.slice(1);Object.defineProperty(f.prototype,a,{get:function(){return this[b]},set:function(a){this[b]=a;this[c]=!0}})});Object.defineProperty(f.prototype,"closed",{get:function(){return this._closed},
set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(f.prototype,"curved",{get:function(){return this._curved},set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(f.prototype,"automatic",{get:function(){return this._automatic},set:function(a){a!==this._automatic&&(this._automatic=!!a)}});Object.defineProperty(f.prototype,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=C(p(a,0),1);this._flagVertices=!0}});Object.defineProperty(f.prototype,
"ending",{get:function(){return this._ending},set:function(a){this._ending=C(p(a,0),1);this._flagVertices=!0}});Object.defineProperty(f.prototype,"vertices",{get:function(){return this._collection},set:function(a){var b=_.bind(f.FlagVertices,this),c=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,b)},this);b()},this),d=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,b)},this);b()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(a.slice(0));
this._collection.bind(Two.Events.insert,c);this._collection.bind(Two.Events.remove,d);verticesChanged=!0;c(this._collection)}});Two.Shape.MakeGetterSetter(f.prototype)})();(function(){var C=Math.min,p=Math.max,n,e,m,q,c,l,t,y,w,x,u,r,k,D,E,v,A,z,F,a,b,h=Two.Group=function(a){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(h,{MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]);_.each(b,function(b){n="_"+b;Object.defineProperty(a,b,{get:function(){return this[n]},set:function(a){this[n]=a;_.each(this.children,function(c){c[b]=a})}})})}});_.extend(h.prototype,Two.Shape.prototype,{_flagAdditions:!1,
_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;m=_.map(this.children,function(a){return a.clone()});q=new h;a.add(q);q.add(m);q.translation.copy(this.translation);q.rotation=this.rotation;q.scale=this.scale;return q},corner:function(){c=this.getBoundingClientRect(!0);l={x:c.left,y:c.top};_.each(this.children,function(a){a.translation.subSelf(l)});
return this},center:function(){c=this.getBoundingClientRect(!0);c.centroid={x:c.left+c.width/2,y:c.top+c.height/2};_.each(this.children,function(a){a.translation.subSelf(c.centroid)});return this},add:function(a){t=arguments.length;y=a;m=this.children;w=this.parent;x=this.additions;_.isArray(a)||(y=_.toArray(arguments));_.each(y,function(a){a&&(u=a.id,e=a.parent,_.isUndefined(m[u])&&(e&&(delete e.children[u],b=_.indexOf(e.additions,u),0<=b&&e.additions.splice(b,1)),m[u]=a,a.parent=this,x.push(u),
this._flagAdditions=!0))},this);return this},remove:function(a){t=arguments.length;y=a;m=this.children;w=this.parent;x=this.subtractions;if(0>=t&&w)return w.remove(this),this;_.isArray(a)||(y=_.toArray(arguments));_.each(y,function(a){u=a.id;grandchildren=a.children;e=a.parent;u in m&&(delete m[u],delete a.parent,b=_.indexOf(e.additions,u),0<=b&&e.additions.splice(b,1),x.push(u),this._flagSubtractions=!0)});return this},getBoundingClientRect:function(b){r=Infinity;k=-Infinity;D=Infinity;E=-Infinity;
_.each(this.children,function(a){c=a.getBoundingClientRect(!0);_.isNumber(c.top)&&(_.isNumber(c.left)&&_.isNumber(c.right)&&_.isNumber(c.bottom))&&(D=C(c.top,D),r=C(c.left,r),k=p(c.right,k),E=p(c.bottom,E))},this);v=b?this._matrix:Two.Utils.getComputedMatrix(this);A=v.multiply(r,D,1);z=v.multiply(k,D,1);F=v.multiply(k,E,1);a=v.multiply(r,E,1);D=C(A.y,z.y,F.y,a.y);r=C(A.x,z.x,F.x,a.x);k=p(A.x,z.x,F.x,a.x);E=p(A.y,z.y,F.y,a.y);return{top:D,left:r,right:k,bottom:E,width:k-r,height:E-D}},noFill:function(){_.each(this.children,
function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this},subdivide:function(){_.each(this.children,function(a){a.subdivide()});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);return this}});h.MakeGetterSetter(h.prototype,Two.Polygon.Properties);Two.Shape.MakeGetterSetter(h.prototype)})();
