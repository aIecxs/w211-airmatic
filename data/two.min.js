(function(){var C=this,n=C._,q={},c=Array.prototype,l=Object.prototype,r=c.push,h=c.slice,p=c.concat,m=l.toString,x=l.hasOwnProperty,y=c.forEach,w=c.map,u=c.reduce,s=c.reduceRight,k=c.filter,D=c.every,E=c.some,v=c.indexOf,A=c.lastIndexOf,l=Array.isArray,z=Object.keys,F=Function.prototype.bind,a=function(e){if(e instanceof a)return e;if(!(this instanceof a))return new a(e);this._wrapped=e};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=a),exports._=
a):C._=a;a.VERSION="1.5.1";var b=a.each=a.forEach=function(e,f,t){if(null!=e)if(y&&e.forEach===y)e.forEach(f,t);else if(e.length===+e.length)for(var b=0,d=e.length;b<d&&f.call(t,e[b],b,e)!==q;b++);else for(b in e)if(a.has(e,b)&&f.call(t,e[b],b,e)===q)break};a.map=a.collect=function(a,f,t){var d=[];if(null==a)return d;if(w&&a.map===w)return a.map(f,t);b(a,function(a,e,b){d.push(f.call(t,a,e,b))});return d};a.reduce=a.foldl=a.inject=function(e,f,t,d){var g=2<arguments.length;null==e&&(e=[]);if(u&&e.reduce===
u)return d&&(f=a.bind(f,d)),g?e.reduce(f,t):e.reduce(f);b(e,function(a,e,b){g?t=f.call(d,t,a,e,b):(t=a,g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");return t};a.reduceRight=a.foldr=function(e,f,t,d){var g=2<arguments.length;null==e&&(e=[]);if(s&&e.reduceRight===s)return d&&(f=a.bind(f,d)),g?e.reduceRight(f,t):e.reduceRight(f);var k=e.length;if(k!==+k)var m=a.keys(e),k=m.length;b(e,function(a,b,c){b=m?m[--k]:--k;g?t=f.call(d,t,e[b],b,c):(t=e[b],g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");
return t};a.find=a.detect=function(a,f,t){var b;g(a,function(a,e,d){if(f.call(t,a,e,d))return b=a,!0});return b};a.filter=a.select=function(a,f,t){var d=[];if(null==a)return d;if(k&&a.filter===k)return a.filter(f,t);b(a,function(a,e,b){f.call(t,a,e,b)&&d.push(a)});return d};a.reject=function(e,f,t){return a.filter(e,function(a,e,b){return!f.call(t,a,e,b)},t)};a.every=a.all=function(e,f,t){f||(f=a.identity);var d=!0;if(null==e)return d;if(D&&e.every===D)return e.every(f,t);b(e,function(a,e,b){if(!(d=
d&&f.call(t,a,e,b)))return q});return!!d};var g=a.some=a.any=function(e,f,t){f||(f=a.identity);var d=!1;if(null==e)return d;if(E&&e.some===E)return e.some(f,t);b(e,function(a,e,b){if(d||(d=f.call(t,a,e,b)))return q});return!!d};a.contains=a.include=function(a,f){return null==a?!1:v&&a.indexOf===v?-1!=a.indexOf(f):g(a,function(a){return a===f})};a.invoke=function(e,f){var t=h.call(arguments,2),b=a.isFunction(f);return a.map(e,function(a){return(b?f:a[f]).apply(a,t)})};a.pluck=function(e,f){return a.map(e,
function(a){return a[f]})};a.where=function(e,f,t){return a.isEmpty(f)?t?void 0:[]:a[t?"find":"filter"](e,function(a){for(var e in f)if(f[e]!==a[e])return!1;return!0})};a.findWhere=function(e,f){return a.where(e,f,!0)};a.max=function(e,f,t){if(!f&&a.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!f&&a.isEmpty(e))return-Infinity;var d={computed:-Infinity,value:-Infinity};b(e,function(a,e,b){e=f?f.call(t,a,e,b):a;e>d.computed&&(d={value:a,computed:e})});return d.value};a.min=
function(e,f,t){if(!f&&a.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!f&&a.isEmpty(e))return Infinity;var d={computed:Infinity,value:Infinity};b(e,function(a,e,b){e=f?f.call(t,a,e,b):a;e<d.computed&&(d={value:a,computed:e})});return d.value};a.shuffle=function(e){var f,t=0,d=[];b(e,function(e){f=a.random(t++);d[t-1]=d[f];d[f]=e});return d};var d=function(e){return a.isFunction(e)?e:function(a){return a[e]}};a.sortBy=function(e,f,b){var g=d(f);return a.pluck(a.map(e,function(a,
e,f){return{value:a,index:e,criteria:g.call(b,a,e,f)}}).sort(function(a,e){var f=a.criteria,b=e.criteria;if(f!==b){if(f>b||void 0===f)return 1;if(f<b||void 0===b)return-1}return a.index<e.index?-1:1}),"value")};var H=function(e,f,t,g){var k={},m=d(null==f?a.identity:f);b(e,function(a,f){var b=m.call(t,a,f,e);g(k,b,a)});return k};a.groupBy=function(e,f,b){return H(e,f,b,function(e,f,b){(a.has(e,f)?e[f]:e[f]=[]).push(b)})};a.countBy=function(e,f,b){return H(e,f,b,function(e,f){a.has(e,f)||(e[f]=0);
e[f]++})};a.sortedIndex=function(e,f,b,g){b=null==b?a.identity:d(b);f=b.call(g,f);for(var k=0,m=e.length;k<m;){var c=k+m>>>1;b.call(g,e[c])<f?k=c+1:m=c}return k};a.toArray=function(e){return e?a.isArray(e)?h.call(e):e.length===+e.length?a.map(e,a.identity):a.values(e):[]};a.size=function(e){return null==e?0:e.length===+e.length?e.length:a.keys(e).length};a.first=a.head=a.take=function(a,f,b){return null==a?void 0:null==f||b?a[0]:h.call(a,0,f)};a.initial=function(a,f,b){return h.call(a,0,a.length-
(null==f||b?1:f))};a.last=function(a,f,b){return null==a?void 0:null==f||b?a[a.length-1]:h.call(a,Math.max(a.length-f,0))};a.rest=a.tail=a.drop=function(a,f,b){return h.call(a,null==f||b?1:f)};a.compact=function(e){return a.filter(e,a.identity)};var B=function(e,f,t){if(f&&a.every(e,a.isArray))return p.apply(t,e);b(e,function(e){a.isArray(e)||a.isArguments(e)?f?r.apply(t,e):B(e,f,t):t.push(e)});return t};a.flatten=function(a,f){return B(a,f,[])};a.without=function(e){return a.difference(e,h.call(arguments,
1))};a.uniq=a.unique=function(e,f,t,d){a.isFunction(f)&&(d=t,t=f,f=!1);t=t?a.map(e,t,d):e;var g=[],k=[];b(t,function(b,t){(f?t&&k[k.length-1]===b:a.contains(k,b))||(k.push(b),g.push(e[t]))});return g};a.union=function(){return a.uniq(a.flatten(arguments,!0))};a.intersection=function(e){var f=h.call(arguments,1);return a.filter(a.uniq(e),function(e){return a.every(f,function(f){return 0<=a.indexOf(f,e)})})};a.difference=function(e){var f=p.apply(c,h.call(arguments,1));return a.filter(e,function(e){return!a.contains(f,
e)})};a.zip=function(){for(var e=a.max(a.pluck(arguments,"length").concat(0)),f=Array(e),b=0;b<e;b++)f[b]=a.pluck(arguments,""+b);return f};a.object=function(a,f){if(null==a)return{};for(var b={},d=0,g=a.length;d<g;d++)f?b[a[d]]=f[d]:b[a[d][0]]=a[d][1];return b};a.indexOf=function(e,f,b){if(null==e)return-1;var d=0,g=e.length;if(b)if("number"==typeof b)d=0>b?Math.max(0,g+b):b;else return d=a.sortedIndex(e,f),e[d]===f?d:-1;if(v&&e.indexOf===v)return e.indexOf(f,b);for(;d<g;d++)if(e[d]===f)return d;
return-1};a.lastIndexOf=function(a,f,b){if(null==a)return-1;var d=null!=b;if(A&&a.lastIndexOf===A)return d?a.lastIndexOf(f,b):a.lastIndexOf(f);for(b=d?b:a.length;b--;)if(a[b]===f)return b;return-1};a.range=function(a,f,b){1>=arguments.length&&(f=a||0,a=0);b=arguments[2]||1;for(var d=Math.max(Math.ceil((f-a)/b),0),g=0,k=Array(d);g<d;)k[g++]=a,a+=b;return k};var G=function(){};a.bind=function(e,f){var b,d;if(F&&e.bind===F)return F.apply(e,h.call(arguments,1));if(!a.isFunction(e))throw new TypeError;
b=h.call(arguments,2);return d=function(){if(!(this instanceof d))return e.apply(f,b.concat(h.call(arguments)));G.prototype=e.prototype;var a=new G;G.prototype=null;var g=e.apply(a,b.concat(h.call(arguments)));return Object(g)===g?g:a}};a.partial=function(a){var f=h.call(arguments,1);return function(){return a.apply(this,f.concat(h.call(arguments)))}};a.bindAll=function(e){var f=h.call(arguments,1);if(0===f.length)throw Error("bindAll must be passed function names");b(f,function(f){e[f]=a.bind(e[f],
e)});return e};a.memoize=function(e,f){var b={};f||(f=a.identity);return function(){var d=f.apply(this,arguments);return a.has(b,d)?b[d]:b[d]=e.apply(this,arguments)}};a.delay=function(a,f){var b=h.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},f)};a.defer=function(e){return a.delay.apply(a,[e,1].concat(h.call(arguments,1)))};a.throttle=function(a,f,b){var d,g,k,m=null,c=0;b||(b={});var h=function(){c=!1===b.leading?0:new Date;m=null;k=a.apply(d,g)};return function(){var B=
new Date;c||!1!==b.leading||(c=B);var H=f-(B-c);d=this;g=arguments;0>=H?(clearTimeout(m),m=null,c=B,k=a.apply(d,g)):m||!1===b.trailing||(m=setTimeout(h,H));return k}};a.debounce=function(a,f,b){var d,g=null;return function(){var k=this,m=arguments,c=b&&!g;clearTimeout(g);g=setTimeout(function(){g=null;b||(d=a.apply(k,m))},f);c&&(d=a.apply(k,m));return d}};a.once=function(a){var f=!1,b;return function(){if(f)return b;f=!0;b=a.apply(this,arguments);a=null;return b}};a.wrap=function(a,b){return function(){var d=
[a];r.apply(d,arguments);return b.apply(this,d)}};a.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,b)];return b[0]}};a.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};a.keys=z||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var b=[],d;for(d in e)a.has(e,d)&&b.push(d);return b};a.values=function(e){var b=[],d;for(d in e)a.has(e,d)&&b.push(e[d]);return b};a.pairs=function(e){var b=
[],d;for(d in e)a.has(e,d)&&b.push([d,e[d]]);return b};a.invert=function(e){var b={},d;for(d in e)a.has(e,d)&&(b[e[d]]=d);return b};a.functions=a.methods=function(e){var b=[],d;for(d in e)a.isFunction(e[d])&&b.push(d);return b.sort()};a.extend=function(a){b(h.call(arguments,1),function(b){if(b)for(var d in b)a[d]=b[d]});return a};a.pick=function(a){var f={},d=p.apply(c,h.call(arguments,1));b(d,function(b){b in a&&(f[b]=a[b])});return f};a.omit=function(e){var b={},d=p.apply(c,h.call(arguments,1)),
g;for(g in e)a.contains(d,g)||(b[g]=e[g]);return b};a.defaults=function(a){b(h.call(arguments,1),function(b){if(b)for(var d in b)void 0===a[d]&&(a[d]=b[d])});return a};a.clone=function(b){return a.isObject(b)?a.isArray(b)?b.slice():a.extend({},b):b};a.tap=function(a,b){b(a);return a};var I=function(b,f,d,g){if(b===f)return 0!==b||1/b==1/f;if(null==b||null==f)return b===f;b instanceof a&&(b=b._wrapped);f instanceof a&&(f=f._wrapped);var k=m.call(b);if(k!=m.call(f))return!1;switch(k){case "[object String]":return b==
String(f);case "[object Number]":return b!=+b?f!=+f:0==b?1/b==1/f:b==+f;case "[object Date]":case "[object Boolean]":return+b==+f;case "[object RegExp]":return b.source==f.source&&b.global==f.global&&b.multiline==f.multiline&&b.ignoreCase==f.ignoreCase}if("object"!=typeof b||"object"!=typeof f)return!1;for(var c=d.length;c--;)if(d[c]==b)return g[c]==f;var c=b.constructor,h=f.constructor;if(c!==h&&!(a.isFunction(c)&&c instanceof c&&a.isFunction(h)&&h instanceof h))return!1;d.push(b);g.push(f);c=0;
h=!0;if("[object Array]"==k){if(c=b.length,h=c==f.length)for(;c--&&(h=I(b[c],f[c],d,g)););}else{for(var B in b)if(a.has(b,B)&&(c++,!(h=a.has(f,B)&&I(b[B],f[B],d,g))))break;if(h){for(B in f)if(a.has(f,B)&&!c--)break;h=!c}}d.pop();g.pop();return h};a.isEqual=function(a,b){return I(a,b,[],[])};a.isEmpty=function(b){if(null==b)return!0;if(a.isArray(b)||a.isString(b))return 0===b.length;for(var d in b)if(a.has(b,d))return!1;return!0};a.isElement=function(a){return!(!a||1!==a.nodeType)};a.isArray=l||function(a){return"[object Array]"==
m.call(a)};a.isObject=function(a){return a===Object(a)};b("Arguments Function String Number Date RegExp".split(" "),function(b){a["is"+b]=function(a){return m.call(a)=="[object "+b+"]"}});a.isArguments(arguments)||(a.isArguments=function(b){return!(!b||!a.has(b,"callee"))});"function"!==typeof/./&&(a.isFunction=function(a){return"function"===typeof a});a.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};a.isNaN=function(b){return a.isNumber(b)&&b!=+b};a.isBoolean=function(a){return!0===
a||!1===a||"[object Boolean]"==m.call(a)};a.isNull=function(a){return null===a};a.isUndefined=function(a){return void 0===a};a.has=function(a,b){return x.call(a,b)};a.noConflict=function(){C._=n;return this};a.identity=function(a){return a};a.times=function(a,b,d){for(var g=Array(Math.max(0,a)),k=0;k<a;k++)g[k]=b.call(d,k);return g};a.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var J={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
J.unescape=a.invert(J.escape);var M={escape:RegExp("["+a.keys(J.escape).join("")+"]","g"),unescape:RegExp("("+a.keys(J.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(b){a[b]=function(a){return null==a?"":(""+a).replace(M[b],function(a){return J[b][a]})}});a.result=function(b,d){if(null!=b){var g=b[d];return a.isFunction(g)?g.call(b):g}};a.mixin=function(d){b(a.functions(d),function(b){var g=a[b]=d[b];a.prototype[b]=function(){var b=[this._wrapped];r.apply(b,arguments);b=g.apply(a,
b);return this._chain?a(b).chain():b}})};var Q=0;a.uniqueId=function(a){var b=++Q+"";return a?a+b:b};a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},S=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(b,d,g){var k;g=a.defaults({},g,a.templateSettings);var c=RegExp([(g.escape||N).source,(g.interpolate||N).source,(g.evaluate||N).source].join("|")+
"|$","g"),m=0,h="__p+='";b.replace(c,function(a,d,f,g,k){h+=b.slice(m,k).replace(S,function(a){return"\\"+R[a]});d&&(h+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'");f&&(h+="'+\n((__t=("+f+"))==null?'':__t)+\n'");g&&(h+="';\n"+g+"\n__p+='");m=k+a.length;return a});h+="';\n";g.variable||(h="with(obj||{}){\n"+h+"}\n");h="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+h+"return __p;\n";try{k=new Function(g.variable||"obj","_",h)}catch(B){throw B.source=
h,B;}if(d)return k(d,a);d=function(b){return k.call(this,b,a)};d.source="function("+(g.variable||"obj")+"){\n"+h+"}";return d};a.chain=function(b){return a(b).chain()};a.mixin(a);b("pop push reverse shift sort splice unshift".split(" "),function(b){var d=c[b];a.prototype[b]=function(){var g=this._wrapped;d.apply(g,arguments);"shift"!=b&&"splice"!=b||0!==g.length||delete g[0];return this._chain?a(g).chain():g}});b(["concat","join","slice"],function(b){var d=c[b];a.prototype[b]=function(){var b=d.apply(this._wrapped,
arguments);return this._chain?a(b).chain():b}});a.extend(a.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var C=[].slice,n=function(c,l,r){var h;c=-1;var p=l.length;switch(r.length){case 0:for(;++c<p;)(h=l[c]).callback.call(h.ctx);break;case 1:for(;++c<p;)(h=l[c]).callback.call(h.ctx,r[0]);break;case 2:for(;++c<p;)(h=l[c]).callback.call(h.ctx,r[0],r[1]);break;case 3:for(;++c<p;)(h=l[c]).callback.call(h.ctx,r[0],r[1],r[2]);break;default:for(;++c<p;)(h=l[c]).callback.apply(h.ctx,r)}},q=Backbone.Events={on:function(c,l,r){this._events||(this._events={});(this._events[c]||(this._events[c]=[])).push({callback:l,
context:r,ctx:r||this});return this},once:function(c,l,r){var h=this,p=_.once(function(){h.off(c,p);l.apply(this,arguments)});p._callback=l;this.on(c,p,r);return this},off:function(c,l,r){var h,p,m,q,n,w,u,s;if(!this._events)return this;if(!c&&!l&&!r)return this._events={},this;q=c?[c]:_.keys(this._events);n=0;for(w=q.length;n<w;n++)if(c=q[n],h=this._events[c]){m=[];if(l||r)for(u=0,s=h.length;u<s;u++)p=h[u],(l&&l!==(p.callback._callback||p.callback)||r&&r!==p.context)&&m.push(p);this._events[c]=m}return this},
trigger:function(c){if(!this._events)return this;var l=C.call(arguments,1),r=this._events[c],h=this._events.all;r&&n(this,r,l);h&&n(this,h,arguments);return this},listenTo:function(c,l,r){var h=this._listeners||(this._listeners={}),p=c._listenerId||(c._listenerId=_.uniqueId("l"));h[p]=c;c.on(l,r||this,this);return this},stopListening:function(c,l,r){var h=this._listeners;if(h){if(c)c.off(l,r,this),l||r||delete h[c._listenerId];else{for(var p in h)h[p].off(null,null,this);this._listeners={}}return this}}};
q.bind=q.on;q.unbind=q.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=q),exports.Backbone=exports.Backbone||Backbone)})();(function(){function C(c,h){var p=(new Date).getTime(),m=Math.max(0,16-(p-q)),l=n.setTimeout(function(){c(p+m)},m);q=p+m;return l}var n=this,q=0,c=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=C),exports.requestAnimationFrame=C;else{for(var l=0;l<c.length&&!n.requestAnimationFrame;++l)n.requestAnimationFrame=n[c[l]+"RequestAnimationFrame"],n.cancelAnimationFrame=n[c[l]+"CancelAnimationFrame"]||n[c[l]+"CancelRequestAnimationFrame"];
n.requestAnimationFrame||(n.requestAnimationFrame=C);n.cancelAnimationFrame||(n.cancelAnimationFrame=function(c){clearTimeout(c)})}})();(function(){function C(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a,this.ratio);this.trigger(k.Events.resize,b,a)}var n=this,q=n.Two||{},c=Math.sin,l=Math.cos,r=Math.atan2,h=Math.sqrt,p=Math.abs,m=Math.PI,x=2*m,y=m/2,w=Math.pow,u=0,s={hasEventListeners:_.isFunction(n.addEventListener),bind:function(a,b,g,d){this.hasEventListeners?a.addEventListener(b,g,!!d):a.attachEvent("on"+b,g);return this},unbind:function(a,b,g,d){this.hasEventListeners?
a.removeEventListeners(b,g,!!d):a.detachEvent("on"+b,g);return this}},k=n.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:k.Types.svg,autostart:!1});_.each(a,function(a,g){"fullscreen"!==g&&("width"!==g&&"height"!==g&&"autostart"!==g)&&(this[g]=a)},this);_.isElement(a.domElement)&&(this.type=k.Types[a.domElement.tagName.toLowerCase()]);this.renderer=new k[this.type](this);k.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(C,this),_.extend(document.body.style,
{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),s.bind(n,"resize",a),a()):_.isElement(a.domElement)||(this.renderer.setSize(a.width,a.height,this.ratio),this.width=a.width,this.height=a.height);this.scene=this.renderer.scene;k.Instances.push(this)};_.extend(k,{Array:n.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},
Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){n.Two=q;return this},uniqueId:function(){var a=u;u++;return a},Utils:{Curve:{CollinearityEpsilon:w(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},
devicePixelRatio:n.devicePixelRatio||1,getBackingStoreRatio:function(a){return a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1},getRatio:function(a){return k.Utils.devicePixelRatio/F(a)},setPlaying:function(a){this.playing=!!a;return this},getComputedMatrix:function(a,b){b=b&&b.identity()||new k.Matrix;for(var g=a;g&&g._matrix;){var d=g._matrix.elements;b.multiply(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],
d[8],d[9]);g=g.parent}return b},getComputedScale:function(a){for(var b=1;a&&a._scale;)b*=a._scale,a=a.parent;return b},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";_.each(a.attributes,function(a,d){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=
a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});return b},read:{svg:function(){return k.Utils.read.g.apply(this,arguments)},g:function(a){var b=new k.Group;this.add(b);_.each(a.childNodes,function(a){var d=a.nodeName;d&&(d=d.replace(/svg\:/ig,"").toLowerCase(),d in k.Utils.read&&(a=k.Utils.read[d].call(this,a),b.add(a)))},this);return k.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var g=[];a.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,
function(a,b,d){g.push(new k.Anchor(parseFloat(b),parseFloat(d)))});var d=(new k.Polygon(g,!b)).noStroke();return k.Utils.applySvgAttributes(a,d)},polyline:function(a){return k.Utils.read.polygon(a,!0)},path:function(a){var b,g,d,c=!1,h=!1,m=a.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),r=m.length-1,m=_.flatten(_.map(m,function(a,m){var l,p,q=a[0],x=q.toLowerCase();d=a.slice(1).trim();d=d.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,d){return parseFloat(b)*Math.pow(10,d)});d=d.split(/[\s,]+|(?=\s?[+\-])/);
c=q===x;var e,f,t,n;switch(x){case "z":m>=r?h=!0:(p=b.x,l=b.y,l=new k.Anchor(p,l,void 0,void 0,void 0,void 0,k.Commands.close));break;case "m":case "l":p=parseFloat(d[0]);l=parseFloat(d[1]);l=new k.Anchor(p,l,void 0,void 0,void 0,void 0,"m"===x?k.Commands.move:k.Commands.line);c&&l.addSelf(b);b=l;break;case "h":case "v":p="h"===x?"x":"y";q="x"===p?"y":"x";l=new k.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,k.Commands.line);l[p]=parseFloat(d[0]);l[q]=b[q];c&&(l[p]+=b[p]);b=l;break;case "s":case "c":l=
b.x;q=b.y;g||(g=(new k.Vector).copy(b));"c"===x?(e=parseFloat(d[0]),p=parseFloat(d[1]),x=parseFloat(d[2]),f=parseFloat(d[3]),t=parseFloat(d[4]),n=parseFloat(d[5])):(f=k.Utils.getReflection(b,g,c),e=f.x,p=f.y,x=parseFloat(d[0]),f=parseFloat(d[1]),t=parseFloat(d[2]),n=parseFloat(d[3]));c&&(e+=l,p+=q,x+=l,f+=q,t+=l,n+=q);_.isObject(b.controls)||k.Anchor.AppendCurveProperties(b);b.controls.right.set(e,p);b=l=new k.Anchor(t,n,x,f,void 0,void 0,k.Commands.curve);g=l.controls.left;break;case "t":case "q":l=
b.x;q=b.y;g||(g=(new k.Vector).copy(b));g.isZero()?(e=l,p=q):(e=g.x,q=g.y);"q"===x?(x=parseFloat(d[0]),f=parseFloat(d[1]),t=parseFloat(d[1]),n=parseFloat(d[2])):(f=k.Utils.getReflection(b,g,c),x=f.x,f=f.y,t=parseFloat(d[0]),n=parseFloat(d[1]));c&&(e+=l,p+=q,x+=l,f+=q,t+=l,n+=q);_.isObject(b.controls)||k.Anchor.AppendCurveProperties(b);b.controls.right.set(e,p);b=l=new k.Anchor(t,n,x,f,void 0,void 0,k.Commands.curve);g=l.controls.left;break;case "a":throw new k.Utils.Error("not yet able to interpret Elliptical Arcs.");
}return l}));if(!(1>=m.length))return m=_.compact(m),m=(new k.Polygon(m,h,void 0,!0)).noStroke(),k.Utils.applySvgAttributes(a,m)},circle:function(a){var b=parseFloat(a.getAttribute("cx")),g=parseFloat(a.getAttribute("cy")),d=parseFloat(a.getAttribute("r")),m=k.Resolution,h=_.map(_.range(m),function(a){var b=a/m*x;a=d*l(b);b=d*c(b);return new k.Anchor(a,b)},this),h=(new k.Polygon(h,!0,!0)).noStroke();h.translation.set(b,g);return k.Utils.applySvgAttributes(a,h)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),
g=parseFloat(a.getAttribute("cy")),d=parseFloat(a.getAttribute("rx")),m=parseFloat(a.getAttribute("ry")),h=k.Resolution,p=_.map(_.range(h),function(a){var b=a/h*x;a=d*l(b);b=m*c(b);return new k.Anchor(a,b)},this),p=(new k.Polygon(p,!0,!0)).noStroke();p.translation.set(b,g);return k.Utils.applySvgAttributes(a,p)},rect:function(a){var b=parseFloat(a.getAttribute("x")),g=parseFloat(a.getAttribute("y")),d=parseFloat(a.getAttribute("width")),c=parseFloat(a.getAttribute("height")),d=d/2,c=c/2,m=[new k.Anchor(d,
c),new k.Anchor(-d,c),new k.Anchor(-d,-c),new k.Anchor(d,-c)],m=(new k.Polygon(m,!0)).noStroke();m.translation.set(b+d,g+c);return k.Utils.applySvgAttributes(a,m)},line:function(a){var b=parseFloat(a.getAttribute("x1")),g=parseFloat(a.getAttribute("y1")),d=parseFloat(a.getAttribute("x2")),c=parseFloat(a.getAttribute("y2")),d=(d-b)/2,c=(c-g)/2,m=[new k.Anchor(-d,-c),new k.Anchor(d,c)],m=(new k.Polygon(m)).noFill();m.translation.set(b+d,g+c);return k.Utils.applySvgAttributes(a,m)}},subdivide:function(a,
b,g,d,c,h,l,q,n){var s=k.Utils.Curve.CollinearityEpsilon,u=k.Utils.Curve.RecursionLimit,v=k.Utils.Curve.CuspLimit,w=k.Utils.Curve.Tolerance,y;n=n||0;if(n>u)return[];var u=(a+g)/2,e=(b+d)/2,f=(g+c)/2,t=(d+h)/2,A=(c+l)/2,C=(h+q)/2,D=(u+f)/2,E=(e+t)/2,f=(f+A)/2,t=(t+C)/2,z=(D+f)/2,F=(E+t)/2;y=l-a;var L=q-b,O=p((g-l)*L-(d-q)*y),P=p((c-l)*L-(h-q)*y);if(0<n){if(O>s&&P>s&&(O+P)*(O+P)<=w.distance*(y*y+L*L)){if(w.angle<w.epsilon)return[new k.Anchor(z,F)];y=r(h-d,c-g);s=p(y-r(d-b,g-a));y=p(r(q-h,l-c)-y);s>=
m&&(s=x-s);y>=m&&(y=x-y);if(s+y<w.angle)return[new k.Anchor(z,F)];if(0!==v){if(s>v)return[new k.Anchor(g,d)];if(y>v)return[new k.Anchor(c,h)]}}}else if(O>s)if(O*O<=w.distance*(y*y+L*L)){if(w.angle<w.epsilon)return[new k.Anchor(z,F)];s=p(r(h-d,c-g)-r(d-b,g-a));s>=m&&(s=x-s);if(s<w.angle)return[new k.Anchor(g,d),new k.Anchor(c,h)];if(0!==v&&s>v)return[new k.Anchor(g,d)]}else if(P>s){if(P*P<=w.distance*(y*y+L*L)){if(w.angle<w.epsilon)return[new k.Anchor(z,F)];s=p(r(q-h,l-c)-r(h-d,c-g));s>=m&&(s=x-s);
if(s<w.angle)return[new k.Anchor(g,d),new k.Anchor(c,h)];if(0!==v&&s>v)return[new k.Anchor(c,h)]}}else if(y=z-(a+l)/2,L=F-(b+q)/2,y*y+L*L<=w.distance)return[new k.Anchor(z,F)];return k.Utils.subdivide(a,b,u,e,D,E,z,F,n+1).concat(k.Utils.subdivide(z,F,f,t,A,C,l,q,n+1))},getCurveFromPoints:function(a,b){for(var g=a.length,d=g-1,c=0;c<g;c++){var m=a[c];_.isObject(m.controls)||k.Anchor.AppendCurveProperties(m);var h=b?z(c-1,g):Math.max(c-1,0),l=b?z(c+1,g):Math.min(c+1,d);A(a[h],m,a[l]);m._command=0===
c?k.Commands.move:k.Commands.curve;m.controls.left.x=_.isNumber(m.controls.left.x)?m.controls.left.x:m.x;m.controls.left.y=_.isNumber(m.controls.left.y)?m.controls.left.y:m.y;m.controls.right.x=_.isNumber(m.controls.right.x)?m.controls.right.x:m.x;m.controls.right.y=_.isNumber(m.controls.right.y)?m.controls.right.y:m.y}},getControlPoints:function(a,b,g){var d=v(a,b),h=v(g,b);a=D(a,b);g=D(g,b);var p=(d+h)/2;b.u=_.isObject(b.controls.left)?b.controls.left:new k.Vector(b.x,b.y);b.v=_.isObject(b.controls.right)?
b.controls.right:new k.Vector(b.x,b.y);if(1E-4>a||1E-4>g)return b.controls.left.copy(b),b.controls.right.copy(b),b;a*=0.33;g*=0.33;p=h<d?p+y:p-y;b.controls.left.x=b.x+l(p)*a;b.controls.left.y=b.y+c(p)*a;p-=m;b.controls.right.x=b.x+l(p)*g;b.controls.right.y=b.y+c(p)*g;return b},getReflection:function(a,b,g){var d=a.distanceTo(b);if(1E-4>=d)return g?new k.Vector:a.clone();b=v(a,b);return new k.Vector(d*Math.cos(b)+(g?0:a.x),d*Math.sin(b)+(g?0:a.y))},angleBetween:function(a,b){return r(a.y-b.y,a.x-b.x)},
distanceBetweenSquared:function(a,b){var g=a.x-b.x,d=a.y-b.y;return g*g+d*d},distanceBetween:function(a,b){return h(E(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=a}}});k.Utils.Error.prototype=Error();k.Utils.Error.prototype.constructor=k.Utils.Error;k.Utils.Collection.prototype=
[];k.Utils.Collection.constructor=k.Utils.Collection;_.extend(k.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(k.Events.remove,[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(k.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);this.trigger(k.Events.insert,arguments);return a},unshift:function(){var a=Array.prototype.unshift.apply(this,
arguments);this.trigger(k.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,arguments),b;this.trigger(k.Events.remove,a);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(k.Events.insert,b));return a}});var D=k.Utils.distanceBetween,E=k.Utils.distanceBetweenSquared,v=k.Utils.angleBetween,A=k.Utils.getControlPoints,z=k.Utils.mod,F=k.Utils.getBackingStoreRatio;_.extend(k.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);
return this},play:function(){k.Utils.setPlaying.call(this,!0);return this.trigger(k.Events.play)},pause:function(){this.playing=!1;return this.trigger(k.Events.pause)},update:function(){var a=!!this._lastFrame,b=(n.performance&&n.performance.now?n.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,g=this.renderer;a===g.width&&b===g.height||g.setSize(a,b,this.ratio);return this.trigger(k.Events.update,
this.frameCount,this.timeDelta)},render:function(){this.renderer.render();return this.trigger(k.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));return this},makeLine:function(a,b,g,d){g=(g-a)/2;d=(d-b)/2;var c=[new k.Anchor(-g,-d),new k.Anchor(g,d)],c=(new k.Polygon(c)).noFill();
c.translation.set(a+g,b+d);this.scene.add(c);return c},makeRectangle:function(a,b,g,d){g/=2;d/=2;d=[new k.Anchor(g,d),new k.Anchor(-g,d),new k.Anchor(-g,-d),new k.Anchor(g,-d)];d=new k.Polygon(d,!0);d.translation.set(a,b);this.scene.add(d);return d},makeCircle:function(a,b,g){return this.makeEllipse(a,b,g,g)},makeEllipse:function(a,b,g,d){var m=k.Resolution,h=_.map(_.range(m),function(a){var b=a/m*x;a=g*l(b);b=d*c(b);return new k.Anchor(a,b)},this),h=new k.Polygon(h,!0,!0);h.translation.set(a,b);
this.scene.add(h);return h},makeCurve:function(a){var b=arguments.length,g=a;if(!_.isArray(a))for(var g=[],d=0;d<b;d+=2){var c=arguments[d];if(!_.isNumber(c))break;g.push(new k.Anchor(c,arguments[d+1]))}var b=arguments[b-1],g=new k.Polygon(g,!(_.isBoolean(b)&&b),!0),b=g.getBoundingClientRect(),m=b.left+b.width/2,h=b.top+b.height/2;_.each(g.vertices,function(a){a.x-=m;a.y-=h});g.translation.set(m,h);this.scene.add(g);return g},makePolygon:function(a){var b=arguments.length,g=a;if(!_.isArray(a))for(var g=
[],d=0;d<b;d+=2){var c=arguments[d];if(!_.isNumber(c))break;g.push(new k.Anchor(c,arguments[d+1]))}b=arguments[b-1];g=new k.Polygon(g,!(_.isBoolean(b)&&b));b=g.getBoundingClientRect();g.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(g);return g},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var g=new k.Group;this.scene.add(g);g.add(b);return g},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in k.Utils.read))return null;a=k.Utils.read[b].call(this,
a);this.add(a);return a}});(function(){requestAnimationFrame(arguments.callee);_.each(k.Instances,function(a){a.playing&&a.update().render()})})();"function"===typeof define&&define.amd?define(function(){return k}):"undefined"!=typeof module&&module.exports&&(module.exports=k)})();(function(){var C,n,q,c,l=Two.Vector=function(c,h){this.x=c||0;this.y=h||0};_.extend(l.prototype,Backbone.Events,{set:function(c,h){this.x=c;this.y=h;return this},copy:function(c){this.x=c.x;this.y=c.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new l(this.x,this.y)},add:function(c,h){this.x=c.x+h.x;this.y=c.y+h.y;return this},addSelf:function(c){this.x+=c.x;this.y+=c.y;return this},sub:function(c,h){this.x=c.x-h.x;this.y=c.y-h.y;return this},subSelf:function(c){this.x-=
c.x;this.y-=c.y;return this},multiplySelf:function(c){this.x*=c.x;this.y*=c.y;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;return this},divideScalar:function(c){c?(this.x/=c,this.y/=c):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this.x*c.x+this.y*c.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(h){q=this.x-h.x;c=this.y-h.y;return q*q+c*c},setLength:function(c){return this.normalize().multiplyScalar(c)},equals:function(c){return 1E-4>this.distanceTo(c)},lerp:function(c,h){C=(c.x-this.x)*h+this.x;n=(c.y-this.y)*h+this.y;return this.set(C,n)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var r={set:function(c,
h){this._x=c;this._y=h;return this.trigger(Two.Events.change)},copy:function(c){this._x=c.x;this._y=c.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new l(this._x,this._y)},add:function(c,h){this._x=c.x+h.x;this._y=c.y+h.y;return this.trigger(Two.Events.change)},addSelf:function(c){this._x+=c.x;this._y+=c.y;return this.trigger(Two.Events.change)},sub:function(c,h){this._x=c.x-h.x;this._y=c.y-h.y;return this.trigger(Two.Events.change)},
subSelf:function(c){this._x-=c.x;this._y-=c.y;return this.trigger(Two.Events.change)},multiplySelf:function(c){this._x*=c.x;this._y*=c.y;return this.trigger(Two.Events.change)},multiplyScalar:function(c){this._x*=c;this._y*=c;return this.trigger(Two.Events.change)},divideScalar:function(c){return c?(this._x/=c,this._y/=c,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this._x*c.x+this._y*c.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(h){q=this._x-h.x;c=this._y-h.y;return q*q+c*c},setLength:function(c){return this.normalize().multiplyScalar(c)},equals:function(c){return 1E-4>this.distanceTo(c)},lerp:function(c,h){C=(c.x-this._x)*h+this._x;n=(c.y-this._y)*h+this._y;return this.set(C,n)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},h={get:function(){return this._x},set:function(c){this._x=c;this.trigger(Two.Events.change,"x")}},p={get:function(){return this._y},set:function(c){this._y=c;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",h),Object.defineProperty(this,"y",p),_.extend(this,r),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var C=Two.Commands,n,q,c,l=Two.Anchor=function(c,h,p,m,q,n,w){Two.Vector.call(this,c,h);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(c){this._command=c;this._command!==C.curve||_.isObject(this.controls)||l.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=w||C.move;if(!w)return this;l.AppendCurveProperties(this);_.isNumber(p)&&(this.controls.left.x=
p);_.isNumber(m)&&(this.controls.left.y=m);_.isNumber(q)&&(this.controls.right.x=q);_.isNumber(n)&&(this.controls.right.y=n)};_.extend(l,{AppendCurveProperties:function(c){n=c._x||c.x;q=c._y||c.y;c.controls={left:new Two.Vector(n,q),right:new Two.Vector(n,q)}}});_.extend(l.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||l.AppendCurveProperties(this);_.each(this.controls,function(c){c.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(c){c.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){c=this.controls;return new Two.Anchor(this.x,this.y,c&&c.left.x,c&&c.left.y,c&&c.right.x,c&&c.right.y,this.command)}})})();(function(){_.range(6);var C=Math.cos,n=Math.sin,q=Math.tan,c,l,r,h,p,m,x,y,w,u,s,k,D,E,v,A,z,F,a,b,g,d,H,B,G,I,J,M,Q,N,R,S,e,f,t,ea,V,W,$,ba,X,L,O,P,aa,ca,da,Y,T,Z=[],fa=Two.Matrix=function(a,b,d,c,f,e){this.elements=new Two.Array(9);var g=a;_.isArray(g)||(g=_.toArray(arguments));this.identity().set(g)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(f,e,h){if(3>=e.length)return k,D,E,c=e[0]||0,l=e[1]||0,r=e[2]||0,p=f,k=p[0]*c+p[1]*l+p[2]*r,D=p[3]*c+p[4]*l+p[5]*r,E=p[6]*c+p[7]*l+p[8]*
r,{x:k,y:D,z:E};v=f[0];A=f[1];z=f[2];F=f[3];a=f[4];b=f[5];g=f[6];d=f[7];H=f[8];B=e[0];G=e[1];I=e[2];J=e[3];M=e[4];Q=e[5];N=e[6];R=e[7];S=e[8];h=h||new Two.Array(9);h[0]=v*B+A*J+z*N;h[1]=v*G+A*M+z*R;h[2]=v*I+A*Q+z*S;h[3]=F*B+a*J+b*N;h[4]=F*G+a*M+b*R;h[5]=F*I+a*Q+b*S;h[6]=g*B+d*J+H*N;h[7]=g*G+d*M+H*R;h[8]=g*I+d*Q+H*S;return h}});_.extend(fa.prototype,Backbone.Events,{set:function(a,b,d,c,f,e){s=a;t=arguments.length;_.isArray(s)||(s=_.toArray(arguments));_.each(s,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(c,h,l,p,m,q,n,r,ma){s=arguments;t=s.length;if(1>=t)return _.each(this.elements,function(a,b){this.elements[b]=a*c},this),this.trigger(Two.Events.change);if(3>=t)return k,D,E,c=c||0,h=h||0,l=l||0,m=this.elements,k=m[0]*c+m[1]*h+m[2]*l,D=m[3]*c+m[4]*h+m[5]*l,E=m[6]*c+m[7]*h+m[8]*l,{x:k,y:D,z:E};e=this.elements;f=s;v=e[0];A=e[1];z=e[2];F=e[3];a=e[4];b=e[5];g=e[6];d=e[7];H=e[8];B=
f[0];G=f[1];I=f[2];J=f[3];M=f[4];Q=f[5];N=f[6];R=f[7];S=f[8];this.elements[0]=v*B+A*J+z*N;this.elements[1]=v*G+A*M+z*R;this.elements[2]=v*I+A*Q+z*S;this.elements[3]=F*B+a*J+b*N;this.elements[4]=F*G+a*M+b*R;this.elements[5]=F*I+a*Q+b*S;this.elements[6]=g*B+d*J+H*N;this.elements[7]=g*G+d*M+H*R;this.elements[8]=g*I+d*Q+H*S;return this.trigger(Two.Events.change)},inverse:function(a){c=this.elements;a=a||new Two.Matrix;V=c[0];W=c[1];$=c[2];ba=c[3];X=c[4];L=c[5];O=c[6];P=c[7];aa=c[8];ca=aa*X-L*P;da=-aa*
ba+L*O;Y=P*ba-X*O;T=V*ca+W*da+$*Y;if(!T)return null;T=1/T;a.elements[0]=ca*T;a.elements[1]=(-aa*W+$*P)*T;a.elements[2]=(L*W-$*X)*T;a.elements[3]=da*T;a.elements[4]=(aa*V-$*O)*T;a.elements[5]=(-L*V+$*ba)*T;a.elements[6]=Y*T;a.elements[7]=(-P*V+W*O)*T;a.elements[8]=(X*V-W*ba)*T;return a},scale:function(a,b){t=arguments.length;1>=t&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){r=C(a);ea=n(a);return this.multiply(r,-ea,0,ea,r,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){c=q(a);return this.multiply(1,c,0,0,1,0,0,0,1)},skewY:function(a){c=q(a);return this.multiply(1,0,0,c,1,0,0,0,1)},toString:function(a){this.toArray(a,Z);return Z.join(" ")},toArray:function(a,b){s=this.elements;u=!!b;c=parseFloat(s[0].toFixed(3));l=parseFloat(s[1].toFixed(3));r=parseFloat(s[2].toFixed(3));h=parseFloat(s[3].toFixed(3));p=parseFloat(s[4].toFixed(3));m=parseFloat(s[5].toFixed(3));if(a){x=parseFloat(s[6].toFixed(3));y=parseFloat(s[7].toFixed(3));w=
parseFloat(s[8].toFixed(3));if(u){b[0]=c;b[1]=h;b[2]=x;b[3]=l;b[4]=p;b[5]=y;b[6]=r;b[7]=m;b[8]=w;return}return[c,h,x,l,p,y,r,m,w]}if(u)b[0]=c,b[1]=h,b[2]=l,b[3]=p,b[4]=r,b[5]=m;else return[c,h,l,p,r,m]},clone:function(){c=this.elements[0];l=this.elements[1];r=this.elements[2];h=this.elements[3];p=this.elements[4];m=this.elements[5];x=this.elements[6];y=this.elements[7];w=this.elements[8];return new Two.Matrix(c,l,r,h,p,m,x,y,w)}})})();(function(){var C=Two.Utils.mod,n,q,c,l={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(h,p){c=h;q=document.createElementNS(this.ns,c);"svg"===c&&(p=_.defaults(p||{},{version:this.version}));_.isObject(p)&&l.setAttributes(q,p);return q},setAttribute:function(c,l){this.setAttribute(l,c)},setAttributes:function(c,p){_.each(p,l.setAttribute,c);return this},removeAttribute:function(c,l){this.removeAttribute(l)},removeAttributes:function(c,p){_.each(p,
l.removeAttribute,c);return this},toString:function(c,l){var m=c.length,q=m-1;return _.map(c,function(n,r){var u,s=l?C(r-1,m):Math.max(r-1,0),k=l?C(r+1,m):Math.min(r+1,q),s=c[s],k=c[k],D,E,v,A,z;z=n.x.toFixed(3);A=n.y.toFixed(3);switch(n._command){case Two.Commands.close:u=Two.Commands.close;break;case Two.Commands.curve:D=s.controls&&s.controls.right||s;u=n.controls&&n.controls.left||n;s=D.x.toFixed(3);D=D.y.toFixed(3);E=u.x.toFixed(3);v=u.y.toFixed(3);u=(0===r?Two.Commands.move:Two.Commands.curve)+
" "+s+" "+D+" "+E+" "+v+" "+z+" "+A;break;default:u=(0===r?Two.Commands.move:n._command)+" "+z+" "+A}r>=q&&l&&(n._command===Two.Commands.curve&&(A=n.controls&&n.controls.right||n,z=k.controls&&k.controls.left||k,s=A.x.toFixed(3),D=A.y.toFixed(3),E=z.x.toFixed(3),v=z.y.toFixed(3),z=k.x.toFixed(3),A=k.y.toFixed(3),u+=" C "+s+" "+D+" "+E+" "+v+" "+z+" "+A),u+=" Z");return u}).join(" ")},group:{appendChild:function(c){(q=this.domElement.querySelector("#"+Two.Identifier+c))&&this.elem.appendChild(q)},
removeChild:function(c){(q=this.domElement.querySelector("#"+Two.Identifier+c))&&this.elem.removeChild(q)},renderChild:function(c){l[c._renderer.type].render.call(c,this)},render:function(c){this.update();this._renderer.elem||(this._renderer.elem=l.createElement("g",{id:Two.Identifier+this.id}),c.appendChild(this._renderer.elem));n=this._matrix.manual||this._flagMatrix;var p={domElement:c,elem:this._renderer.elem};n&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");
_.each(this.children,l.group.renderChild,c);this._flagAdditions&&_.each(this.additions,l.group.appendChild,{domElement:c,elem:this._renderer.elem});this._flagSubtractions&&_.each(this.subtractions,l.group.removeChild,p);return this.flagReset()}},polygon:{render:function(c){this.update();this._renderer.elem||(this._renderer.elem=l.createElement("path",{id:Two.Identifier+this.id}),c.appendChild(this._renderer.elem));q=this._renderer.elem;(n=this._matrix.manual||this._flagMatrix)&&q.setAttribute("transform",
"matrix("+this._matrix.toString()+")");this._flagVertices&&(vertices=l.toString(this._vertices,this._closed),q.setAttribute("d",vertices));this._flagFill&&q.setAttribute("fill",this._fill);this._flagStroke&&q.setAttribute("stroke",this._stroke);this._flagLinewidth&&q.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(q.setAttribute("stroke-opacity",this._opacity),q.setAttribute("fill-opacity",this._opacity));this._flagVisible&&q.setAttribute("visible",this._visible);this._flagCap&&q.setAttribute("stroke-linecap",
this._cap);this._flagJoin&&q.setAttribute("stroke-linejoin",this._join);this._flagMiter&&q.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},r=Two[Two.Types.svg]=function(c){this.domElement=c.domElement||l.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(r,{Utils:l});_.extend(r.prototype,Backbone.Events,{setSize:function(c,p){this.width=c;this.height=p;l.setAttributes(this.domElement,{width:c,height:p});return this},render:function(){l.group.render.call(this.scene,
this.domElement);return this}})})();(function(){var C=Two.Utils.mod,n=Two.Utils.getRatio,q,c,l,r,h,p,m,x,y,w,u,s,k,D,E,v,A,z,F,a,b,g,d,H,B,G,I,J={group:{render:function(a){this.update();q=this._matrix.elements;a.save();a.transform(q[0],q[3],q[1],q[4],q[2],q[5]);_.each(this.children,function(b){J[b._renderer.type].render.call(b,a)});a.restore();return this.flagReset()}},polygon:{render:function(n){this.update();q=this._matrix.elements;c=this.stroke;l=this.linewidth;r=this.fill;h=this.opacity;p=this.visible;m=this.cap;x=this.join;y=this.miter;
w=this.closed;u=this._vertices;s=u.length;k=s-1;if(!p)return this;n.save();q&&n.transform(q[0],q[3],q[1],q[4],q[2],q[5]);r&&(n.fillStyle=r);c&&(n.strokeStyle=c);l&&(n.lineWidth=l);y&&(n.miterLimit=y);x&&(n.lineJoin=x);m&&(n.lineCap=m);_.isNumber(h)&&(n.globalAlpha=h);n.beginPath();_.each(u,function(c,h){G=c.x.toFixed(3);I=c.y.toFixed(3);switch(c._command){case Two.Commands.close:n.closePath();break;case Two.Commands.curve:E=w?C(h-1,s):Math.max(h-1,0);D=w?C(h+1,s):Math.min(h+1,k);v=u[E];A=u[D];g=v.controls&&
v.controls.right||v;d=c.controls&&c.controls.left||c;a=g.x.toFixed(3);b=g.y.toFixed(3);z=d.x.toFixed(3);F=d.y.toFixed(3);n.bezierCurveTo(a,b,z,F,G,I);h>=k&&w&&(H=c.controls&&c.controls.right||c,B=A.controls&&A.controls.left||A,a=H.x.toFixed(3),b=H.y.toFixed(3),z=B.x.toFixed(3),F=B.y.toFixed(3),G=A.x.toFixed(3),I=A.y.toFixed(3),n.bezierCurveTo(a,b,z,F,G,I));break;case Two.Commands.line:n.lineTo(G,I);break;case Two.Commands.move:n.moveTo(G,I)}});w&&n.closePath();n.fill();n.stroke();n.restore();return this.flagReset()}}},
M=Two[Two.Types.canvas]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.scene=new Two.Group;this.scene.parent=this};_.extend(M,{Utils:J});_.extend(M.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?n(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});return this},
render:function(){var a=1===this.ratio;a||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);J.group.render.call(this.scene,this.ctx);a||this.ctx.restore();return this}})})();(function(){var C=Two.Matrix.Multiply,n=Two.Utils.mod,q=[1,0,0,0,1,0,0,0,1],c=new Two.Array(9),l=Two.Utils.getRatio,r,h,p,m,x,y,w,u,s,k,D,E,v,A,z,F,a,b,g,d,H,B,G,I,J,M,Q,N,R,S,e,f,t,ea,V,W,$,ba,X,L,O,P,aa,ca,da,Y,T,Z,fa,ga,K,ia,ja,ka,ha,U={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{render:function(a,b){this.update();r=this.parent;h=r._matrix&&r._matrix.manual||r._flagMatrix;p=this._matrix.manual||this._flagMatrix;if(h||p)this._renderer.matrix||(this._renderer.matrix=
new Two.Array(9)),this._matrix.toArray(!0,c),C(c,r._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*r._renderer.scale,h&&(this._flagMatrix=!0);_.each(this.children,function(c){U[c._renderer.type].render.call(c,a,b)});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;r=this.parent;h=r._matrix.manual||r._flagMatrix;p=this._matrix.manual||this._flagMatrix;m=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||
this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this.update();if(h||p)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,c),C(c,r._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*r._renderer.scale;m&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),U.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),
U.getTriangles(this._renderer.rect,this._renderer.triangles),U.updateBuffer(a,this,b),U.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(c,
d,f){x=Infinity;y=-Infinity;w=Infinity;u=-Infinity;_.each(c,function(b,c){s=b.x;k=b.y;D;E;v;A;z=b.controls;w=Math.min(k,w);x=Math.min(s,x);y=Math.max(s,y);u=Math.max(k,u);b.controls&&(F=z.left,a=z.right,F&&a&&(D=F.x,E=F.y,v=a.x,A=a.y,D&&(E&&v&&A)&&(w=Math.min(E,A,w),x=Math.min(D,v,x),y=Math.max(D,v,y),u=Math.max(E,A,u))))});_.isNumber(d)&&(w-=d,x-=d,y+=d,u+=d);b=y-x;g=u-w;f.top=w;f.left=x;f.right=y;f.bottom=u;f.width=b;f.height=g;f.centroid||(f.centroid={});f.centroid.x=-x;f.centroid.y=-w},getTriangles:function(a,
b){w=a.top;x=a.left;y=a.right;u=a.bottom;b[0]=x;b[1]=w;b[2]=y;b[3]=w;b[4]=x;b[5]=u;b[6]=x;b[7]=u;b[8]=y;b[9]=w;b[10]=y;b[11]=u},updateCanvas:function(a){d=a._vertices;H=this.canvas;B=this.ctx;G=a._renderer.scale;I=a._stroke;J=a._linewidth*G;M=a._fill;Q=a._opacity;N=a._cap;R=a._join;S=a._miter;e=a._closed;f=d.length;t=f-1;H.width=Math.max(Math.ceil(a._renderer.rect.width*G),1);H.height=Math.max(Math.ceil(a._renderer.rect.height*G),1);ea=a._renderer.rect.centroid;V=ea.x*G;W=ea.y*G;B.clearRect(0,0,H.width,
H.height);M&&(B.fillStyle=M);I&&(B.strokeStyle=I);J&&(B.lineWidth=J);S&&(B.miterLimit=S);R&&(B.lineJoin=R);N&&(B.lineCap=N);_.isNumber(Q)&&(B.globalAlpha=Q);B.beginPath();_.each(d,function(a,b){$;ba;D;v;X;L;O;P;aa;ca;da;F;s=(a.x*G+V).toFixed(3);k=(a.y*G+W).toFixed(3);switch(a._command){case Two.Commands.close:B.closePath();break;case Two.Commands.curve:ba=e?n(b-1,f):Math.max(b-1,0);$=e?n(b+1,f):Math.min(b+1,t);D=d[ba];v=d[$];aa=D.controls&&D.controls.right||D;ca=a.controls&&a.controls.left||a;O=(aa.x*
G+V).toFixed(3);P=(aa.y*G+W).toFixed(3);X=(ca.x*G+V).toFixed(3);L=(ca.y*G+W).toFixed(3);B.bezierCurveTo(O,P,X,L,s,k);b>=t&&e&&(da=a.controls&&a.controls.right||a,F=v.controls&&v.controls.left||v,O=(da.x*G+V).toFixed(3),P=(da.y*G+W).toFixed(3),X=(F.x*G+V).toFixed(3),L=(F.y*G+W).toFixed(3),s=(v.x*G+V).toFixed(3),k=(v.y*G+W).toFixed(3),B.bezierCurveTo(O,P,X,L,s,k));break;case Two.Commands.line:B.lineTo(s,k);break;case Two.Commands.move:B.moveTo(s,k)}});e&&B.closePath();B.fill();B.stroke()},updateTexture:function(a,
b){this.updateCanvas(b);b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,
a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);
a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){Y=a.createProgram();_.each(b,function(b){a.attachShader(Y,b)});a.linkProgram(Y);T=a.getProgramParameter(Y,a.LINK_STATUS);if(!T)throw ga=a.getProgramInfoLog(Y),a.deleteProgram(Y),new Two.Utils.Error("unable to link program: "+ga);return Y}},shaders:{create:function(a,b,c){Z=a.createShader(a[c]);a.shaderSource(Z,b);a.compileShader(Z);fa=a.getShaderParameter(Z,a.COMPILE_STATUS);
if(!fa)throw ga=a.getShaderInfoLog(Z),a.deleteShader(Z),new Two.Utils.Error("unable to compile shader "+Z+": "+ga);return Z},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};U.ctx=U.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(q),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;K=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=U.shaders.create(K,U.shaders.vertex,U.shaders.types.vertex);ja=U.shaders.create(K,U.shaders.fragment,U.shaders.types.fragment);this.program=U.program.create(K,[ka,ja]);K.useProgram(this.program);this.program.position=K.getAttribLocation(this.program,
"a_position");this.program.matrix=K.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=K.getAttribLocation(this.program,"a_textureCoords");K.disable(K.DEPTH_TEST);K.enable(K.BLEND);K.blendEquationSeparate(K.FUNC_ADD,K.FUNC_ADD);K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?l(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){K=this.ctx;this.overdraw||K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT);U.group.render.call(this.scene,K,this.program);this._flagMatrix=!1;return this}})})();(function(){new Two.Vector;var C,n=Two.Shape=function(q){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(n.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(n,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeGetterSetter:function(n){Object.defineProperty(n,"rotation",{get:function(){return this._rotation},set:function(c){this._rotation=c;this._flagMatrix=!0}});Object.defineProperty(n,
"scale",{get:function(){return this._scale},set:function(c){this._scale=c;this._flagScale=this._flagMatrix=!0}})}});_.extend(n.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(n){n.add(this);return this},clone:function(){C=new n;C.translation.copy(this.translation);C.rotation=this.rotation;C.scale=this.scale;_.each(n.Properties,function(n){C[n]=this[n]},this);return C.update()},update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});n.MakeGetterSetter(n.prototype)})();(function(){var C=Math.min,n=Math.max,q=Math.round,c=Two.Utils.getComputedMatrix,l,r,h,p,m,x,y,w,u,s,k,D,E,v,A,z,F,a,b,g,d,H,B,G,I,J,M,Q,N,R,S,e=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!c;this._automatic=!d;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4;this._vertices=[];this.vertices=a};_.extend(e,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),
FlagVertices:function(){this._flagVertices=!0}});_.extend(e.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;w=_.map(this.vertices,function(a){return a.clone()});u=new e(w,this.closed,this.curved,
!this.automatic);_.each(Two.Shape.Properties,function(a){u[a]=this[a]},this);u.translation.copy(this.translation);u.rotation=this.rotation;u.scale=this.scale;a.add(u);return u},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){s=this.getBoundingClientRect(!0);k={x:s.left,y:s.top};_.each(this.vertices,function(a){a.subSelf(k)});return this},center:function(){s=this.getBoundingClientRect(!0);s.centroid={x:s.left+s.width/
2,y:s.top+s.height/2};_.each(this.vertices,function(a){a.subSelf(s.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(f){D=this.linewidth/2;void 0;E=Infinity;v=-Infinity;A=Infinity;z=-Infinity;_.each(this.vertices,function(b){F=b.x;a=b.y;A=C(a,A);E=C(F,E);v=n(F,v);z=n(a,z)});A-=D;E-=D;v+=D;z+=D;B=f?this._matrix:c(this);b=B.multiply(E,A,1);g=B.multiply(v,A,1);d=B.multiply(v,z,1);H=B.multiply(E,z,1);A=C(b.y,g.y,
d.y,H.y);E=C(b.x,g.x,d.x,H.x);v=n(b.x,g.x,d.x,H.x);z=n(b.y,g.y,d.y,H.y);return{top:A,left:E,right:v,bottom:z,width:v-E,height:z-A}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this.vertices,this.closed),this;_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(){p=this.vertices.length-1;m=this._closed||this.vertices[p].command===Two.Commands.close;w=[];_.each(this.vertices,function(a,b){0>=b&&!m||(v=g.controls&&
g.controls.right,E=a.controls&&a.controls.left,G=g.x,I=g.y,J=(v||g).x,M=(v||g).y,Q=(E||a).x,N=(E||a).y,R=a.x,S=a.y,w.push(Two.Utils.subdivide(G,I,J,M,Q,N,R,S)));g=a},this);this._curved=this._automatic=!1;this.vertices=_.flatten(w);this.plot();return this},update:function(){if(this._flagVertices)for(this._automatic&&this.plot(),l=this.vertices.length,p=l-1,r=q(this._beginning*p),h=q(this._ending*p),this._vertices.length=0,y=r;y<h+1;y++)x=this.vertices[y],this._vertices.push(x);Two.Shape.prototype.update.call(this);
return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});_.each(e.Properties.slice(0,8),function(a){var b="_"+a,c="_flag"+a.charAt(0).toUpperCase()+a.slice(1);Object.defineProperty(e.prototype,a,{get:function(){return this[b]},set:function(a){this[b]=a;this[c]=!0}})});Object.defineProperty(e.prototype,"closed",{get:function(){return this._closed},
set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(e.prototype,"curved",{get:function(){return this._curved},set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(e.prototype,"automatic",{get:function(){return this._automatic},set:function(a){a!==this._automatic&&(this._automatic=!!a)}});Object.defineProperty(e.prototype,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=C(n(a,0),1);this._flagVertices=!0}});Object.defineProperty(e.prototype,
"ending",{get:function(){return this._ending},set:function(a){this._ending=C(n(a,0),1);this._flagVertices=!0}});Object.defineProperty(e.prototype,"vertices",{get:function(){return this._collection},set:function(a){var b=_.bind(e.FlagVertices,this),c=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,b)},this);b()},this),d=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,b)},this);b()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(a.slice(0));
this._collection.bind(Two.Events.insert,c);this._collection.bind(Two.Events.remove,d);verticesChanged=!0;c(this._collection)}});Two.Shape.MakeGetterSetter(e.prototype)})();(function(){var C=Math.min,n=Math.max,q,c,l,r,h,p,m,x,y,w,u,s,k,D,E,v,A,z,F,a,b,g=Two.Group=function(a){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(g,{MakeGetterSetter:function(a,b){_.isArray(b)||(b=[b]);_.each(b,function(b){q="_"+b;Object.defineProperty(a,b,{get:function(){return this[q]},set:function(a){this[q]=a;_.each(this.children,function(c){c[b]=a})}})})}});_.extend(g.prototype,Two.Shape.prototype,{_flagAdditions:!1,
_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;l=_.map(this.children,function(a){return a.clone()});r=new g;a.add(r);r.add(l);r.translation.copy(this.translation);r.rotation=this.rotation;r.scale=this.scale;return r},corner:function(){h=this.getBoundingClientRect(!0);p={x:h.left,y:h.top};_.each(this.children,function(a){a.translation.subSelf(p)});
return this},center:function(){h=this.getBoundingClientRect(!0);h.centroid={x:h.left+h.width/2,y:h.top+h.height/2};_.each(this.children,function(a){a.translation.subSelf(h.centroid)});return this},add:function(a){m=arguments.length;x=a;l=this.children;y=this.parent;w=this.additions;_.isArray(a)||(x=_.toArray(arguments));_.each(x,function(a){a&&(u=a.id,c=a.parent,_.isUndefined(l[u])&&(c&&(delete c.children[u],b=_.indexOf(c.additions,u),0<=b&&c.additions.splice(b,1)),l[u]=a,a.parent=this,w.push(u),
this._flagAdditions=!0))},this);return this},remove:function(a){m=arguments.length;x=a;l=this.children;y=this.parent;w=this.subtractions;if(0>=m&&y)return y.remove(this),this;_.isArray(a)||(x=_.toArray(arguments));_.each(x,function(a){u=a.id;grandchildren=a.children;c=a.parent;u in l&&(delete l[u],delete a.parent,b=_.indexOf(c.additions,u),0<=b&&c.additions.splice(b,1),w.push(u),this._flagSubtractions=!0)});return this},getBoundingClientRect:function(b){s=Infinity;k=-Infinity;D=Infinity;E=-Infinity;
_.each(this.children,function(a){h=a.getBoundingClientRect(!0);_.isNumber(h.top)&&(_.isNumber(h.left)&&_.isNumber(h.right)&&_.isNumber(h.bottom))&&(D=C(h.top,D),s=C(h.left,s),k=n(h.right,k),E=n(h.bottom,E))},this);v=b?this._matrix:Two.Utils.getComputedMatrix(this);A=v.multiply(s,D,1);z=v.multiply(k,D,1);F=v.multiply(k,E,1);a=v.multiply(s,E,1);D=C(A.y,z.y,F.y,a.y);s=C(A.x,z.x,F.x,a.x);k=n(A.x,z.x,F.x,a.x);E=n(A.y,z.y,F.y,a.y);return{top:D,left:s,right:k,bottom:E,width:k-s,height:E-D}},noFill:function(){_.each(this.children,
function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this},subdivide:function(){_.each(this.children,function(a){a.subdivide()});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);return this}});g.MakeGetterSetter(g.prototype,Two.Polygon.Properties);Two.Shape.MakeGetterSetter(g.prototype)})();
