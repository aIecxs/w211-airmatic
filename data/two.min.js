(function(){var C=this,p=C._,g={},e=Array.prototype,t=Object.prototype,k=e.push,h=e.slice,l=e.concat,f=t.toString,u=t.hasOwnProperty,G=e.forEach,q=e.map,w=e.reduce,d=e.reduceRight,s=e.filter,D=e.every,z=e.some,r=e.indexOf,A=e.lastIndexOf,t=Array.isArray,F=Object.keys,E=Function.prototype.bind,a=function(b){if(b instanceof a)return b;if(!(this instanceof a))return new a(b);this._wrapped=b};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=a),exports._=
a):C._=a;a.VERSION="1.5.1";var c=a.each=a.forEach=function(b,m,B){if(null!=b)if(G&&b.forEach===G)b.forEach(m,B);else if(b.length===+b.length)for(var c=0,d=b.length;c<d&&m.call(B,b[c],c,b)!==g;c++);else for(c in b)if(a.has(b,c)&&m.call(B,b[c],c,b)===g)break};a.map=a.collect=function(b,a,B){var d=[];if(null==b)return d;if(q&&b.map===q)return b.map(a,B);c(b,function(b,c,n){d.push(a.call(B,b,c,n))});return d};a.reduce=a.foldl=a.inject=function(b,m,B,d){var n=2<arguments.length;null==b&&(b=[]);if(w&&b.reduce===
w)return d&&(m=a.bind(m,d)),n?b.reduce(m,B):b.reduce(m);c(b,function(b,a,c){n?B=m.call(d,B,b,a,c):(B=b,n=!0)});if(!n)throw new TypeError("Reduce of empty array with no initial value");return B};a.reduceRight=a.foldr=function(b,m,B,n){var f=2<arguments.length;null==b&&(b=[]);if(d&&b.reduceRight===d)return n&&(m=a.bind(m,n)),f?b.reduceRight(m,B):b.reduceRight(m);var x=b.length;if(x!==+x)var e=a.keys(b),x=e.length;c(b,function(a,c,d){c=e?e[--x]:--x;f?B=m.call(n,B,b[c],c,d):(B=b[c],f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");
return B};a.find=a.detect=function(b,a,c){var d;n(b,function(b,n,x){if(a.call(c,b,n,x))return d=b,!0});return d};a.filter=a.select=function(b,a,B){var d=[];if(null==b)return d;if(s&&b.filter===s)return b.filter(a,B);c(b,function(b,c,n){a.call(B,b,c,n)&&d.push(b)});return d};a.reject=function(b,m,c){return a.filter(b,function(b,a,d){return!m.call(c,b,a,d)},c)};a.every=a.all=function(b,m,B){m||(m=a.identity);var d=!0;if(null==b)return d;if(D&&b.every===D)return b.every(m,B);c(b,function(b,a,c){if(!(d=
d&&m.call(B,b,a,c)))return g});return!!d};var n=a.some=a.any=function(b,m,B){m||(m=a.identity);var d=!1;if(null==b)return d;if(z&&b.some===z)return b.some(m,B);c(b,function(b,a,c){if(d||(d=m.call(B,b,a,c)))return g});return!!d};a.contains=a.include=function(b,a){return null==b?!1:r&&b.indexOf===r?-1!=b.indexOf(a):n(b,function(b){return b===a})};a.invoke=function(b,m){var c=h.call(arguments,2),d=a.isFunction(m);return a.map(b,function(b){return(d?m:b[m]).apply(b,c)})};a.pluck=function(b,m){return a.map(b,
function(b){return b[m]})};a.where=function(b,m,c){return a.isEmpty(m)?c?void 0:[]:a[c?"find":"filter"](b,function(b){for(var a in m)if(m[a]!==b[a])return!1;return!0})};a.findWhere=function(b,m){return a.where(b,m,!0)};a.max=function(b,m,B){if(!m&&a.isArray(b)&&b[0]===+b[0]&&65535>b.length)return Math.max.apply(Math,b);if(!m&&a.isEmpty(b))return-Infinity;var d={computed:-Infinity,value:-Infinity};c(b,function(b,a,c){a=m?m.call(B,b,a,c):b;a>d.computed&&(d={value:b,computed:a})});return d.value};a.min=
function(b,m,B){if(!m&&a.isArray(b)&&b[0]===+b[0]&&65535>b.length)return Math.min.apply(Math,b);if(!m&&a.isEmpty(b))return Infinity;var d={computed:Infinity,value:Infinity};c(b,function(b,a,c){a=m?m.call(B,b,a,c):b;a<d.computed&&(d={value:b,computed:a})});return d.value};a.shuffle=function(b){var m,B=0,d=[];c(b,function(b){m=a.random(B++);d[B-1]=d[m];d[m]=b});return d};var x=function(b){return a.isFunction(b)?b:function(a){return a[b]}};a.sortBy=function(b,m,c){var d=x(m);return a.pluck(a.map(b,function(b,
a,m){return{value:b,index:a,criteria:d.call(c,b,a,m)}}).sort(function(b,a){var m=b.criteria,c=a.criteria;if(m!==c){if(m>c||void 0===m)return 1;if(m<c||void 0===c)return-1}return b.index<a.index?-1:1}),"value")};var K=function(b,m,d,n){var f={},e=x(null==m?a.identity:m);c(b,function(a,m){var c=e.call(d,a,m,b);n(f,c,a)});return f};a.groupBy=function(b,m,c){return K(b,m,c,function(b,m,c){(a.has(b,m)?b[m]:b[m]=[]).push(c)})};a.countBy=function(b,m,c){return K(b,m,c,function(b,m){a.has(b,m)||(b[m]=0);
b[m]++})};a.sortedIndex=function(b,m,c,d){c=null==c?a.identity:x(c);m=c.call(d,m);for(var n=0,f=b.length;n<f;){var e=n+f>>>1;c.call(d,b[e])<m?n=e+1:f=e}return n};a.toArray=function(b){return b?a.isArray(b)?h.call(b):b.length===+b.length?a.map(b,a.identity):a.values(b):[]};a.size=function(b){return null==b?0:b.length===+b.length?b.length:a.keys(b).length};a.first=a.head=a.take=function(b,a,c){return null==b?void 0:null==a||c?b[0]:h.call(b,0,a)};a.initial=function(b,a,c){return h.call(b,0,b.length-
(null==a||c?1:a))};a.last=function(b,a,c){return null==b?void 0:null==a||c?b[b.length-1]:h.call(b,Math.max(b.length-a,0))};a.rest=a.tail=a.drop=function(b,a,c){return h.call(b,null==a||c?1:a)};a.compact=function(b){return a.filter(b,a.identity)};var v=function(b,m,d){if(m&&a.every(b,a.isArray))return l.apply(d,b);c(b,function(b){a.isArray(b)||a.isArguments(b)?m?k.apply(d,b):v(b,m,d):d.push(b)});return d};a.flatten=function(b,a){return v(b,a,[])};a.without=function(b){return a.difference(b,h.call(arguments,
1))};a.uniq=a.unique=function(b,m,d,n){a.isFunction(m)&&(n=d,d=m,m=!1);d=d?a.map(b,d,n):b;var f=[],x=[];c(d,function(c,d){(m?d&&x[x.length-1]===c:a.contains(x,c))||(x.push(c),f.push(b[d]))});return f};a.union=function(){return a.uniq(a.flatten(arguments,!0))};a.intersection=function(b){var c=h.call(arguments,1);return a.filter(a.uniq(b),function(b){return a.every(c,function(c){return 0<=a.indexOf(c,b)})})};a.difference=function(b){var c=l.apply(e,h.call(arguments,1));return a.filter(b,function(b){return!a.contains(c,
b)})};a.zip=function(){for(var b=a.max(a.pluck(arguments,"length").concat(0)),c=Array(b),d=0;d<b;d++)c[d]=a.pluck(arguments,""+d);return c};a.object=function(b,a){if(null==b)return{};for(var c={},d=0,n=b.length;d<n;d++)a?c[b[d]]=a[d]:c[b[d][0]]=b[d][1];return c};a.indexOf=function(b,c,d){if(null==b)return-1;var n=0,f=b.length;if(d)if("number"==typeof d)n=0>d?Math.max(0,f+d):d;else return n=a.sortedIndex(b,c),b[n]===c?n:-1;if(r&&b.indexOf===r)return b.indexOf(c,d);for(;n<f;n++)if(b[n]===c)return n;
return-1};a.lastIndexOf=function(b,a,c){if(null==b)return-1;var d=null!=c;if(A&&b.lastIndexOf===A)return d?b.lastIndexOf(a,c):b.lastIndexOf(a);for(c=d?c:b.length;c--;)if(b[c]===a)return c;return-1};a.range=function(b,a,c){1>=arguments.length&&(a=b||0,b=0);c=arguments[2]||1;for(var d=Math.max(Math.ceil((a-b)/c),0),n=0,f=Array(d);n<d;)f[n++]=b,b+=c;return f};var y=function(){};a.bind=function(b,c){var d,n;if(E&&b.bind===E)return E.apply(b,h.call(arguments,1));if(!a.isFunction(b))throw new TypeError;
d=h.call(arguments,2);return n=function(){if(!(this instanceof n))return b.apply(c,d.concat(h.call(arguments)));y.prototype=b.prototype;var a=new y;y.prototype=null;var f=b.apply(a,d.concat(h.call(arguments)));return Object(f)===f?f:a}};a.partial=function(b){var a=h.call(arguments,1);return function(){return b.apply(this,a.concat(h.call(arguments)))}};a.bindAll=function(b){var d=h.call(arguments,1);if(0===d.length)throw Error("bindAll must be passed function names");c(d,function(c){b[c]=a.bind(b[c],
b)});return b};a.memoize=function(b,c){var d={};c||(c=a.identity);return function(){var n=c.apply(this,arguments);return a.has(d,n)?d[n]:d[n]=b.apply(this,arguments)}};a.delay=function(b,a){var c=h.call(arguments,2);return setTimeout(function(){return b.apply(null,c)},a)};a.defer=function(b){return a.delay.apply(a,[b,1].concat(h.call(arguments,1)))};a.throttle=function(b,a,c){var d,n,f,x=null,e=0;c||(c={});var h=function(){e=!1===c.leading?0:new Date;x=null;f=b.apply(d,n)};return function(){var v=
new Date;e||!1!==c.leading||(e=v);var k=a-(v-e);d=this;n=arguments;0>=k?(clearTimeout(x),x=null,e=v,f=b.apply(d,n)):x||!1===c.trailing||(x=setTimeout(h,k));return f}};a.debounce=function(b,a,c){var d,n=null;return function(){var f=this,x=arguments,e=c&&!n;clearTimeout(n);n=setTimeout(function(){n=null;c||(d=b.apply(f,x))},a);e&&(d=b.apply(f,x));return d}};a.once=function(b){var a=!1,c;return function(){if(a)return c;a=!0;c=b.apply(this,arguments);b=null;return c}};a.wrap=function(b,a){return function(){var c=
[b];k.apply(c,arguments);return a.apply(this,c)}};a.compose=function(){var b=arguments;return function(){for(var a=arguments,c=b.length-1;0<=c;c--)a=[b[c].apply(this,a)];return a[0]}};a.after=function(b,a){return function(){if(1>--b)return a.apply(this,arguments)}};a.keys=F||function(b){if(b!==Object(b))throw new TypeError("Invalid object");var c=[],d;for(d in b)a.has(b,d)&&c.push(d);return c};a.values=function(b){var c=[],d;for(d in b)a.has(b,d)&&c.push(b[d]);return c};a.pairs=function(b){var c=
[],d;for(d in b)a.has(b,d)&&c.push([d,b[d]]);return c};a.invert=function(b){var c={},d;for(d in b)a.has(b,d)&&(c[b[d]]=d);return c};a.functions=a.methods=function(b){var c=[],d;for(d in b)a.isFunction(b[d])&&c.push(d);return c.sort()};a.extend=function(b){c(h.call(arguments,1),function(a){if(a)for(var c in a)b[c]=a[c]});return b};a.pick=function(b){var a={},d=l.apply(e,h.call(arguments,1));c(d,function(c){c in b&&(a[c]=b[c])});return a};a.omit=function(b){var c={},d=l.apply(e,h.call(arguments,1)),
n;for(n in b)a.contains(d,n)||(c[n]=b[n]);return c};a.defaults=function(b){c(h.call(arguments,1),function(a){if(a)for(var c in a)void 0===b[c]&&(b[c]=a[c])});return b};a.clone=function(b){return a.isObject(b)?a.isArray(b)?b.slice():a.extend({},b):b};a.tap=function(a,c){c(a);return a};var J=function(b,c,d,n){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b instanceof a&&(b=b._wrapped);c instanceof a&&(c=c._wrapped);var x=f.call(b);if(x!=f.call(c))return!1;switch(x){case "[object String]":return b==
String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==+c;case "[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var e=d.length;e--;)if(d[e]==b)return n[e]==c;var e=b.constructor,h=c.constructor;if(e!==h&&!(a.isFunction(e)&&e instanceof e&&a.isFunction(h)&&h instanceof h))return!1;d.push(b);n.push(c);e=0;
h=!0;if("[object Array]"==x){if(e=b.length,h=e==c.length)for(;e--&&(h=J(b[e],c[e],d,n)););}else{for(var v in b)if(a.has(b,v)&&(e++,!(h=a.has(c,v)&&J(b[v],c[v],d,n))))break;if(h){for(v in c)if(a.has(c,v)&&!e--)break;h=!e}}d.pop();n.pop();return h};a.isEqual=function(a,c){return J(a,c,[],[])};a.isEmpty=function(b){if(null==b)return!0;if(a.isArray(b)||a.isString(b))return 0===b.length;for(var c in b)if(a.has(b,c))return!1;return!0};a.isElement=function(a){return!(!a||1!==a.nodeType)};a.isArray=t||function(a){return"[object Array]"==
f.call(a)};a.isObject=function(a){return a===Object(a)};c("Arguments Function String Number Date RegExp".split(" "),function(b){a["is"+b]=function(a){return f.call(a)=="[object "+b+"]"}});a.isArguments(arguments)||(a.isArguments=function(b){return!(!b||!a.has(b,"callee"))});"function"!==typeof/./&&(a.isFunction=function(a){return"function"===typeof a});a.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};a.isNaN=function(b){return a.isNumber(b)&&b!=+b};a.isBoolean=function(a){return!0===
a||!1===a||"[object Boolean]"==f.call(a)};a.isNull=function(a){return null===a};a.isUndefined=function(a){return void 0===a};a.has=function(a,c){return u.call(a,c)};a.noConflict=function(){C._=p;return this};a.identity=function(a){return a};a.times=function(a,c,d){for(var n=Array(Math.max(0,a)),f=0;f<a;f++)n[f]=c.call(d,f);return n};a.random=function(a,c){null==c&&(c=a,a=0);return a+Math.floor(Math.random()*(c-a+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
I.unescape=a.invert(I.escape);var M={escape:RegExp("["+a.keys(I.escape).join("")+"]","g"),unescape:RegExp("("+a.keys(I.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(b){a[b]=function(a){return null==a?"":(""+a).replace(M[b],function(a){return I[b][a]})}});a.result=function(b,c){if(null!=b){var d=b[c];return a.isFunction(d)?d.call(b):d}};a.mixin=function(b){c(a.functions(b),function(c){var d=a[c]=b[c];a.prototype[c]=function(){var b=[this._wrapped];k.apply(b,arguments);b=d.apply(a,
b);return this._chain?a(b).chain():b}})};var O=0;a.uniqueId=function(a){var c=++O+"";return a?a+c:c};a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Q=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(b,c,d){var n;d=a.defaults({},d,a.templateSettings);var f=RegExp([(d.escape||Q).source,(d.interpolate||Q).source,(d.evaluate||Q).source].join("|")+
"|$","g"),x=0,e="__p+='";b.replace(f,function(a,c,d,n,f){e+=b.slice(x,f).replace(H,function(a){return"\\"+N[a]});c&&(e+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");d&&(e+="'+\n((__t=("+d+"))==null?'':__t)+\n'");n&&(e+="';\n"+n+"\n__p+='");x=f+a.length;return a});e+="';\n";d.variable||(e="with(obj||{}){\n"+e+"}\n");e="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+e+"return __p;\n";try{n=new Function(d.variable||"obj","_",e)}catch(h){throw h.source=
e,h;}if(c)return n(c,a);c=function(b){return n.call(this,b,a)};c.source="function("+(d.variable||"obj")+"){\n"+e+"}";return c};a.chain=function(b){return a(b).chain()};a.mixin(a);c("pop push reverse shift sort splice unshift".split(" "),function(b){var c=e[b];a.prototype[b]=function(){var d=this._wrapped;c.apply(d,arguments);"shift"!=b&&"splice"!=b||0!==d.length||delete d[0];return this._chain?a(d).chain():d}});c(["concat","join","slice"],function(b){var c=e[b];a.prototype[b]=function(){var b=c.apply(this._wrapped,
arguments);return this._chain?a(b).chain():b}});a.extend(a.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var C=[].slice,p=function(e,g,k){var h;e=-1;var l=g.length;switch(k.length){case 0:for(;++e<l;)(h=g[e]).callback.call(h.ctx);break;case 1:for(;++e<l;)(h=g[e]).callback.call(h.ctx,k[0]);break;case 2:for(;++e<l;)(h=g[e]).callback.call(h.ctx,k[0],k[1]);break;case 3:for(;++e<l;)(h=g[e]).callback.call(h.ctx,k[0],k[1],k[2]);break;default:for(;++e<l;)(h=g[e]).callback.apply(h.ctx,k)}},g=Backbone.Events={on:function(e,g,k){this._events||(this._events={});(this._events[e]||(this._events[e]=[])).push({callback:g,
context:k,ctx:k||this});return this},once:function(e,g,k){var h=this,l=_.once(function(){h.off(e,l);g.apply(this,arguments)});l._callback=g;this.on(e,l,k);return this},off:function(e,g,k){var h,l,f,u,p,q,w,d;if(!this._events)return this;if(!e&&!g&&!k)return this._events={},this;u=e?[e]:_.keys(this._events);p=0;for(q=u.length;p<q;p++)if(e=u[p],h=this._events[e]){f=[];if(g||k)for(w=0,d=h.length;w<d;w++)l=h[w],(g&&g!==(l.callback._callback||l.callback)||k&&k!==l.context)&&f.push(l);this._events[e]=f}return this},
trigger:function(e){if(!this._events)return this;var g=C.call(arguments,1),k=this._events[e],h=this._events.all;k&&p(this,k,g);h&&p(this,h,arguments);return this},listenTo:function(e,g,k){var h=this._listeners||(this._listeners={}),l=e._listenerId||(e._listenerId=_.uniqueId("l"));h[l]=e;e.on(g,k||this,this);return this},stopListening:function(e,g,k){var h=this._listeners;if(h){if(e)e.off(g,k,this),g||k||delete h[e._listenerId];else{for(var l in h)h[l].off(null,null,this);this._listeners={}}return this}}};
g.bind=g.on;g.unbind=g.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=g),exports.Backbone=exports.Backbone||Backbone)})();(function(){function C(e,h){var l=(new Date).getTime(),f=Math.max(0,16-(l-g)),u=p.setTimeout(function(){e(l+f)},f);g=l+f;return u}var p=this,g=0,e=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=C),exports.requestAnimationFrame=C;else{for(var t=0;t<e.length&&!p.requestAnimationFrame;++t)p.requestAnimationFrame=p[e[t]+"RequestAnimationFrame"],p.cancelAnimationFrame=p[e[t]+"CancelAnimationFrame"]||p[e[t]+"CancelRequestAnimationFrame"];
p.requestAnimationFrame||(p.requestAnimationFrame=C);p.cancelAnimationFrame||(p.cancelAnimationFrame=function(e){clearTimeout(e)})}})();(function(){function C(){var a=document.body.getBoundingClientRect(),c=this.width=a.width,a=this.height=a.height;this.renderer.setSize(c,a,this.ratio);this.trigger(d.Events.resize,c,a)}var p=this,g=p.Two||{},e=Math.sin,t=Math.cos,k=Math.atan2,h=Math.sqrt,l=Math.PI,f=2*l,u=l/2,G=Math.pow,q=0,w={hasEventListeners:_.isFunction(p.addEventListener),bind:function(a,c,d,e){this.hasEventListeners?a.addEventListener(c,d,!!e):a.attachEvent("on"+c,d);return this},unbind:function(a,c,d,e){this.hasEventListeners?
a.removeEventListeners(c,d,!!e):a.detachEvent("on"+c,d);return this}},d=p.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:d.Types.svg,autostart:!1});_.each(a,function(a,d){"fullscreen"!==d&&("width"!==d&&"height"!==d&&"autostart"!==d)&&(this[d]=a)},this);_.isElement(a.domElement)&&(this.type=d.Types[a.domElement.tagName.toLowerCase()]);this.renderer=new d[this.type](this);d.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(C,this),_.extend(document.body.style,
{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),w.bind(p,"resize",a),a()):_.isElement(a.domElement)||(this.renderer.setSize(a.width,a.height,this.ratio),this.width=a.width,this.height=a.height);this.scene=this.renderer.scene;d.Instances.push(this)};_.extend(d,{Array:p.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},
Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){p.Two=g;return this},uniqueId:function(){var a=q;q++;return a},Utils:{release:function(a){_.isObject(a)&&(_.isFunction(a.unbind)&&a.unbind(),a.vertices&&(_.isFunction(a.vertices.unbind)&&
a.vertices.unbind(),_.each(a.vertices,function(a){_.isFunction(a.unbind)&&a.unbind()})),a.children&&_.each(a.children,function(a){d.Utils.release(a)}))},Curve:{CollinearityEpsilon:G(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},devicePixelRatio:p.devicePixelRatio||1,getBackingStoreRatio:function(a){return a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1},getRatio:function(a){return d.Utils.devicePixelRatio/
F(a)},setPlaying:function(a){this.playing=!!a;return this},getComputedMatrix:function(a,c){var n=[];c=c&&c.identity()||new d.Matrix;for(var e=a;e&&e._matrix;)n.push(e._matrix),e=e.parent;n.reverse();_.each(n,function(a){a=a.elements;c.multiply(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9])});return c},applySvgAttributes:function(a,c){_.each(a.attributes,function(a,d){switch(a.nodeName){case "visibility":c.visible=!!a.nodeValue;break;case "stroke-linecap":c.cap=a.nodeValue;break;case "stroke-linejoin":c.join=
a.nodeValue;break;case "stroke-miterlimit":c.miter=a.nodeValue;break;case "stroke-width":c.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":case "opacity":c.opacity=a.nodeValue;break;case "fill":c.fill=a.nodeValue;break;case "stroke":c.stroke=a.nodeValue;break;case "id":c.id=a.nodeValue}});return c},read:{svg:function(){return d.Utils.read.g.apply(this,arguments)},g:function(a){var c=new d.Group;this.add(c);_.each(a.childNodes,function(a){var e=a.nodeName;e&&(e=e.replace(/svg\:/ig,
"").toLowerCase(),e in d.Utils.read&&(a=d.Utils.read[e].call(this,a),c.add(a)))},this);return d.Utils.applySvgAttributes(a,c)},polygon:function(a,c){var e=[];a.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,function(a,c,f){e.push(new d.Anchor(parseFloat(c),parseFloat(f)))});var f=(new d.Polygon(e,!c)).noStroke();f.fill="black";return d.Utils.applySvgAttributes(a,f)},polyline:function(a){return d.Utils.read.polygon(a,!0)},path:function(a){var c,e,f,h=!1,v=!1,g=a.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),
k=g.length-1,g=_.flatten(_.map(g,function(a,g){var l,s,u=a[0],H=u.toLowerCase();f=a.slice(1).trim();f=f.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,c){return parseFloat(b)*Math.pow(10,c)});f=f.split(/[\s,]+|(?=\s?[+\-])/);h=u===H;var b,m,r,q;switch(H){case "z":g>=k?v=!0:(s=c.x,l=c.y,l=new d.Anchor(s,l,void 0,void 0,void 0,void 0,d.Commands.close));break;case "m":case "l":s=parseFloat(f[0]);l=parseFloat(f[1]);l=new d.Anchor(s,l,void 0,void 0,void 0,void 0,"m"===H?d.Commands.move:d.Commands.line);
h&&l.addSelf(c);c=l;break;case "h":case "v":s="h"===H?"x":"y";u="x"===s?"y":"x";l=new d.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,d.Commands.line);l[s]=parseFloat(f[0]);l[u]=c[u];h&&(l[s]+=c[s]);c=l;break;case "s":case "c":l=c.x;u=c.y;e||(e=(new d.Vector).copy(c));"c"===H?(b=parseFloat(f[0]),s=parseFloat(f[1]),H=parseFloat(f[2]),m=parseFloat(f[3]),r=parseFloat(f[4]),q=parseFloat(f[5])):(m=d.Utils.getReflection(c,e,h),b=m.x,s=m.y,H=parseFloat(f[0]),m=parseFloat(f[1]),r=parseFloat(f[2]),q=parseFloat(f[3]));
h&&(b+=l,s+=u,H+=l,m+=u,r+=l,q+=u);_.isObject(c.controls)||d.Anchor.AppendCurveProperties(c);c.controls.right.set(b-c.x,s-c.y);c=l=new d.Anchor(r,q,H-r,m-q,void 0,void 0,d.Commands.curve);e=l.controls.left;break;case "t":case "q":l=c.x;u=c.y;e||(e=(new d.Vector).copy(c));e.isZero()?(b=l,s=u):(b=e.x,u=e.y);"q"===H?(H=parseFloat(f[0]),m=parseFloat(f[1]),r=parseFloat(f[1]),q=parseFloat(f[2])):(m=d.Utils.getReflection(c,e,h),H=m.x,m=m.y,r=parseFloat(f[0]),q=parseFloat(f[1]));h&&(b+=l,s+=u,H+=l,m+=u,r+=
l,q+=u);_.isObject(c.controls)||d.Anchor.AppendCurveProperties(c);c.controls.right.set(b-c.x,s-c.y);c=l=new d.Anchor(r,q,H-r,m-q,void 0,void 0,d.Commands.curve);e=l.controls.left;break;case "a":throw new d.Utils.Error("not yet able to interpret Elliptical Arcs.");}return l}));if(!(1>=g.length))return g=_.compact(g),g=(new d.Polygon(g,v,void 0,!0)).noStroke(),g.fill="black",d.Utils.applySvgAttributes(a,g)},circle:function(a){var c=parseFloat(a.getAttribute("cx")),n=parseFloat(a.getAttribute("cy")),
h=parseFloat(a.getAttribute("r")),g=d.Resolution,v=_.map(_.range(g),function(a){var c=a/g*f;a=h*t(c);c=h*e(c);return new d.Anchor(a,c)},this),v=(new d.Polygon(v,!0,!0)).noStroke();v.translation.set(c,n);v.fill="black";return d.Utils.applySvgAttributes(a,v)},ellipse:function(a){var c=parseFloat(a.getAttribute("cx")),n=parseFloat(a.getAttribute("cy")),h=parseFloat(a.getAttribute("rx")),g=parseFloat(a.getAttribute("ry")),v=d.Resolution,l=_.map(_.range(v),function(a){var c=a/v*f;a=h*t(c);c=g*e(c);return new d.Anchor(a,
c)},this),l=(new d.Polygon(l,!0,!0)).noStroke();l.translation.set(c,n);l.fill="black";return d.Utils.applySvgAttributes(a,l)},rect:function(a){var c=parseFloat(a.getAttribute("x")),e=parseFloat(a.getAttribute("y")),f=parseFloat(a.getAttribute("width")),h=parseFloat(a.getAttribute("height")),f=f/2,h=h/2,g=[new d.Anchor(f,h),new d.Anchor(-f,h),new d.Anchor(-f,-h),new d.Anchor(f,-h)],g=(new d.Polygon(g,!0)).noStroke();g.translation.set(c+f,e+h);g.fill="black";return d.Utils.applySvgAttributes(a,g)},
line:function(a){var c=parseFloat(a.getAttribute("x1")),f=parseFloat(a.getAttribute("y1")),e=parseFloat(a.getAttribute("x2")),h=parseFloat(a.getAttribute("y2")),e=(e-c)/2,h=(h-f)/2,g=[new d.Anchor(-e,-h),new d.Anchor(e,h)],g=(new d.Polygon(g)).noFill();g.translation.set(c+e,f+h);return d.Utils.applySvgAttributes(a,g)}},subdivide:function(a,c,f,e,h,g,l,s,k){k=k||d.Utils.Curve.RecursionLimit;var u=k+1;return a===l&&c===s?[new d.Anchor(l,s)]:_.map(_.range(0,u),function(k){var r=k/u;k=E(r,a,f,h,l);r=
E(r,c,e,g,s);return new d.Anchor(k,r)})},getPointOnCubicBezier:function(a,c,d,f,e){var h=1-a;return h*h*h*c+3*h*h*a*d+3*h*a*a*f+a*a*a*e},getCurveFromPoints:function(a,c){for(var f=a.length,e=f-1,h=0;h<f;h++){var g=a[h];_.isObject(g.controls)||d.Anchor.AppendCurveProperties(g);var l=c?A(h-1,f):Math.max(h-1,0),s=c?A(h+1,f):Math.min(h+1,e);r(a[l],g,a[s]);g._command=0===h?d.Commands.move:d.Commands.curve;g.controls.left.x=_.isNumber(g.controls.left.x)?g.controls.left.x:g.x;g.controls.left.y=_.isNumber(g.controls.left.y)?
g.controls.left.y:g.y;g.controls.right.x=_.isNumber(g.controls.right.x)?g.controls.right.x:g.x;g.controls.right.y=_.isNumber(g.controls.right.y)?g.controls.right.y:g.y}},getControlPoints:function(a,c,f){var h=z(a,c),g=z(f,c);a=s(a,c);f=s(f,c);var k=(h+g)/2;c.u=_.isObject(c.controls.left)?c.controls.left:new d.Vector(0,0);c.v=_.isObject(c.controls.right)?c.controls.right:new d.Vector(0,0);if(1E-4>a||1E-4>f)return c._relative||(c.controls.left.copy(c),c.controls.right.copy(c)),c;a*=0.33;f*=0.33;k=g<
h?k+u:k-u;c.controls.left.x=t(k)*a;c.controls.left.y=e(k)*a;k-=l;c.controls.right.x=t(k)*f;c.controls.right.y=e(k)*f;c._relative||(c.controls.left.x+=c.x,c.controls.left.y+=c.y,c.controls.right.x+=c.x,c.controls.right.y+=c.y);return c},getReflection:function(a,c,f){var e=c.distanceTo(d.Vector.zero);c=z(d.Vector.zero,c);return new d.Vector(e*Math.cos(c)+(f?0:a.x),e*Math.sin(c)+(f?0:a.y))},angleBetween:function(a,c){var d,f;if(4<=arguments.length)return d=arguments[0]-arguments[2],f=arguments[1]-arguments[3],
k(f,d);d=a.x-c.x;f=a.y-c.y;return k(f,d)},distanceBetweenSquared:function(a,c){var d=a.x-c.x,f=a.y-c.y;return d*d+f*f},distanceBetween:function(a,c){return h(D(a,c))},mod:function(a,c){for(;0>a;)a+=c;return a%c},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=a}}});d.Utils.Error.prototype=Error();d.Utils.Error.prototype.constructor=
d.Utils.Error;d.Utils.Collection.prototype=[];d.Utils.Collection.constructor=d.Utils.Collection;_.extend(d.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(d.Events.remove,[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(d.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);this.trigger(d.Events.insert,arguments);return a},unshift:function(){var a=
Array.prototype.unshift.apply(this,arguments);this.trigger(d.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,arguments),c;this.trigger(d.Events.remove,a);2<arguments.length&&(c=this.slice(arguments[0],arguments.length-2),this.trigger(d.Events.insert,c));return a}});var s=d.Utils.distanceBetween,D=d.Utils.distanceBetweenSquared,z=d.Utils.angleBetween,r=d.Utils.getControlPoints,A=d.Utils.mod,F=d.Utils.getBackingStoreRatio,E=d.Utils.getPointOnCubicBezier;
_.extend(d.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){d.Utils.setPlaying.call(this,!0);return this.trigger(d.Events.play)},pause:function(){this.playing=!1;return this.trigger(d.Events.pause)},update:function(){var a=!!this._lastFrame,c=(p.performance&&p.performance.now?p.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((c-this._lastFrame).toFixed(3)));this._lastFrame=c;var a=this.width,c=this.height,
f=this.renderer;a===f.width&&c===f.height||f.setSize(a,c,this.ratio);this.trigger(d.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(d.Events.render,this.frameCount)},add:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));this.scene.add(c);return this},remove:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));this.scene.remove(c);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));
return this},makeLine:function(a,c,f,e){f=(f-a)/2;e=(e-c)/2;var h=[new d.Anchor(-f,-e),new d.Anchor(f,e)],h=(new d.Polygon(h)).noFill();h.translation.set(a+f,c+e);this.scene.add(h);return h},makeRectangle:function(a,c,f,e){f/=2;e/=2;e=[new d.Anchor(-f,-e),new d.Anchor(f,-e),new d.Anchor(f,e),new d.Anchor(-f,e)];e=new d.Polygon(e,!0);e.translation.set(a,c);this.scene.add(e);return e},makeCircle:function(a,c,d){return this.makeEllipse(a,c,d,d)},makeEllipse:function(a,c,h,g){var l=d.Resolution,k=_.map(_.range(l),
function(a){var c=a/l*f;a=h*t(c);c=g*e(c);return new d.Anchor(a,c)},this),k=new d.Polygon(k,!0,!0);k.translation.set(a,c);this.scene.add(k);return k},makeCurve:function(a){var c=arguments.length,f=a;if(!_.isArray(a))for(var f=[],e=0;e<c;e+=2){var h=arguments[e];if(!_.isNumber(h))break;f.push(new d.Anchor(h,arguments[e+1]))}var c=arguments[c-1],f=new d.Polygon(f,!(_.isBoolean(c)&&c),!0),c=f.getBoundingClientRect(),g=c.left+c.width/2,l=c.top+c.height/2;_.each(f.vertices,function(a){a.x-=g;a.y-=l});
f.translation.set(g,l);this.scene.add(f);return f},makePolygon:function(a){var c=arguments.length,f=a;if(!_.isArray(a))for(var f=[],e=0;e<c;e+=2){var h=arguments[e];if(!_.isNumber(h))break;f.push(new d.Anchor(h,arguments[e+1]))}c=arguments[c-1];f=new d.Polygon(f,!(_.isBoolean(c)&&c));c=f.getBoundingClientRect();f.center().translation.set(c.left+c.width/2,c.top+c.height/2);this.scene.add(f);return f},makeGroup:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));var f=new d.Group;this.scene.add(f);
f.add(c);return f},interpret:function(a){var c=a.tagName.toLowerCase();if(!(c in d.Utils.read))return null;a=d.Utils.read[c].call(this,a);this.add(a);return a}});(function(){requestAnimationFrame(arguments.callee);_.each(d.Instances,function(a){a.playing&&a.update()})})();"function"===typeof define&&define.amd?define(function(){return d}):"undefined"!=typeof module&&module.exports&&(module.exports=d)})();(function(){var C,p,g,e,t=Two.Vector=function(f,e){this.x=f||0;this.y=e||0};_.extend(t,{zero:new Two.Vector});_.extend(t.prototype,Backbone.Events,{set:function(f,e){this.x=f;this.y=e;return this},copy:function(f){this.x=f.x;this.y=f.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new t(this.x,this.y)},add:function(f,e){this.x=f.x+e.x;this.y=f.y+e.y;return this},addSelf:function(f){this.x+=f.x;this.y+=f.y;return this},sub:function(f,e){this.x=f.x-e.x;this.y=f.y-
e.y;return this},subSelf:function(f){this.x-=f.x;this.y-=f.y;return this},multiplySelf:function(f){this.x*=f.x;this.y*=f.y;return this},multiplyScalar:function(f){this.x*=f;this.y*=f;return this},divideScalar:function(f){f?(this.x/=f,this.y/=f):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(f){return this.x*f.x+this.y*f.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(f){return Math.sqrt(this.distanceToSquared(f))},distanceToSquared:function(f){g=this.x-f.x;e=this.y-f.y;return g*g+e*e},setLength:function(f){return this.normalize().multiplyScalar(f)},equals:function(f){return 1E-4>this.distanceTo(f)},lerp:function(f,e){C=(f.x-this.x)*e+this.x;p=(f.y-this.y)*e+this.y;return this.set(C,p)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var k={set:function(f,
e){this._x=f;this._y=e;return this.trigger(Two.Events.change)},copy:function(f){this._x=f.x;this._y=f.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new t(this._x,this._y)},add:function(f,e){this._x=f.x+e.x;this._y=f.y+e.y;return this.trigger(Two.Events.change)},addSelf:function(f){this._x+=f.x;this._y+=f.y;return this.trigger(Two.Events.change)},sub:function(f,e){this._x=f.x-e.x;this._y=f.y-e.y;return this.trigger(Two.Events.change)},
subSelf:function(f){this._x-=f.x;this._y-=f.y;return this.trigger(Two.Events.change)},multiplySelf:function(f){this._x*=f.x;this._y*=f.y;return this.trigger(Two.Events.change)},multiplyScalar:function(f){this._x*=f;this._y*=f;return this.trigger(Two.Events.change)},divideScalar:function(f){return f?(this._x/=f,this._y/=f,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(f){return this._x*f.x+this._y*f.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(f){return Math.sqrt(this.distanceToSquared(f))},distanceToSquared:function(f){g=this._x-f.x;e=this._y-f.y;return g*g+e*e},setLength:function(f){return this.normalize().multiplyScalar(f)},equals:function(f){return 1E-4>this.distanceTo(f)},lerp:function(f,e){C=(f.x-this._x)*e+this._x;p=(f.y-this._y)*e+this._y;return this.set(C,p)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},h={get:function(){return this._x},set:function(f){this._x=f;this.trigger(Two.Events.change,"x")}},l={get:function(){return this._y},set:function(f){this._y=f;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",h),Object.defineProperty(this,"y",l),_.extend(this,k),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var C=Two.Commands,p,g,e,t=Two.Anchor=function(e,g,f,k,p,q,w){Two.Vector.call(this,e,g);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);this._command=w||C.move;this._relative=!0;if(!w)return this;t.AppendCurveProperties(this);_.isNumber(f)&&(this.controls.left.x=f);_.isNumber(k)&&(this.controls.left.y=k);_.isNumber(p)&&(this.controls.right.x=p);_.isNumber(q)&&(this.controls.right.y=q)};_.extend(t,{AppendCurveProperties:function(e){e.controls={left:new Two.Vector(0,
0),right:new Two.Vector(0,0)}}});var k={listen:function(){_.isObject(this.controls)||t.AppendCurveProperties(this);_.each(this.controls,function(e){e.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,function(e){e.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){g=this.controls;e=new Two.Anchor(this.x,this.y,g&&g.left.x,g&&g.left.y,g&&g.right.x,g&&g.right.y,this.command);e.relative=this._relative;return e},toObject:function(){p=
{x:this.x,y:this.y};this._command&&(p.command=this._command);this._relative&&(p.relative=this._relative);this.controls&&(p.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()});return p}};Object.defineProperty(t.prototype,"command",{get:function(){return this._command},set:function(e){this._command=e;this._command!==C.curve||_.isObject(this.controls)||t.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});Object.defineProperty(t.prototype,"relative",
{get:function(){return this._relative},set:function(e){if(this._relative==e)return this;this._relative=!!e;return this.trigger(Two.Events.change)}});_.extend(t.prototype,Two.Vector.prototype,k);Two.Anchor.prototype.bind=Two.Anchor.prototype.on=function(){Two.Vector.prototype.bind.apply(this,arguments);_.extend(this,k)};Two.Anchor.prototype.unbind=Two.Anchor.prototype.off=function(){Two.Vector.prototype.unbind.apply(this,arguments);_.extend(this,k)}})();(function(){_.range(6);var C=Math.cos,p=Math.sin,g=Math.tan,e,t,k,h,l,f,u,G,q,w,d,s,D,z,r,A,F,E,a,c,n,x,K,v,y,J,I,M,O,Q,N,H,b,m,B,ea,P,R,aa,da,U,V,W,X,Y,ba,ca,Z,S,$=[],fa=Two.Matrix=function(a,b,c,d,e,f){this.elements=new Two.Array(9);var h=a;_.isArray(h)||(h=_.toArray(arguments));this.identity().set(h)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(b,d,f){if(3>=d.length)return s,D,z,e=d[0]||0,t=d[1]||0,k=d[2]||0,l=b,s=l[0]*e+l[1]*t+l[2]*k,D=l[3]*e+l[4]*t+l[5]*k,z=l[6]*e+l[7]*t+l[8]*
k,{x:s,y:D,z:z};r=b[0];A=b[1];F=b[2];E=b[3];a=b[4];c=b[5];n=b[6];x=b[7];K=b[8];v=d[0];y=d[1];J=d[2];I=d[3];M=d[4];O=d[5];Q=d[6];N=d[7];H=d[8];f=f||new Two.Array(9);f[0]=r*v+A*I+F*Q;f[1]=r*y+A*M+F*N;f[2]=r*J+A*O+F*H;f[3]=E*v+a*I+c*Q;f[4]=E*y+a*M+c*N;f[5]=E*J+a*O+c*H;f[6]=n*v+x*I+K*Q;f[7]=n*y+x*M+K*N;f[8]=n*J+x*O+K*H;return f}});_.extend(fa.prototype,Backbone.Events,{set:function(a,b,c,f,e,h){d=a;B=arguments.length;_.isArray(d)||(d=_.toArray(arguments));_.each(d,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(f,e,h,g,l,k,q,p,ma){d=arguments;B=d.length;if(1>=B)return _.each(this.elements,function(a,b){this.elements[b]=a*f},this),this.trigger(Two.Events.change);if(3>=B)return s,D,z,f=f||0,e=e||0,h=h||0,l=this.elements,s=l[0]*f+l[1]*e+l[2]*h,D=l[3]*f+l[4]*e+l[5]*h,z=l[6]*f+l[7]*e+l[8]*h,{x:s,y:D,z:z};b=this.elements;m=d;r=b[0];A=b[1];F=b[2];E=b[3];a=b[4];c=b[5];n=b[6];x=b[7];K=b[8];v=
m[0];y=m[1];J=m[2];I=m[3];M=m[4];O=m[5];Q=m[6];N=m[7];H=m[8];this.elements[0]=r*v+A*I+F*Q;this.elements[1]=r*y+A*M+F*N;this.elements[2]=r*J+A*O+F*H;this.elements[3]=E*v+a*I+c*Q;this.elements[4]=E*y+a*M+c*N;this.elements[5]=E*J+a*O+c*H;this.elements[6]=n*v+x*I+K*Q;this.elements[7]=n*y+x*M+K*N;this.elements[8]=n*J+x*O+K*H;return this.trigger(Two.Events.change)},inverse:function(a){e=this.elements;a=a||new Two.Matrix;P=e[0];R=e[1];aa=e[2];da=e[3];U=e[4];V=e[5];W=e[6];X=e[7];Y=e[8];ba=Y*U-V*X;ca=-Y*da+
V*W;Z=X*da-U*W;S=P*ba+R*ca+aa*Z;if(!S)return null;S=1/S;a.elements[0]=ba*S;a.elements[1]=(-Y*R+aa*X)*S;a.elements[2]=(V*R-aa*U)*S;a.elements[3]=ca*S;a.elements[4]=(Y*P-aa*W)*S;a.elements[5]=(-V*P+aa*da)*S;a.elements[6]=Z*S;a.elements[7]=(-X*P+R*W)*S;a.elements[8]=(U*P-R*da)*S;return a},scale:function(a,b){B=arguments.length;1>=B&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){k=C(a);ea=p(a);return this.multiply(k,-ea,0,ea,k,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){e=g(a);return this.multiply(1,e,0,0,1,0,0,0,1)},skewY:function(a){e=g(a);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(a){this.toArray(a,$);return $.join(" ")},toArray:function(a,b){d=this.elements;w=!!b;e=parseFloat(d[0].toFixed(3));t=parseFloat(d[1].toFixed(3));k=parseFloat(d[2].toFixed(3));h=parseFloat(d[3].toFixed(3));l=parseFloat(d[4].toFixed(3));f=parseFloat(d[5].toFixed(3));if(a){u=parseFloat(d[6].toFixed(3));G=parseFloat(d[7].toFixed(3));q=
parseFloat(d[8].toFixed(3));if(w){b[0]=e;b[1]=h;b[2]=u;b[3]=t;b[4]=l;b[5]=G;b[6]=k;b[7]=f;b[8]=q;return}return[e,h,u,t,l,G,k,f,q]}if(w)b[0]=e,b[1]=h,b[2]=t,b[3]=l,b[4]=k,b[5]=f;else return[e,h,t,l,k,f]},clone:function(){e=this.elements[0];t=this.elements[1];k=this.elements[2];h=this.elements[3];l=this.elements[4];f=this.elements[5];u=this.elements[6];G=this.elements[7];q=this.elements[8];return new Two.Matrix(e,t,k,h,l,f,u,G,q)}})})();(function(){var C=Two.Utils.mod,p,g,e,t={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(h,l){e=h;g=document.createElementNS(this.ns,e);"svg"===e&&(l=_.defaults(l||{},{version:this.version}));_.isObject(l)&&t.setAttributes(g,l);return g},setAttribute:function(e,g){this.setAttribute(g,e)},setAttributes:function(e,g){_.each(g,t.setAttribute,e);return this},removeAttribute:function(e,g){this.removeAttribute(g)},removeAttributes:function(e,g){_.each(g,
t.removeAttribute,e);return this},toString:function(e,g){var f=e.length,k=f-1,p;return _.map(e,function(q,t){var d,s=g?C(t-1,f):Math.max(t-1,0),D=g?C(t+1,f):Math.min(t+1,k);d=e[s];var z=e[D],r,A,F,s=q.x.toFixed(3),z=q.y.toFixed(3);switch(q._command){case Two.Commands.close:d=Two.Commands.close;break;case Two.Commands.curve:r=d.controls&&d.controls.right||d;F=q.controls&&q.controls.left||q;d._relative?(D=(r.x+d.x).toFixed(3),r=(r.y+d.y).toFixed(3)):(D=r.x.toFixed(3),r=r.y.toFixed(3));q._relative?(A=
(F.x+q.x).toFixed(3),F=(F.y+q.y).toFixed(3)):(A=F.x.toFixed(3),F=F.y.toFixed(3));d=(0===t?Two.Commands.move:Two.Commands.curve)+" "+D+" "+r+" "+A+" "+F+" "+s+" "+z;break;case Two.Commands.move:p=q;d=Two.Commands.move+" "+s+" "+z;break;default:d=q._command+" "+s+" "+z}t>=k&&g&&(q._command===Two.Commands.curve&&(z=p,r=q.controls&&q.controls.right||q,s=z.controls&&z.controls.left||z,q._relative?(D=(r.x+q.x).toFixed(3),r=(r.y+q.y).toFixed(3)):(D=r.x.toFixed(3),r=r.y.toFixed(3)),z._relative?(A=(s.x+z.x).toFixed(3),
F=(s.y+z.y).toFixed(3)):(A=s.x.toFixed(3),F=s.y.toFixed(3)),s=z.x.toFixed(3),z=z.y.toFixed(3),d+=" C "+D+" "+r+" "+A+" "+F+" "+s+" "+z),d+=" Z");return d}).join(" ")},group:{appendChild:function(e){(g=this.domElement.querySelector("#"+e))&&this.elem.appendChild(g)},removeChild:function(e){(g=this.domElement.querySelector("#"+e))&&this.elem.removeChild(g)},renderChild:function(e){t[e._renderer.type].render.call(e,this)},render:function(e){this._update();this._renderer.elem||(this._renderer.elem=t.createElement("g",
{id:this.id}),e.appendChild(this._renderer.elem));p=this._matrix.manual||this._flagMatrix;var g={domElement:e,elem:this._renderer.elem};p&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");_.each(this.children,t.group.renderChild,e);this._flagAdditions&&_.each(this.additions,t.group.appendChild,g);this._flagSubtractions&&_.each(this.subtractions,t.group.removeChild,g);return this.flagReset()}},polygon:{render:function(e){this._update();this._renderer.elem||(this._renderer.elem=
t.createElement("path",{id:this.id}),e.appendChild(this._renderer.elem));g=this._renderer.elem;(p=this._matrix.manual||this._flagMatrix)&&g.setAttribute("transform","matrix("+this._matrix.toString()+")");this._flagVertices&&(vertices=t.toString(this._vertices,this._closed),g.setAttribute("d",vertices));this._flagFill&&g.setAttribute("fill",this._fill);this._flagStroke&&g.setAttribute("stroke",this._stroke);this._flagLinewidth&&g.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(g.setAttribute("stroke-opacity",
this._opacity),g.setAttribute("fill-opacity",this._opacity));this._flagVisible&&g.setAttribute("visibility",this._visible?"visible":"hidden");this._flagCap&&g.setAttribute("stroke-linecap",this._cap);this._flagJoin&&g.setAttribute("stroke-linejoin",this._join);this._flagMiter&&g.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},k=Two[Two.Types.svg]=function(e){this.domElement=e.domElement||t.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(k,{Utils:t});
_.extend(k.prototype,Backbone.Events,{setSize:function(e,g){this.width=e;this.height=g;t.setAttributes(this.domElement,{width:e,height:g});return this},render:function(){t.group.render.call(this.scene,this.domElement);return this}})})();(function(){var C=Two.Utils.mod,p=Two.Utils.getRatio,g,e,t,k,h,l,f,u,G,q,w,d,s,D,z,r,A,F,E,a,c,n,x,K,v,y,J,I,M={group:{renderChild:function(a){M[a._renderer.type].render.call(a,this)},render:function(a){this._update();g=this._matrix.elements;a.save();a.transform(g[0],g[3],g[1],g[4],g[2],g[5]);_.each(this.children,M.group.renderChild,a);a.restore();return this.flagReset()}},polygon:{render:function(p){this._update();g=this._matrix.elements;e=this.stroke;t=this.linewidth;k=this.fill;h=this.opacity;
l=this.visible;f=this.cap;u=this.join;G=this.miter;q=this.closed;w=this._vertices;d=w.length;s=d-1;if(!l)return this;p.save();g&&p.transform(g[0],g[3],g[1],g[4],g[2],g[5]);k&&(p.fillStyle=k);e&&(p.strokeStyle=e);t&&(p.lineWidth=t);G&&(p.miterLimit=G);u&&(p.lineJoin=u);f&&(p.lineCap=f);_.isNumber(h)&&(p.globalAlpha=h);p.beginPath();_.each(w,function(e,f){J=e.x.toFixed(3);I=e.y.toFixed(3);switch(e._command){case Two.Commands.close:p.closePath();break;case Two.Commands.curve:z=q?C(f-1,d):Math.max(f-
1,0);D=q?C(f+1,d):Math.min(f+1,s);r=w[z];A=w[D];x=r.controls&&r.controls.right||r;K=e.controls&&e.controls.left||e;r._relative?(c=(x.x+r.x).toFixed(3),n=(x.y+r.y).toFixed(3)):(c=x.x.toFixed(3),n=x.y.toFixed(3));e._relative?(E=(K.x+e.x).toFixed(3),a=(K.y+e.y).toFixed(3)):(E=K.x.toFixed(3),a=K.y.toFixed(3));p.bezierCurveTo(c,n,E,a,J,I);f>=s&&q&&(A=F,v=e.controls&&e.controls.right||e,y=A.controls&&A.controls.left||A,e._relative?(c=(v.x+e.x).toFixed(3),n=(v.y+e.y).toFixed(3)):(c=v.x.toFixed(3),n=v.y.toFixed(3)),
A._relative?(E=(y.x+A.x).toFixed(3),a=(y.y+A.y).toFixed(3)):(E=y.x.toFixed(3),a=y.y.toFixed(3)),J=A.x.toFixed(3),I=A.y.toFixed(3),p.bezierCurveTo(c,n,E,a,J,I));break;case Two.Commands.line:p.lineTo(J,I);break;case Two.Commands.move:F=e,p.moveTo(J,I)}});q&&p.closePath();p.fill();p.stroke();p.restore();return this.flagReset()}}},O=Two[Two.Types.canvas]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=a.overdraw||!1;this.scene=
new Two.Group;this.scene.parent=this};_.extend(O,{Utils:M});_.extend(O.prototype,Backbone.Events,{setSize:function(a,c,d){this.width=a;this.height=c;this.ratio=_.isUndefined(d)?p(this.ctx):d;this.domElement.width=a*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:c+"px"});return this},render:function(){var a=1===this.ratio;a||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);M.group.render.call(this.scene,
this.ctx);a||this.ctx.restore();return this}})})();(function(){var C=Two.Matrix.Multiply,p=Two.Utils.mod,g=[1,0,0,0,1,0,0,0,1],e=new Two.Array(9),t=Two.Utils.getRatio,k,h,l,f,u,G,q,w,d,s,D,z,r,A,F,E,a,c,n,x,K,v,y,J,I,M,O,Q,N,H,b,m,B,ea,P,R,aa,da,U,V,W,X,Y,ba,ca,Z,S,$,fa,ga,L,ia,ja,ka,ha,T={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){T[a._renderer.type].render.call(a,this.gl,this.program)},render:function(a,b){this._update();k=this.parent;h=k._matrix&&k._matrix.manual||k._flagMatrix;
l=this._matrix.manual||this._flagMatrix;if(h||l)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,e),C(e,k._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*k._renderer.scale,h&&(this._flagMatrix=!0);_.each(this.children,T.group.renderChild,{gl:a,program:b});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;k=this.parent;h=k._matrix.manual||k._flagMatrix;l=this._matrix.manual||this._flagMatrix;
f=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this._update();if(h||l)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,e),C(e,k._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*k._renderer.scale;f&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),
T.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),T.getTriangles(this._renderer.rect,this._renderer.triangles),T.updateBuffer(a,this,b),T.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,
!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(b,e,f){u=Infinity;G=-Infinity;q=Infinity;w=-Infinity;_.each(b,function(b,c){d=b.x;s=b.y;D;z;r;A;F=b.controls;q=Math.min(s,q);u=Math.min(d,u);G=Math.max(d,G);w=Math.max(s,w);b.controls&&(E=F.left,a=F.right,E&&a&&(D=b._relative?E.x+d:E.x,z=b._relative?E.y+s:E.y,r=b._relative?a.x+d:a.x,A=b._relative?a.y+s:a.y,D&&(z&&r&&A)&&(q=Math.min(z,A,q),u=Math.min(D,r,u),G=Math.max(D,r,G),w=Math.max(z,A,w))))});_.isNumber(e)&&
(q-=e,u-=e,G+=e,w+=e);c=G-u;n=w-q;f.top=q;f.left=u;f.right=G;f.bottom=w;f.width=c;f.height=n;f.centroid||(f.centroid={});f.centroid.x=-u;f.centroid.y=-q},getTriangles:function(a,b){q=a.top;u=a.left;G=a.right;w=a.bottom;b[0]=u;b[1]=q;b[2]=G;b[3]=q;b[4]=u;b[5]=w;b[6]=u;b[7]=w;b[8]=G;b[9]=q;b[10]=G;b[11]=w},updateCanvas:function(a){x=a._vertices;K=this.canvas;v=this.ctx;y=a._renderer.scale;J=a._stroke;I=a._linewidth*y;M=a._fill;O=a._opacity;Q=a._cap;N=a._join;H=a._miter;b=a._closed;m=x.length;B=m-1;
K.width=Math.max(Math.ceil(a._renderer.rect.width*y),1);K.height=Math.max(Math.ceil(a._renderer.rect.height*y),1);ea=a._renderer.rect.centroid;P=ea.x*y;R=ea.y*y;v.clearRect(0,0,K.width,K.height);M&&(v.fillStyle=M);J&&(v.strokeStyle=J);I&&(v.lineWidth=I);H&&(v.miterLimit=H);N&&(v.lineJoin=N);Q&&(v.lineCap=Q);_.isNumber(O)&&(v.globalAlpha=O);v.beginPath();_.each(x,function(a,c){aa;da;D;r;U;V;W;X;Y;ba;ca;E;d=(a.x*y+P).toFixed(3);s=(a.y*y+R).toFixed(3);switch(a._command){case Two.Commands.close:v.closePath();
break;case Two.Commands.curve:da=b?p(c-1,m):Math.max(c-1,0);aa=b?p(c+1,m):Math.min(c+1,B);D=x[da];r=x[aa];Y=D.controls&&D.controls.right||D;ba=a.controls&&a.controls.left||a;D._relative?(W=((Y.x+D.x)*y+P).toFixed(3),X=((Y.y+D.y)*y+R).toFixed(3)):(W=(Y.x*y+P).toFixed(3),X=(Y.y*y+R).toFixed(3));a._relative?(U=((ba.x+a.x)*y+P).toFixed(3),V=((ba.y+a.y)*y+R).toFixed(3)):(U=(ba.x*y+P).toFixed(3),V=(ba.y*y+R).toFixed(3));v.bezierCurveTo(W,X,U,V,d,s);c>=B&&b&&(r=A,ca=a.controls&&a.controls.right||a,E=r.controls&&
r.controls.left||r,a._relative?(W=((ca.x+a.x)*y+P).toFixed(3),X=((ca.y+a.y)*y+R).toFixed(3)):(W=(ca.x*y+P).toFixed(3),X=(ca.y*y+R).toFixed(3)),r._relative?(U=((E.x+r.x)*y+P).toFixed(3),V=((E.y+r.y)*y+P).toFixed(3)):(U=(E.x*y+P).toFixed(3),V=(E.y*y+R).toFixed(3)),d=(r.x*y+P).toFixed(3),s=(r.y*y+R).toFixed(3),v.bezierCurveTo(W,X,U,V,d,s));break;case Two.Commands.line:v.lineTo(d,s);break;case Two.Commands.move:A=a,v.moveTo(d,s)}});b&&v.closePath();v.fill();v.stroke()},updateTexture:function(a,b){this.updateCanvas(b);
b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},
updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);
a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){Z=a.createProgram();_.each(b,function(b){a.attachShader(Z,b)});a.linkProgram(Z);S=a.getProgramParameter(Z,a.LINK_STATUS);if(!S)throw ga=a.getProgramInfoLog(Z),a.deleteProgram(Z),new Two.Utils.Error("unable to link program: "+ga);return Z}},shaders:{create:function(a,b,c){$=a.createShader(a[c]);a.shaderSource($,b);a.compileShader($);fa=a.getShaderParameter($,a.COMPILE_STATUS);if(!fa)throw ga=a.getShaderInfoLog($),a.deleteShader($),
new Two.Utils.Error("unable to compile shader "+$+": "+ga);return $},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};T.ctx=T.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(g),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;L=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=T.shaders.create(L,T.shaders.vertex,T.shaders.types.vertex);ja=T.shaders.create(L,T.shaders.fragment,T.shaders.types.fragment);this.program=T.program.create(L,[ka,ja]);L.useProgram(this.program);this.program.position=L.getAttribLocation(this.program,
"a_position");this.program.matrix=L.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=L.getAttribLocation(this.program,"a_textureCoords");L.disable(L.DEPTH_TEST);L.enable(L.BLEND);L.blendEquationSeparate(L.FUNC_ADD,L.FUNC_ADD);L.blendFuncSeparate(L.SRC_ALPHA,L.ONE_MINUS_SRC_ALPHA,L.ONE,L.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?t(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){L=this.ctx;this.overdraw||L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT);T.group.render.call(this.scene,L,this.program);this._flagMatrix=!1;return this}})})();(function(){var C,p=Two.Shape=function(g){this._renderer={};this.id=Two.Identifier+Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(p.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(p,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(g){Object.defineProperty(g,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e;this._flagMatrix=!0}});Object.defineProperty(g,
"scale",{get:function(){return this._scale},set:function(e){this._scale=e;this._flagScale=this._flagMatrix=!0}})}});_.extend(p.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(g){g.add(this);return this},clone:function(){C=new p;C.translation.copy(this.translation);C.rotation=this.rotation;C.scale=this.scale;_.each(p.Properties,function(g){C[g]=this[g]},this);return C._update()},_update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);this.parent&&_.isFunction(this.parent._update)&&this.parent._update();return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});p.MakeObservable(p.prototype)})();(function(){function C(a,b,c){r=b.controls&&b.controls.right;z=a.controls&&a.controls.left;K=b.x;v=b.y;y=(r||b).x;J=(r||b).y;I=(z||a).x;M=(z||a).y;O=a.x;Q=a.y;r&&b._relative&&(y+=b.x,J+=b.y);z&&a._relative&&(I+=a.x,M+=a.y);return Two.Utils.subdivide(K,v,y,J,I,M,O,Q,c)}var p=Math.min,g=Math.max,e=Math.round,t=Two.Utils.getComputedMatrix,k,h,l,f,u,G,q,w,d,s,D,z,r,A,F,E,a,c,n,x,K,v,y,J,I,M,O,Q;_.each(Two.Commands,function(a,b){});var N=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type=
"polygon";this._closed=!!b;this._curved=!!c;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.cap="butt";this.join="miter";this.miter=4;this._vertices=[];this.vertices=a;this.automatic=!d};_.extend(N,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),FlagVertices:function(){this._flagVertices=!0},MakeObservable:function(a){Two.Shape.MakeObservable(a);_.each(N.Properties.slice(0,
8),function(b){var c="_"+b,d="_flag"+b.charAt(0).toUpperCase()+b.slice(1);Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a;this[d]=!0}})});Object.defineProperty(a,"closed",{get:function(){return this._closed},set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(a,"curved",{get:function(){return this._curved},set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(N.prototype,"automatic",{get:function(){return this._automatic},
set:function(a){a!==this._automatic&&(method=(this._automatic=!!a)?"ignore":"listen",_.each(this.vertices,function(a){a[method]()}))}});Object.defineProperty(a,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=p(g(a,0),this._ending);this._flagVertices=!0}});Object.defineProperty(a,"ending",{get:function(){return this._ending},set:function(a){this._ending=p(g(a,this._beginning),1);this._flagVertices=!0}});Object.defineProperty(a,"vertices",{get:function(){return this._collection},
set:function(a){var c=_.bind(N.FlagVertices,this),d=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,c)},this);c()},this),e=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,c)},this);c()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(a.slice(0));this._collection.bind(Two.Events.insert,d);this._collection.bind(Two.Events.remove,e);verticesChanged=!0;d(this._collection)}})}});_.extend(N.prototype,Two.Shape.prototype,{_flagVertices:!0,
_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;w=_.map(this.vertices,function(a){return a.clone()});d=new N(w,this.closed,this.curved,!this.automatic);_.each(Two.Shape.Properties,function(a){d[a]=this[a]},this);d.translation.copy(this.translation);
d.rotation=this.rotation;d.scale=this.scale;a.add(d);return d},toObject:function(){var a={vertices:_.map(this.vertices,function(a){return a.toObject()})};_.each(Two.Shape.Properties,function(b){a[b]=this[b]},this);a.translation=this.translation.toObject;a.rotation=this.rotation;a.scale=this.scale;return a},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){s=this.getBoundingClientRect(!0);s.centroid={x:s.left+s.width/
2,y:s.top+s.height/2};_.each(this.vertices,function(a){a.addSelf(s.centroid)});return this},center:function(){s=this.getBoundingClientRect(!0);s.centroid={x:s.left+s.width/2,y:s.top+s.height/2};_.each(this.vertices,function(a){a.subSelf(s.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(c){this._update();x=c?this._matrix:t(this);D=this.linewidth/2;void 0;z=Infinity;r=-Infinity;A=Infinity;F=-Infinity;_.each(this._vertices,
function(b){E=b.x;a=b.y;b=x.multiply(E,a,1);A=p(b.y-D,A);z=p(b.x-D,z);r=g(b.x+D,r);F=g(b.y+D,F)});return{top:A,left:z,right:r,bottom:F,width:r-z,height:F-A}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this._vertices,this.closed),this;_.each(this._vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(a){this._update();f=this.vertices.length-1;c=this.vertices[f];u=this._closed||this.vertices[f]._command===Two.Commands.close;
w=[];_.each(this.vertices,function(b,d){if(0>=d&&!u)c=b;else if(b.command===Two.Commands.move)w.push(new Two.Anchor(c.x,c.y)),0<d&&(w[w.length-1].command=Two.Commands.line),c=n=b;else{var e=C(b,c,a);w=w.concat(e);_.each(e,function(a,b){a.command=0>=b&&c.command===Two.Commands.move?Two.Commands.move:Two.Commands.line});d>=f&&(this._closed&&this._automatic?(c=b,b=n,e=C(b,c,a),w=w.concat(e),_.each(e,function(a,b){a.command=0>=b&&c.command===Two.Commands.move?Two.Commands.move:Two.Commands.line})):u&&
w.push(new Two.Anchor(b.x,b.y)),w[w.length-1].command=u?Two.Commands.close:Two.Commands.line);c=b}},this);this._curved=this._automatic=!1;this.vertices=w;return this},_update:function(){if(this._flagVertices){k=this.vertices.length;f=k-1;h=e(this._beginning*f);l=e(this._ending*f);this._vertices.length=0;for(q=h;q<l+1;q++)G=this.vertices[q],this._vertices.push(G);this._automatic&&this.plot()}Two.Shape.prototype._update.call(this);return this},flagReset:function(){this._flagVertices=this._flagFill=
this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});N.MakeObservable(N.prototype)})();(function(){var C=Math.min,p=Math.max,g,e,t,k,h,l,f,u,G,q,w,d=Two.Group=function(d){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(d,{MakeObservable:function(e){Two.Shape.MakeObservable(e);d.MakeGetterSetters(e,Two.Polygon.Properties)},MakeGetterSetters:function(e,f){_.isArray(f)||(f=[f]);_.each(f,function(f){d.MakeGetterSetter(e,f)})},MakeGetterSetter:function(d,e){var f="_"+e;Object.defineProperty(d,e,{get:function(){return this[f]},
set:function(d){this[f]=d;_.each(this.children,function(f){f[e]=d})}})}});_.extend(d.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(f){f=f||this.parent;t=new d;f.add(t);e=_.map(this.children,function(d){return d.clone(t)});t.translation.copy(this.translation);t.rotation=this.rotation;t.scale=this.scale;
return t},toObject:function(){var d={children:{},translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};_.each(this.children,function(e,f){d.children[f]=e.toObject()},this);return d},corner:function(){k=this.getBoundingClientRect(!0);h={x:k.left,y:k.top};_.each(this.children,function(d){d.translation.subSelf(h)});return this},center:function(){k=this.getBoundingClientRect(!0);k.centroid={x:k.left+k.width/2,y:k.top+k.height/2};_.each(this.children,function(d){d.translation.subSelf(k.centroid)});
return this},add:function(d){l=arguments.length;f=d;e=this.children;u=this.parent;G=this.additions;_.isArray(d)||(f=_.toArray(arguments));_.each(f,function(d){d&&(q=d.id,g=d.parent,_.isUndefined(e[q])&&(g&&(delete g.children[q],w=_.indexOf(g.additions,q),0<=w&&g.additions.splice(w,1)),e[q]=d,d.parent=this,G.push(q),this._flagAdditions=!0))},this);return this},remove:function(d){l=arguments.length;f=d;e=this.children;u=this.parent;G=this.subtractions;if(0>=l&&u)return u.remove(this),this;_.isArray(d)||
(f=_.toArray(arguments));_.each(f,function(d){q=d.id;grandchildren=d.children;g=d.parent;q in e&&(delete e[q],delete d.parent,w=_.indexOf(g.additions,q),0<=w&&g.additions.splice(w,1),G.push(q),this._flagSubtractions=!0)},this);return this},getBoundingClientRect:function(d){this._update();var e=Infinity,f=-Infinity,g=Infinity,h=-Infinity;_.each(this.children,function(d){k=d.getBoundingClientRect();_.isNumber(k.top)&&(_.isNumber(k.left)&&_.isNumber(k.right)&&_.isNumber(k.bottom))&&(g=C(k.top,g),e=C(k.left,
e),f=p(k.right,f),h=p(k.bottom,h))},this);return{top:g,left:e,right:f,bottom:h,width:f-e,height:h-g}},noFill:function(){_.each(this.children,function(d){d.noFill()});return this},noStroke:function(){_.each(this.children,function(d){d.noStroke()});return this},subdivide:function(){var d=arguments;_.each(this.children,function(e){e.subdivide.apply(e,d)});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=
0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);return this}});d.MakeObservable(d.prototype)})();
