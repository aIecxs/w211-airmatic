(function(){var p=this,k=p._,e={},h=Array.prototype,d=Object.prototype,b=h.push,c=h.slice,q=h.concat,a=d.toString,l=d.hasOwnProperty,n=h.forEach,m=h.map,w=h.reduce,g=h.reduceRight,u=h.filter,x=h.every,v=h.some,r=h.indexOf,z=h.lastIndexOf,d=Array.isArray,s=Object.keys,t=Function.prototype.bind,f=function(j){if(j instanceof f)return j;if(!(this instanceof f))return new f(j);this._wrapped=j};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=f),exports._=
f):p._=f;f.VERSION="1.5.1";var y=f.each=f.forEach=function(j,a,b){if(null!=j)if(n&&j.forEach===n)j.forEach(a,b);else if(j.length===+j.length)for(var c=0,d=j.length;c<d&&a.call(b,j[c],c,j)!==e;c++);else for(c in j)if(f.has(j,c)&&a.call(b,j[c],c,j)===e)break};f.map=f.collect=function(j,f,a){var b=[];if(null==j)return b;if(m&&j.map===m)return j.map(f,a);y(j,function(j,c,d){b.push(f.call(a,j,c,d))});return b};f.reduce=f.foldl=f.inject=function(j,a,b,c){var d=2<arguments.length;null==j&&(j=[]);if(w&&j.reduce===
w)return c&&(a=f.bind(a,c)),d?j.reduce(a,b):j.reduce(a);y(j,function(j,f,g){d?b=a.call(c,b,j,f,g):(b=j,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return b};f.reduceRight=f.foldr=function(j,a,b,c){var d=2<arguments.length;null==j&&(j=[]);if(g&&j.reduceRight===g)return c&&(a=f.bind(a,c)),d?j.reduceRight(a,b):j.reduceRight(a);var t=j.length;if(t!==+t)var l=f.keys(j),t=l.length;y(j,function(f,g,s){g=l?l[--t]:--t;d?b=a.call(c,b,j[g],g,s):(b=j[g],d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");
return b};f.find=f.detect=function(j,f,a){var b;A(j,function(j,c,d){if(f.call(a,j,c,d))return b=j,!0});return b};f.filter=f.select=function(j,f,a){var b=[];if(null==j)return b;if(u&&j.filter===u)return j.filter(f,a);y(j,function(j,c,d){f.call(a,j,c,d)&&b.push(j)});return b};f.reject=function(j,a,b){return f.filter(j,function(j,f,c){return!a.call(b,j,f,c)},b)};f.every=f.all=function(j,a,b){a||(a=f.identity);var c=!0;if(null==j)return c;if(x&&j.every===x)return j.every(a,b);y(j,function(j,f,d){if(!(c=
c&&a.call(b,j,f,d)))return e});return!!c};var A=f.some=f.any=function(j,a,b){a||(a=f.identity);var c=!1;if(null==j)return c;if(v&&j.some===v)return j.some(a,b);y(j,function(j,f,d){if(c||(c=a.call(b,j,f,d)))return e});return!!c};f.contains=f.include=function(j,f){return null==j?!1:r&&j.indexOf===r?-1!=j.indexOf(f):A(j,function(j){return j===f})};f.invoke=function(j,a){var b=c.call(arguments,2),d=f.isFunction(a);return f.map(j,function(j){return(d?a:j[a]).apply(j,b)})};f.pluck=function(j,a){return f.map(j,
function(j){return j[a]})};f.where=function(j,a,b){return f.isEmpty(a)?b?void 0:[]:f[b?"find":"filter"](j,function(j){for(var f in a)if(a[f]!==j[f])return!1;return!0})};f.findWhere=function(j,a){return f.where(j,a,!0)};f.max=function(j,a,b){if(!a&&f.isArray(j)&&j[0]===+j[0]&&65535>j.length)return Math.max.apply(Math,j);if(!a&&f.isEmpty(j))return-Infinity;var c={computed:-Infinity,value:-Infinity};y(j,function(j,f,d){f=a?a.call(b,j,f,d):j;f>c.computed&&(c={value:j,computed:f})});return c.value};f.min=
function(j,a,b){if(!a&&f.isArray(j)&&j[0]===+j[0]&&65535>j.length)return Math.min.apply(Math,j);if(!a&&f.isEmpty(j))return Infinity;var c={computed:Infinity,value:Infinity};y(j,function(j,f,d){f=a?a.call(b,j,f,d):j;f<c.computed&&(c={value:j,computed:f})});return c.value};f.shuffle=function(j){var a,b=0,c=[];y(j,function(j){a=f.random(b++);c[b-1]=c[a];c[a]=j});return c};var C=function(j){return f.isFunction(j)?j:function(a){return a[j]}};f.sortBy=function(j,a,b){var c=C(a);return f.pluck(f.map(j,function(j,
a,f){return{value:j,index:a,criteria:c.call(b,j,a,f)}}).sort(function(j,a){var f=j.criteria,b=a.criteria;if(f!==b){if(f>b||void 0===f)return 1;if(f<b||void 0===b)return-1}return j.index<a.index?-1:1}),"value")};var Q=function(j,a,b,c){var d={},g=C(null==a?f.identity:a);y(j,function(a,f){var t=g.call(b,a,f,j);c(d,t,a)});return d};f.groupBy=function(j,a,b){return Q(j,a,b,function(a,j,b){(f.has(a,j)?a[j]:a[j]=[]).push(b)})};f.countBy=function(a,b,c){return Q(a,b,c,function(a,j){f.has(a,j)||(a[j]=0);
a[j]++})};f.sortedIndex=function(a,b,c,d){c=null==c?f.identity:C(c);b=c.call(d,b);for(var g=0,t=a.length;g<t;){var l=g+t>>>1;c.call(d,a[l])<b?g=l+1:t=l}return g};f.toArray=function(a){return!a?[]:f.isArray(a)?c.call(a):a.length===+a.length?f.map(a,f.identity):f.values(a)};f.size=function(a){return null==a?0:a.length===+a.length?a.length:f.keys(a).length};f.first=f.head=f.take=function(a,f,b){return null==a?void 0:null!=f&&!b?c.call(a,0,f):a[0]};f.initial=function(a,f,b){return c.call(a,0,a.length-
(null==f||b?1:f))};f.last=function(a,f,b){return null==a?void 0:null!=f&&!b?c.call(a,Math.max(a.length-f,0)):a[a.length-1]};f.rest=f.tail=f.drop=function(a,f,b){return c.call(a,null==f||b?1:f)};f.compact=function(a){return f.filter(a,f.identity)};var R=function(a,c,d){if(c&&f.every(a,f.isArray))return q.apply(d,a);y(a,function(a){f.isArray(a)||f.isArguments(a)?c?b.apply(d,a):R(a,c,d):d.push(a)});return d};f.flatten=function(a,f){return R(a,f,[])};f.without=function(a){return f.difference(a,c.call(arguments,
1))};f.uniq=f.unique=function(a,b,c,d){f.isFunction(b)&&(d=c,c=b,b=!1);c=c?f.map(a,c,d):a;var g=[],t=[];y(c,function(c,d){if(b?!d||t[t.length-1]!==c:!f.contains(t,c))t.push(c),g.push(a[d])});return g};f.union=function(){return f.uniq(f.flatten(arguments,!0))};f.intersection=function(a){var b=c.call(arguments,1);return f.filter(f.uniq(a),function(a){return f.every(b,function(j){return 0<=f.indexOf(j,a)})})};f.difference=function(a){var b=q.apply(h,c.call(arguments,1));return f.filter(a,function(a){return!f.contains(b,
a)})};f.zip=function(){for(var a=f.max(f.pluck(arguments,"length").concat(0)),b=Array(a),c=0;c<a;c++)b[c]=f.pluck(arguments,""+c);return b};f.object=function(a,f){if(null==a)return{};for(var b={},c=0,d=a.length;c<d;c++)f?b[a[c]]=f[c]:b[a[c][0]]=a[c][1];return b};f.indexOf=function(a,b,c){if(null==a)return-1;var d=0,g=a.length;if(c)if("number"==typeof c)d=0>c?Math.max(0,g+c):c;else return d=f.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b,c);for(;d<g;d++)if(a[d]===b)return d;
return-1};f.lastIndexOf=function(a,f,b){if(null==a)return-1;var c=null!=b;if(z&&a.lastIndexOf===z)return c?a.lastIndexOf(f,b):a.lastIndexOf(f);for(b=c?b:a.length;b--;)if(a[b]===f)return b;return-1};f.range=function(a,f,b){1>=arguments.length&&(f=a||0,a=0);b=arguments[2]||1;for(var c=Math.max(Math.ceil((f-a)/b),0),d=0,g=Array(c);d<c;)g[d++]=a,a+=b;return g};var J=function(){};f.bind=function(a,b){var d,g;if(t&&a.bind===t)return t.apply(a,c.call(arguments,1));if(!f.isFunction(a))throw new TypeError;
d=c.call(arguments,2);return g=function(){if(!(this instanceof g))return a.apply(b,d.concat(c.call(arguments)));J.prototype=a.prototype;var f=new J;J.prototype=null;var t=a.apply(f,d.concat(c.call(arguments)));return Object(t)===t?t:f}};f.partial=function(a){var f=c.call(arguments,1);return function(){return a.apply(this,f.concat(c.call(arguments)))}};f.bindAll=function(a){var b=c.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");y(b,function(b){a[b]=f.bind(a[b],
a)});return a};f.memoize=function(a,b){var c={};b||(b=f.identity);return function(){var d=b.apply(this,arguments);return f.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};f.delay=function(a,f){var b=c.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},f)};f.defer=function(a){return f.delay.apply(f,[a,1].concat(c.call(arguments,1)))};f.throttle=function(a,f,b){var c,d,g,t=null,l=0;b||(b={});var s=function(){l=!1===b.leading?0:new Date;t=null;g=a.apply(c,d)};return function(){var e=
new Date;!l&&!1===b.leading&&(l=e);var h=f-(e-l);c=this;d=arguments;0>=h?(clearTimeout(t),t=null,l=e,g=a.apply(c,d)):!t&&!1!==b.trailing&&(t=setTimeout(s,h));return g}};f.debounce=function(a,f,b){var c,d=null;return function(){var g=this,t=arguments,l=b&&!d;clearTimeout(d);d=setTimeout(function(){d=null;b||(c=a.apply(g,t))},f);l&&(c=a.apply(g,t));return c}};f.once=function(a){var f=!1,b;return function(){if(f)return b;f=!0;b=a.apply(this,arguments);a=null;return b}};f.wrap=function(a,f){return function(){var c=
[a];b.apply(c,arguments);return f.apply(this,c)}};f.compose=function(){var a=arguments;return function(){for(var f=arguments,b=a.length-1;0<=b;b--)f=[a[b].apply(this,f)];return f[0]}};f.after=function(a,f){return function(){if(1>--a)return f.apply(this,arguments)}};f.keys=s||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)f.has(a,c)&&b.push(c);return b};f.values=function(a){var b=[],c;for(c in a)f.has(a,c)&&b.push(a[c]);return b};f.pairs=function(a){var b=
[],c;for(c in a)f.has(a,c)&&b.push([c,a[c]]);return b};f.invert=function(a){var b={},c;for(c in a)f.has(a,c)&&(b[a[c]]=c);return b};f.functions=f.methods=function(a){var b=[],c;for(c in a)f.isFunction(a[c])&&b.push(c);return b.sort()};f.extend=function(a){y(c.call(arguments,1),function(f){if(f)for(var b in f)a[b]=f[b]});return a};f.pick=function(a){var f={},b=q.apply(h,c.call(arguments,1));y(b,function(b){b in a&&(f[b]=a[b])});return f};f.omit=function(a){var b={},d=q.apply(h,c.call(arguments,1)),
g;for(g in a)f.contains(d,g)||(b[g]=a[g]);return b};f.defaults=function(a){y(c.call(arguments,1),function(f){if(f)for(var b in f)void 0===a[b]&&(a[b]=f[b])});return a};f.clone=function(a){return!f.isObject(a)?a:f.isArray(a)?a.slice():f.extend({},a)};f.tap=function(a,f){f(a);return a};var K=function(b,c,d,g){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b instanceof f&&(b=b._wrapped);c instanceof f&&(c=c._wrapped);var t=a.call(b);if(t!=a.call(c))return!1;switch(t){case "[object String]":return b==
String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==+c;case "[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var l=d.length;l--;)if(d[l]==b)return g[l]==c;var l=b.constructor,s=c.constructor;if(l!==s&&(!f.isFunction(l)||!(l instanceof l&&f.isFunction(s)&&s instanceof s)))return!1;d.push(b);g.push(c);l=
0;s=!0;if("[object Array]"==t){if(l=b.length,s=l==c.length)for(;l--&&(s=K(b[l],c[l],d,g)););}else{for(var e in b)if(f.has(b,e)&&(l++,!(s=f.has(c,e)&&K(b[e],c[e],d,g))))break;if(s){for(e in c)if(f.has(c,e)&&!l--)break;s=!l}}d.pop();g.pop();return s};f.isEqual=function(a,b){return K(a,b,[],[])};f.isEmpty=function(a){if(null==a)return!0;if(f.isArray(a)||f.isString(a))return 0===a.length;for(var b in a)if(f.has(a,b))return!1;return!0};f.isElement=function(a){return!!(a&&1===a.nodeType)};f.isArray=d||
function(b){return"[object Array]"==a.call(b)};f.isObject=function(a){return a===Object(a)};y("Arguments Function String Number Date RegExp".split(" "),function(b){f["is"+b]=function(f){return a.call(f)=="[object "+b+"]"}});f.isArguments(arguments)||(f.isArguments=function(a){return!(!a||!f.has(a,"callee"))});"function"!==typeof/./&&(f.isFunction=function(a){return"function"===typeof a});f.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};f.isNaN=function(a){return f.isNumber(a)&&a!=
+a};f.isBoolean=function(b){return!0===b||!1===b||"[object Boolean]"==a.call(b)};f.isNull=function(a){return null===a};f.isUndefined=function(a){return void 0===a};f.has=function(a,b){return l.call(a,b)};f.noConflict=function(){p._=k;return this};f.identity=function(a){return a};f.times=function(a,b,f){for(var c=Array(Math.max(0,a)),d=0;d<a;d++)c[d]=b.call(f,d);return c};f.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",
'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=f.invert(I.escape);var S={escape:RegExp("["+f.keys(I.escape).join("")+"]","g"),unescape:RegExp("("+f.keys(I.unescape).join("|")+")","g")};f.each(["escape","unescape"],function(a){f[a]=function(b){return null==b?"":(""+b).replace(S[a],function(b){return I[a][b]})}});f.result=function(a,b){if(null!=a){var c=a[b];return f.isFunction(c)?c.call(a):c}};f.mixin=function(a){y(f.functions(a),function(c){var d=f[c]=a[c];f.prototype[c]=function(){var a=[this._wrapped];
b.apply(a,arguments);a=d.apply(f,a);return this._chain?f(a).chain():a}})};var T=0;f.uniqueId=function(a){var b=++T+"";return a?a+b:b};f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\t|\u2028|\u2029/g;f.template=function(a,b,c){var d;c=f.defaults({},c,f.templateSettings);var g=RegExp([(c.escape||L).source,(c.interpolate||L).source,(c.evaluate||
L).source].join("|")+"|$","g"),t=0,l="__p+='";a.replace(g,function(b,f,c,d,g){l+=a.slice(t,g).replace(F,function(a){return"\\"+U[a]});f&&(l+="'+\n((__t=("+f+"))==null?'':_.escape(__t))+\n'");c&&(l+="'+\n((__t=("+c+"))==null?'':__t)+\n'");d&&(l+="';\n"+d+"\n__p+='");t=g+b.length;return b});l+="';\n";c.variable||(l="with(obj||{}){\n"+l+"}\n");l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+l+"return __p;\n";try{d=new Function(c.variable||"obj","_",l)}catch(s){throw s.source=
l,s;}if(b)return d(b,f);b=function(a){return d.call(this,a,f)};b.source="function("+(c.variable||"obj")+"){\n"+l+"}";return b};f.chain=function(a){return f(a).chain()};f.mixin(f);y("pop push reverse shift sort splice unshift".split(" "),function(a){var b=h[a];f.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);("shift"==a||"splice"==a)&&0===c.length&&delete c[0];return this._chain?f(c).chain():c}});y(["concat","join","slice"],function(a){var b=h[a];f.prototype[a]=function(){var a=b.apply(this._wrapped,
arguments);return this._chain?f(a).chain():a}});f.extend(f.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var p=[].slice,k=function(e,d,b){var c;e=-1;var q=d.length;switch(b.length){case 0:for(;++e<q;)(c=d[e]).callback.call(c.ctx);break;case 1:for(;++e<q;)(c=d[e]).callback.call(c.ctx,b[0]);break;case 2:for(;++e<q;)(c=d[e]).callback.call(c.ctx,b[0],b[1]);break;case 3:for(;++e<q;)(c=d[e]).callback.call(c.ctx,b[0],b[1],b[2]);break;default:for(;++e<q;)(c=d[e]).callback.apply(c.ctx,b)}},e=Backbone.Events={on:function(e,d,b){this._events||(this._events={});(this._events[e]||(this._events[e]=[])).push({callback:d,
context:b,ctx:b||this});return this},once:function(e,d,b){var c=this,q=_.once(function(){c.off(e,q);d.apply(this,arguments)});q._callback=d;this.on(e,q,b);return this},off:function(e,d,b){var c,q,a,l,n,m,w,g;if(!this._events)return this;if(!e&&!d&&!b)return this._events={},this;l=e?[e]:_.keys(this._events);n=0;for(m=l.length;n<m;n++)if(e=l[n],c=this._events[e]){a=[];if(d||b){w=0;for(g=c.length;w<g;w++)q=c[w],(d&&d!==(q.callback._callback||q.callback)||b&&b!==q.context)&&a.push(q)}this._events[e]=
a}return this},trigger:function(e){if(!this._events)return this;var d=p.call(arguments,1),b=this._events[e],c=this._events.all;b&&k(this,b,d);c&&k(this,c,arguments);return this},listenTo:function(e,d,b){var c=this._listeners||(this._listeners={}),q=e._listenerId||(e._listenerId=_.uniqueId("l"));c[q]=e;e.on(d,b||this,this);return this},stopListening:function(e,d,b){var c=this._listeners;if(c){if(e)e.off(d,b,this),!d&&!b&&delete c[e._listenerId];else{for(var q in c)c[q].off(null,null,this);this._listeners=
{}}return this}}};e.bind=e.on;e.unbind=e.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports.Backbone=exports.Backbone||Backbone)})();(function(){function p(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-e)),a=k.setTimeout(function(){b(c+d)},d);e=c+d;return a}var k=this,e=0,h=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=p),exports.requestAnimationFrame=p;else{for(var d=0;d<h.length&&!k.requestAnimationFrame;++d)k.requestAnimationFrame=k[h[d]+"RequestAnimationFrame"],k.cancelAnimationFrame=k[h[d]+"CancelAnimationFrame"]||k[h[d]+"CancelRequestAnimationFrame"];
k.requestAnimationFrame||(k.requestAnimationFrame=p);k.cancelAnimationFrame||(k.cancelAnimationFrame=function(b){clearTimeout(b)})}})();(function(){function p(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(g.Events.resize,b,a)}var k=this,e=k.Two||{},h=Math.sin,d=Math.cos,b=Math.atan2,c=Math.sqrt,q=Math.abs,a=Math.PI,l=2*a,n=a/2,m=Math.pow,w={hasEventListeners:_.isFunction(k.addEventListener),bind:function(a,b,f,c){this.hasEventListeners?a.addEventListener(b,f,!!c):a.attachEvent("on"+b,f);return this},unbind:function(a,b,f,c){this.hasEventListeners?
a.removeEventListeners(b,f,!!c):a.detachEvent("on"+b,f);return this}},g=k.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:g.Types.svg,autostart:!1});_.each(a,function(a,b){"fullscreen"===b||("width"===b||"height"===b||"autostart"===b)||(this[b]=a)},this);this.renderer=new g[this.type](this);g.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(p,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,
position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),w.bind(k,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);this.scene=new g.Group;this.renderer.add(this.scene);g.Instances.push(this)};_.extend(g,{Array:k.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.3.0",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",
pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){k.Two=e;return this},Utils:{Curve:{CollinearityEpsilon:m(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},setPlaying:function(a){_.defer(_.bind(function(){this.playing=!!a},this))},getComputedMatrix:function(a){for(var b=new g.Matrix;a&&a._matrix;){var f=a._matrix.elements;
b.multiply(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9]);a=a.parent}return b},applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";_.each(a.attributes,function(a){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=
a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});return b},read:{svg:function(){return g.Utils.read.g.apply(this,arguments)},g:function(a){var b=new g.Group;this.add(b);_.each(a.childNodes,function(a){if(a.localName){var c=a.localName.toLowerCase();c in g.Utils.read&&(a=g.Utils.read[c].call(this,a),b.add(a))}},this);return g.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var f=a.points;if(f){var c=_.map(_.range(f.numberOfItems),function(a){a=f.getItem(a);
return new g.Anchor(a.x,a.y)}),c=(new g.Polygon(c,!b)).noStroke();return g.Utils.applySvgAttributes(a,c)}},polyline:function(a){return g.Utils.read.polygon(a,!0)},path:function(a){var b,f,c,d=!1,l=!1,e=a.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),n=e.length-1,e=_.flatten(_.map(e,function(a,e){var s,m,q=a[0],h=q.toLowerCase();c=a.slice(1).trim();c=c.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,f){return parseFloat(b)*Math.pow(10,f)});c=c.split(/[\s,]+|(?=\s?[+\-])/);d=q===h;var w,
u,j,k;switch(h){case "z":e>=n?l=!0:(m=b.x,s=b.y,s=new g.Anchor(m,s,void 0,void 0,void 0,void 0,g.Commands.close));break;case "m":case "l":m=parseFloat(c[0]);s=parseFloat(c[1]);s=new g.Anchor(m,s,void 0,void 0,void 0,void 0,"m"===h?g.Commands.move:g.Commands.line);d&&s.addSelf(b);b=s;break;case "h":case "v":m="h"===h?"x":"y";q="x"===m?"y":"x";s=new g.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,g.Commands.line);s[m]=parseFloat(c[0]);s[q]=b[q];d&&(s[m]+=b[m]);b=s;break;case "s":case "c":s=b.x;q=
b.y;f||(f=(new g.Vector).copy(b));"c"===h?(w=parseFloat(c[0]),m=parseFloat(c[1]),h=parseFloat(c[2]),u=parseFloat(c[3]),j=parseFloat(c[4]),k=parseFloat(c[5])):(u=g.Utils.getReflection(b,f,d),w=u.x,m=u.y,h=parseFloat(c[0]),u=parseFloat(c[1]),j=parseFloat(c[2]),k=parseFloat(c[3]));d&&(w+=s,m+=q,h+=s,u+=q,j+=s,k+=q);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(w,m);b=s=new g.Anchor(j,k,h,u,void 0,void 0,g.Commands.curve);f=s.controls.left;break;case "t":case "q":s=b.x;
q=b.y;f||(f=(new g.Vector).copy(b));f.isZero()?(w=s,m=q):(w=f.x,q=f.y);"q"===h?(h=parseFloat(c[0]),u=parseFloat(c[1]),j=parseFloat(c[1]),k=parseFloat(c[2])):(u=g.Utils.getReflection(b,f,d),h=u.x,u=u.y,j=parseFloat(c[0]),k=parseFloat(c[1]));d&&(w+=s,m+=q,h+=s,u+=q,j+=s,k+=q);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(w,m);b=s=new g.Anchor(j,k,h,u,void 0,void 0,g.Commands.curve);f=s.controls.left;break;case "a":throw new g.Utils.Error("not yet able to interpret Elliptical Arcs.");
}return s}));if(!(1>=e.length))return e=_.compact(e),e=(new g.Polygon(e,l,void 0,!0)).noStroke(),g.Utils.applySvgAttributes(a,e)},circle:function(a){var b=parseFloat(a.getAttribute("cx")),f=parseFloat(a.getAttribute("cy")),c=parseFloat(a.getAttribute("r")),e=g.Resolution,n=_.map(_.range(e),function(a){var b=a/e*l;a=c*d(b);b=c*h(b);return new g.Anchor(a,b)},this),n=(new g.Polygon(n,!0,!0)).noStroke();n.translation.set(b,f);return g.Utils.applySvgAttributes(a,n)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),
f=parseFloat(a.getAttribute("cy")),c=parseFloat(a.getAttribute("rx")),e=parseFloat(a.getAttribute("ry")),n=g.Resolution,m=_.map(_.range(n),function(a){var b=a/n*l;a=c*d(b);b=e*h(b);return new g.Anchor(a,b)},this),m=(new g.Polygon(m,!0,!0)).noStroke();m.translation.set(b,f);return g.Utils.applySvgAttributes(a,m)},rect:function(a){var b=parseFloat(a.getAttribute("x")),f=parseFloat(a.getAttribute("y")),c=parseFloat(a.getAttribute("width")),d=parseFloat(a.getAttribute("height")),c=c/2,d=d/2,l=[new g.Anchor(c,
d),new g.Anchor(-c,d),new g.Anchor(-c,-d),new g.Anchor(c,-d)],l=(new g.Polygon(l,!0)).noStroke();l.translation.set(b+c,f+d);return g.Utils.applySvgAttributes(a,l)},line:function(a){var b=parseFloat(a.getAttribute("x1")),c=parseFloat(a.getAttribute("y1")),d=parseFloat(a.getAttribute("x2")),l=parseFloat(a.getAttribute("y2")),d=(d-b)/2,l=(l-c)/2,e=[new g.Anchor(-d,-l),new g.Anchor(d,l)],e=(new g.Polygon(e)).noFill();e.translation.set(b+d,c+l);return g.Utils.applySvgAttributes(a,e)}},subdivide:function(c,
d,f,e,n,m,h,w,u){var k=g.Utils.Curve.CollinearityEpsilon,x=g.Utils.Curve.RecursionLimit,v=g.Utils.Curve.CuspLimit,r=g.Utils.Curve.Tolerance,p;u=u||0;if(u>x)return[];var x=(c+f)/2,z=(d+e)/2,F=(f+n)/2,j=(e+m)/2,M=(n+h)/2,N=(m+w)/2,O=(x+F)/2,P=(z+j)/2,F=(F+M)/2,j=(j+N)/2,D=(O+F)/2,E=(P+j)/2;p=h-c;var B=w-d,G=q((f-h)*B-(e-w)*p),H=q((n-h)*B-(m-w)*p);if(0<u){if(G>k&&H>k&&(G+H)*(G+H)<=r.distance*(p*p+B*B)){if(r.angle<r.epsilon)return[new g.Anchor(D,E)];p=b(m-e,n-f);k=q(p-b(e-d,f-c));p=q(b(w-m,h-n)-p);k>=
a&&(k=l-k);p>=a&&(p=l-p);if(k+p<r.angle)return[new g.Anchor(D,E)];if(0!==v){if(k>v)return[new g.Anchor(f,e)];if(p>v)return[new g.Anchor(n,m)]}}}else if(G>k)if(G*G<=r.distance*(p*p+B*B)){if(r.angle<r.epsilon)return[new g.Anchor(D,E)];k=q(b(m-e,n-f)-b(e-d,f-c));k>=a&&(k=l-k);if(k<r.angle)return[new g.Anchor(f,e),new g.Anchor(n,m)];if(0!==v&&k>v)return[new g.Anchor(f,e)]}else if(H>k){if(H*H<=r.distance*(p*p+B*B)){if(r.angle<r.epsilon)return[new g.Anchor(D,E)];k=q(b(w-m,h-n)-b(m-e,n-f));k>=a&&(k=l-k);
if(k<r.angle)return[new g.Anchor(f,e),new g.Anchor(n,m)];if(0!==v&&k>v)return[new g.Anchor(n,m)]}}else if(p=D-(c+h)/2,B=E-(d+w)/2,p*p+B*B<=r.distance)return[new g.Anchor(D,E)];return g.Utils.subdivide(c,d,x,z,O,P,D,E,u+1).concat(g.Utils.subdivide(D,E,F,j,M,N,h,w,u+1))},getCurveFromPoints:function(a,b){for(var c=a.length,d=c-1,l=0;l<c;l++){var e=a[l];_.isObject(e.controls)||g.Anchor.AppendCurveProperties(e);var n=b?z(l-1,c):Math.max(l-1,0),m=b?z(l+1,c):Math.min(l+1,d);r(a[n],e,a[m]);e._command=0===
l?g.Commands.move:g.Commands.curve;e.controls.left.x=_.isNumber(e.controls.left.x)?e.controls.left.x:e.x;e.controls.left.y=_.isNumber(e.controls.left.y)?e.controls.left.y:e.y;e.controls.right.x=_.isNumber(e.controls.right.x)?e.controls.right.x:e.x;e.controls.right.y=_.isNumber(e.controls.right.y)?e.controls.right.y:e.y}},getControlPoints:function(b,c,f){var e=v(b,c),l=v(f,c);b=u(b,c);f=u(f,c);var m=(e+l)/2;c.u=_.isObject(c.controls.left)?c.controls.left:new g.Vector(c.x,c.y);c.v=_.isObject(c.controls.right)?
c.controls.right:new g.Vector(c.x,c.y);if(1E-4>b||1E-4>f)return c.controls.left.copy(c),c.controls.right.copy(c),c;b*=0.33;f*=0.33;m=l<e?m+n:m-n;c.controls.left.x=c.x+d(m)*b;c.controls.left.y=c.y+h(m)*b;m-=a;c.controls.right.x=c.x+d(m)*f;c.controls.right.y=c.y+h(m)*f;return c},getReflection:function(a,b,c){var d=a.distanceTo(b);if(1E-4>=d)return c?new g.Vector:a.clone();b=v(a,b);return new g.Vector(d*Math.cos(b)+(c?0:a.x),d*Math.sin(b)+(c?0:a.y))},angleBetween:function(a,c){return b(a.y-c.y,a.x-c.x)},
distanceBetweenSquared:function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},distanceBetween:function(a,b){return c(x(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=a}}});g.Utils.Error.prototype=Error();g.Utils.Error.prototype.constructor=g.Utils.Error;g.Utils.Collection.prototype=
[];g.Utils.Collection.constructor=g.Utils.Collection;_.extend(g.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(g.Events.remove,[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(g.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);this.trigger(g.Events.insert,arguments);return a},unshift:function(){var a=Array.prototype.unshift.apply(this,
arguments);this.trigger(g.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,arguments),b;this.trigger(g.Events.remove,a);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(g.Events.insert,b));return a}});var u=g.Utils.distanceBetween,x=g.Utils.distanceBetweenSquared,v=g.Utils.angleBetween,r=g.Utils.getControlPoints,z=g.Utils.mod;_.extend(g.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);
return this},play:function(){g.Utils.setPlaying.call(this,!0);return this.trigger(g.Events.play)},pause:function(){this.playing=!1;return this.trigger(g.Events.pause)},update:function(){_.defer(_.bind(function(){var a=!!this._lastFrame,b=(k.performance&&k.performance.now?k.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,c=this.renderer;(a!==c.width||b!==c.height)&&c.setSize(a,b);this.trigger(g.Events.update,
this.frameCount,this.timeDelta);this.render()},this));return this},render:function(){this.renderer.render();return this.trigger(g.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){_.each(this.scene.children,function(a){a.remove()});return this},makeLine:function(a,b,c,d){c=(c-a)/2;d=(d-b)/2;var e=[new g.Anchor(-c,
-d),new g.Anchor(c,d)],e=(new g.Polygon(e)).noFill();e.translation.set(a+c,b+d);this.scene.add(e);return e},makeRectangle:function(a,b,c,d){c/=2;d/=2;d=[new g.Anchor(c,d),new g.Anchor(-c,d),new g.Anchor(-c,-d),new g.Anchor(c,-d)];d=new g.Polygon(d,!0);d.translation.set(a,b);this.scene.add(d);return d},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,c,e){var m=g.Resolution,n=_.map(_.range(m),function(a){var b=a/m*l;a=c*d(b);b=e*h(b);return new g.Anchor(a,b)},this),
n=new g.Polygon(n,!0,!0);n.translation.set(a,b);this.scene.add(n);return n},makeCurve:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],d=0;d<b;d+=2){var e=arguments[d];if(!_.isNumber(e))break;c.push(new g.Anchor(e,arguments[d+1]))}var b=arguments[b-1],c=new g.Polygon(c,!(_.isBoolean(b)&&b),!0),b=c.getBoundingClientRect(),l=b.left+b.width/2,m=b.top+b.height/2;_.each(c.vertices,function(a){a.x-=l;a.y-=m});c.translation.set(l,m);this.scene.add(c);return c},makePolygon:function(a){var b=
arguments.length,c=a;if(!_.isArray(a))for(var c=[],d=0;d<b;d+=2){var e=arguments[d];if(!_.isNumber(e))break;c.push(new g.Anchor(e,arguments[d+1]))}b=arguments[b-1];c=new g.Polygon(c,!(_.isBoolean(b)&&b));b=c.getBoundingClientRect();c.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new g.Group;this.scene.add(c);c.add(b);return c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in
g.Utils.read))return null;a=g.Utils.read[b].call(this,a);this.add(a);return a}});(function(){_.each(g.Instances,function(a){a.playing&&a.update()});requestAnimationFrame(arguments.callee)})();"function"===typeof define&&define.amd?define(function(){return g}):"undefined"!=typeof module&&module.exports&&(module.exports=g)})();(function(){var p=Two.Vector=function(e,h){this.x=e||0;this.y=h||0};_.extend(p,{MakeGetterSetter:function(e,h,d){var b="_"+h;Object.defineProperty(e,h,{get:function(){return this[b]},set:function(c){this[b]=c;this.trigger(Two.Events.change,h)}});e[b]=d}});_.extend(p.prototype,Backbone.Events,{set:function(e,h){this.x=e;this.y=h;return this},copy:function(e){this.x=e.x;this.y=e.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new p(this.x,this.y)},add:function(e,
h){this.x=e.x+h.x;this.y=e.y+h.y;return this},addSelf:function(e){this.x+=e.x;this.y+=e.y;return this},sub:function(e,h){this.x=e.x-h.x;this.y=e.y-h.y;return this},subSelf:function(e){this.x-=e.x;this.y-=e.y;return this},multiplySelf:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){e?(this.x/=e,this.y/=e):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+
this.y*e.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var h=this.x-e.x;e=this.y-e.y;return h*h+e*e},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,h){return this.set((e.x-this.x)*
h+this.x,(e.y-this.y)*h+this.y)},isZero:function(){return 1E-4>this.length()}});var k={set:function(e,h){this._x=e;this._y=h;return this.trigger(Two.Events.change)},copy:function(e){this._x=e.x;this._y=e.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new p(this._x,this._y)},add:function(e,h){this._x=e.x+h.x;this._y=e.y+h.y;return this.trigger(Two.Events.change)},addSelf:function(e){this._x+=e.x;this._y+=
e.y;return this.trigger(Two.Events.change)},sub:function(e,h){this._x=e.x-h.x;this._y=e.y-h.y;return this.trigger(Two.Events.change)},subSelf:function(e){this._x-=e.x;this._y-=e.y;return this.trigger(Two.Events.change)},multiplySelf:function(e){this._x*=e.x;this._y*=e.y;return this.trigger(Two.Events.change)},multiplyScalar:function(e){this._x*=e;this._y*=e;return this.trigger(Two.Events.change)},divideScalar:function(e){return e?(this._x/=e,this._y/=e,this.trigger(Two.Events.change)):this.clear()},
negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this._x*e.x+this._y*e.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var h=this._x-e.x;e=this._y-e.y;return h*h+e*e},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>
this.distanceTo(e)},lerp:function(e,h){return this.set((e.x-this._x)*h+this._x,(e.y-this._y)*h+this._y)},isZero:function(){return 1E-4>this.length()}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(Two.Vector.MakeGetterSetter(this,"x",this.x),Two.Vector.MakeGetterSetter(this,"y",this.y),_.extend(this,k),this._bound=!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var p=Two.Commands,k=Two.Anchor=function(e,h,d,b,c,q,a){Two.Vector.call(this,e,h);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(a){this._command=a;this._command===p.curve&&!_.isObject(this.controls)&&k.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=a||p.move;if(!a)return this;k.AppendCurveProperties(this);_.isNumber(d)&&(this.controls.left.x=
d);_.isNumber(b)&&(this.controls.left.y=b);_.isNumber(c)&&(this.controls.right.x=c);_.isNumber(q)&&(this.controls.right.y=q)};_.extend(k,{AppendCurveProperties:function(e){var h=e._x||e.x,d=e._y||e.y;e.controls={left:new Two.Vector(h,d),right:new Two.Vector(h,d)}}});_.extend(k.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||k.AppendCurveProperties(this);_.each(this.controls,function(e){e.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(e){e.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){var e=this.controls;return new Two.Anchor(this.x,this.y,e&&e.left.x,e&&e.left.y,e&&e.right.x,e&&e.right.y,this.command)}})})();(function(){_.range(6);var p=Math.cos,k=Math.sin,e=Math.tan,h=Two.Matrix=function(d,b,c,e,a,l){this.elements=new Two.Array(9);var n=d;_.isArray(n)||(n=_.toArray(arguments));this.identity().set(n)};_.extend(h,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(d,b){if(3>=b.length){var c=b[0]||0,e=b[1]||0,a=b[2]||0;return{x:d[0]*c+d[1]*e+d[2]*a,y:d[3]*c+d[4]*e+d[5]*a,z:d[6]*c+d[7]*e+d[8]*a}}var c=d[0],e=d[1],a=d[2],l=d[3],n=d[4],m=d[5],h=d[6],g=d[7],k=d[8],x=b[0],v=b[1],r=b[2],p=b[3],s=b[4],t=b[5],f=b[6],
y=b[7],A=b[8];return[c*x+e*p+a*f,c*v+e*s+a*y,c*r+e*t+a*A,l*x+n*p+m*f,l*v+n*s+m*y,l*r+n*t+m*A,h*x+g*p+k*f,h*v+g*s+k*y,h*r+g*t+k*A]}});_.extend(h.prototype,Backbone.Events,{set:function(d,b,c,e,a,l){var n=d;_.isArray(n)||(n=_.toArray(arguments));_.each(n,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(h.Identity);return this},multiply:function(d,b,c,e,a,l,n,m,h){var g=arguments,k=g.length;if(1>=k)return _.each(this.elements,
function(a,b){this.elements[b]=a*d},this),this.trigger(Two.Events.change);if(3>=k)return d=d||0,b=b||0,c=c||0,a=this.elements,{x:a[0]*d+a[1]*b+a[2]*c,y:a[3]*d+a[4]*b+a[5]*c,z:a[6]*d+a[7]*b+a[8]*c};k=this.elements;A0=k[0];A1=k[1];A2=k[2];A3=k[3];A4=k[4];A5=k[5];A6=k[6];A7=k[7];A8=k[8];B0=g[0];B1=g[1];B2=g[2];B3=g[3];B4=g[4];B5=g[5];B6=g[6];B7=g[7];B8=g[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=
A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this.trigger(Two.Events.change)},inverse:function(d){var b=this.elements;d=d||new Two.Matrix;var c=b[0],e=b[1],a=b[2],l=b[3],n=b[4],m=b[5],h=b[6],g=b[7],b=b[8],k=b*n-m*g,p=-b*l+m*h,v=g*l-n*h,r=c*k+e*p+a*v;if(!r)return null;r=1/r;d.elements[0]=k*r;d.elements[1]=(-b*e+a*g)*r;d.elements[2]=(m*e-a*n)*r;d.elements[3]=p*r;d.elements[4]=(b*c-
a*h)*r;d.elements[5]=(-m*c+a*l)*r;d.elements[6]=v*r;d.elements[7]=(-g*c+e*h)*r;d.elements[8]=(n*c-e*l)*r;return d},scale:function(d,b){1>=arguments.length&&(b=d);return this.multiply(d,0,0,0,b,0,0,0,1)},rotate:function(d){var b=p(d);d=k(d);return this.multiply(b,-d,0,d,b,0,0,0,1)},translate:function(d,b){return this.multiply(1,0,d,0,1,b,0,0,1)},skewX:function(d){d=e(d);return this.multiply(1,d,0,0,1,0,0,0,1)},skewY:function(d){d=e(d);return this.multiply(1,0,0,d,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},
toArray:function(d){var b=this.elements,c=parseFloat(b[0].toFixed(3)),e=parseFloat(b[1].toFixed(3)),a=parseFloat(b[2].toFixed(3)),l=parseFloat(b[3].toFixed(3)),n=parseFloat(b[4].toFixed(3)),m=parseFloat(b[5].toFixed(3));if(d){d=parseFloat(b[6].toFixed(3));var h=parseFloat(b[7].toFixed(3)),b=parseFloat(b[8].toFixed(3));return[c,l,d,e,n,h,a,m,b]}return[c,l,e,n,a,m]},clone:function(){return new Two.Matrix(this.elements[0],this.elements[1],this.elements[2],this.elements[3],this.elements[4],this.elements[5],
this.elements[6],this.elements[7],this.elements[8])}})})();(function(){function p(d){var b={},c=d.id,q=d.translation,a=d.rotation,l=d.scale,n=d.stroke,m=d.linewidth,k=d.fill,g=d.opacity,p=d.visible,x=d.cap,v=d.join,r=d.miter,z=d.closed,s=d.vertices;c&&(b.id=h.Identifier+c);q&&(_.isNumber(l)&&_.isNumber(a))&&(b.transform="matrix("+d._matrix.toString()+")");n&&(b.stroke=n);k&&(b.fill=k);g&&(b["stroke-opacity"]=b["fill-opacity"]=g);b.visibility=p?"visible":"hidden";x&&(b["stroke-linecap"]=x);v&&(b["stroke-linejoin"]=v);r&&(b["stroke-miterlimit"]=r);m&&(b["stroke-width"]=
m);s&&(b.d=e.toString(s,z));return b}var k=Two.Utils.mod,e={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(d,b){var c=document.createElementNS(this.ns,d);"svg"===d&&(b=_.defaults(b||{},{version:this.version}));_.isObject(b)&&this.setAttributes(c,b);return c},setAttributes:function(d,b){_.each(b,function(b,d){this.setAttribute(d,b)},d);return this},removeAttributes:function(d,b){_.each(b,function(b){this.removeAttribute(b)},d);return this},toString:function(d,
b){var c=d.length,e=c-1;return _.map(d,function(a,l){var n,m=b?k(l-1,c):Math.max(l-1,0),h=b?k(l+1,c):Math.min(l+1,e),m=d[m],h=d[h],g,p,x,v,r;r=a.x.toFixed(3);v=a.y.toFixed(3);switch(a._command){case Two.Commands.close:n=a._command;break;case Two.Commands.curve:g=m.controls&&m.controls.right||m;n=a.controls&&a.controls.left||a;m=g.x.toFixed(3);g=g.y.toFixed(3);p=n.x.toFixed(3);x=n.y.toFixed(3);n=a._command+" "+m+" "+g+" "+p+" "+x+" "+r+" "+v;break;default:n=(a._command||(0===l?Two.Commands.move:Two.Commands.line))+
" "+r+" "+v}l>=e&&b&&(a._command===Two.Commands.curve&&(v=a.controls&&a.controls.right||a,r=h.controls&&h.controls.left||h,m=v.x.toFixed(3),g=v.y.toFixed(3),p=r.x.toFixed(3),x=r.y.toFixed(3),r=h.x.toFixed(3),v=h.y.toFixed(3),n+=" C "+m+" "+g+" "+p+" "+x+" "+r+" "+v),n+=" Z");return n}).join(" ")}},h=Two[Two.Types.svg]=function(){this.count=0;this.domElement=e.createElement("svg");this.elements=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility=
"visible"},this))};_.extend(h,{Identifier:"two-",Utils:e});_.extend(h.prototype,Backbone.Events,{setSize:function(d,b){this.width=d;this.height=b;e.setAttributes(this.domElement,{width:d,height:b});return this},add:function(d){var b=d,c=this.elements,h=this.domElement;_.isArray(d)||(b=_.map(arguments,function(a){return a}));_.each(b,function(a){var b;b=a instanceof Two.Group;if(_.isUndefined(a.id)){var d=this.count;this.count++;a.id=d}b?(b="g",_.isUndefined(a.parent)&&(a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,
_.bind(this.update,this))),a=p(a),delete a.stroke,delete a.fill,delete a["fill-opacity"],delete a["stroke-opacity"],delete a["stroke-linecap"],delete a["stroke-linejoin"],delete a["stroke-miterlimit"],delete a["stroke-width"]):(b="path",a=p(a));a=e.createElement(b,a);h.appendChild(a);c.push(a)},this);return this},update:function(d,b,c,h){var a=this.elements,l=a[d];switch(b){case Two.Properties.hierarchy:_.each(c,function(b){l.appendChild(a[b])});break;case Two.Properties.demotion:_.each(c,function(b){l.removeChild(a[b])});
break;default:a:{d=b;switch(d){case "matrix":d="transform";c="matrix("+c.toString()+")";break;case "visible":d="visibility";c=c?"visible":"hidden";break;case "cap":d="stroke-linecap";break;case "join":d="stroke-linejoin";break;case "miter":d="stroke-miterlimit";break;case "linewidth":d="stroke-width";break;case "vertices":d="d";c=e.toString(c,h);break;case "opacity":e.setAttributes(l,{"stroke-opacity":c,"fill-opacity":c});break a}l.setAttribute(d,c)}}return this},render:function(){this.unveil();return this}})})();(function(){var p=Two.Utils.mod,k=function(b){_.each(b,function(b,d){this[d]=b},this);this.children=[]};_.extend(k.prototype,{appendChild:function(b){var c=b.parent;_.isUndefined(c)||c.removeChild(b);this.children.push(b);b.parent=this;return this},removeChild:function(b){b=_.indexOf(this.children,b);return 0>b?this:this.children.splice(b,1)[0]},render:function(b){var c=this.matrix;b.save();b.transform(c[0],c[1],c[2],c[3],c[4],c[5]);_.each(this.children,function(c){c.render(b)});b.restore();return this}});
var e=function(b){_.each(b,function(b,d){this[d]=b},this)};_.extend(e.prototype,{render:function(b){var c=this.matrix,d=this.stroke,a=this.linewidth,e=this.fill,h=this.opacity,m=this.cap,k=this.join,g=this.miter,u=this.closed,x=this.commands,v=x.length,r=v-1;if(!this.visible)return this;b.save();c&&b.transform(c[0],c[1],c[2],c[3],c[4],c[5]);e&&(b.fillStyle=e);d&&(b.strokeStyle=d);a&&(b.lineWidth=a);g&&(b.miterLimit=g);k&&(b.lineJoin=k);m&&(b.lineCap=m);_.isNumber(h)&&(b.globalAlpha=h);b.beginPath();
_.each(x,function(a,c){var d,f,e,l,g,m,h;h=a.x.toFixed(3);m=a.y.toFixed(3);switch(a._command){case Two.Commands.close:b.closePath();break;case Two.Commands.curve:f=u?p(c-1,v):Math.max(c-1,0);d=u?p(c+1,v):Math.min(c+1,r);f=x[f];d=x[d];e=f.controls&&f.controls.right||f;l=a.controls&&a.controls.left||a;f=e.x.toFixed(3);g=e.y.toFixed(3);e=l.x.toFixed(3);l=l.y.toFixed(3);b.bezierCurveTo(f,g,e,l,h,m);c>=r&&u&&(m=a.controls&&a.controls.right||a,h=d.controls&&d.controls.left||d,f=m.x.toFixed(3),g=m.y.toFixed(3),
e=h.x.toFixed(3),l=h.y.toFixed(3),h=d.x.toFixed(3),m=d.y.toFixed(3),b.bezierCurveTo(f,g,e,l,h,m));break;case Two.Commands.line:b.lineTo(h,m);break;case Two.Commands.move:b.moveTo(h,m)}});u&&b.closePath();b.fill();b.stroke();b.restore()}});var h={devicePixelRatio:this.devicePixelRatio||1,getBackingStoreRatio:function(b){return b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1},getRatio:function(b){return this.devicePixelRatio/
this.getBackingStoreRatio(b)}},d=Two[Two.Types.canvas]=function(){this.count=0;this.domElement=document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.elements=[];this.stage=null};_.extend(d,{Group:k,Element:e,getStyles:function(b){var c={},d=b.id,a=b._matrix,e=b.stroke,h=b.linewidth,m=b.fill,k=b.opacity,g=b.visible,p=b.cap,x=b.join,v=b.miter,r=b.closed;b=b.vertices;d&&(c.id=d);_.isObject(a)&&(c.matrix=a.toArray());e&&(c.stroke=e);m&&(c.fill=m);_.isNumber(k)&&
(c.opacity=k);p&&(c.cap=p);x&&(c.join=x);v&&(c.miter=v);h&&(c.linewidth=h);b&&(c.commands=b);c.visible=!!g;c.closed=!!r;return c},setStyles:function(b,c,d,a){switch(c){case "matrix":c="matrix";d=d.toArray();break;case "vertices":c="commands",b.closed=a}b[c]=d},Utils:h});_.extend(d.prototype,Backbone.Events,{setSize:function(b,c,d){this.width=b;this.height=c;this.ratio=_.isUndefined(d)?h.getRatio(this.ctx):d;this.domElement.width=b*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,
{width:b+"px",height:c+"px"});return this},add:function(b){constructor=Object.getPrototypeOf(this).constructor;var c=b,d=this.elements,a=constructor.Group,e=constructor.Element,h=constructor.getStyles;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(b){var c;c=b instanceof Two.Group;var g=_.isNull(this.stage);if(_.isUndefined(b.id)){var k=this.count;this.count++;b.id=k}c?(c=h.call(this,b),delete c.stroke,delete c.fill,delete c.opacity,delete c.cap,delete c.join,delete c.miter,
delete c.linewidth,c=new a(c),g&&(this.stage=c,this.stage.object=b,this.stage.parent=b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):c=new e(h.call(this,b));d.push(c);g||this.stage.appendChild(c)},this);return this},update:function(b,c,d,a,e){var h=Object.getPrototypeOf(this).constructor,m=this.elements,k=m[b];switch(c){case Two.Properties.hierarchy:_.each(d,function(a){k.appendChild(m[a])});break;case Two.Properties.demotion:_.each(d,function(a){k.removeChild(m[a]);
this.elements[a]=null},this);break;default:h.setStyles.call(this,k,c,d,a,e)}return this},render:function(){if(_.isNull(this.stage))return this;var b=1===this.ratio;b||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);b||this.ctx.restore();return this}})})();(function(){function p(a,b){var c=Math.min(a.top,b.top),d=Math.min(a.left,b.left),e=Math.max(a.right,b.right),g=Math.max(a.bottom,b.bottom);return{top:c,left:d,right:e,bottom:g,width:e-d,height:g-c,centroid:{x:-d,y:-c}}}var k=Two[Two.Types.canvas],e=Two.Matrix.Multiply,h=Two.Utils.mod,d=function(a){k.Group.call(this,a)};_.extend(d.prototype,k.Group.prototype,{appendChild:function(){k.Group.prototype.appendChild.apply(this,arguments);this.updateMatrix();return this},updateTexture:function(a){_.each(this.children,
function(b){b.updateTexture(a)});return this},updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=e(this.matrix,b);this._scale=this.scale*a;_.each(this.children,function(a){a.updateMatrix(this)},this);return this},render:function(a,b){_.each(this.children,function(c){c.render(a,b)})}});var b=function(a){k.Element.call(this,a)};_.extend(b.prototype,k.Element.prototype,{updateMatrix:function(a){var b=
a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=e(this.matrix,b);this._scale=this.scale*a;return this},updateTexture:function(a){c.updateTexture(a,this);return this},render:function(a,b){if(!this.visible||!this.opacity||!this.buffer)return this;a.bindBuffer(a.ARRAY_BUFFER,this.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this.texture);a.uniformMatrix3fv(b.matrix,
!1,this._matrix);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this}});var c={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(a,b){var c=Infinity,d=-Infinity,e=Infinity,g=-Infinity;_.each(a,function(a){var b=a.x,l=a.y,h;h=a.controls;e=Math.min(l,e);c=Math.min(b,c);d=Math.max(b,d);g=Math.max(l,g);a.controls&&(a=h.left,l=h.right,a&&l&&(h=a.x,a=a.y,b=l.x,
l=l.y,h&&(a&&b&&l)&&(e=Math.min(a,l,e),c=Math.min(h,b,c),d=Math.max(h,b,d),g=Math.max(a,l,g))))});_.isNumber(b)&&(e-=b,c-=b,d+=b,g+=b);return{top:e,left:c,right:d,bottom:g,width:d-c,height:g-e,centroid:{x:-c,y:-e}}},getTriangles:function(a){var b=a.top,c=a.left,d=a.right;a=a.bottom;return new Two.Array([c,b,d,b,c,a,c,a,d,b,d,a])},updateCanvas:function(a){var b=a.commands,c=this.canvas,d=this.ctx,e=a._scale,g=a.stroke,k=a.linewidth*e,q=a.fill,p=a.opacity,r=a.cap,z=a.join,s=a.miter,t=a.closed,f=b.length,
y=f-1;c.width=Math.max(Math.ceil(a.rect.width*e),1);c.height=Math.max(Math.ceil(a.rect.height*e),1);a=a.rect.centroid;var A=a.x*e,C=a.y*e;d.clearRect(0,0,c.width,c.height);q&&(d.fillStyle=q);g&&(d.strokeStyle=g);k&&(d.lineWidth=k);s&&(d.miterLimit=s);z&&(d.lineJoin=z);r&&(d.lineCap=r);_.isNumber(p)&&(d.globalAlpha=p);d.beginPath();_.each(b,function(a,c){var g,k,n,q,p,r,s;s=(a.x*e+A).toFixed(3);r=(a.y*e+C).toFixed(3);switch(a._command){case Two.Commands.close:d.closePath();break;case Two.Commands.curve:k=
t?h(c-1,f):Math.max(c-1,0);g=t?h(c+1,f):Math.min(c+1,y);k=b[k];g=b[g];n=k.controls&&k.controls.right||k;q=a.controls&&a.controls.left||a;k=(n.x*e+A).toFixed(3);p=(n.y*e+C).toFixed(3);n=(q.x*e+A).toFixed(3);q=(q.y*e+C).toFixed(3);d.bezierCurveTo(k,p,n,q,s,r);c>=y&&t&&(r=a.controls&&a.controls.right||a,s=g.controls&&g.controls.left||g,k=(r.x*e+A).toFixed(3),p=(r.y*e+C).toFixed(3),n=(s.x*e+A).toFixed(3),q=(s.y*e+C).toFixed(3),s=(g.x*e+A).toFixed(3),r=(g.y*e+C).toFixed(3),d.bezierCurveTo(k,p,n,q,s,r));
break;case Two.Commands.line:d.lineTo(s,r);break;case Two.Commands.move:d.moveTo(s,r)}});t&&d.closePath();d.fill();d.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b.texture&&a.deleteTexture(b.texture);a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);b.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,
a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b.buffer)&&a.deleteBuffer(b.buffer);b.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW);_.isObject(b.textureCoordsBuffer)&&a.deleteBuffer(b.textureCoordsBuffer);b.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);
a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)});a.linkProgram(c);if(!a.getProgramParameter(c,a.LINK_STATUS))throw error=a.getProgramInfoLog(c),a.deleteProgram(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){c=a.createShader(a[c]);a.shaderSource(c,b);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw b=
a.getShaderInfoLog(c),a.deleteShader(c),new Two.Utils.Error("unable to compile shader "+c+": "+b);return c},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};c.ctx=c.canvas.getContext("2d");var q=Two[Two.Types.webgl]=function(a){this.count=0;this.domElement=document.createElement("canvas");this.elements=[];this.stage=null;this._matrix=[1,0,0,0,1,0,0,0,1];this._scale=1;a=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!1});a=this.ctx=this.domElement.getContext("webgl",
a)||this.domElement.getContext("experimental-webgl",a);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var b=c.shaders.create(a,c.shaders.vertex,c.shaders.types.vertex),d=c.shaders.create(a,c.shaders.fragment,c.shaders.types.fragment);this.program=c.program.create(a,[b,d]);a.useProgram(this.program);this.program.position=a.getAttribLocation(this.program,"a_position");this.program.matrix=a.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=
a.getAttribLocation(this.program,"a_textureCoords");a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)};_.extend(q,{Group:d,Element:b,getStyles:function(a){var d={},e=a.id,h=a._matrix,k=a.stroke,g=a.linewidth,q=a.fill,p=a.opacity,v=a.visible,r=a.cap,z=a.join,s=a.miter,t=a.closed,f=a.vertices;e&&(d.id=e);_.isObject(h)&&(d.matrix=d._matrix=h.toArray(!0),d.scale=d._scale=1);k&&(d.stroke=
k);q&&(d.fill=q);_.isNumber(p)&&(d.opacity=p);r&&(d.cap=r);z&&(d.join=z);s&&(d.miter=s);g&&(d.linewidth=g);f&&(d.vertices=f,d.commands=d.vertices,d.rect=c.getBoundingClientRect(d.commands,d.linewidth),d.triangles=c.getTriangles(d.rect));d.visible=!!v;d.closed=!!t;a instanceof Two.Polygon&&(c.updateBuffer(this.ctx,d,this.program),b.prototype.updateTexture.call(d,this.ctx));return d},setStyles:function(a,b,d,e,h){var g=!1;/matrix/.test(b)?(a[b]=d.toArray(!0),_.isNumber(e)&&(g=a.scale!==e,a.scale=e),
a.updateMatrix()):/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(b)?(a[b]=d,a.rect=p(c.getBoundingClientRect(a.commands,a.linewidth),a.rect),a.triangles=c.getTriangles(a.rect),c.updateBuffer(this.ctx,a,this.program),g=!0):"vertices"===b?(_.isUndefined(e)||(a.closed=e),h?a.commands=d:(a.vertices=d,a.commands=a.vertices),a.rect=p(c.getBoundingClientRect(a.vertices,a.linewidth),a.rect),a.triangles=c.getTriangles(a.rect),c.updateBuffer(this.ctx,a,this.program),g=!0):a[b]=d;g&&a.updateTexture(this.ctx)}});
_.extend(q.prototype,Backbone.Events,k.prototype,{setSize:function(a,b,c){k.prototype.setSize.apply(this,arguments);a*=this.ratio;b*=this.ratio;this._matrix[0]=this._matrix[4]=this._scale=this.ratio;_.isNull(this.stage)||this.stage.updateMatrix();this.ctx.viewport(0,0,a,b);var d=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(d,a,b);return this},render:function(){if(_.isNull(this.stage))return this;this.stage.render(this.ctx,this.program);return this}})})();(function(){var p=Two.Shape=function(k){this._matrix=new Two.Matrix;var e=_.debounce(_.bind(function(){var e=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",e,this.scale)},this),0);this._rotation=0;Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(h){this._rotation=h;e()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(h){this._scale=h;e()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,e);if(k)return this;p.MakeGetterSetter(this,p.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4};_.extend(p,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(k,e){_.isArray(e)||(e=[e]);_.each(e,function(e){var d="_"+e;Object.defineProperty(k,
e,{get:function(){return this[d]},set:function(b){this[d]=b;this.trigger(Two.Events.change,this.id,e,b,this)}})})}});_.extend(p.prototype,Backbone.Events,{addTo:function(k){k.add(this);return this},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},clone:function(){var k=new p;k.translation.copy(this.translation);_.each(p.Properties,function(e){k[e]=this[e]},this);return this}})})();(function(){var p=Math.min,k=Math.max,e=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;e.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(e,{MakeGetterSetter:function(e,d){_.isArray(d)||(d=[d]);_.each(d,function(b){var c="_"+b;Object.defineProperty(e,b,{get:function(){return this[c]},set:function(d){this[c]=d;_.each(this.children,function(a){a[b]=d})}})})}});
_.extend(e.prototype,Two.Shape.prototype,{clone:function(h){h=h||this.parent;var d=_.map(this.children,function(b){return b.clone(h)}),b=new e;h.add(b);b.add(d);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},corner:function(){var e=this.getBoundingClientRect(!0),d={x:e.left,y:e.top};_.each(this.children,function(b){b.translation.subSelf(d)});return this},center:function(){var e=this.getBoundingClientRect(!0);e.centroid={x:e.left+e.width/2,y:e.top+e.height/
2};_.each(this.children,function(d){d.translation.subSelf(e.centroid)});return this},add:function(e){var d=e,b=this.children,c=this.parent,k=[];_.isArray(e)||(d=_.toArray(arguments));var a=_.bind(function(a,b,c,d,e){this.trigger(Two.Events.change,a,b,c,d,e)},this);_.each(d,function(d){if(d){var e=d.id,h=d.parent;_.isUndefined(e)&&(c.add(d),e=d.id);_.isUndefined(b[e])&&(h&&delete h.children[e],b[e]=d,d.parent=this,d.unbind(Two.Events.change).bind(Two.Events.change,a),k.push(e))}},this);0<k.length&&
this.trigger(Two.Events.change,this.id,Two.Properties.hierarchy,k);return this},remove:function(e){var d=e,b=this.children,c=this.parent,k=[];if(0>=arguments.length&&c)return c.remove(this),this;_.isArray(e)||(d=_.toArray(arguments));_.each(d,function(a){var c=a.id;c in b&&(delete b[c],delete a.parent,a.unbind(Two.Events.change),k.push(c))});0<k.length&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,k);return this},getBoundingClientRect:function(e){var d=Infinity,b=-Infinity,c=Infinity,
q=-Infinity;_.each(this.children,function(a){a=a.getBoundingClientRect(!0);_.isNumber(a.top)&&(_.isNumber(a.left)&&_.isNumber(a.right)&&_.isNumber(a.bottom))&&(c=p(a.top,c),d=p(a.left,d),b=k(a.right,b),q=k(a.bottom,q))},this);var a=e?this._matrix:Two.Utils.getComputedMatrix(this);e=a.multiply(d,c,1);var l=a.multiply(b,c,1),n=a.multiply(b,q,1),a=a.multiply(d,q,1),c=p(e.y,l.y,n.y,a.y),d=p(e.x,l.x,n.x,a.x),b=k(e.x,l.x,n.x,a.x),q=k(e.y,l.y,n.y,a.y);return{top:c,left:d,right:b,bottom:q,width:b-d,height:q-
c}},noFill:function(){_.each(this.children,function(e){e.noFill()});return this},noStroke:function(){_.each(this.children,function(e){e.noStroke()});return this},subdivide:function(){_.each(this.children,function(e){e.subdivide()});return this}})})();(function(){var p=Math.min,k=Math.max,e=Math.round,h=Two.Polygon=function(d,b,c,h){Two.Shape.call(this);this._closed=!!b;this._curved=!!c;this._automatic=!h;var a=0,l=1,n=!1,m=!1,w,g=[],u=_.debounce(_.bind(function(){var b,c;this._automatic&&this.plot();if(n||m){b=w.length;c=b-1;b=e(a*c);c=e(l*c);for(g.length=0;b<c+1;b++)g.push(w[b])}this.trigger(Two.Events.change,this.id,"vertices",g,this._closed,n);m=n=!1},this),0);Object.defineProperty(this,"closed",{get:function(){return this._closed},set:function(a){this._closed=
!!a;u()}});Object.defineProperty(this,"curved",{get:function(){return this._curved},set:function(a){this._curved=!!a;u()}});Object.defineProperty(this,"automatic",{get:function(){return this._automatic},set:function(a){if(a!==this._automatic){var b=(this._automatic=!!a)?"ignore":"listen";_.each(this.vertices,function(a){a[b]()},this);u()}}});Object.defineProperty(this,"beginning",{get:function(){return a},set:function(b){a=p(k(b,0),1);n=!0;u()}});Object.defineProperty(this,"ending",{get:function(){return l},
set:function(a){l=p(k(a,0),1);n=!0;u()}});Object.defineProperty(this,"vertices",{get:function(){return w},set:function(a){var b=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,u)},this);m=!0;u()},this),c=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,u)},this);m=!0;u()},this);w&&w.unbind();w=new Two.Utils.Collection(a.slice(0));w.bind(Two.Events.insert,b);w.bind(Two.Events.remove,c);m=!0;b(w)}});this.vertices=d;if(this._automatic)return this.plot(),this;_.each(this.vertices,
function(a){_.isFunction(a.listen)&&a.listen()})};_.extend(h.prototype,Two.Shape.prototype,{clone:function(){var d=_.map(this.vertices,function(b){return b.clone()}),b=new h(d,this._closed,this._curved);_.each(Two.Shape.Properties,function(c){b[c]=this[c]},this);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},corner:function(){var d=this.getBoundingClientRect(!0),b={x:d.left,y:d.top};_.each(this.vertices,function(c){c.subSelf(b)});return this},center:function(){var d=
this.getBoundingClientRect(!0);d.centroid={x:d.left+d.width/2,y:d.top+d.height/2};_.each(this.vertices,function(b){b.subSelf(d.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(d){var b=this.linewidth/2,c=Infinity,e=-Infinity,a=Infinity,h=-Infinity;_.each(this.vertices,function(b){var d=b.x;b=b.y;a=p(b,a);c=p(d,c);e=k(d,e);h=k(b,h)});var a=a-b,c=c-b,e=e+b,h=h+b,n=d?this._matrix:Two.Utils.getComputedMatrix(this);
d=n.multiply(c,a,1);var b=n.multiply(e,a,1),m=n.multiply(e,h,1),n=n.multiply(c,h,1),a=p(d.y,b.y,m.y,n.y),c=p(d.x,b.x,m.x,n.x),e=k(d.x,b.x,m.x,n.x),h=k(d.y,b.y,m.y,n.y);return{top:a,left:c,right:e,bottom:h,width:e-c,height:h-a}},plot:function(){if(this._curved)return Two.Utils.getCurveFromPoints(this.vertices,this._closed),this;_.each(this.vertices,function(d,b){d._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(){var d=this.vertices.length-1,b=this._closed||
this.vertices[d].command===Two.Commands.close,c=[],e;_.each(this.vertices,function(a,d){var h,k,p,g,u,x,v,r;if(!(0>=d)||b)h=e.x,k=e.y,p=(e.controls&&e.controls.right||e).x,g=(e.controls&&e.controls.right||e).y,u=(a.controls&&a.controls.left||a).x,x=(a.controls&&a.controls.left||a).y,v=a.x,r=a.y,c.push(Two.Utils.subdivide(h,k,p,g,u,x,v,r));e=a},this);this._curved=this._manual=!1;this.vertices=_.flatten(c);this.plot();return this}})})();
