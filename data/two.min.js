(function(){var C=this,p=C._,l={},f=Array.prototype,n=Object.prototype,q=f.push,e=f.slice,k=f.concat,m=n.toString,z=n.hasOwnProperty,E=f.forEach,t=f.map,A=f.reduce,s=f.reduceRight,D=f.filter,g=f.every,u=f.some,v=f.indexOf,y=f.lastIndexOf,n=Array.isArray,w=Object.keys,G=Function.prototype.bind,c=function(a){if(a instanceof c)return a;if(!(this instanceof c))return new c(a);this._wrapped=a};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=c),exports._=
c):C._=c;c.VERSION="1.5.1";var B=c.each=c.forEach=function(a,h,x){if(null!=a)if(E&&a.forEach===E)a.forEach(h,x);else if(a.length===+a.length)for(var b=0,d=a.length;b<d&&h.call(x,a[b],b,a)!==l;b++);else for(b in a)if(c.has(a,b)&&h.call(x,a[b],b,a)===l)break};c.map=c.collect=function(a,h,x){var b=[];if(null==a)return b;if(t&&a.map===t)return a.map(h,x);B(a,function(a,c,d){b.push(h.call(x,a,c,d))});return b};c.reduce=c.foldl=c.inject=function(a,h,x,b){var d=2<arguments.length;null==a&&(a=[]);if(A&&a.reduce===
A)return b&&(h=c.bind(h,b)),d?a.reduce(h,x):a.reduce(h);B(a,function(a,c,r){d?x=h.call(b,x,a,c,r):(x=a,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return x};c.reduceRight=c.foldr=function(a,h,x,b){var d=2<arguments.length;null==a&&(a=[]);if(s&&a.reduceRight===s)return b&&(h=c.bind(h,b)),d?a.reduceRight(h,x):a.reduceRight(h);var r=a.length;if(r!==+r)var j=c.keys(a),r=j.length;B(a,function(c,g,m){g=j?j[--r]:--r;d?x=h.call(b,x,a[g],g,m):(x=a[g],d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");
return x};c.find=c.detect=function(a,h,x){var b;d(a,function(a,c,d){if(h.call(x,a,c,d))return b=a,!0});return b};c.filter=c.select=function(a,h,x){var b=[];if(null==a)return b;if(D&&a.filter===D)return a.filter(h,x);B(a,function(a,c,d){h.call(x,a,c,d)&&b.push(a)});return b};c.reject=function(a,h,x){return c.filter(a,function(a,b,c){return!h.call(x,a,b,c)},x)};c.every=c.all=function(a,h,x){h||(h=c.identity);var b=!0;if(null==a)return b;if(g&&a.every===g)return a.every(h,x);B(a,function(a,c,d){if(!(b=
b&&h.call(x,a,c,d)))return l});return!!b};var d=c.some=c.any=function(a,h,x){h||(h=c.identity);var b=!1;if(null==a)return b;if(u&&a.some===u)return a.some(h,x);B(a,function(a,c,d){if(b||(b=h.call(x,a,c,d)))return l});return!!b};c.contains=c.include=function(a,h){return null==a?!1:v&&a.indexOf===v?-1!=a.indexOf(h):d(a,function(a){return a===h})};c.invoke=function(a,h){var b=e.call(arguments,2),d=c.isFunction(h);return c.map(a,function(a){return(d?h:a[h]).apply(a,b)})};c.pluck=function(a,h){return c.map(a,
function(a){return a[h]})};c.where=function(a,h,b){return c.isEmpty(h)?b?void 0:[]:c[b?"find":"filter"](a,function(a){for(var b in h)if(h[b]!==a[b])return!1;return!0})};c.findWhere=function(a,h){return c.where(a,h,!0)};c.max=function(a,h,b){if(!h&&c.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!h&&c.isEmpty(a))return-Infinity;var d={computed:-Infinity,value:-Infinity};B(a,function(a,c,r){c=h?h.call(b,a,c,r):a;c>d.computed&&(d={value:a,computed:c})});return d.value};c.min=
function(a,h,b){if(!h&&c.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!h&&c.isEmpty(a))return Infinity;var d={computed:Infinity,value:Infinity};B(a,function(a,c,r){c=h?h.call(b,a,c,r):a;c<d.computed&&(d={value:a,computed:c})});return d.value};c.shuffle=function(a){var h,b=0,d=[];B(a,function(a){h=c.random(b++);d[b-1]=d[h];d[h]=a});return d};var b=function(a){return c.isFunction(a)?a:function(h){return h[a]}};c.sortBy=function(a,h,x){var d=b(h);return c.pluck(c.map(a,function(a,
h,b){return{value:a,index:h,criteria:d.call(x,a,h,b)}}).sort(function(a,h){var b=a.criteria,c=h.criteria;if(b!==c){if(b>c||void 0===b)return 1;if(b<c||void 0===c)return-1}return a.index<h.index?-1:1}),"value")};var r=function(a,h,x,d){var r={},j=b(null==h?c.identity:h);B(a,function(h,b){var c=j.call(x,h,b,a);d(r,c,h)});return r};c.groupBy=function(a,h,b){return r(a,h,b,function(a,h,b){(c.has(a,h)?a[h]:a[h]=[]).push(b)})};c.countBy=function(a,h,b){return r(a,h,b,function(a,h){c.has(a,h)||(a[h]=0);
a[h]++})};c.sortedIndex=function(a,h,d,r){d=null==d?c.identity:b(d);h=d.call(r,h);for(var j=0,g=a.length;j<g;){var m=j+g>>>1;d.call(r,a[m])<h?j=m+1:g=m}return j};c.toArray=function(a){return!a?[]:c.isArray(a)?e.call(a):a.length===+a.length?c.map(a,c.identity):c.values(a)};c.size=function(a){return null==a?0:a.length===+a.length?a.length:c.keys(a).length};c.first=c.head=c.take=function(a,h,b){return null==a?void 0:null!=h&&!b?e.call(a,0,h):a[0]};c.initial=function(a,h,b){return e.call(a,0,a.length-
(null==h||b?1:h))};c.last=function(a,h,b){return null==a?void 0:null!=h&&!b?e.call(a,Math.max(a.length-h,0)):a[a.length-1]};c.rest=c.tail=c.drop=function(a,h,b){return e.call(a,null==h||b?1:h)};c.compact=function(a){return c.filter(a,c.identity)};var j=function(a,h,b){if(h&&c.every(a,c.isArray))return k.apply(b,a);B(a,function(a){c.isArray(a)||c.isArguments(a)?h?q.apply(b,a):j(a,h,b):b.push(a)});return b};c.flatten=function(a,h){return j(a,h,[])};c.without=function(a){return c.difference(a,e.call(arguments,
1))};c.uniq=c.unique=function(a,h,b,d){c.isFunction(h)&&(d=b,b=h,h=!1);b=b?c.map(a,b,d):a;var r=[],j=[];B(b,function(b,d){if(h?!d||j[j.length-1]!==b:!c.contains(j,b))j.push(b),r.push(a[d])});return r};c.union=function(){return c.uniq(c.flatten(arguments,!0))};c.intersection=function(a){var h=e.call(arguments,1);return c.filter(c.uniq(a),function(a){return c.every(h,function(h){return 0<=c.indexOf(h,a)})})};c.difference=function(a){var h=k.apply(f,e.call(arguments,1));return c.filter(a,function(a){return!c.contains(h,
a)})};c.zip=function(){for(var a=c.max(c.pluck(arguments,"length").concat(0)),h=Array(a),b=0;b<a;b++)h[b]=c.pluck(arguments,""+b);return h};c.object=function(a,h){if(null==a)return{};for(var b={},c=0,d=a.length;c<d;c++)h?b[a[c]]=h[c]:b[a[c][0]]=a[c][1];return b};c.indexOf=function(a,b,d){if(null==a)return-1;var r=0,j=a.length;if(d)if("number"==typeof d)r=0>d?Math.max(0,j+d):d;else return r=c.sortedIndex(a,b),a[r]===b?r:-1;if(v&&a.indexOf===v)return a.indexOf(b,d);for(;r<j;r++)if(a[r]===b)return r;
return-1};c.lastIndexOf=function(a,b,d){if(null==a)return-1;var c=null!=d;if(y&&a.lastIndexOf===y)return c?a.lastIndexOf(b,d):a.lastIndexOf(b);for(d=c?d:a.length;d--;)if(a[d]===b)return d;return-1};c.range=function(a,b,d){1>=arguments.length&&(b=a||0,a=0);d=arguments[2]||1;for(var c=Math.max(Math.ceil((b-a)/d),0),r=0,j=Array(c);r<c;)j[r++]=a,a+=d;return j};var F=function(){};c.bind=function(a,b){var d,r;if(G&&a.bind===G)return G.apply(a,e.call(arguments,1));if(!c.isFunction(a))throw new TypeError;
d=e.call(arguments,2);return r=function(){if(!(this instanceof r))return a.apply(b,d.concat(e.call(arguments)));F.prototype=a.prototype;var c=new F;F.prototype=null;var j=a.apply(c,d.concat(e.call(arguments)));return Object(j)===j?j:c}};c.partial=function(a){var b=e.call(arguments,1);return function(){return a.apply(this,b.concat(e.call(arguments)))}};c.bindAll=function(a){var b=e.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");B(b,function(b){a[b]=c.bind(a[b],
a)});return a};c.memoize=function(a,b){var d={};b||(b=c.identity);return function(){var r=b.apply(this,arguments);return c.has(d,r)?d[r]:d[r]=a.apply(this,arguments)}};c.delay=function(a,b){var d=e.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},b)};c.defer=function(a){return c.delay.apply(c,[a,1].concat(e.call(arguments,1)))};c.throttle=function(a,b,d){var c,r,j,g=null,m=0;d||(d={});var f=function(){m=!1===d.leading?0:new Date;g=null;j=a.apply(c,r)};return function(){var e=
new Date;!m&&!1===d.leading&&(m=e);var F=b-(e-m);c=this;r=arguments;0>=F?(clearTimeout(g),g=null,m=e,j=a.apply(c,r)):!g&&!1!==d.trailing&&(g=setTimeout(f,F));return j}};c.debounce=function(a,b,d){var c,r=null;return function(){var j=this,g=arguments,m=d&&!r;clearTimeout(r);r=setTimeout(function(){r=null;d||(c=a.apply(j,g))},b);m&&(c=a.apply(j,g));return c}};c.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;d=a.apply(this,arguments);a=null;return d}};c.wrap=function(a,b){return function(){var d=
[a];q.apply(d,arguments);return b.apply(this,d)}};c.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,b)];return b[0]}};c.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};c.keys=w||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)c.has(a,d)&&b.push(d);return b};c.values=function(a){var b=[],d;for(d in a)c.has(a,d)&&b.push(a[d]);return b};c.pairs=function(a){var b=
[],d;for(d in a)c.has(a,d)&&b.push([d,a[d]]);return b};c.invert=function(a){var b={},d;for(d in a)c.has(a,d)&&(b[a[d]]=d);return b};c.functions=c.methods=function(a){var b=[],d;for(d in a)c.isFunction(a[d])&&b.push(d);return b.sort()};c.extend=function(a){B(e.call(arguments,1),function(b){if(b)for(var d in b)a[d]=b[d]});return a};c.pick=function(a){var b={},d=k.apply(f,e.call(arguments,1));B(d,function(d){d in a&&(b[d]=a[d])});return b};c.omit=function(a){var b={},d=k.apply(f,e.call(arguments,1)),
r;for(r in a)c.contains(d,r)||(b[r]=a[r]);return b};c.defaults=function(a){B(e.call(arguments,1),function(b){if(b)for(var d in b)void 0===a[d]&&(a[d]=b[d])});return a};c.clone=function(a){return!c.isObject(a)?a:c.isArray(a)?a.slice():c.extend({},a)};c.tap=function(a,b){b(a);return a};var I=function(a,b,d,r){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof c&&(a=a._wrapped);b instanceof c&&(b=b._wrapped);var j=m.call(a);if(j!=m.call(b))return!1;switch(j){case "[object String]":return a==
String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var g=d.length;g--;)if(d[g]==a)return r[g]==b;var g=a.constructor,f=b.constructor;if(g!==f&&(!c.isFunction(g)||!(g instanceof g&&c.isFunction(f)&&f instanceof f)))return!1;d.push(a);r.push(b);g=
0;f=!0;if("[object Array]"==j){if(g=a.length,f=g==b.length)for(;g--&&(f=I(a[g],b[g],d,r)););}else{for(var e in a)if(c.has(a,e)&&(g++,!(f=c.has(b,e)&&I(a[e],b[e],d,r))))break;if(f){for(e in b)if(c.has(b,e)&&!g--)break;f=!g}}d.pop();r.pop();return f};c.isEqual=function(a,b){return I(a,b,[],[])};c.isEmpty=function(a){if(null==a)return!0;if(c.isArray(a)||c.isString(a))return 0===a.length;for(var b in a)if(c.has(a,b))return!1;return!0};c.isElement=function(a){return!!(a&&1===a.nodeType)};c.isArray=n||
function(a){return"[object Array]"==m.call(a)};c.isObject=function(a){return a===Object(a)};B("Arguments Function String Number Date RegExp".split(" "),function(a){c["is"+a]=function(b){return m.call(b)=="[object "+a+"]"}});c.isArguments(arguments)||(c.isArguments=function(a){return!(!a||!c.has(a,"callee"))});"function"!==typeof/./&&(c.isFunction=function(a){return"function"===typeof a});c.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};c.isNaN=function(a){return c.isNumber(a)&&a!=
+a};c.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==m.call(a)};c.isNull=function(a){return null===a};c.isUndefined=function(a){return void 0===a};c.has=function(a,b){return z.call(a,b)};c.noConflict=function(){C._=p;return this};c.identity=function(a){return a};c.times=function(a,b,d){for(var c=Array(Math.max(0,a)),r=0;r<a;r++)c[r]=b.call(d,r);return c};c.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var J={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",
'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};J.unescape=c.invert(J.escape);var M={escape:RegExp("["+c.keys(J.escape).join("")+"]","g"),unescape:RegExp("("+c.keys(J.unescape).join("|")+")","g")};c.each(["escape","unescape"],function(a){c[a]=function(b){return null==b?"":(""+b).replace(M[a],function(b){return J[a][b]})}});c.result=function(a,b){if(null!=a){var d=a[b];return c.isFunction(d)?d.call(a):d}};c.mixin=function(a){B(c.functions(a),function(b){var d=c[b]=a[b];c.prototype[b]=function(){var a=[this._wrapped];
q.apply(a,arguments);a=d.apply(c,a);return this._chain?c(a).chain():a}})};var H=0;c.uniqueId=function(a){var b=++H+"";return a?a+b:b};c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,S={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},T=/\\|'|\r|\n|\t|\u2028|\u2029/g;c.template=function(a,b,d){var r;d=c.defaults({},d,c.templateSettings);var j=RegExp([(d.escape||O).source,(d.interpolate||O).source,(d.evaluate||
O).source].join("|")+"|$","g"),g=0,m="__p+='";a.replace(j,function(b,d,c,r,j){m+=a.slice(g,j).replace(T,function(a){return"\\"+S[a]});d&&(m+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'");c&&(m+="'+\n((__t=("+c+"))==null?'':__t)+\n'");r&&(m+="';\n"+r+"\n__p+='");g=j+b.length;return b});m+="';\n";d.variable||(m="with(obj||{}){\n"+m+"}\n");m="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+m+"return __p;\n";try{r=new Function(d.variable||"obj","_",m)}catch(f){throw f.source=
m,f;}if(b)return r(b,c);b=function(a){return r.call(this,a,c)};b.source="function("+(d.variable||"obj")+"){\n"+m+"}";return b};c.chain=function(a){return c(a).chain()};c.mixin(c);B("pop push reverse shift sort splice unshift".split(" "),function(a){var b=f[a];c.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);("shift"==a||"splice"==a)&&0===d.length&&delete d[0];return this._chain?c(d).chain():d}});B(["concat","join","slice"],function(a){var b=f[a];c.prototype[a]=function(){var a=b.apply(this._wrapped,
arguments);return this._chain?c(a).chain():a}});c.extend(c.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var C=[].slice,p=function(f,n,q){var e;f=-1;var k=n.length;switch(q.length){case 0:for(;++f<k;)(e=n[f]).callback.call(e.ctx);break;case 1:for(;++f<k;)(e=n[f]).callback.call(e.ctx,q[0]);break;case 2:for(;++f<k;)(e=n[f]).callback.call(e.ctx,q[0],q[1]);break;case 3:for(;++f<k;)(e=n[f]).callback.call(e.ctx,q[0],q[1],q[2]);break;default:for(;++f<k;)(e=n[f]).callback.apply(e.ctx,q)}},l=Backbone.Events={on:function(f,n,q){this._events||(this._events={});(this._events[f]||(this._events[f]=[])).push({callback:n,
context:q,ctx:q||this});return this},once:function(f,n,q){var e=this,k=_.once(function(){e.off(f,k);n.apply(this,arguments)});k._callback=n;this.on(f,k,q);return this},off:function(f,n,q){var e,k,m,l,p,t,A,s;if(!this._events)return this;if(!f&&!n&&!q)return this._events={},this;l=f?[f]:_.keys(this._events);p=0;for(t=l.length;p<t;p++)if(f=l[p],e=this._events[f]){m=[];if(n||q){A=0;for(s=e.length;A<s;A++)k=e[A],(n&&n!==(k.callback._callback||k.callback)||q&&q!==k.context)&&m.push(k)}this._events[f]=
m}return this},trigger:function(f){if(!this._events)return this;var n=C.call(arguments,1),q=this._events[f],e=this._events.all;q&&p(this,q,n);e&&p(this,e,arguments);return this},listenTo:function(f,n,q){var e=this._listeners||(this._listeners={}),k=f._listenerId||(f._listenerId=_.uniqueId("l"));e[k]=f;f.on(n,q||this,this);return this},stopListening:function(f,n,q){var e=this._listeners;if(e){if(f)f.off(n,q,this),!n&&!q&&delete e[f._listenerId];else{for(var k in e)e[k].off(null,null,this);this._listeners=
{}}return this}}};l.bind=l.on;l.unbind=l.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=l),exports.Backbone=exports.Backbone||Backbone)})();(function(){function C(f){var e=(new Date).getTime(),k=Math.max(0,16-(e-l)),m=p.setTimeout(function(){f(e+k)},k);l=e+k;return m}var p=this,l=0,f=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=C),exports.requestAnimationFrame=C;else{for(var n=0;n<f.length&&!p.requestAnimationFrame;++n)p.requestAnimationFrame=p[f[n]+"RequestAnimationFrame"],p.cancelAnimationFrame=p[f[n]+"CancelAnimationFrame"]||p[f[n]+"CancelRequestAnimationFrame"];
p.requestAnimationFrame||(p.requestAnimationFrame=C);p.cancelAnimationFrame||(p.cancelAnimationFrame=function(f){clearTimeout(f)})}})();(function(){function C(){var d=document.body.getBoundingClientRect(),b=this.width=d.width,d=this.height=d.height;this.renderer.setSize(b,d,this.ratio);this.trigger(g.Events.resize,b,d)}var p=this,l=p.Two||{},f=Math.sin,n=Math.cos,q=Math.atan2,e=Math.sqrt,k=Math.abs,m=Math.PI,z=2*m,E=m/2,t=Math.pow,A=Math.max,s=0,D={hasEventListeners:_.isFunction(p.addEventListener),bind:function(d,b,c,j){this.hasEventListeners?d.addEventListener(b,c,!!j):d.attachEvent("on"+b,c);return this},unbind:function(d,b,c,
j){this.hasEventListeners?d.removeEventListeners(b,c,!!j):d.detachEvent("on"+b,c);return this}},g=p.Two=function(d){d=_.defaults(d||{},{fullscreen:!1,width:640,height:480,type:g.Types.svg,autostart:!1});_.each(d,function(b,d){"fullscreen"===d||("width"===d||"height"===d||"autostart"===d)||(this[d]=b)},this);_.isElement(d.domElement)&&(this.type=g.Types[d.domElement.tagName.toLowerCase()]);this.renderer=new g[this.type](this);g.Utils.setPlaying.call(this,d.autostart);this.frameCount=0;d.fullscreen?
(d=_.bind(C,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),D.bind(p,"resize",d),d()):_.isElement(d.domElement)||(this.renderer.setSize(d.width,d.height,this.ratio),this.width=d.width,this.height=d.height);this.scene=this.renderer.scene;g.Instances.push(this)};_.extend(g,{Array:p.Float32Array||Array,Types:{webgl:"WebGLRenderer",
svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){p.Two=l;return this},uniqueId:function(){var d=s;s++;return d},Utils:{Curve:{CollinearityEpsilon:t(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,
angle:0,epsilon:0.01}},devicePixelRatio:p.devicePixelRatio||1,getBackingStoreRatio:function(d){return d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1},getRatio:function(d){return g.Utils.devicePixelRatio/c(d)},setPlaying:function(d){this.playing=!!d;return this},getComputedMatrix:function(d,b){b=b&&b.identity()||new g.Matrix;for(var c=d;c&&c._matrix;){var j=c._matrix.elements;b.multiply(j[0],j[1],j[2],
j[3],j[4],j[5],j[6],j[7],j[8],j[9]);c=c.parent}return b},applySvgAttributes:function(d,b){b.cap="butt";b.join="bevel";_.each(d.attributes,function(d){switch(d.nodeName){case "visibility":b.visible=!!d.nodeValue;break;case "stroke-linecap":b.cap=d.nodeValue;break;case "stroke-linejoin":b.join=d.nodeValue;break;case "stroke-miterlimit":b.miter=d.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(d.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=d.nodeValue;break;case "fill":b.fill=
d.nodeValue;break;case "stroke":b.stroke=d.nodeValue}});return b},read:{svg:function(){return g.Utils.read.g.apply(this,arguments)},g:function(d){var b=new g.Group;this.add(b);_.each(d.childNodes,function(d){var c=d.nodeName;c&&(c=c.replace(/svg\:/ig,"").toLowerCase(),c in g.Utils.read&&(d=g.Utils.read[c].call(this,d),b.add(d)))},this);return g.Utils.applySvgAttributes(d,b)},polygon:function(d,b){var c=[];d.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,function(b,d,j){c.push(new g.Anchor(parseFloat(d),
parseFloat(j)))});var j=(new g.Polygon(c,!b)).noStroke();return g.Utils.applySvgAttributes(d,j)},polyline:function(d){return g.Utils.read.polygon(d,!0)},path:function(d){var b,c,j,m=!1,f=!1,e=d.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),q=e.length-1,e=_.flatten(_.map(e,function(d,e){var k,n,a=d[0],h=a.toLowerCase();j=d.slice(1).trim();j=j.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,d){return parseFloat(b)*Math.pow(10,d)});j=j.split(/[\s,]+|(?=\s?[+\-])/);m=a===h;var x,l,z,p;switch(h){case "z":e>=
q?f=!0:(n=b.x,k=b.y,k=new g.Anchor(n,k,void 0,void 0,void 0,void 0,g.Commands.close));break;case "m":case "l":n=parseFloat(j[0]);k=parseFloat(j[1]);k=new g.Anchor(n,k,void 0,void 0,void 0,void 0,"m"===h?g.Commands.move:g.Commands.line);m&&k.addSelf(b);b=k;break;case "h":case "v":n="h"===h?"x":"y";a="x"===n?"y":"x";k=new g.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,g.Commands.line);k[n]=parseFloat(j[0]);k[a]=b[a];m&&(k[n]+=b[n]);b=k;break;case "s":case "c":k=b.x;a=b.y;c||(c=(new g.Vector).copy(b));
"c"===h?(x=parseFloat(j[0]),n=parseFloat(j[1]),h=parseFloat(j[2]),l=parseFloat(j[3]),z=parseFloat(j[4]),p=parseFloat(j[5])):(l=g.Utils.getReflection(b,c,m),x=l.x,n=l.y,h=parseFloat(j[0]),l=parseFloat(j[1]),z=parseFloat(j[2]),p=parseFloat(j[3]));m&&(x+=k,n+=a,h+=k,l+=a,z+=k,p+=a);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(x,n);b=k=new g.Anchor(z,p,h,l,void 0,void 0,g.Commands.curve);c=k.controls.left;break;case "t":case "q":k=b.x;a=b.y;c||(c=(new g.Vector).copy(b));
c.isZero()?(x=k,n=a):(x=c.x,a=c.y);"q"===h?(h=parseFloat(j[0]),l=parseFloat(j[1]),z=parseFloat(j[1]),p=parseFloat(j[2])):(l=g.Utils.getReflection(b,c,m),h=l.x,l=l.y,z=parseFloat(j[0]),p=parseFloat(j[1]));m&&(x+=k,n+=a,h+=k,l+=a,z+=k,p+=a);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(x,n);b=k=new g.Anchor(z,p,h,l,void 0,void 0,g.Commands.curve);c=k.controls.left;break;case "a":throw new g.Utils.Error("not yet able to interpret Elliptical Arcs.");}return k}));if(!(1>=
e.length))return e=_.compact(e),e=(new g.Polygon(e,f,void 0,!0)).noStroke(),g.Utils.applySvgAttributes(d,e)},circle:function(d){var b=parseFloat(d.getAttribute("cx")),c=parseFloat(d.getAttribute("cy")),j=parseFloat(d.getAttribute("r")),m=g.Resolution,e=_.map(_.range(m),function(b){var d=b/m*z;b=j*n(d);d=j*f(d);return new g.Anchor(b,d)},this),e=(new g.Polygon(e,!0,!0)).noStroke();e.translation.set(b,c);return g.Utils.applySvgAttributes(d,e)},ellipse:function(d){var b=parseFloat(d.getAttribute("cx")),
c=parseFloat(d.getAttribute("cy")),j=parseFloat(d.getAttribute("rx")),m=parseFloat(d.getAttribute("ry")),e=g.Resolution,k=_.map(_.range(e),function(b){var d=b/e*z;b=j*n(d);d=m*f(d);return new g.Anchor(b,d)},this),k=(new g.Polygon(k,!0,!0)).noStroke();k.translation.set(b,c);return g.Utils.applySvgAttributes(d,k)},rect:function(d){var b=parseFloat(d.getAttribute("x")),c=parseFloat(d.getAttribute("y")),j=parseFloat(d.getAttribute("width")),m=parseFloat(d.getAttribute("height")),j=j/2,m=m/2,e=[new g.Anchor(j,
m),new g.Anchor(-j,m),new g.Anchor(-j,-m),new g.Anchor(j,-m)],e=(new g.Polygon(e,!0)).noStroke();e.translation.set(b+j,c+m);return g.Utils.applySvgAttributes(d,e)},line:function(d){var b=parseFloat(d.getAttribute("x1")),c=parseFloat(d.getAttribute("y1")),j=parseFloat(d.getAttribute("x2")),m=parseFloat(d.getAttribute("y2")),j=(j-b)/2,m=(m-c)/2,e=[new g.Anchor(-j,-m),new g.Anchor(j,m)],e=(new g.Polygon(e)).noFill();e.translation.set(b+j,c+m);return g.Utils.applySvgAttributes(d,e)}},subdivide:function(d,
b,c,j,e,l,p,s,H,v){var t=g.Utils.Curve.CollinearityEpsilon;v=v||g.Utils.Curve.RecursionLimit;var E=g.Utils.Curve.CuspLimit,a=g.Utils.Curve.Tolerance,h,x,y,C,u,w;H=H||0;if(H>v)return[];if(B(c,j,d,b,p,s)&&B(e,l,d,b,p,s))return u=p-d,w=s-b,c=G(q(w,u),m),H=A(v-H,1),x=H-1,y=n(c),C=f(c),_.map(_.range(H),function(a){a/=x;return new g.Anchor(u*a*y+d,w*a*C+b)});var D=(d+c)/2,X=(b+j)/2,Q=(c+e)/2,R=(j+l)/2,Y=(e+p)/2,Z=(l+s)/2,$=(D+Q)/2,aa=(X+R)/2,Q=(Q+Y)/2,R=(R+Z)/2,N=($+Q)/2,K=(aa+R)/2;u=p-d;w=s-b;h=k((c-p)*
w-(j-s)*u);var P=k((e-p)*w-(l-s)*u);if(0<H){if(h>t&&P>t&&(h+P)*(h+P)<=a.distance*(u*u+w*w)){if(a.angle<a.epsilon)return[new g.Anchor(N,K)];h=q(l-j,e-c);t=k(h-q(j-b,c-d));h=k(q(s-l,p-e)-h);t>=m&&(t=z-t);h>=m&&(h=z-h);if(t+h<a.angle)return[new g.Anchor(N,K)];if(0!==E){if(t>E)return[new g.Anchor(c,j)];if(h>E)return[new g.Anchor(e,l)]}}}else if(h>t)if(h*h<=a.distance*(u*u+w*w)){if(a.angle<a.epsilon)return[new g.Anchor(N,K)];t=k(q(l-j,e-c)-q(j-b,c-d));t>=m&&(t=z-t);if(t<a.angle)return[new g.Anchor(c,j),
new g.Anchor(e,l)];if(0!==E&&t>E)return[new g.Anchor(c,j)]}else if(P>t){if(P*P<=a.distance*(u*u+w*w)){if(a.angle<a.epsilon)return[new g.Anchor(N,K)];t=k(q(s-l,p-e)-q(l-j,e-c));t>=m&&(t=z-t);if(t<a.angle)return[new g.Anchor(c,j),new g.Anchor(e,l)];if(0!==E&&t>E)return[new g.Anchor(e,l)]}}else if(u=N-(d+p)/2,w=K-(b+s)/2,u*u+w*w<=a.distance)return[new g.Anchor(N,K)];return g.Utils.subdivide(d,b,D,X,$,aa,N,K,H+1,v).concat(g.Utils.subdivide(N,K,Q,R,Y,Z,p,s,H+1,v))},pointOnLine:function(d,b,c,j,m,e){var f=
g.Utils.Curve.Tolerance.epsilon;if(k((b-j)*(m-c)-(d-c)*(e-j))>f)return!1;d=(d-c)*(m-c)+(b-j)*(e-j);return 0>d||d>(m-c)*(m-c)+(e-j)*(e-j)?!1:!0},getCurveFromPoints:function(d,b){for(var c=d.length,j=c-1,m=0;m<c;m++){var e=d[m];_.isObject(e.controls)||g.Anchor.AppendCurveProperties(e);var f=b?G(m-1,c):Math.max(m-1,0),k=b?G(m+1,c):Math.min(m+1,j);w(d[f],e,d[k]);e._command=0===m?g.Commands.move:g.Commands.curve;e.controls.left.x=_.isNumber(e.controls.left.x)?e.controls.left.x:e.x;e.controls.left.y=_.isNumber(e.controls.left.y)?
e.controls.left.y:e.y;e.controls.right.x=_.isNumber(e.controls.right.x)?e.controls.right.x:e.x;e.controls.right.y=_.isNumber(e.controls.right.y)?e.controls.right.y:e.y}},getControlPoints:function(d,b,c){var j=y(d,b),e=y(c,b);d=u(d,b);c=u(c,b);var k=(j+e)/2;b.u=_.isObject(b.controls.left)?b.controls.left:new g.Vector(b.x,b.y);b.v=_.isObject(b.controls.right)?b.controls.right:new g.Vector(b.x,b.y);if(1E-4>d||1E-4>c)return b.controls.left.copy(b),b.controls.right.copy(b),b;d*=0.33;c*=0.33;k=e<j?k+E:
k-E;b.controls.left.x=b.x+n(k)*d;b.controls.left.y=b.y+f(k)*d;k-=m;b.controls.right.x=b.x+n(k)*c;b.controls.right.y=b.y+f(k)*c;return b},getReflection:function(d,b,c){var j=d.distanceTo(b);if(1E-4>=j)return c?new g.Vector:d.clone();b=y(d,b);return new g.Vector(j*Math.cos(b)+(c?0:d.x),j*Math.sin(b)+(c?0:d.y))},angleBetween:function(d,b){var c,j;if(4<=arguments.length)return c=arguments[0]-arguments[2],j=arguments[1]-arguments[3],q(j,c);c=d.x-b.x;j=d.y-b.y;return q(j,c)},distanceBetweenSquared:function(d,
b){var c=d.x-b.x,j=d.y-b.y;return c*c+j*j},distanceBetween:function(d,b){return e(v(d,b))},mod:function(d,b){for(;0>d;)d+=b;return d%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(d){this.name="two.js";this.message=d}}});g.Utils.Error.prototype=Error();g.Utils.Error.prototype.constructor=g.Utils.Error;g.Utils.Collection.prototype=[];g.Utils.Collection.constructor=
g.Utils.Collection;_.extend(g.Utils.Collection.prototype,Backbone.Events,{pop:function(){var d=Array.prototype.pop.apply(this,arguments);this.trigger(g.Events.remove,[d]);return d},shift:function(){var d=Array.prototype.shift.apply(this,arguments);this.trigger(g.Events.remove,[d]);return d},push:function(){var d=Array.prototype.push.apply(this,arguments);this.trigger(g.Events.insert,arguments);return d},unshift:function(){var d=Array.prototype.unshift.apply(this,arguments);this.trigger(g.Events.insert,
arguments);return d},splice:function(){var d=Array.prototype.splice.apply(this,arguments),b;this.trigger(g.Events.remove,d);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(g.Events.insert,b));return d}});var u=g.Utils.distanceBetween,v=g.Utils.distanceBetweenSquared,y=g.Utils.angleBetween,w=g.Utils.getControlPoints,G=g.Utils.mod,c=g.Utils.getBackingStoreRatio,B=g.Utils.pointOnLine;_.extend(g.prototype,Backbone.Events,{appendTo:function(d){d.appendChild(this.renderer.domElement);
return this},play:function(){g.Utils.setPlaying.call(this,!0);return this.trigger(g.Events.play)},pause:function(){this.playing=!1;return this.trigger(g.Events.pause)},update:function(){var d=!!this._lastFrame,b=(p.performance&&p.performance.now?p.performance:Date).now();this.frameCount++;d&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var d=this.width,b=this.height,c=this.renderer;(d!==c.width||b!==c.height)&&c.setSize(d,b,this.ratio);this.trigger(g.Events.update,
this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(g.Events.render,this.frameCount)},add:function(d){var b=d;_.isArray(d)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(d){var b=d;_.isArray(d)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));return this},makeLine:function(d,b,c,j){c=(c-d)/2;j=(j-b)/2;var e=[new g.Anchor(-c,-j),new g.Anchor(c,
j)],e=(new g.Polygon(e)).noFill();e.translation.set(d+c,b+j);this.scene.add(e);return e},makeRectangle:function(d,b,c,e){c/=2;e/=2;e=[new g.Anchor(c,e),new g.Anchor(-c,e),new g.Anchor(-c,-e),new g.Anchor(c,-e)];e=new g.Polygon(e,!0);e.translation.set(d,b);this.scene.add(e);return e},makeCircle:function(d,b,c){return this.makeEllipse(d,b,c,c)},makeEllipse:function(d,b,c,e){var m=g.Resolution,k=_.map(_.range(m),function(b){var d=b/m*z;b=c*n(d);d=e*f(d);return new g.Anchor(b,d)},this),k=new g.Polygon(k,
!0,!0);k.translation.set(d,b);this.scene.add(k);return k},makeCurve:function(d){var b=arguments.length,c=d;if(!_.isArray(d))for(var c=[],e=0;e<b;e+=2){var m=arguments[e];if(!_.isNumber(m))break;c.push(new g.Anchor(m,arguments[e+1]))}var b=arguments[b-1],c=new g.Polygon(c,!(_.isBoolean(b)&&b),!0),b=c.getBoundingClientRect(),f=b.left+b.width/2,k=b.top+b.height/2;_.each(c.vertices,function(b){b.x-=f;b.y-=k});c.translation.set(f,k);this.scene.add(c);return c},makePolygon:function(d){var b=arguments.length,
c=d;if(!_.isArray(d))for(var c=[],e=0;e<b;e+=2){var m=arguments[e];if(!_.isNumber(m))break;c.push(new g.Anchor(m,arguments[e+1]))}b=arguments[b-1];c=new g.Polygon(c,!(_.isBoolean(b)&&b));b=c.getBoundingClientRect();c.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(c);return c},makeGroup:function(c){var b=c;_.isArray(c)||(b=_.toArray(arguments));var e=new g.Group;this.scene.add(e);e.add(b);return e},interpret:function(c){var b=c.tagName.toLowerCase();if(!(b in g.Utils.read))return null;
c=g.Utils.read[b].call(this,c);this.add(c);return c}});(function(){requestAnimationFrame(arguments.callee);_.each(g.Instances,function(c){c.playing&&c.update()})})();"function"===typeof define&&define.amd?define(function(){return g}):"undefined"!=typeof module&&module.exports&&(module.exports=g)})();(function(){var C,p,l,f,n=Two.Vector=function(e,f){this.x=e||0;this.y=f||0};_.extend(n.prototype,Backbone.Events,{set:function(e,f){this.x=e;this.y=f;return this},copy:function(e){this.x=e.x;this.y=e.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new n(this.x,this.y)},add:function(e,f){this.x=e.x+f.x;this.y=e.y+f.y;return this},addSelf:function(e){this.x+=e.x;this.y+=e.y;return this},sub:function(e,f){this.x=e.x-f.x;this.y=e.y-f.y;return this},subSelf:function(e){this.x-=
e.x;this.y-=e.y;return this},multiplySelf:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){e?(this.x/=e,this.y/=e):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){l=this.x-e.x;f=this.y-e.y;return l*l+f*f},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,f){C=(e.x-this.x)*f+this.x;p=(e.y-this.y)*f+this.y;return this.set(C,p)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var q={set:function(e,
f){this._x=e;this._y=f;return this.trigger(Two.Events.change)},copy:function(e){this._x=e.x;this._y=e.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new n(this._x,this._y)},add:function(e,f){this._x=e.x+f.x;this._y=e.y+f.y;return this.trigger(Two.Events.change)},addSelf:function(e){this._x+=e.x;this._y+=e.y;return this.trigger(Two.Events.change)},sub:function(e,f){this._x=e.x-f.x;this._y=e.y-f.y;return this.trigger(Two.Events.change)},
subSelf:function(e){this._x-=e.x;this._y-=e.y;return this.trigger(Two.Events.change)},multiplySelf:function(e){this._x*=e.x;this._y*=e.y;return this.trigger(Two.Events.change)},multiplyScalar:function(e){this._x*=e;this._y*=e;return this.trigger(Two.Events.change)},divideScalar:function(e){return e?(this._x/=e,this._y/=e,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this._x*e.x+this._y*e.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){l=this._x-e.x;f=this._y-e.y;return l*l+f*f},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,f){C=(e.x-this._x)*f+this._x;p=(e.y-this._y)*f+this._y;return this.set(C,p)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},e={get:function(){return this._x},set:function(e){this._x=e;this.trigger(Two.Events.change,"x")}},k={get:function(){return this._y},set:function(e){this._y=e;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",e),Object.defineProperty(this,"y",k),_.extend(this,q),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var C=Two.Commands,p,l,f,n=Two.Anchor=function(f,e,k,m,l,p,t){Two.Vector.call(this,f,e);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(e){this._command=e;this._command===C.curve&&!_.isObject(this.controls)&&n.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=t||C.move;if(!t)return this;n.AppendCurveProperties(this);_.isNumber(k)&&(this.controls.left.x=
k);_.isNumber(m)&&(this.controls.left.y=m);_.isNumber(l)&&(this.controls.right.x=l);_.isNumber(p)&&(this.controls.right.y=p)};_.extend(n,{AppendCurveProperties:function(f){p=f._x||f.x;l=f._y||f.y;f.controls={left:new Two.Vector(p,l),right:new Two.Vector(p,l)}}});_.extend(n.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||n.AppendCurveProperties(this);_.each(this.controls,function(f){f.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(f){f.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){f=this.controls;return new Two.Anchor(this.x,this.y,f&&f.left.x,f&&f.left.y,f&&f.right.x,f&&f.right.y,this.command)}})})();(function(){_.range(6);var C=Math.cos,p=Math.sin,l=Math.tan,f,n,q,e,k,m,z,E,t,A,s,D,g,u,v,y,w,G,c,B,d,b,r,j,F,I,J,M,H,O,S,T,a,h,x,da,V,W,ba,ca,X,Q,R,Y,Z,$,aa,N,K,P=[],ea=Two.Matrix=function(a,b,c,d,e,g){this.elements=new Two.Array(9);var h=a;_.isArray(h)||(h=_.toArray(arguments));this.identity().set(h)};_.extend(ea,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(a,e,h){if(3>=e.length)return D,g,u,f=e[0]||0,n=e[1]||0,q=e[2]||0,k=a,D=k[0]*f+k[1]*n+k[2]*q,g=k[3]*f+k[4]*n+k[5]*q,u=k[6]*f+k[7]*n+k[8]*
q,{x:D,y:g,z:u};v=a[0];y=a[1];w=a[2];G=a[3];c=a[4];B=a[5];d=a[6];b=a[7];r=a[8];j=e[0];F=e[1];I=e[2];J=e[3];M=e[4];H=e[5];O=e[6];S=e[7];T=e[8];h=h||new Two.Array(9);h[0]=v*j+y*J+w*O;h[1]=v*F+y*M+w*S;h[2]=v*I+y*H+w*T;h[3]=G*j+c*J+B*O;h[4]=G*F+c*M+B*S;h[5]=G*I+c*H+B*T;h[6]=d*j+b*J+r*O;h[7]=d*F+b*M+r*S;h[8]=d*I+b*H+r*T;return h}});_.extend(ea.prototype,Backbone.Events,{set:function(a,b,c,d,e,h){s=a;x=arguments.length;_.isArray(s)||(s=_.toArray(arguments));_.each(s,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(ea.Identity);return this},multiply:function(e,f,k,m,l,n,p,q,la){s=arguments;x=s.length;if(1>=x)return _.each(this.elements,function(a,b){this.elements[b]=a*e},this),this.trigger(Two.Events.change);if(3>=x)return D,g,u,e=e||0,f=f||0,k=k||0,l=this.elements,D=l[0]*e+l[1]*f+l[2]*k,g=l[3]*e+l[4]*f+l[5]*k,u=l[6]*e+l[7]*f+l[8]*k,{x:D,y:g,z:u};a=this.elements;h=s;v=a[0];y=a[1];w=a[2];G=a[3];c=a[4];B=a[5];d=a[6];b=a[7];r=a[8];j=
h[0];F=h[1];I=h[2];J=h[3];M=h[4];H=h[5];O=h[6];S=h[7];T=h[8];this.elements[0]=v*j+y*J+w*O;this.elements[1]=v*F+y*M+w*S;this.elements[2]=v*I+y*H+w*T;this.elements[3]=G*j+c*J+B*O;this.elements[4]=G*F+c*M+B*S;this.elements[5]=G*I+c*H+B*T;this.elements[6]=d*j+b*J+r*O;this.elements[7]=d*F+b*M+r*S;this.elements[8]=d*I+b*H+r*T;return this.trigger(Two.Events.change)},inverse:function(a){f=this.elements;a=a||new Two.Matrix;V=f[0];W=f[1];ba=f[2];ca=f[3];X=f[4];Q=f[5];R=f[6];Y=f[7];Z=f[8];$=Z*X-Q*Y;aa=-Z*ca+
Q*R;N=Y*ca-X*R;K=V*$+W*aa+ba*N;if(!K)return null;K=1/K;a.elements[0]=$*K;a.elements[1]=(-Z*W+ba*Y)*K;a.elements[2]=(Q*W-ba*X)*K;a.elements[3]=aa*K;a.elements[4]=(Z*V-ba*R)*K;a.elements[5]=(-Q*V+ba*ca)*K;a.elements[6]=N*K;a.elements[7]=(-Y*V+W*R)*K;a.elements[8]=(X*V-W*ca)*K;return a},scale:function(a,b){x=arguments.length;1>=x&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){q=C(a);da=p(a);return this.multiply(q,-da,0,da,q,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){f=l(a);return this.multiply(1,f,0,0,1,0,0,0,1)},skewY:function(a){f=l(a);return this.multiply(1,0,0,f,1,0,0,0,1)},toString:function(a){this.toArray(a,P);return P.join(" ")},toArray:function(a,b){s=this.elements;A=!!b;f=parseFloat(s[0].toFixed(3));n=parseFloat(s[1].toFixed(3));q=parseFloat(s[2].toFixed(3));e=parseFloat(s[3].toFixed(3));k=parseFloat(s[4].toFixed(3));m=parseFloat(s[5].toFixed(3));if(a){z=parseFloat(s[6].toFixed(3));E=parseFloat(s[7].toFixed(3));t=
parseFloat(s[8].toFixed(3));if(A){b[0]=f;b[1]=e;b[2]=z;b[3]=n;b[4]=k;b[5]=E;b[6]=q;b[7]=m;b[8]=t;return}return[f,e,z,n,k,E,q,m,t]}if(A)b[0]=f,b[1]=e,b[2]=n,b[3]=k,b[4]=q,b[5]=m;else return[f,e,n,k,q,m]},clone:function(){f=this.elements[0];n=this.elements[1];q=this.elements[2];e=this.elements[3];k=this.elements[4];m=this.elements[5];z=this.elements[6];E=this.elements[7];t=this.elements[8];return new Two.Matrix(f,n,q,e,k,m,z,E,t)}})})();(function(){var C=Two.Utils.mod,p,l,f,n={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(e,k){f=e;l=document.createElementNS(this.ns,f);"svg"===f&&(k=_.defaults(k||{},{version:this.version}));_.isObject(k)&&n.setAttributes(l,k);return l},setAttribute:function(e,f){this.setAttribute(f,e)},setAttributes:function(e,f){_.each(f,n.setAttribute,e);return this},removeAttribute:function(e,f){this.removeAttribute(f)},removeAttributes:function(e,f){_.each(f,
n.removeAttribute,e);return this},toString:function(e,f){var m=e.length,l=m-1;return _.map(e,function(n,p){var q,s=f?C(p-1,m):Math.max(p-1,0),D=f?C(p+1,m):Math.min(p+1,l),s=e[s],D=e[D],g,u,v,y,w;w=n.x.toFixed(3);y=n.y.toFixed(3);switch(n._command){case Two.Commands.close:q=Two.Commands.close;break;case Two.Commands.curve:g=s.controls&&s.controls.right||s;q=n.controls&&n.controls.left||n;s=g.x.toFixed(3);g=g.y.toFixed(3);u=q.x.toFixed(3);v=q.y.toFixed(3);q=(0===p?Two.Commands.move:Two.Commands.curve)+
" "+s+" "+g+" "+u+" "+v+" "+w+" "+y;break;default:q=(0===p?Two.Commands.move:n._command)+" "+w+" "+y}p>=l&&f&&(n._command===Two.Commands.curve&&(y=n.controls&&n.controls.right||n,w=D.controls&&D.controls.left||D,s=y.x.toFixed(3),g=y.y.toFixed(3),u=w.x.toFixed(3),v=w.y.toFixed(3),w=D.x.toFixed(3),y=D.y.toFixed(3),q+=" C "+s+" "+g+" "+u+" "+v+" "+w+" "+y),q+=" Z");return q}).join(" ")},group:{appendChild:function(e){(l=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.appendChild(l)},
removeChild:function(e){(l=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.removeChild(l)},renderChild:function(e){n[e._renderer.type].render.call(e,this)},render:function(e){this.update();this._renderer.elem||(this._renderer.elem=n.createElement("g",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));p=this._matrix.manual||this._flagMatrix;var f={domElement:e,elem:this._renderer.elem};p&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");
_.each(this.children,n.group.renderChild,e);this._flagAdditions&&_.each(this.additions,n.group.appendChild,f);this._flagSubtractions&&_.each(this.subtractions,n.group.removeChild,f);return this.flagReset()}},polygon:{render:function(e){this.update();this._renderer.elem||(this._renderer.elem=n.createElement("path",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));l=this._renderer.elem;(p=this._matrix.manual||this._flagMatrix)&&l.setAttribute("transform","matrix("+this._matrix.toString()+
")");this._flagVertices&&(vertices=n.toString(this._vertices,this._closed),l.setAttribute("d",vertices));this._flagFill&&l.setAttribute("fill",this._fill);this._flagStroke&&l.setAttribute("stroke",this._stroke);this._flagLinewidth&&l.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(l.setAttribute("stroke-opacity",this._opacity),l.setAttribute("fill-opacity",this._opacity));this._flagVisible&&l.setAttribute("visibility",this._visible?"visible":"hidden");this._flagCap&&l.setAttribute("stroke-linecap",
this._cap);this._flagJoin&&l.setAttribute("stroke-linejoin",this._join);this._flagMiter&&l.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},q=Two[Two.Types.svg]=function(e){this.domElement=e.domElement||n.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(q,{Utils:n});_.extend(q.prototype,Backbone.Events,{setSize:function(e,f){this.width=e;this.height=f;n.setAttributes(this.domElement,{width:e,height:f});return this},render:function(){n.group.render.call(this.scene,
this.domElement);return this}})})();(function(){var C=Two.Utils.mod,p=Two.Utils.getRatio,l,f,n,q,e,k,m,z,E,t,A,s,D,g,u,v,y,w,G,c,B,d,b,r,j,F,I,J={group:{renderChild:function(b){J[b._renderer.type].render.call(b,this)},render:function(b){this.update();l=this._matrix.elements;b.save();b.transform(l[0],l[3],l[1],l[4],l[2],l[5]);_.each(this.children,J.group.renderChild,b);b.restore();return this.flagReset()}},polygon:{render:function(p){this.update();l=this._matrix.elements;f=this.stroke;n=this.linewidth;q=this.fill;e=this.opacity;k=this.visible;
m=this.cap;z=this.join;E=this.miter;t=this.closed;A=this._vertices;s=A.length;D=s-1;if(!k)return this;p.save();l&&p.transform(l[0],l[3],l[1],l[4],l[2],l[5]);q&&(p.fillStyle=q);f&&(p.strokeStyle=f);n&&(p.lineWidth=n);E&&(p.miterLimit=E);z&&(p.lineJoin=z);m&&(p.lineCap=m);_.isNumber(e)&&(p.globalAlpha=e);p.beginPath();_.each(A,function(e,f){F=e.x.toFixed(3);I=e.y.toFixed(3);switch(e._command){case Two.Commands.close:p.closePath();break;case Two.Commands.curve:u=t?C(f-1,s):Math.max(f-1,0);g=t?C(f+1,
s):Math.min(f+1,D);v=A[u];y=A[g];d=v.controls&&v.controls.right||v;b=e.controls&&e.controls.left||e;c=d.x.toFixed(3);B=d.y.toFixed(3);w=b.x.toFixed(3);G=b.y.toFixed(3);p.bezierCurveTo(c,B,w,G,F,I);f>=D&&t&&(r=e.controls&&e.controls.right||e,j=y.controls&&y.controls.left||y,c=r.x.toFixed(3),B=r.y.toFixed(3),w=j.x.toFixed(3),G=j.y.toFixed(3),F=y.x.toFixed(3),I=y.y.toFixed(3),p.bezierCurveTo(c,B,w,G,F,I));break;case Two.Commands.line:p.lineTo(F,I);break;case Two.Commands.move:p.moveTo(F,I)}});t&&p.closePath();
p.fill();p.stroke();p.restore();return this.flagReset()}}},M=Two[Two.Types.canvas]=function(b){this.domElement=b.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.scene=new Two.Group;this.scene.parent=this};_.extend(M,{Utils:J});_.extend(M.prototype,Backbone.Events,{setSize:function(b,c,d){this.width=b;this.height=c;this.ratio=_.isUndefined(d)?p(this.ctx):d;this.domElement.width=b*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,
{width:b+"px",height:c+"px"});return this},render:function(){var b=1===this.ratio;b||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);J.group.render.call(this.scene,this.ctx);b||this.ctx.restore();return this}})})();(function(){var C=Two.Matrix.Multiply,p=Two.Utils.mod,l=[1,0,0,0,1,0,0,0,1],f=new Two.Array(9),n=Two.Utils.getRatio,q,e,k,m,z,E,t,A,s,D,g,u,v,y,w,G,c,B,d,b,r,j,F,I,J,M,H,O,S,T,a,h,x,da,V,W,ba,ca,X,Q,R,Y,Z,$,aa,N,K,P,ea,fa,L,ha,ia,ja,ga,U={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){U[a._renderer.type].render.call(a,this.gl,this.program)},render:function(a,b){this.update();q=this.parent;e=q._matrix&&q._matrix.manual||q._flagMatrix;
k=this._matrix.manual||this._flagMatrix;if(e||k)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,f),C(f,q._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*q._renderer.scale,e&&(this._flagMatrix=!0);_.each(this.children,U.group.renderChild,{gl:a,program:b});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;q=this.parent;e=q._matrix.manual||q._flagMatrix;k=this._matrix.manual||this._flagMatrix;
m=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this.update();if(e||k)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,f),C(f,q._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*q._renderer.scale;m&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),
U.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),U.getTriangles(this._renderer.rect,this._renderer.triangles),U.updateBuffer(a,this,b),U.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,
!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(a,b,e){z=Infinity;E=-Infinity;t=Infinity;A=-Infinity;_.each(a,function(a){s=a.x;D=a.y;g;u;v;y;w=a.controls;t=Math.min(D,t);z=Math.min(s,z);E=Math.max(s,E);A=Math.max(D,A);a.controls&&(G=w.left,c=w.right,G&&c&&(g=G.x,u=G.y,v=c.x,y=c.y,g&&(u&&v&&y)&&(t=Math.min(u,y,t),z=Math.min(g,v,z),E=Math.max(g,v,E),A=Math.max(u,y,A))))});_.isNumber(b)&&(t-=b,z-=b,E+=b,A+=b);B=E-z;d=A-t;e.top=t;e.left=z;e.right=E;e.bottom=
A;e.width=B;e.height=d;e.centroid||(e.centroid={});e.centroid.x=-z;e.centroid.y=-t},getTriangles:function(a,b){t=a.top;z=a.left;E=a.right;A=a.bottom;b[0]=z;b[1]=t;b[2]=E;b[3]=t;b[4]=z;b[5]=A;b[6]=z;b[7]=A;b[8]=E;b[9]=t;b[10]=E;b[11]=A},updateCanvas:function(c){b=c._vertices;r=this.canvas;j=this.ctx;F=c._renderer.scale;I=c._stroke;J=c._linewidth*F;M=c._fill;H=c._opacity;O=c._cap;S=c._join;T=c._miter;a=c._closed;h=b.length;x=h-1;r.width=Math.max(Math.ceil(c._renderer.rect.width*F),1);r.height=Math.max(Math.ceil(c._renderer.rect.height*
F),1);da=c._renderer.rect.centroid;V=da.x*F;W=da.y*F;j.clearRect(0,0,r.width,r.height);M&&(j.fillStyle=M);I&&(j.strokeStyle=I);J&&(j.lineWidth=J);T&&(j.miterLimit=T);S&&(j.lineJoin=S);O&&(j.lineCap=O);_.isNumber(H)&&(j.globalAlpha=H);j.beginPath();_.each(b,function(c,d){ba;ca;g;v;X;Q;R;Y;Z;$;aa;G;s=(c.x*F+V).toFixed(3);D=(c.y*F+W).toFixed(3);switch(c._command){case Two.Commands.close:j.closePath();break;case Two.Commands.curve:ca=a?p(d-1,h):Math.max(d-1,0);ba=a?p(d+1,h):Math.min(d+1,x);g=b[ca];v=
b[ba];Z=g.controls&&g.controls.right||g;$=c.controls&&c.controls.left||c;R=(Z.x*F+V).toFixed(3);Y=(Z.y*F+W).toFixed(3);X=($.x*F+V).toFixed(3);Q=($.y*F+W).toFixed(3);j.bezierCurveTo(R,Y,X,Q,s,D);d>=x&&a&&(aa=c.controls&&c.controls.right||c,G=v.controls&&v.controls.left||v,R=(aa.x*F+V).toFixed(3),Y=(aa.y*F+W).toFixed(3),X=(G.x*F+V).toFixed(3),Q=(G.y*F+W).toFixed(3),s=(v.x*F+V).toFixed(3),D=(v.y*F+W).toFixed(3),j.bezierCurveTo(R,Y,X,Q,s,D));break;case Two.Commands.line:j.lineTo(s,D);break;case Two.Commands.move:j.moveTo(s,
D)}});a&&j.closePath();j.fill();j.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||
0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=
a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){N=a.createProgram();_.each(b,function(b){a.attachShader(N,b)});a.linkProgram(N);K=a.getProgramParameter(N,a.LINK_STATUS);if(!K)throw fa=a.getProgramInfoLog(N),a.deleteProgram(N),new Two.Utils.Error("unable to link program: "+fa);return N}},shaders:{create:function(a,b,c){P=a.createShader(a[c]);a.shaderSource(P,
b);a.compileShader(P);ea=a.getShaderParameter(P,a.COMPILE_STATUS);if(!ea)throw fa=a.getShaderInfoLog(P),a.deleteShader(P),new Two.Utils.Error("unable to compile shader "+P+": "+fa);return P},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};U.ctx=U.canvas.getContext("2d");var ka=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(l),scale:1};this._flagMatrix=!0;ga=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ga.overdraw;L=this.ctx=this.domElement.getContext("webgl",ga)||this.domElement.getContext("experimental-webgl",ga);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ja=U.shaders.create(L,U.shaders.vertex,U.shaders.types.vertex);ia=U.shaders.create(L,U.shaders.fragment,U.shaders.types.fragment);this.program=U.program.create(L,[ja,ia]);L.useProgram(this.program);this.program.position=L.getAttribLocation(this.program,
"a_position");this.program.matrix=L.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=L.getAttribLocation(this.program,"a_textureCoords");L.disable(L.DEPTH_TEST);L.enable(L.BLEND);L.blendEquationSeparate(L.FUNC_ADD,L.FUNC_ADD);L.blendFuncSeparate(L.SRC_ALPHA,L.ONE_MINUS_SRC_ALPHA,L.ONE,L.ONE_MINUS_SRC_ALPHA)};_.extend(ka.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?n(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ha=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ha,a,b);return this},render:function(){L=this.ctx;this.overdraw||L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT);U.group.render.call(this.scene,L,this.program);this._flagMatrix=!1;return this}})})();(function(){new Two.Vector;var C,p=Two.Shape=function(){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(p.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(p,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(l){Object.defineProperty(l,"rotation",{get:function(){return this._rotation},set:function(f){this._rotation=f;this._flagMatrix=!0}});Object.defineProperty(l,
"scale",{get:function(){return this._scale},set:function(f){this._scale=f;this._flagScale=this._flagMatrix=!0}})}});_.extend(p.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(l){l.add(this);return this},clone:function(){C=new p;C.translation.copy(this.translation);C.rotation=this.rotation;C.scale=this.scale;_.each(p.Properties,function(l){C[l]=this[l]},this);return C.update()},update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});p.MakeObservable(p.prototype)})();(function(){var C=Math.min,p=Math.max,l=Math.round,f=Two.Utils.getComputedMatrix,n,q,e,k,m,z,E,t,A,s,D,g,u,v,y,w,G,c,B,d,b,r,j,F,I,J,M,H,O,S,T,a=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!c;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4;this._vertices=[];this.vertices=a;this.automatic=!d};_.extend(a,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),
FlagVertices:function(){this._flagVertices=!0},MakeObservable:function(b){Two.Shape.MakeObservable(b);_.each(a.Properties.slice(0,8),function(a){var c="_"+a,d="_flag"+a.charAt(0).toUpperCase()+a.slice(1);Object.defineProperty(b,a,{get:function(){return this[c]},set:function(a){this[c]=a;this[d]=!0}})});Object.defineProperty(b,"closed",{get:function(){return this._closed},set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(b,"curved",{get:function(){return this._curved},
set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(a.prototype,"automatic",{get:function(){return this._automatic},set:function(a){a!==this._automatic&&(method=(this._automatic=!!a)?"ignore":"listen",_.each(this.vertices,function(a){a[method]()}))}});Object.defineProperty(b,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=C(p(a,0),1);this._flagVertices=!0}});Object.defineProperty(b,"ending",{get:function(){return this._ending},set:function(a){this._ending=
C(p(a,0),1);this._flagVertices=!0}});Object.defineProperty(b,"vertices",{get:function(){return this._collection},set:function(b){var c=_.bind(a.FlagVertices,this),d=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,c)},this);c()},this),e=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,c)},this);c()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(b.slice(0));this._collection.bind(Two.Events.insert,d);this._collection.bind(Two.Events.remove,
e);verticesChanged=!0;d(this._collection)}})}});_.extend(a.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(b){b=b||this.parent;t=_.map(this.vertices,function(a){return a.clone()});A=new a(t,this.closed,this.curved,
!this.automatic);_.each(Two.Shape.Properties,function(a){A[a]=this[a]},this);A.translation.copy(this.translation);A.rotation=this.rotation;A.scale=this.scale;b.add(A);return A},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){s=this.getBoundingClientRect(!0);D={x:s.left,y:s.top};_.each(this.vertices,function(a){a.subSelf(D)});return this},center:function(){s=this.getBoundingClientRect(!0);s.centroid={x:s.left+s.width/
2,y:s.top+s.height/2};_.each(this.vertices,function(a){a.subSelf(s.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(a){this.update();g=this.linewidth/2;void 0;u=Infinity;v=-Infinity;y=Infinity;w=-Infinity;_.each(this._vertices,function(a){G=a.x;c=a.y;y=C(c,y);u=C(G,u);v=p(G,v);w=p(c,w)});y-=g;u-=g;v+=g;w+=g;j=a?this._matrix:f(this);B=j.multiply(u,y,1);d=j.multiply(v,y,1);b=j.multiply(v,w,1);r=j.multiply(u,w,
1);y=C(B.y,d.y,b.y,r.y);u=C(B.x,d.x,b.x,r.x);v=p(B.x,d.x,b.x,r.x);w=p(B.y,d.y,b.y,r.y);return{top:y,left:u,right:v,bottom:w,width:v-u,height:w-y}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this.vertices,this.closed),this;_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(a){k=this.vertices.length-1;d=this.vertices[k];m=this._closed||this.vertices[k].command===Two.Commands.close;t=[];_.each(this.vertices,
function(b,c){if(!(0>=c)||m)v=d.controls&&d.controls.right,u=b.controls&&b.controls.left,F=d.x,I=d.y,J=(v||d).x,M=(v||d).y,H=(u||b).x,O=(u||b).y,S=b.x,T=b.y,t.push(Two.Utils.subdivide(F,I,J,M,H,O,S,T,0,a));d=b},this);this._curved=this._automatic=!1;this.vertices=_.flatten(t);this.plot();return this},update:function(){if(this._flagVertices){this._automatic&&this.plot();n=this.vertices.length;k=n-1;q=l(this._beginning*k);e=l(this._ending*k);this._vertices.length=0;for(E=q;E<e+1;E++)z=this.vertices[E],
this._vertices.push(z)}Two.Shape.prototype.update.call(this);return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});a.MakeObservable(a.prototype)})();(function(){var C=Math.min,p=Math.max,l,f,n,q,e,k,m,z,E,t,A,s,D,g,u,v,y,w,G,c,B,d=Two.Group=function(){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(d,{MakeObservable:function(b){Two.Shape.MakeObservable(b);d.MakeGetterSetter(b,Two.Polygon.Properties)},MakeGetterSetter:function(b,c){_.isArray(c)||(c=[c]);_.each(c,function(c){l="_"+c;Object.defineProperty(b,c,{get:function(){return this[l]},set:function(b){this[l]=b;_.each(this.children,
function(d){d[c]=b})}})})}});_.extend(d.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(b){b=b||this.parent;n=_.map(this.children,function(b){return b.clone()});q=new d;b.add(q);q.add(n);q.translation.copy(this.translation);q.rotation=this.rotation;q.scale=this.scale;return q},corner:function(){e=this.getBoundingClientRect(!0);
k={x:e.left,y:e.top};_.each(this.children,function(b){b.translation.subSelf(k)});return this},center:function(){e=this.getBoundingClientRect(!0);e.centroid={x:e.left+e.width/2,y:e.top+e.height/2};_.each(this.children,function(b){b.translation.subSelf(e.centroid)});return this},add:function(b){m=arguments.length;z=b;n=this.children;E=this.parent;t=this.additions;_.isArray(b)||(z=_.toArray(arguments));_.each(z,function(b){b&&(A=b.id,f=b.parent,_.isUndefined(n[A])&&(f&&(delete f.children[A],B=_.indexOf(f.additions,
A),0<=B&&f.additions.splice(B,1)),n[A]=b,b.parent=this,t.push(A),this._flagAdditions=!0))},this);return this},remove:function(b){m=arguments.length;z=b;n=this.children;E=this.parent;t=this.subtractions;if(0>=m&&E)return E.remove(this),this;_.isArray(b)||(z=_.toArray(arguments));_.each(z,function(b){A=b.id;grandchildren=b.children;f=b.parent;A in n&&(delete n[A],delete b.parent,B=_.indexOf(f.additions,A),0<=B&&f.additions.splice(B,1),t.push(A),this._flagSubtractions=!0)});return this},getBoundingClientRect:function(b){this.update();
s=Infinity;D=-Infinity;g=Infinity;u=-Infinity;_.each(this.children,function(b){e=b.getBoundingClientRect(!0);_.isNumber(e.top)&&(_.isNumber(e.left)&&_.isNumber(e.right)&&_.isNumber(e.bottom))&&(g=C(e.top,g),s=C(e.left,s),D=p(e.right,D),u=p(e.bottom,u))},this);v=b?this._matrix:Two.Utils.getComputedMatrix(this);y=v.multiply(s,g,1);w=v.multiply(D,g,1);G=v.multiply(D,u,1);c=v.multiply(s,u,1);g=C(y.y,w.y,G.y,c.y);s=C(y.x,w.x,G.x,c.x);D=p(y.x,w.x,G.x,c.x);u=p(y.y,w.y,G.y,c.y);return{top:g,left:s,right:D,
bottom:u,width:D-s,height:u-g}},noFill:function(){_.each(this.children,function(b){b.noFill()});return this},noStroke:function(){_.each(this.children,function(b){b.noStroke()});return this},subdivide:function(){var b=arguments;_.each(this.children,function(c){c.subdivide.apply(c,b)});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);
return this}});d.MakeObservable(d.prototype)})();
