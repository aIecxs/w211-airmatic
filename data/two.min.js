(function(){var D=this,p=D._,g={},f=Array.prototype,r=Object.prototype,s=f.push,d=f.slice,k=f.concat,h=r.toString,B=r.hasOwnProperty,H=f.forEach,y=f.map,t=f.reduce,e=f.reduceRight,v=f.filter,E=f.every,u=f.some,q=f.indexOf,A=f.lastIndexOf,r=Array.isArray,G=Object.keys,F=Function.prototype.bind,a=function(b){if(b instanceof a)return b;if(!(this instanceof a))return new a(b);this._wrapped=b};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=a),exports._=
a):D._=a;a.VERSION="1.5.1";var c=a.each=a.forEach=function(b,m,z){if(null!=b)if(H&&b.forEach===H)b.forEach(m,z);else if(b.length===+b.length)for(var c=0,e=b.length;c<e&&m.call(z,b[c],c,b)!==g;c++);else for(c in b)if(a.has(b,c)&&m.call(z,b[c],c,b)===g)break};a.map=a.collect=function(b,a,z){var e=[];if(null==b)return e;if(y&&b.map===y)return b.map(a,z);c(b,function(b,c,l){e.push(a.call(z,b,c,l))});return e};a.reduce=a.foldl=a.inject=function(b,m,z,e){var l=2<arguments.length;null==b&&(b=[]);if(t&&b.reduce===
t)return e&&(m=a.bind(m,e)),l?b.reduce(m,z):b.reduce(m);c(b,function(b,a,c){l?z=m.call(e,z,b,a,c):(z=b,l=!0)});if(!l)throw new TypeError("Reduce of empty array with no initial value");return z};a.reduceRight=a.foldr=function(b,m,z,l){var n=2<arguments.length;null==b&&(b=[]);if(e&&b.reduceRight===e)return l&&(m=a.bind(m,l)),n?b.reduceRight(m,z):b.reduceRight(m);var h=b.length;if(h!==+h)var d=a.keys(b),h=d.length;c(b,function(a,c,e){c=d?d[--h]:--h;n?z=m.call(l,z,b[c],c,e):(z=b[c],n=!0)});if(!n)throw new TypeError("Reduce of empty array with no initial value");
return z};a.find=a.detect=function(b,a,c){var e;l(b,function(b,l,n){if(a.call(c,b,l,n))return e=b,!0});return e};a.filter=a.select=function(b,a,z){var e=[];if(null==b)return e;if(v&&b.filter===v)return b.filter(a,z);c(b,function(b,c,l){a.call(z,b,c,l)&&e.push(b)});return e};a.reject=function(b,m,c){return a.filter(b,function(b,a,e){return!m.call(c,b,a,e)},c)};a.every=a.all=function(b,m,z){m||(m=a.identity);var e=!0;if(null==b)return e;if(E&&b.every===E)return b.every(m,z);c(b,function(b,a,c){if(!(e=
e&&m.call(z,b,a,c)))return g});return!!e};var l=a.some=a.any=function(b,m,z){m||(m=a.identity);var e=!1;if(null==b)return e;if(u&&b.some===u)return b.some(m,z);c(b,function(b,a,c){if(e||(e=m.call(z,b,a,c)))return g});return!!e};a.contains=a.include=function(b,a){return null==b?!1:q&&b.indexOf===q?-1!=b.indexOf(a):l(b,function(b){return b===a})};a.invoke=function(b,m){var c=d.call(arguments,2),e=a.isFunction(m);return a.map(b,function(b){return(e?m:b[m]).apply(b,c)})};a.pluck=function(b,m){return a.map(b,
function(b){return b[m]})};a.where=function(b,m,c){return a.isEmpty(m)?c?void 0:[]:a[c?"find":"filter"](b,function(b){for(var a in m)if(m[a]!==b[a])return!1;return!0})};a.findWhere=function(b,m){return a.where(b,m,!0)};a.max=function(b,m,z){if(!m&&a.isArray(b)&&b[0]===+b[0]&&65535>b.length)return Math.max.apply(Math,b);if(!m&&a.isEmpty(b))return-Infinity;var e={computed:-Infinity,value:-Infinity};c(b,function(b,a,c){a=m?m.call(z,b,a,c):b;a>e.computed&&(e={value:b,computed:a})});return e.value};a.min=
function(b,m,z){if(!m&&a.isArray(b)&&b[0]===+b[0]&&65535>b.length)return Math.min.apply(Math,b);if(!m&&a.isEmpty(b))return Infinity;var e={computed:Infinity,value:Infinity};c(b,function(b,a,c){a=m?m.call(z,b,a,c):b;a<e.computed&&(e={value:b,computed:a})});return e.value};a.shuffle=function(b){var m,z=0,e=[];c(b,function(b){m=a.random(z++);e[z-1]=e[m];e[m]=b});return e};var n=function(b){return a.isFunction(b)?b:function(a){return a[b]}};a.sortBy=function(b,m,c){var e=n(m);return a.pluck(a.map(b,function(b,
a,m){return{value:b,index:a,criteria:e.call(c,b,a,m)}}).sort(function(b,a){var m=b.criteria,c=a.criteria;if(m!==c){if(m>c||void 0===m)return 1;if(m<c||void 0===c)return-1}return b.index<a.index?-1:1}),"value")};var K=function(b,m,z,e){var l={},h=n(null==m?a.identity:m);c(b,function(a,m){var c=h.call(z,a,m,b);e(l,c,a)});return l};a.groupBy=function(b,m,c){return K(b,m,c,function(b,m,c){(a.has(b,m)?b[m]:b[m]=[]).push(c)})};a.countBy=function(b,m,c){return K(b,m,c,function(b,m){a.has(b,m)||(b[m]=0);
b[m]++})};a.sortedIndex=function(b,m,c,e){c=null==c?a.identity:n(c);m=c.call(e,m);for(var l=0,h=b.length;l<h;){var d=l+h>>>1;c.call(e,b[d])<m?l=d+1:h=d}return l};a.toArray=function(b){return b?a.isArray(b)?d.call(b):b.length===+b.length?a.map(b,a.identity):a.values(b):[]};a.size=function(b){return null==b?0:b.length===+b.length?b.length:a.keys(b).length};a.first=a.head=a.take=function(b,a,c){return null==b?void 0:null==a||c?b[0]:d.call(b,0,a)};a.initial=function(b,a,c){return d.call(b,0,b.length-
(null==a||c?1:a))};a.last=function(b,a,c){return null==b?void 0:null==a||c?b[b.length-1]:d.call(b,Math.max(b.length-a,0))};a.rest=a.tail=a.drop=function(b,a,c){return d.call(b,null==a||c?1:a)};a.compact=function(b){return a.filter(b,a.identity)};var w=function(b,m,e){if(m&&a.every(b,a.isArray))return k.apply(e,b);c(b,function(b){a.isArray(b)||a.isArguments(b)?m?s.apply(e,b):w(b,m,e):e.push(b)});return e};a.flatten=function(b,a){return w(b,a,[])};a.without=function(b){return a.difference(b,d.call(arguments,
1))};a.uniq=a.unique=function(b,m,e,l){a.isFunction(m)&&(l=e,e=m,m=!1);e=e?a.map(b,e,l):b;var h=[],n=[];c(e,function(c,e){(m?e&&n[n.length-1]===c:a.contains(n,c))||(n.push(c),h.push(b[e]))});return h};a.union=function(){return a.uniq(a.flatten(arguments,!0))};a.intersection=function(b){var c=d.call(arguments,1);return a.filter(a.uniq(b),function(b){return a.every(c,function(c){return 0<=a.indexOf(c,b)})})};a.difference=function(b){var c=k.apply(f,d.call(arguments,1));return a.filter(b,function(b){return!a.contains(c,
b)})};a.zip=function(){for(var b=a.max(a.pluck(arguments,"length").concat(0)),c=Array(b),e=0;e<b;e++)c[e]=a.pluck(arguments,""+e);return c};a.object=function(b,a){if(null==b)return{};for(var c={},e=0,l=b.length;e<l;e++)a?c[b[e]]=a[e]:c[b[e][0]]=b[e][1];return c};a.indexOf=function(b,c,e){if(null==b)return-1;var l=0,h=b.length;if(e)if("number"==typeof e)l=0>e?Math.max(0,h+e):e;else return l=a.sortedIndex(b,c),b[l]===c?l:-1;if(q&&b.indexOf===q)return b.indexOf(c,e);for(;l<h;l++)if(b[l]===c)return l;
return-1};a.lastIndexOf=function(b,a,c){if(null==b)return-1;var e=null!=c;if(A&&b.lastIndexOf===A)return e?b.lastIndexOf(a,c):b.lastIndexOf(a);for(c=e?c:b.length;c--;)if(b[c]===a)return c;return-1};a.range=function(b,a,c){1>=arguments.length&&(a=b||0,b=0);c=arguments[2]||1;for(var e=Math.max(Math.ceil((a-b)/c),0),l=0,h=Array(e);l<e;)h[l++]=b,b+=c;return h};var x=function(){};a.bind=function(b,c){var e,l;if(F&&b.bind===F)return F.apply(b,d.call(arguments,1));if(!a.isFunction(b))throw new TypeError;
e=d.call(arguments,2);return l=function(){if(!(this instanceof l))return b.apply(c,e.concat(d.call(arguments)));x.prototype=b.prototype;var a=new x;x.prototype=null;var h=b.apply(a,e.concat(d.call(arguments)));return Object(h)===h?h:a}};a.partial=function(b){var a=d.call(arguments,1);return function(){return b.apply(this,a.concat(d.call(arguments)))}};a.bindAll=function(b){var e=d.call(arguments,1);if(0===e.length)throw Error("bindAll must be passed function names");c(e,function(c){b[c]=a.bind(b[c],
b)});return b};a.memoize=function(b,c){var e={};c||(c=a.identity);return function(){var l=c.apply(this,arguments);return a.has(e,l)?e[l]:e[l]=b.apply(this,arguments)}};a.delay=function(b,a){var c=d.call(arguments,2);return setTimeout(function(){return b.apply(null,c)},a)};a.defer=function(b){return a.delay.apply(a,[b,1].concat(d.call(arguments,1)))};a.throttle=function(b,a,c){var e,l,h,n=null,d=0;c||(c={});var f=function(){d=!1===c.leading?0:new Date;n=null;h=b.apply(e,l)};return function(){var w=
new Date;d||!1!==c.leading||(d=w);var K=a-(w-d);e=this;l=arguments;0>=K?(clearTimeout(n),n=null,d=w,h=b.apply(e,l)):n||!1===c.trailing||(n=setTimeout(f,K));return h}};a.debounce=function(b,a,c){var e,l=null;return function(){var h=this,n=arguments,d=c&&!l;clearTimeout(l);l=setTimeout(function(){l=null;c||(e=b.apply(h,n))},a);d&&(e=b.apply(h,n));return e}};a.once=function(b){var a=!1,c;return function(){if(a)return c;a=!0;c=b.apply(this,arguments);b=null;return c}};a.wrap=function(b,a){return function(){var c=
[b];s.apply(c,arguments);return a.apply(this,c)}};a.compose=function(){var b=arguments;return function(){for(var a=arguments,c=b.length-1;0<=c;c--)a=[b[c].apply(this,a)];return a[0]}};a.after=function(b,a){return function(){if(1>--b)return a.apply(this,arguments)}};a.keys=G||function(b){if(b!==Object(b))throw new TypeError("Invalid object");var c=[],e;for(e in b)a.has(b,e)&&c.push(e);return c};a.values=function(b){var c=[],e;for(e in b)a.has(b,e)&&c.push(b[e]);return c};a.pairs=function(b){var c=
[],e;for(e in b)a.has(b,e)&&c.push([e,b[e]]);return c};a.invert=function(b){var c={},e;for(e in b)a.has(b,e)&&(c[b[e]]=e);return c};a.functions=a.methods=function(b){var c=[],e;for(e in b)a.isFunction(b[e])&&c.push(e);return c.sort()};a.extend=function(b){c(d.call(arguments,1),function(a){if(a)for(var c in a)b[c]=a[c]});return b};a.pick=function(b){var a={},e=k.apply(f,d.call(arguments,1));c(e,function(c){c in b&&(a[c]=b[c])});return a};a.omit=function(b){var c={},e=k.apply(f,d.call(arguments,1)),
l;for(l in b)a.contains(e,l)||(c[l]=b[l]);return c};a.defaults=function(b){c(d.call(arguments,1),function(a){if(a)for(var c in a)void 0===b[c]&&(b[c]=a[c])});return b};a.clone=function(b){return a.isObject(b)?a.isArray(b)?b.slice():a.extend({},b):b};a.tap=function(a,c){c(a);return a};var L=function(b,c,e,l){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b instanceof a&&(b=b._wrapped);c instanceof a&&(c=c._wrapped);var n=h.call(b);if(n!=h.call(c))return!1;switch(n){case "[object String]":return b==
String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==+c;case "[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var d=e.length;d--;)if(e[d]==b)return l[d]==c;var d=b.constructor,f=c.constructor;if(d!==f&&!(a.isFunction(d)&&d instanceof d&&a.isFunction(f)&&f instanceof f))return!1;e.push(b);l.push(c);d=0;
f=!0;if("[object Array]"==n){if(d=b.length,f=d==c.length)for(;d--&&(f=L(b[d],c[d],e,l)););}else{for(var w in b)if(a.has(b,w)&&(d++,!(f=a.has(c,w)&&L(b[w],c[w],e,l))))break;if(f){for(w in c)if(a.has(c,w)&&!d--)break;f=!d}}e.pop();l.pop();return f};a.isEqual=function(a,c){return L(a,c,[],[])};a.isEmpty=function(b){if(null==b)return!0;if(a.isArray(b)||a.isString(b))return 0===b.length;for(var c in b)if(a.has(b,c))return!1;return!0};a.isElement=function(a){return!(!a||1!==a.nodeType)};a.isArray=r||function(a){return"[object Array]"==
h.call(a)};a.isObject=function(a){return a===Object(a)};c("Arguments Function String Number Date RegExp".split(" "),function(b){a["is"+b]=function(a){return h.call(a)=="[object "+b+"]"}});a.isArguments(arguments)||(a.isArguments=function(b){return!(!b||!a.has(b,"callee"))});"function"!==typeof/./&&(a.isFunction=function(a){return"function"===typeof a});a.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};a.isNaN=function(b){return a.isNumber(b)&&b!=+b};a.isBoolean=function(a){return!0===
a||!1===a||"[object Boolean]"==h.call(a)};a.isNull=function(a){return null===a};a.isUndefined=function(a){return void 0===a};a.has=function(a,c){return B.call(a,c)};a.noConflict=function(){D._=p;return this};a.identity=function(a){return a};a.times=function(a,c,e){for(var l=Array(Math.max(0,a)),d=0;d<a;d++)l[d]=c.call(e,d);return l};a.random=function(a,c){null==c&&(c=a,a=0);return a+Math.floor(Math.random()*(c-a+1))};var J={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
J.unescape=a.invert(J.escape);var N={escape:RegExp("["+a.keys(J.escape).join("")+"]","g"),unescape:RegExp("("+a.keys(J.unescape).join("|")+")","g")};a.each(["escape","unescape"],function(b){a[b]=function(a){return null==a?"":(""+a).replace(N[b],function(a){return J[b][a]})}});a.result=function(b,c){if(null!=b){var e=b[c];return a.isFunction(e)?e.call(b):e}};a.mixin=function(b){c(a.functions(b),function(c){var e=a[c]=b[c];a.prototype[c]=function(){var b=[this._wrapped];s.apply(b,arguments);b=e.apply(a,
b);return this._chain?a(b).chain():b}})};var P=0;a.uniqueId=function(a){var c=++P+"";return a?a+c:c};a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;a.template=function(b,c,e){var l;e=a.defaults({},e,a.templateSettings);var d=RegExp([(e.escape||C).source,(e.interpolate||C).source,(e.evaluate||C).source].join("|")+
"|$","g"),h=0,n="__p+='";b.replace(d,function(a,c,e,l,d){n+=b.slice(h,d).replace(I,function(a){return"\\"+O[a]});c&&(n+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");e&&(n+="'+\n((__t=("+e+"))==null?'':__t)+\n'");l&&(n+="';\n"+l+"\n__p+='");h=d+a.length;return a});n+="';\n";e.variable||(n="with(obj||{}){\n"+n+"}\n");n="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+n+"return __p;\n";try{l=new Function(e.variable||"obj","_",n)}catch(f){throw f.source=
n,f;}if(c)return l(c,a);c=function(b){return l.call(this,b,a)};c.source="function("+(e.variable||"obj")+"){\n"+n+"}";return c};a.chain=function(b){return a(b).chain()};a.mixin(a);c("pop push reverse shift sort splice unshift".split(" "),function(b){var c=f[b];a.prototype[b]=function(){var e=this._wrapped;c.apply(e,arguments);"shift"!=b&&"splice"!=b||0!==e.length||delete e[0];return this._chain?a(e).chain():e}});c(["concat","join","slice"],function(b){var c=f[b];a.prototype[b]=function(){var b=c.apply(this._wrapped,
arguments);return this._chain?a(b).chain():b}});a.extend(a.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var D=[].slice,p=function(f,r,g){var d;f=-1;var k=r.length;switch(g.length){case 0:for(;++f<k;)(d=r[f]).callback.call(d.ctx);break;case 1:for(;++f<k;)(d=r[f]).callback.call(d.ctx,g[0]);break;case 2:for(;++f<k;)(d=r[f]).callback.call(d.ctx,g[0],g[1]);break;case 3:for(;++f<k;)(d=r[f]).callback.call(d.ctx,g[0],g[1],g[2]);break;default:for(;++f<k;)(d=r[f]).callback.apply(d.ctx,g)}},g=Backbone.Events={on:function(f,g,s){this._events||(this._events={});(this._events[f]||(this._events[f]=[])).push({callback:g,
context:s,ctx:s||this});return this},once:function(f,g,s){var d=this,k=_.once(function(){d.off(f,k);g.apply(this,arguments)});k._callback=g;this.on(f,k,s);return this},off:function(f,g,s){var d,k,h,B,p,y,t,e;if(!this._events)return this;if(!f&&!g&&!s)return this._events={},this;B=f?[f]:_.keys(this._events);p=0;for(y=B.length;p<y;p++)if(f=B[p],d=this._events[f]){h=[];if(g||s)for(t=0,e=d.length;t<e;t++)k=d[t],(g&&g!==(k.callback._callback||k.callback)||s&&s!==k.context)&&h.push(k);this._events[f]=h}return this},
trigger:function(f){if(!this._events)return this;var g=D.call(arguments,1),s=this._events[f],d=this._events.all;s&&p(this,s,g);d&&p(this,d,arguments);return this},listenTo:function(f,g,s){var d=this._listeners||(this._listeners={}),k=f._listenerId||(f._listenerId=_.uniqueId("l"));d[k]=f;f.on(g,s||this,this);return this},stopListening:function(f,g,s){var d=this._listeners;if(d){if(f)f.off(g,s,this),g||s||delete d[f._listenerId];else{for(var k in d)d[k].off(null,null,this);this._listeners={}}return this}}};
g.bind=g.on;g.unbind=g.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=g),exports.Backbone=exports.Backbone||Backbone)})();(function(){function D(f,d){var k=(new Date).getTime(),h=Math.max(0,16-(k-g)),r=p.setTimeout(function(){f(k+h)},h);g=k+h;return r}var p=this,g=0,f=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=D),exports.requestAnimationFrame=D;else{for(var r=0;r<f.length&&!p.requestAnimationFrame;++r)p.requestAnimationFrame=p[f[r]+"RequestAnimationFrame"],p.cancelAnimationFrame=p[f[r]+"CancelAnimationFrame"]||p[f[r]+"CancelRequestAnimationFrame"];
p.requestAnimationFrame||(p.requestAnimationFrame=D);p.cancelAnimationFrame||(p.cancelAnimationFrame=function(f){clearTimeout(f)})}})();(function(){function D(){var a=document.body.getBoundingClientRect(),c=this.width=a.width,a=this.height=a.height;this.renderer.setSize(c,a,this.ratio);this.trigger(e.Events.resize,c,a)}var p=this,g=p.Two||{},f=Math.sin,r=Math.cos,s=Math.atan2,d=Math.sqrt,k=Math.PI,h=2*k,B=k/2,H=Math.pow,y=0,t={hasEventListeners:_.isFunction(p.addEventListener),bind:function(a,c,e,n){this.hasEventListeners?a.addEventListener(c,e,!!n):a.attachEvent("on"+c,e);return this},unbind:function(a,c,e,n){this.hasEventListeners?
a.removeEventListeners(c,e,!!n):a.detachEvent("on"+c,e);return this}},e=p.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:e.Types.svg,autostart:!1});_.each(a,function(a,e){"fullscreen"!==e&&("width"!==e&&"height"!==e&&"autostart"!==e)&&(this[e]=a)},this);_.isElement(a.domElement)&&(this.type=e.Types[a.domElement.tagName.toLowerCase()]);this.renderer=new e[this.type](this);e.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(D,this),_.extend(document.body.style,
{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),t.bind(p,"resize",a),a()):_.isElement(a.domElement)||(this.renderer.setSize(a.width,a.height,this.ratio),this.width=a.width,this.height=a.height);this.scene=this.renderer.scene;e.Instances.push(this)};_.extend(e,{Array:p.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},
Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){p.Two=g;return this},uniqueId:function(){var a=y;y++;return a},Utils:{release:function(a){_.isObject(a)&&(_.isFunction(a.unbind)&&a.unbind(),a.vertices&&(_.isFunction(a.vertices.unbind)&&
a.vertices.unbind(),_.each(a.vertices,function(a){_.isFunction(a.unbind)&&a.unbind()})),a.children&&_.each(a.children,function(a){e.Utils.release(a)}))},Curve:{CollinearityEpsilon:H(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},devicePixelRatio:p.devicePixelRatio||1,getBackingStoreRatio:function(a){return a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1},getRatio:function(a){return e.Utils.devicePixelRatio/
G(a)},setPlaying:function(a){this.playing=!!a;return this},getComputedMatrix:function(a,c){var l=[];c=c&&c.identity()||new e.Matrix;for(var n=a;n&&n._matrix;)l.push(n._matrix),n=n.parent;l.reverse();_.each(l,function(a){a=a.elements;c.multiply(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9])});return c},applySvgAttributes:function(a,c){_.each(a.attributes,function(a,e){switch(a.nodeName){case "visibility":c.visible=!!a.nodeValue;break;case "stroke-linecap":c.cap=a.nodeValue;break;case "stroke-linejoin":c.join=
a.nodeValue;break;case "stroke-miterlimit":c.miter=a.nodeValue;break;case "stroke-width":c.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":case "opacity":c.opacity=a.nodeValue;break;case "fill":c.fill=a.nodeValue;break;case "stroke":c.stroke=a.nodeValue;break;case "id":c.id=a.nodeValue}});return c},read:{svg:function(){return e.Utils.read.g.apply(this,arguments)},g:function(a){var c=new e.Group;this.add(c);_.each(a.childNodes,function(a){var n=a.nodeName;n&&(n=n.replace(/svg\:/ig,
"").toLowerCase(),n in e.Utils.read&&(a=e.Utils.read[n].call(this,a),c.add(a)))},this);return e.Utils.applySvgAttributes(a,c)},polygon:function(a,c){var l=[];a.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,function(a,c,n){l.push(new e.Anchor(parseFloat(c),parseFloat(n)))});var n=(new e.Polygon(l,!c)).noStroke();n.fill="black";return e.Utils.applySvgAttributes(a,n)},polyline:function(a){return e.Utils.read.polygon(a,!0)},path:function(a){var c,l,n,d=!1,h=!1,f=a.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),
g=f.length-1,f=_.flatten(_.map(f,function(a,f){var k,C,r=a[0],I=r.toLowerCase();n=a.slice(1).trim();n=n.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,c){return parseFloat(b)*Math.pow(10,c)});n=n.split(/[\s,]+|(?=\s?[+\-])/);d=r===I;var b,m,q,u;switch(I){case "z":f>=g?h=!0:(C=c.x,k=c.y,k=new e.Anchor(C,k,void 0,void 0,void 0,void 0,e.Commands.close));break;case "m":case "l":C=parseFloat(n[0]);k=parseFloat(n[1]);k=new e.Anchor(C,k,void 0,void 0,void 0,void 0,"m"===I?e.Commands.move:e.Commands.line);
d&&k.addSelf(c);c=k;break;case "h":case "v":C="h"===I?"x":"y";r="x"===C?"y":"x";k=new e.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,e.Commands.line);k[C]=parseFloat(n[0]);k[r]=c[r];d&&(k[C]+=c[C]);c=k;break;case "s":case "c":k=c.x;r=c.y;l||(l=(new e.Vector).copy(c));"c"===I?(b=parseFloat(n[0]),C=parseFloat(n[1]),I=parseFloat(n[2]),m=parseFloat(n[3]),q=parseFloat(n[4]),u=parseFloat(n[5])):(m=e.Utils.getReflection(c,l,d),b=m.x,C=m.y,I=parseFloat(n[0]),m=parseFloat(n[1]),q=parseFloat(n[2]),u=parseFloat(n[3]));
d&&(b+=k,C+=r,I+=k,m+=r,q+=k,u+=r);_.isObject(c.controls)||e.Anchor.AppendCurveProperties(c);c.controls.right.set(b-c.x,C-c.y);c=k=new e.Anchor(q,u,I-q,m-u,void 0,void 0,e.Commands.curve);l=k.controls.left;break;case "t":case "q":k=c.x;r=c.y;l||(l=(new e.Vector).copy(c));l.isZero()?(b=k,C=r):(b=l.x,r=l.y);"q"===I?(I=parseFloat(n[0]),m=parseFloat(n[1]),q=parseFloat(n[1]),u=parseFloat(n[2])):(m=e.Utils.getReflection(c,l,d),I=m.x,m=m.y,q=parseFloat(n[0]),u=parseFloat(n[1]));d&&(b+=k,C+=r,I+=k,m+=r,q+=
k,u+=r);_.isObject(c.controls)||e.Anchor.AppendCurveProperties(c);c.controls.right.set(b-c.x,C-c.y);c=k=new e.Anchor(q,u,I-q,m-u,void 0,void 0,e.Commands.curve);l=k.controls.left;break;case "a":throw new e.Utils.Error("not yet able to interpret Elliptical Arcs.");}return k}));if(!(1>=f.length))return f=_.compact(f),f=(new e.Polygon(f,h,void 0,!0)).noStroke(),f.fill="black",e.Utils.applySvgAttributes(a,f)},circle:function(a){var c=parseFloat(a.getAttribute("cx")),l=parseFloat(a.getAttribute("cy")),
d=parseFloat(a.getAttribute("r")),k=e.Resolution,g=_.map(_.range(k),function(a){var c=a/k*h;a=d*r(c);c=d*f(c);return new e.Anchor(a,c)},this),g=(new e.Polygon(g,!0,!0)).noStroke();g.translation.set(c,l);g.fill="black";return e.Utils.applySvgAttributes(a,g)},ellipse:function(a){var c=parseFloat(a.getAttribute("cx")),l=parseFloat(a.getAttribute("cy")),d=parseFloat(a.getAttribute("rx")),g=parseFloat(a.getAttribute("ry")),k=e.Resolution,q=_.map(_.range(k),function(a){var c=a/k*h;a=d*r(c);c=g*f(c);return new e.Anchor(a,
c)},this),q=(new e.Polygon(q,!0,!0)).noStroke();q.translation.set(c,l);q.fill="black";return e.Utils.applySvgAttributes(a,q)},rect:function(a){var c=parseFloat(a.getAttribute("x")),l=parseFloat(a.getAttribute("y")),d=parseFloat(a.getAttribute("width")),h=parseFloat(a.getAttribute("height")),d=d/2,h=h/2,f=[new e.Anchor(d,h),new e.Anchor(-d,h),new e.Anchor(-d,-h),new e.Anchor(d,-h)],f=(new e.Polygon(f,!0)).noStroke();f.translation.set(c+d,l+h);f.fill="black";return e.Utils.applySvgAttributes(a,f)},
line:function(a){var c=parseFloat(a.getAttribute("x1")),d=parseFloat(a.getAttribute("y1")),h=parseFloat(a.getAttribute("x2")),f=parseFloat(a.getAttribute("y2")),h=(h-c)/2,f=(f-d)/2,g=[new e.Anchor(-h,-f),new e.Anchor(h,f)],g=(new e.Polygon(g)).noFill();g.translation.set(c+h,d+f);return e.Utils.applySvgAttributes(a,g)}},subdivide:function(a,c,d,h,f,g,k,r,q){q=q||e.Utils.Curve.RecursionLimit;var u=q+1;return a===k&&c===r?[new e.Anchor(k,r)]:_.map(_.range(0,u),function(q){var C=q/u;q=F(C,a,d,f,k);C=
F(C,c,h,g,r);return new e.Anchor(q,C)})},getPointOnCubicBezier:function(a,c,e,d,h){var f=1-a;return f*f*f*c+3*f*f*a*e+3*f*a*a*d+a*a*a*h},getCurveFromPoints:function(a,c){for(var d=a.length,h=d-1,f=0;f<d;f++){var g=a[f];_.isObject(g.controls)||e.Anchor.AppendCurveProperties(g);var k=c?A(f-1,d):Math.max(f-1,0),r=c?A(f+1,d):Math.min(f+1,h);q(a[k],g,a[r]);g._command=0===f?e.Commands.move:e.Commands.curve;g.controls.left.x=_.isNumber(g.controls.left.x)?g.controls.left.x:g.x;g.controls.left.y=_.isNumber(g.controls.left.y)?
g.controls.left.y:g.y;g.controls.right.x=_.isNumber(g.controls.right.x)?g.controls.right.x:g.x;g.controls.right.y=_.isNumber(g.controls.right.y)?g.controls.right.y:g.y}},getControlPoints:function(a,c,d){var h=u(a,c),g=u(d,c);a=v(a,c);d=v(d,c);var q=(h+g)/2;c.u=_.isObject(c.controls.left)?c.controls.left:new e.Vector(0,0);c.v=_.isObject(c.controls.right)?c.controls.right:new e.Vector(0,0);if(1E-4>a||1E-4>d)return c._relative||(c.controls.left.copy(c),c.controls.right.copy(c)),c;a*=0.33;d*=0.33;q=g<
h?q+B:q-B;c.controls.left.x=r(q)*a;c.controls.left.y=f(q)*a;q-=k;c.controls.right.x=r(q)*d;c.controls.right.y=f(q)*d;c._relative||(c.controls.left.x+=c.x,c.controls.left.y+=c.y,c.controls.right.x+=c.x,c.controls.right.y+=c.y);return c},getReflection:function(a,c,d){var h=c.distanceTo(e.Vector.zero);c=u(e.Vector.zero,c);return new e.Vector(h*Math.cos(c)+(d?0:a.x),h*Math.sin(c)+(d?0:a.y))},angleBetween:function(a,c){var e,d;if(4<=arguments.length)return e=arguments[0]-arguments[2],d=arguments[1]-arguments[3],
s(d,e);e=a.x-c.x;d=a.y-c.y;return s(d,e)},distanceBetweenSquared:function(a,c){var e=a.x-c.x,d=a.y-c.y;return e*e+d*d},distanceBetween:function(a,c){return d(E(a,c))},mod:function(a,c){for(;0>a;)a+=c;return a%c},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=a}}});e.Utils.Error.prototype=Error();e.Utils.Error.prototype.constructor=
e.Utils.Error;e.Utils.Collection.prototype=[];e.Utils.Collection.constructor=e.Utils.Collection;_.extend(e.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(e.Events.remove,[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(e.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);this.trigger(e.Events.insert,arguments);return a},unshift:function(){var a=
Array.prototype.unshift.apply(this,arguments);this.trigger(e.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,arguments),c;this.trigger(e.Events.remove,a);2<arguments.length&&(c=this.slice(arguments[0],arguments.length-2),this.trigger(e.Events.insert,c));return a}});var v=e.Utils.distanceBetween,E=e.Utils.distanceBetweenSquared,u=e.Utils.angleBetween,q=e.Utils.getControlPoints,A=e.Utils.mod,G=e.Utils.getBackingStoreRatio,F=e.Utils.getPointOnCubicBezier;
_.extend(e.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){e.Utils.setPlaying.call(this,!0);return this.trigger(e.Events.play)},pause:function(){this.playing=!1;return this.trigger(e.Events.pause)},update:function(){var a=!!this._lastFrame,c=(p.performance&&p.performance.now?p.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((c-this._lastFrame).toFixed(3)));this._lastFrame=c;var a=this.width,c=this.height,
d=this.renderer;a===d.width&&c===d.height||d.setSize(a,c,this.ratio);this.trigger(e.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(e.Events.render,this.frameCount)},add:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));this.scene.add(c);return this},remove:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));this.scene.remove(c);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));
return this},makeLine:function(a,c,d,h){d=(d-a)/2;h=(h-c)/2;var f=[new e.Anchor(-d,-h),new e.Anchor(d,h)],f=(new e.Polygon(f)).noFill();f.translation.set(a+d,c+h);this.scene.add(f);return f},makeRectangle:function(a,c,d,h){d/=2;h/=2;h=[new e.Anchor(-d,-h),new e.Anchor(d,-h),new e.Anchor(d,h),new e.Anchor(-d,h)];h=new e.Polygon(h,!0);h.translation.set(a,c);this.scene.add(h);return h},makeCircle:function(a,c,e){return this.makeEllipse(a,c,e,e)},makeEllipse:function(a,c,d,g){var k=e.Resolution,q=_.map(_.range(k),
function(a){var c=a/k*h;a=d*r(c);c=g*f(c);return new e.Anchor(a,c)},this),q=new e.Polygon(q,!0,!0);q.translation.set(a,c);this.scene.add(q);return q},makeCurve:function(a){var c=arguments.length,d=a;if(!_.isArray(a))for(var d=[],h=0;h<c;h+=2){var f=arguments[h];if(!_.isNumber(f))break;d.push(new e.Anchor(f,arguments[h+1]))}var c=arguments[c-1],d=new e.Polygon(d,!(_.isBoolean(c)&&c),!0),c=d.getBoundingClientRect(),g=c.left+c.width/2,k=c.top+c.height/2;_.each(d.vertices,function(a){a.x-=g;a.y-=k});
d.translation.set(g,k);this.scene.add(d);return d},makePolygon:function(a){var c=arguments.length,d=a;if(!_.isArray(a))for(var d=[],h=0;h<c;h+=2){var f=arguments[h];if(!_.isNumber(f))break;d.push(new e.Anchor(f,arguments[h+1]))}c=arguments[c-1];d=new e.Polygon(d,!(_.isBoolean(c)&&c));c=d.getBoundingClientRect();d.center().translation.set(c.left+c.width/2,c.top+c.height/2);this.scene.add(d);return d},makeGroup:function(a){var c=a;_.isArray(a)||(c=_.toArray(arguments));var d=new e.Group;this.scene.add(d);
d.add(c);return d},interpret:function(a){var c=a.tagName.toLowerCase();if(!(c in e.Utils.read))return null;a=e.Utils.read[c].call(this,a);this.add(a);return a}});(function(){requestAnimationFrame(arguments.callee);_.each(e.Instances,function(a){a.playing&&a.update()})})();"function"===typeof define&&define.amd?define(function(){return e}):"undefined"!=typeof module&&module.exports&&(module.exports=e)})();(function(){var D,p,g,f,r=Two.Vector=function(d,f){this.x=d||0;this.y=f||0};_.extend(r,{zero:new Two.Vector});_.extend(r.prototype,Backbone.Events,{set:function(d,f){this.x=d;this.y=f;return this},copy:function(d){this.x=d.x;this.y=d.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new r(this.x,this.y)},add:function(d,f){this.x=d.x+f.x;this.y=d.y+f.y;return this},addSelf:function(d){this.x+=d.x;this.y+=d.y;return this},sub:function(d,f){this.x=d.x-f.x;this.y=d.y-
f.y;return this},subSelf:function(d){this.x-=d.x;this.y-=d.y;return this},multiplySelf:function(d){this.x*=d.x;this.y*=d.y;return this},multiplyScalar:function(d){this.x*=d;this.y*=d;return this},divideScalar:function(d){d?(this.x/=d,this.y/=d):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(d){return this.x*d.x+this.y*d.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(d){g=this.x-d.x;f=this.y-d.y;return g*g+f*f},setLength:function(d){return this.normalize().multiplyScalar(d)},equals:function(d){return 1E-4>this.distanceTo(d)},lerp:function(d,f){D=(d.x-this.x)*f+this.x;p=(d.y-this.y)*f+this.y;return this.set(D,p)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var s={set:function(d,
f){this._x=d;this._y=f;return this.trigger(Two.Events.change)},copy:function(d){this._x=d.x;this._y=d.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new r(this._x,this._y)},add:function(d,f){this._x=d.x+f.x;this._y=d.y+f.y;return this.trigger(Two.Events.change)},addSelf:function(d){this._x+=d.x;this._y+=d.y;return this.trigger(Two.Events.change)},sub:function(d,f){this._x=d.x-f.x;this._y=d.y-f.y;return this.trigger(Two.Events.change)},
subSelf:function(d){this._x-=d.x;this._y-=d.y;return this.trigger(Two.Events.change)},multiplySelf:function(d){this._x*=d.x;this._y*=d.y;return this.trigger(Two.Events.change)},multiplyScalar:function(d){this._x*=d;this._y*=d;return this.trigger(Two.Events.change)},divideScalar:function(d){return d?(this._x/=d,this._y/=d,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(d){return this._x*d.x+this._y*d.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(d){g=this._x-d.x;f=this._y-d.y;return g*g+f*f},setLength:function(d){return this.normalize().multiplyScalar(d)},equals:function(d){return 1E-4>this.distanceTo(d)},lerp:function(d,f){D=(d.x-this._x)*f+this._x;p=(d.y-this._y)*f+this._y;return this.set(D,p)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},d={get:function(){return this._x},set:function(d){this._x=d;this.trigger(Two.Events.change,"x")}},k={get:function(){return this._y},set:function(d){this._y=d;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",d),Object.defineProperty(this,"y",k),_.extend(this,s),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var D=Two.Commands,p,g,f,r=Two.Anchor=function(d,f,g,s,p,y,t){Two.Vector.call(this,d,f);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);this._command=t||D.move;this._relative=!0;if(!t)return this;r.AppendCurveProperties(this);_.isNumber(g)&&(this.controls.left.x=g);_.isNumber(s)&&(this.controls.left.y=s);_.isNumber(p)&&(this.controls.right.x=p);_.isNumber(y)&&(this.controls.right.y=y)};_.extend(r,{AppendCurveProperties:function(d){d.controls={left:new Two.Vector(0,
0),right:new Two.Vector(0,0)}}});var s={listen:function(){_.isObject(this.controls)||r.AppendCurveProperties(this);_.each(this.controls,function(d){d.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,function(d){d.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){g=this.controls;f=new Two.Anchor(this.x,this.y,g&&g.left.x,g&&g.left.y,g&&g.right.x,g&&g.right.y,this.command);f.relative=this._relative;return f},toObject:function(){p=
{x:this.x,y:this.y};this._command&&(p.command=this._command);this._relative&&(p.relative=this._relative);this.controls&&(p.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()});return p}};Object.defineProperty(r.prototype,"command",{get:function(){return this._command},set:function(d){this._command=d;this._command!==D.curve||_.isObject(this.controls)||r.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});Object.defineProperty(r.prototype,"relative",
{get:function(){return this._relative},set:function(d){if(this._relative==d)return this;this._relative=!!d;return this.trigger(Two.Events.change)}});_.extend(r.prototype,Two.Vector.prototype,s);Two.Anchor.prototype.bind=Two.Anchor.prototype.on=function(){Two.Vector.prototype.bind.apply(this,arguments);_.extend(this,s)};Two.Anchor.prototype.unbind=Two.Anchor.prototype.off=function(){Two.Vector.prototype.unbind.apply(this,arguments);_.extend(this,s)}})();(function(){_.range(6);var D=Math.cos,p=Math.sin,g=Math.tan,f,r,s,d,k,h,B,H,y,t,e,v,E,u,q,A,G,F,a,c,l,n,K,w,x,L,J,N,P,C,O,I,b,m,z,ea,Q,R,aa,da,U,V,W,X,Y,ba,ca,Z,S,$=[],fa=Two.Matrix=function(a,b,c,e,d,f){this.elements=new Two.Array(9);var g=a;_.isArray(g)||(g=_.toArray(arguments));this.identity().set(g)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(b,e,d){if(3>=e.length)return v,E,u,f=e[0]||0,r=e[1]||0,s=e[2]||0,k=b,v=k[0]*f+k[1]*r+k[2]*s,E=k[3]*f+k[4]*r+k[5]*s,u=k[6]*f+k[7]*r+k[8]*
s,{x:v,y:E,z:u};q=b[0];A=b[1];G=b[2];F=b[3];a=b[4];c=b[5];l=b[6];n=b[7];K=b[8];w=e[0];x=e[1];L=e[2];J=e[3];N=e[4];P=e[5];C=e[6];O=e[7];I=e[8];d=d||new Two.Array(9);d[0]=q*w+A*J+G*C;d[1]=q*x+A*N+G*O;d[2]=q*L+A*P+G*I;d[3]=F*w+a*J+c*C;d[4]=F*x+a*N+c*O;d[5]=F*L+a*P+c*I;d[6]=l*w+n*J+K*C;d[7]=l*x+n*N+K*O;d[8]=l*L+n*P+K*I;return d}});_.extend(fa.prototype,Backbone.Events,{set:function(a,b,c,d,f,g){e=a;z=arguments.length;_.isArray(e)||(e=_.toArray(arguments));_.each(e,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(d,f,g,h,k,r,s,p,ma){e=arguments;z=e.length;if(1>=z)return _.each(this.elements,function(a,b){this.elements[b]=a*d},this),this.trigger(Two.Events.change);if(3>=z)return v,E,u,d=d||0,f=f||0,g=g||0,k=this.elements,v=k[0]*d+k[1]*f+k[2]*g,E=k[3]*d+k[4]*f+k[5]*g,u=k[6]*d+k[7]*f+k[8]*g,{x:v,y:E,z:u};b=this.elements;m=e;q=b[0];A=b[1];G=b[2];F=b[3];a=b[4];c=b[5];l=b[6];n=b[7];K=b[8];w=
m[0];x=m[1];L=m[2];J=m[3];N=m[4];P=m[5];C=m[6];O=m[7];I=m[8];this.elements[0]=q*w+A*J+G*C;this.elements[1]=q*x+A*N+G*O;this.elements[2]=q*L+A*P+G*I;this.elements[3]=F*w+a*J+c*C;this.elements[4]=F*x+a*N+c*O;this.elements[5]=F*L+a*P+c*I;this.elements[6]=l*w+n*J+K*C;this.elements[7]=l*x+n*N+K*O;this.elements[8]=l*L+n*P+K*I;return this.trigger(Two.Events.change)},inverse:function(a){f=this.elements;a=a||new Two.Matrix;Q=f[0];R=f[1];aa=f[2];da=f[3];U=f[4];V=f[5];W=f[6];X=f[7];Y=f[8];ba=Y*U-V*X;ca=-Y*da+
V*W;Z=X*da-U*W;S=Q*ba+R*ca+aa*Z;if(!S)return null;S=1/S;a.elements[0]=ba*S;a.elements[1]=(-Y*R+aa*X)*S;a.elements[2]=(V*R-aa*U)*S;a.elements[3]=ca*S;a.elements[4]=(Y*Q-aa*W)*S;a.elements[5]=(-V*Q+aa*da)*S;a.elements[6]=Z*S;a.elements[7]=(-X*Q+R*W)*S;a.elements[8]=(U*Q-R*da)*S;return a},scale:function(a,b){z=arguments.length;1>=z&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){s=D(a);ea=p(a);return this.multiply(s,-ea,0,ea,s,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){f=g(a);return this.multiply(1,f,0,0,1,0,0,0,1)},skewY:function(a){f=g(a);return this.multiply(1,0,0,f,1,0,0,0,1)},toString:function(a){this.toArray(a,$);return $.join(" ")},toArray:function(a,b){e=this.elements;t=!!b;f=parseFloat(e[0].toFixed(3));r=parseFloat(e[1].toFixed(3));s=parseFloat(e[2].toFixed(3));d=parseFloat(e[3].toFixed(3));k=parseFloat(e[4].toFixed(3));h=parseFloat(e[5].toFixed(3));if(a){B=parseFloat(e[6].toFixed(3));H=parseFloat(e[7].toFixed(3));y=
parseFloat(e[8].toFixed(3));if(t){b[0]=f;b[1]=d;b[2]=B;b[3]=r;b[4]=k;b[5]=H;b[6]=s;b[7]=h;b[8]=y;return}return[f,d,B,r,k,H,s,h,y]}if(t)b[0]=f,b[1]=d,b[2]=r,b[3]=k,b[4]=s,b[5]=h;else return[f,d,r,k,s,h]},clone:function(){f=this.elements[0];r=this.elements[1];s=this.elements[2];d=this.elements[3];k=this.elements[4];h=this.elements[5];B=this.elements[6];H=this.elements[7];y=this.elements[8];return new Two.Matrix(f,r,s,d,k,h,B,H,y)}})})();(function(){var D=Two.Utils.mod,p,g,f,r={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(d,k){f=d;g=document.createElementNS(this.ns,f);"svg"===f&&(k=_.defaults(k||{},{version:this.version}));_.isObject(k)&&r.setAttributes(g,k);return g},setAttribute:function(d,f){this.setAttribute(f,d)},setAttributes:function(d,f){_.each(f,r.setAttribute,d);return this},removeAttribute:function(d,f){this.removeAttribute(f)},removeAttributes:function(d,f){_.each(f,
r.removeAttribute,d);return this},toString:function(d,f){var g=d.length,r=g-1,s;return _.map(d,function(p,t){var e,v=f?D(t-1,g):Math.max(t-1,0),E=f?D(t+1,g):Math.min(t+1,r);e=d[v];var u=d[E],q,A,G,v=p.x.toFixed(3),u=p.y.toFixed(3);switch(p._command){case Two.Commands.close:e=Two.Commands.close;break;case Two.Commands.curve:q=e.controls&&e.controls.right||e;G=p.controls&&p.controls.left||p;e._relative?(E=(q.x+e.x).toFixed(3),q=(q.y+e.y).toFixed(3)):(E=q.x.toFixed(3),q=q.y.toFixed(3));p._relative?(A=
(G.x+p.x).toFixed(3),G=(G.y+p.y).toFixed(3)):(A=G.x.toFixed(3),G=G.y.toFixed(3));e=(0===t?Two.Commands.move:Two.Commands.curve)+" "+E+" "+q+" "+A+" "+G+" "+v+" "+u;break;case Two.Commands.move:s=p;e=Two.Commands.move+" "+v+" "+u;break;default:e=p._command+" "+v+" "+u}t>=r&&f&&(p._command===Two.Commands.curve&&(u=s,q=p.controls&&p.controls.right||p,v=u.controls&&u.controls.left||u,p._relative?(E=(q.x+p.x).toFixed(3),q=(q.y+p.y).toFixed(3)):(E=q.x.toFixed(3),q=q.y.toFixed(3)),u._relative?(A=(v.x+u.x).toFixed(3),
G=(v.y+u.y).toFixed(3)):(A=v.x.toFixed(3),G=v.y.toFixed(3)),v=u.x.toFixed(3),u=u.y.toFixed(3),e+=" C "+E+" "+q+" "+A+" "+G+" "+v+" "+u),e+=" Z");return e}).join(" ")},group:{appendChild:function(d){(g=this.domElement.querySelector("#"+d))&&this.elem.appendChild(g)},removeChild:function(d){(g=this.domElement.querySelector("#"+d))&&this.elem.removeChild(g)},renderChild:function(d){r[d._renderer.type].render.call(d,this)},render:function(d){this._update();this._renderer.elem||(this._renderer.elem=r.createElement("g",
{id:this.id}),d.appendChild(this._renderer.elem));p=this._matrix.manual||this._flagMatrix;var f={domElement:d,elem:this._renderer.elem};p&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");_.each(this.children,r.group.renderChild,d);this._flagAdditions&&_.each(this.additions,r.group.appendChild,f);this._flagSubtractions&&_.each(this.subtractions,r.group.removeChild,f);return this.flagReset()}},polygon:{render:function(d){this._update();this._renderer.elem||(this._renderer.elem=
r.createElement("path",{id:this.id}),d.appendChild(this._renderer.elem));g=this._renderer.elem;(p=this._matrix.manual||this._flagMatrix)&&g.setAttribute("transform","matrix("+this._matrix.toString()+")");this._flagVertices&&(vertices=r.toString(this._vertices,this._closed),g.setAttribute("d",vertices));this._flagFill&&g.setAttribute("fill",this._fill);this._flagStroke&&g.setAttribute("stroke",this._stroke);this._flagLinewidth&&g.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(g.setAttribute("stroke-opacity",
this._opacity),g.setAttribute("fill-opacity",this._opacity));this._flagVisible&&g.setAttribute("visibility",this._visible?"visible":"hidden");this._flagCap&&g.setAttribute("stroke-linecap",this._cap);this._flagJoin&&g.setAttribute("stroke-linejoin",this._join);this._flagMiter&&g.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},s=Two[Two.Types.svg]=function(d){this.domElement=d.domElement||r.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(s,{Utils:r});
_.extend(s.prototype,Backbone.Events,{setSize:function(d,f){this.width=d;this.height=f;r.setAttributes(this.domElement,{width:d,height:f});return this},render:function(){r.group.render.call(this.scene,this.domElement);return this}})})();(function(){var D=Two.Utils.mod,p=Two.Utils.getRatio,g,f,r,s,d,k,h,B,H,y,t,e,v,E,u,q,A,G,F,a,c,l,n,K,w,x,L,J,N={group:{renderChild:function(a){N[a._renderer.type].render.call(a,this)},render:function(a){this._update();g=this._matrix.elements;a.save();a.transform(g[0],g[3],g[1],g[4],g[2],g[5]);_.each(this.children,N.group.renderChild,a);a.restore();return this.flagReset()}},polygon:{render:function(p){this._update();g=this._matrix.elements;f=this.stroke;r=this.linewidth;s=this.fill;d=this.opacity;
k=this.visible;h=this.cap;B=this.join;H=this.miter;y=this.closed;t=this._vertices;e=t.length;v=e-1;if(!k)return this;p.save();g&&p.transform(g[0],g[3],g[1],g[4],g[2],g[5]);s&&(p.fillStyle=s);f&&(p.strokeStyle=f);r&&(p.lineWidth=r);H&&(p.miterLimit=H);B&&(p.lineJoin=B);h&&(p.lineCap=h);_.isNumber(d)&&(p.globalAlpha=d);p.beginPath();_.each(t,function(d,f){L=d.x.toFixed(3);J=d.y.toFixed(3);switch(d._command){case Two.Commands.close:p.closePath();break;case Two.Commands.curve:u=y?D(f-1,e):Math.max(f-
1,0);E=y?D(f+1,e):Math.min(f+1,v);q=t[u];A=t[E];n=q.controls&&q.controls.right||q;K=d.controls&&d.controls.left||d;q._relative?(c=(n.x+q.x).toFixed(3),l=(n.y+q.y).toFixed(3)):(c=n.x.toFixed(3),l=n.y.toFixed(3));d._relative?(F=(K.x+d.x).toFixed(3),a=(K.y+d.y).toFixed(3)):(F=K.x.toFixed(3),a=K.y.toFixed(3));p.bezierCurveTo(c,l,F,a,L,J);f>=v&&y&&(A=G,w=d.controls&&d.controls.right||d,x=A.controls&&A.controls.left||A,d._relative?(c=(w.x+d.x).toFixed(3),l=(w.y+d.y).toFixed(3)):(c=w.x.toFixed(3),l=w.y.toFixed(3)),
A._relative?(F=(x.x+A.x).toFixed(3),a=(x.y+A.y).toFixed(3)):(F=x.x.toFixed(3),a=x.y.toFixed(3)),L=A.x.toFixed(3),J=A.y.toFixed(3),p.bezierCurveTo(c,l,F,a,L,J));break;case Two.Commands.line:p.lineTo(L,J);break;case Two.Commands.move:G=d,p.moveTo(L,J)}});y&&p.closePath();p.fill();p.stroke();p.restore();return this.flagReset()}}},P=Two[Two.Types.canvas]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=a.overdraw||!1;this.scene=
new Two.Group;this.scene.parent=this};_.extend(P,{Utils:N});_.extend(P.prototype,Backbone.Events,{setSize:function(a,c,d){this.width=a;this.height=c;this.ratio=_.isUndefined(d)?p(this.ctx):d;this.domElement.width=a*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:c+"px"});return this},render:function(){var a=1===this.ratio;a||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);N.group.render.call(this.scene,
this.ctx);a||this.ctx.restore();return this}})})();(function(){var D=Two.Matrix.Multiply,p=Two.Utils.mod,g=[1,0,0,0,1,0,0,0,1],f=new Two.Array(9),r=Two.Utils.getRatio,s,d,k,h,B,H,y,t,e,v,E,u,q,A,G,F,a,c,l,n,K,w,x,L,J,N,P,C,O,I,b,m,z,ea,Q,R,aa,da,U,V,W,X,Y,ba,ca,Z,S,$,fa,ga,M,ia,ja,ka,ha,T={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){T[a._renderer.type].render.call(a,this.gl,this.program)},render:function(a,b){this._update();s=this.parent;d=s._matrix&&s._matrix.manual||s._flagMatrix;
k=this._matrix.manual||this._flagMatrix;if(d||k)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,f),D(f,s._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*s._renderer.scale,d&&(this._flagMatrix=!0);_.each(this.children,T.group.renderChild,{gl:a,program:b});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;s=this.parent;d=s._matrix.manual||s._flagMatrix;k=this._matrix.manual||this._flagMatrix;
h=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this._update();if(d||k)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,f),D(f,s._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*s._renderer.scale;h&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),
T.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),T.getTriangles(this._renderer.rect,this._renderer.triangles),T.updateBuffer(a,this,b),T.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,
!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(b,d,f){B=Infinity;H=-Infinity;y=Infinity;t=-Infinity;_.each(b,function(b,c){e=b.x;v=b.y;E;u;q;A;G=b.controls;y=Math.min(v,y);B=Math.min(e,B);H=Math.max(e,H);t=Math.max(v,t);b.controls&&(F=G.left,a=G.right,F&&a&&(E=b._relative?F.x+e:F.x,u=b._relative?F.y+v:F.y,q=b._relative?a.x+e:a.x,A=b._relative?a.y+v:a.y,E&&(u&&q&&A)&&(y=Math.min(u,A,y),B=Math.min(E,q,B),H=Math.max(E,q,H),t=Math.max(u,A,t))))});_.isNumber(d)&&
(y-=d,B-=d,H+=d,t+=d);c=H-B;l=t-y;f.top=y;f.left=B;f.right=H;f.bottom=t;f.width=c;f.height=l;f.centroid||(f.centroid={});f.centroid.x=-B;f.centroid.y=-y},getTriangles:function(a,b){y=a.top;B=a.left;H=a.right;t=a.bottom;b[0]=B;b[1]=y;b[2]=H;b[3]=y;b[4]=B;b[5]=t;b[6]=B;b[7]=t;b[8]=H;b[9]=y;b[10]=H;b[11]=t},updateCanvas:function(a){n=a._vertices;K=this.canvas;w=this.ctx;x=a._renderer.scale;L=a._stroke;J=a._linewidth*x;N=a._fill;P=a._opacity;C=a._cap;O=a._join;I=a._miter;b=a._closed;m=n.length;z=m-1;
K.width=Math.max(Math.ceil(a._renderer.rect.width*x),1);K.height=Math.max(Math.ceil(a._renderer.rect.height*x),1);ea=a._renderer.rect.centroid;Q=ea.x*x;R=ea.y*x;w.clearRect(0,0,K.width,K.height);N&&(w.fillStyle=N);L&&(w.strokeStyle=L);J&&(w.lineWidth=J);I&&(w.miterLimit=I);O&&(w.lineJoin=O);C&&(w.lineCap=C);_.isNumber(P)&&(w.globalAlpha=P);w.beginPath();_.each(n,function(a,c){aa;da;E;q;U;V;W;X;Y;ba;ca;F;e=(a.x*x+Q).toFixed(3);v=(a.y*x+R).toFixed(3);switch(a._command){case Two.Commands.close:w.closePath();
break;case Two.Commands.curve:da=b?p(c-1,m):Math.max(c-1,0);aa=b?p(c+1,m):Math.min(c+1,z);E=n[da];q=n[aa];Y=E.controls&&E.controls.right||E;ba=a.controls&&a.controls.left||a;E._relative?(W=((Y.x+E.x)*x+Q).toFixed(3),X=((Y.y+E.y)*x+R).toFixed(3)):(W=(Y.x*x+Q).toFixed(3),X=(Y.y*x+R).toFixed(3));a._relative?(U=((ba.x+a.x)*x+Q).toFixed(3),V=((ba.y+a.y)*x+R).toFixed(3)):(U=(ba.x*x+Q).toFixed(3),V=(ba.y*x+R).toFixed(3));w.bezierCurveTo(W,X,U,V,e,v);c>=z&&b&&(q=A,ca=a.controls&&a.controls.right||a,F=q.controls&&
q.controls.left||q,a._relative?(W=((ca.x+a.x)*x+Q).toFixed(3),X=((ca.y+a.y)*x+R).toFixed(3)):(W=(ca.x*x+Q).toFixed(3),X=(ca.y*x+R).toFixed(3)),q._relative?(U=((F.x+q.x)*x+Q).toFixed(3),V=((F.y+q.y)*x+Q).toFixed(3)):(U=(F.x*x+Q).toFixed(3),V=(F.y*x+R).toFixed(3)),e=(q.x*x+Q).toFixed(3),v=(q.y*x+R).toFixed(3),w.bezierCurveTo(W,X,U,V,e,v));break;case Two.Commands.line:w.lineTo(e,v);break;case Two.Commands.move:A=a,w.moveTo(e,v)}});b&&w.closePath();w.fill();w.stroke()},updateTexture:function(a,b){this.updateCanvas(b);
b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},
updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);
a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){Z=a.createProgram();_.each(b,function(b){a.attachShader(Z,b)});a.linkProgram(Z);S=a.getProgramParameter(Z,a.LINK_STATUS);if(!S)throw ga=a.getProgramInfoLog(Z),a.deleteProgram(Z),new Two.Utils.Error("unable to link program: "+ga);return Z}},shaders:{create:function(a,b,c){$=a.createShader(a[c]);a.shaderSource($,b);a.compileShader($);fa=a.getShaderParameter($,a.COMPILE_STATUS);if(!fa)throw ga=a.getShaderInfoLog($),a.deleteShader($),
new Two.Utils.Error("unable to compile shader "+$+": "+ga);return $},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};T.ctx=T.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(g),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;M=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=T.shaders.create(M,T.shaders.vertex,T.shaders.types.vertex);ja=T.shaders.create(M,T.shaders.fragment,T.shaders.types.fragment);this.program=T.program.create(M,[ka,ja]);M.useProgram(this.program);this.program.position=M.getAttribLocation(this.program,
"a_position");this.program.matrix=M.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=M.getAttribLocation(this.program,"a_textureCoords");M.disable(M.DEPTH_TEST);M.enable(M.BLEND);M.blendEquationSeparate(M.FUNC_ADD,M.FUNC_ADD);M.blendFuncSeparate(M.SRC_ALPHA,M.ONE_MINUS_SRC_ALPHA,M.ONE,M.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?r(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){M=this.ctx;this.overdraw||M.clear(M.COLOR_BUFFER_BIT|M.DEPTH_BUFFER_BIT);T.group.render.call(this.scene,M,this.program);this._flagMatrix=!1;return this}})})();(function(){var D,p=Two.Shape=function(g){this._renderer={};this.id=Two.Identifier+Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(p.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(p,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(g){Object.defineProperty(g,"rotation",{get:function(){return this._rotation},set:function(f){this._rotation=f;this._flagMatrix=!0}});Object.defineProperty(g,
"scale",{get:function(){return this._scale},set:function(f){this._scale=f;this._flagScale=this._flagMatrix=!0}})}});_.extend(p.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(g){g.add(this);return this},clone:function(){D=new p;D.translation.copy(this.translation);D.rotation=this.rotation;D.scale=this.scale;_.each(p.Properties,function(g){D[g]=this[g]},this);return D._update()},_update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);this.parent&&_.isFunction(this.parent._update)&&this.parent._update();return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});p.MakeObservable(p.prototype)})();(function(){function D(a,b,c){q=b.controls&&b.controls.right;u=a.controls&&a.controls.left;K=b.x;w=b.y;x=(q||b).x;L=(q||b).y;J=(u||a).x;N=(u||a).y;P=a.x;C=a.y;q&&b._relative&&(x+=b.x,L+=b.y);u&&a._relative&&(J+=a.x,N+=a.y);return Two.Utils.subdivide(K,w,x,L,J,N,P,C,c)}var p=Math.min,g=Math.max,f=Math.round,r=Two.Utils.getComputedMatrix,s,d,k,h,B,H,y,t,e,v,E,u,q,A,G,F,a,c,l,n,K,w,x,L,J,N,P,C;_.each(Two.Commands,function(a,b){});var O=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type=
"polygon";this._closed=!!b;this._curved=!!c;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.cap="butt";this.join="miter";this.miter=4;this._vertices=[];this.vertices=a;this.automatic=!d};_.extend(O,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),FlagVertices:function(){this._flagVertices=!0},MakeObservable:function(a){Two.Shape.MakeObservable(a);_.each(O.Properties.slice(0,
8),function(b){var c="_"+b,d="_flag"+b.charAt(0).toUpperCase()+b.slice(1);Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a;this[d]=!0}})});Object.defineProperty(a,"closed",{get:function(){return this._closed},set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(a,"curved",{get:function(){return this._curved},set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(O.prototype,"automatic",{get:function(){return this._automatic},
set:function(a){a!==this._automatic&&(method=(this._automatic=!!a)?"ignore":"listen",_.each(this.vertices,function(a){a[method]()}))}});Object.defineProperty(a,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=p(g(a,0),this._ending);this._flagVertices=!0}});Object.defineProperty(a,"ending",{get:function(){return this._ending},set:function(a){this._ending=p(g(a,this._beginning),1);this._flagVertices=!0}});Object.defineProperty(a,"vertices",{get:function(){return this._collection},
set:function(a){var c=_.bind(O.FlagVertices,this),d=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,c)},this);c()},this),e=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,c)},this);c()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(a.slice(0));this._collection.bind(Two.Events.insert,d);this._collection.bind(Two.Events.remove,e);verticesChanged=!0;d(this._collection)}})}});_.extend(O.prototype,Two.Shape.prototype,{_flagVertices:!0,
_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;t=_.map(this.vertices,function(a){return a.clone()});e=new O(t,this.closed,this.curved,!this.automatic);_.each(Two.Shape.Properties,function(a){e[a]=this[a]},this);e.translation.copy(this.translation);
e.rotation=this.rotation;e.scale=this.scale;a.add(e);return e},toObject:function(){var a={vertices:_.map(this.vertices,function(a){return a.toObject()})};_.each(Two.Shape.Properties,function(b){a[b]=this[b]},this);a.translation=this.translation.toObject;a.rotation=this.rotation;a.scale=this.scale;return a},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){v=this.getBoundingClientRect(!0);v.centroid={x:v.left+v.width/
2,y:v.top+v.height/2};_.each(this.vertices,function(a){a.addSelf(v.centroid)});return this},center:function(){v=this.getBoundingClientRect(!0);v.centroid={x:v.left+v.width/2,y:v.top+v.height/2};_.each(this.vertices,function(a){a.subSelf(v.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(c){this._update();n=c?this._matrix:r(this);E=this.linewidth/2;void 0;u=Infinity;q=-Infinity;A=Infinity;G=-Infinity;_.each(this._vertices,
function(b){F=b.x;a=b.y;b=n.multiply(F,a,1);A=p(b.y-E,A);u=p(b.x-E,u);q=g(b.x+E,q);G=g(b.y+E,G)});return{top:A,left:u,right:q,bottom:G,width:q-u,height:G-A}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this._vertices,this.closed),this;_.each(this._vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(a){this._update();h=this.vertices.length-1;c=this.vertices[h];B=this._closed||this.vertices[h]._command===Two.Commands.close;
t=[];_.each(this.vertices,function(b,d){if(0>=d&&!B)c=b;else if(b.command===Two.Commands.move)t.push(new Two.Anchor(c.x,c.y)),0<d&&(t[t.length-1].command=Two.Commands.line),c=l=b;else{var e=D(b,c,a);t=t.concat(e);_.each(e,function(a,b){a.command=0>=b&&c.command===Two.Commands.move?Two.Commands.move:Two.Commands.line});d>=h&&(this._closed&&this._automatic?(c=b,b=l,e=D(b,c,a),t=t.concat(e),_.each(e,function(a,b){a.command=0>=b&&c.command===Two.Commands.move?Two.Commands.move:Two.Commands.line})):B&&
t.push(new Two.Anchor(b.x,b.y)),t[t.length-1].command=B?Two.Commands.close:Two.Commands.line);c=b}},this);this._curved=this._automatic=!1;this.vertices=t;return this},_update:function(){if(this._flagVertices){s=this.vertices.length;h=s-1;d=f(this._beginning*h);k=f(this._ending*h);this._vertices.length=0;for(y=d;y<k+1;y++)H=this.vertices[y],this._vertices.push(H);this._automatic&&this.plot()}Two.Shape.prototype._update.call(this);return this},flagReset:function(){this._flagVertices=this._flagFill=
this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});O.MakeObservable(O.prototype)})();(function(){var D=Math.min,p=Math.max,g,f,r,s,d,k,h,B,H,y,t,e,v=Two.Group=function(d){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(v,{MakeObservable:function(d){Two.Shape.MakeObservable(d);v.MakeGetterSetter(d,Two.Polygon.Properties)},MakeGetterSetter:function(d,e){_.isArray(e)||(e=[e]);_.each(e,function(e){g="_"+e;Object.defineProperty(d,e,{get:function(){return this[g]},set:function(d){this[g]=d;_.each(this.children,function(f){f[e]=
d})}})})}});_.extend(v.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(d){d=d||this.parent;s=new v;d.add(s);r=_.map(this.children,function(d){return d.clone(s)});s.translation.copy(this.translation);s.rotation=this.rotation;s.scale=this.scale;return s},toObject:function(){var d={children:{},translation:this.translation.toObject(),
rotation:this.rotation,scale:this.scale};_.each(this.children,function(e,f){d.children[f]=e.toObject()},this);return d},corner:function(){d=this.getBoundingClientRect(!0);k={x:d.left,y:d.top};_.each(this.children,function(d){d.translation.subSelf(k)});return this},center:function(){d=this.getBoundingClientRect(!0);d.centroid={x:d.left+d.width/2,y:d.top+d.height/2};_.each(this.children,function(e){e.translation.subSelf(d.centroid)});return this},add:function(d){h=arguments.length;B=d;r=this.children;
H=this.parent;y=this.additions;_.isArray(d)||(B=_.toArray(arguments));_.each(B,function(d){d&&(t=d.id,f=d.parent,_.isUndefined(r[t])&&(f&&(delete f.children[t],e=_.indexOf(f.additions,t),0<=e&&f.additions.splice(e,1)),r[t]=d,d.parent=this,y.push(t),this._flagAdditions=!0))},this);return this},remove:function(d){h=arguments.length;B=d;r=this.children;H=this.parent;y=this.subtractions;if(0>=h&&H)return H.remove(this),this;_.isArray(d)||(B=_.toArray(arguments));_.each(B,function(d){t=d.id;grandchildren=
d.children;f=d.parent;t in r&&(delete r[t],delete d.parent,e=_.indexOf(f.additions,t),0<=e&&f.additions.splice(e,1),y.push(t),this._flagSubtractions=!0)},this);return this},getBoundingClientRect:function(e){this._update();var f=Infinity,g=-Infinity,h=Infinity,k=-Infinity;_.each(this.children,function(e){d=e.getBoundingClientRect();_.isNumber(d.top)&&(_.isNumber(d.left)&&_.isNumber(d.right)&&_.isNumber(d.bottom))&&(h=D(d.top,h),f=D(d.left,f),g=p(d.right,g),k=p(d.bottom,k))},this);return{top:h,left:f,
right:g,bottom:k,width:g-f,height:k-h}},noFill:function(){_.each(this.children,function(d){d.noFill()});return this},noStroke:function(){_.each(this.children,function(d){d.noStroke()});return this},subdivide:function(){var d=arguments;_.each(this.children,function(e){e.subdivide.apply(e,d)});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);
return this}});v.MakeObservable(v.prototype)})();
