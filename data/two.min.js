(function(){var x=this,q=x._,p={},e=Array.prototype,n=Object.prototype,l=e.push,k=e.slice,t=e.concat,f=n.toString,A=n.hasOwnProperty,E=e.forEach,u=e.map,w=e.reduce,s=e.reduceRight,C=e.filter,g=e.every,B=e.some,y=e.indexOf,v=e.lastIndexOf,n=Array.isArray,D=Object.keys,F=Function.prototype.bind,c=function(a){if(a instanceof c)return a;if(!(this instanceof c))return new c(a);this._wrapped=a};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=c),exports._=
c):x._=c;c.VERSION="1.5.1";var z=c.each=c.forEach=function(a,h,K){if(null!=a)if(E&&a.forEach===E)a.forEach(h,K);else if(a.length===+a.length)for(var b=0,d=a.length;b<d&&h.call(K,a[b],b,a)!==p;b++);else for(b in a)if(c.has(a,b)&&h.call(K,a[b],b,a)===p)break};c.map=c.collect=function(a,h,K){var b=[];if(null==a)return b;if(u&&a.map===u)return a.map(h,K);z(a,function(a,c,d){b.push(h.call(K,a,c,d))});return b};c.reduce=c.foldl=c.inject=function(a,h,K,b){var d=2<arguments.length;null==a&&(a=[]);if(w&&a.reduce===
w)return b&&(h=c.bind(h,b)),d?a.reduce(h,K):a.reduce(h);z(a,function(a,c,r){d?K=h.call(b,K,a,c,r):(K=a,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return K};c.reduceRight=c.foldr=function(a,h,b,d){var r=2<arguments.length;null==a&&(a=[]);if(s&&a.reduceRight===s)return d&&(h=c.bind(h,d)),r?a.reduceRight(h,b):a.reduceRight(h);var g=a.length;if(g!==+g)var m=c.keys(a),g=m.length;z(a,function(c,f,e){f=m?m[--g]:--g;r?b=h.call(d,b,a[f],f,e):(b=a[f],r=!0)});if(!r)throw new TypeError("Reduce of empty array with no initial value");
return b};c.find=c.detect=function(a,h,b){var c;d(a,function(a,d,r){if(h.call(b,a,d,r))return c=a,!0});return c};c.filter=c.select=function(a,h,b){var c=[];if(null==a)return c;if(C&&a.filter===C)return a.filter(h,b);z(a,function(a,d,r){h.call(b,a,d,r)&&c.push(a)});return c};c.reject=function(a,h,b){return c.filter(a,function(a,c,d){return!h.call(b,a,c,d)},b)};c.every=c.all=function(a,h,b){h||(h=c.identity);var d=!0;if(null==a)return d;if(g&&a.every===g)return a.every(h,b);z(a,function(a,c,r){if(!(d=
d&&h.call(b,a,c,r)))return p});return!!d};var d=c.some=c.any=function(a,h,b){h||(h=c.identity);var d=!1;if(null==a)return d;if(B&&a.some===B)return a.some(h,b);z(a,function(a,c,r){if(d||(d=h.call(b,a,c,r)))return p});return!!d};c.contains=c.include=function(a,h){return null==a?!1:y&&a.indexOf===y?-1!=a.indexOf(h):d(a,function(a){return a===h})};c.invoke=function(a,h){var b=k.call(arguments,2),d=c.isFunction(h);return c.map(a,function(a){return(d?h:a[h]).apply(a,b)})};c.pluck=function(a,h){return c.map(a,
function(a){return a[h]})};c.where=function(a,h,b){return c.isEmpty(h)?b?void 0:[]:c[b?"find":"filter"](a,function(a){for(var b in h)if(h[b]!==a[b])return!1;return!0})};c.findWhere=function(a,h){return c.where(a,h,!0)};c.max=function(a,h,b){if(!h&&c.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!h&&c.isEmpty(a))return-Infinity;var d={computed:-Infinity,value:-Infinity};z(a,function(a,c,r){c=h?h.call(b,a,c,r):a;c>d.computed&&(d={value:a,computed:c})});return d.value};c.min=
function(a,h,b){if(!h&&c.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!h&&c.isEmpty(a))return Infinity;var d={computed:Infinity,value:Infinity};z(a,function(a,c,r){c=h?h.call(b,a,c,r):a;c<d.computed&&(d={value:a,computed:c})});return d.value};c.shuffle=function(a){var h,b=0,d=[];z(a,function(a){h=c.random(b++);d[b-1]=d[h];d[h]=a});return d};var b=function(a){return c.isFunction(a)?a:function(h){return h[a]}};c.sortBy=function(a,h,d){var r=b(h);return c.pluck(c.map(a,function(a,
h,b){return{value:a,index:h,criteria:r.call(d,a,h,b)}}).sort(function(a,h){var b=a.criteria,c=h.criteria;if(b!==c){if(b>c||void 0===b)return 1;if(b<c||void 0===c)return-1}return a.index<h.index?-1:1}),"value")};var r=function(a,h,d,r){var g={},m=b(null==h?c.identity:h);z(a,function(h,b){var c=m.call(d,h,b,a);r(g,c,h)});return g};c.groupBy=function(a,h,b){return r(a,h,b,function(a,h,b){(c.has(a,h)?a[h]:a[h]=[]).push(b)})};c.countBy=function(a,h,b){return r(a,h,b,function(a,h){c.has(a,h)||(a[h]=0);
a[h]++})};c.sortedIndex=function(a,h,d,r){d=null==d?c.identity:b(d);h=d.call(r,h);for(var g=0,m=a.length;g<m;){var f=g+m>>>1;d.call(r,a[f])<h?g=f+1:m=f}return g};c.toArray=function(a){return a?c.isArray(a)?k.call(a):a.length===+a.length?c.map(a,c.identity):c.values(a):[]};c.size=function(a){return null==a?0:a.length===+a.length?a.length:c.keys(a).length};c.first=c.head=c.take=function(a,h,b){return null==a?void 0:null==h||b?a[0]:k.call(a,0,h)};c.initial=function(a,h,b){return k.call(a,0,a.length-
(null==h||b?1:h))};c.last=function(a,h,b){return null==a?void 0:null==h||b?a[a.length-1]:k.call(a,Math.max(a.length-h,0))};c.rest=c.tail=c.drop=function(a,h,b){return k.call(a,null==h||b?1:h)};c.compact=function(a){return c.filter(a,c.identity)};var m=function(a,h,b){if(h&&c.every(a,c.isArray))return t.apply(b,a);z(a,function(a){c.isArray(a)||c.isArguments(a)?h?l.apply(b,a):m(a,h,b):b.push(a)});return b};c.flatten=function(a,h){return m(a,h,[])};c.without=function(a){return c.difference(a,k.call(arguments,
1))};c.uniq=c.unique=function(a,h,b,d){c.isFunction(h)&&(d=b,b=h,h=!1);b=b?c.map(a,b,d):a;var r=[],g=[];z(b,function(b,d){(h?d&&g[g.length-1]===b:c.contains(g,b))||(g.push(b),r.push(a[d]))});return r};c.union=function(){return c.uniq(c.flatten(arguments,!0))};c.intersection=function(a){var h=k.call(arguments,1);return c.filter(c.uniq(a),function(a){return c.every(h,function(h){return 0<=c.indexOf(h,a)})})};c.difference=function(a){var h=t.apply(e,k.call(arguments,1));return c.filter(a,function(a){return!c.contains(h,
a)})};c.zip=function(){for(var a=c.max(c.pluck(arguments,"length").concat(0)),h=Array(a),b=0;b<a;b++)h[b]=c.pluck(arguments,""+b);return h};c.object=function(a,h){if(null==a)return{};for(var b={},c=0,d=a.length;c<d;c++)h?b[a[c]]=h[c]:b[a[c][0]]=a[c][1];return b};c.indexOf=function(a,h,b){if(null==a)return-1;var d=0,r=a.length;if(b)if("number"==typeof b)d=0>b?Math.max(0,r+b):b;else return d=c.sortedIndex(a,h),a[d]===h?d:-1;if(y&&a.indexOf===y)return a.indexOf(h,b);for(;d<r;d++)if(a[d]===h)return d;
return-1};c.lastIndexOf=function(a,h,b){if(null==a)return-1;var c=null!=b;if(v&&a.lastIndexOf===v)return c?a.lastIndexOf(h,b):a.lastIndexOf(h);for(b=c?b:a.length;b--;)if(a[b]===h)return b;return-1};c.range=function(a,h,b){1>=arguments.length&&(h=a||0,a=0);b=arguments[2]||1;for(var c=Math.max(Math.ceil((h-a)/b),0),d=0,r=Array(c);d<c;)r[d++]=a,a+=b;return r};var G=function(){};c.bind=function(a,b){var d,r;if(F&&a.bind===F)return F.apply(a,k.call(arguments,1));if(!c.isFunction(a))throw new TypeError;
d=k.call(arguments,2);return r=function(){if(!(this instanceof r))return a.apply(b,d.concat(k.call(arguments)));G.prototype=a.prototype;var c=new G;G.prototype=null;var g=a.apply(c,d.concat(k.call(arguments)));return Object(g)===g?g:c}};c.partial=function(a){var b=k.call(arguments,1);return function(){return a.apply(this,b.concat(k.call(arguments)))}};c.bindAll=function(a){var b=k.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");z(b,function(b){a[b]=c.bind(a[b],
a)});return a};c.memoize=function(a,b){var d={};b||(b=c.identity);return function(){var r=b.apply(this,arguments);return c.has(d,r)?d[r]:d[r]=a.apply(this,arguments)}};c.delay=function(a,b){var c=k.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};c.defer=function(a){return c.delay.apply(c,[a,1].concat(k.call(arguments,1)))};c.throttle=function(a,b,c){var d,r,g,m=null,f=0;c||(c={});var e=function(){f=!1===c.leading?0:new Date;m=null;g=a.apply(d,r)};return function(){var k=
new Date;f||!1!==c.leading||(f=k);var G=b-(k-f);d=this;r=arguments;0>=G?(clearTimeout(m),m=null,f=k,g=a.apply(d,r)):m||!1===c.trailing||(m=setTimeout(e,G));return g}};c.debounce=function(a,b,c){var d,r=null;return function(){var g=this,m=arguments,f=c&&!r;clearTimeout(r);r=setTimeout(function(){r=null;c||(d=a.apply(g,m))},b);f&&(d=a.apply(g,m));return d}};c.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};c.wrap=function(a,b){return function(){var c=
[a];l.apply(c,arguments);return b.apply(this,c)}};c.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};c.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};c.keys=D||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)c.has(a,d)&&b.push(d);return b};c.values=function(a){var b=[],d;for(d in a)c.has(a,d)&&b.push(a[d]);return b};c.pairs=function(a){var b=
[],d;for(d in a)c.has(a,d)&&b.push([d,a[d]]);return b};c.invert=function(a){var b={},d;for(d in a)c.has(a,d)&&(b[a[d]]=d);return b};c.functions=c.methods=function(a){var b=[],d;for(d in a)c.isFunction(a[d])&&b.push(d);return b.sort()};c.extend=function(a){z(k.call(arguments,1),function(b){if(b)for(var d in b)a[d]=b[d]});return a};c.pick=function(a){var b={},d=t.apply(e,k.call(arguments,1));z(d,function(d){d in a&&(b[d]=a[d])});return b};c.omit=function(a){var b={},d=t.apply(e,k.call(arguments,1)),
r;for(r in a)c.contains(d,r)||(b[r]=a[r]);return b};c.defaults=function(a){z(k.call(arguments,1),function(b){if(b)for(var d in b)void 0===a[d]&&(a[d]=b[d])});return a};c.clone=function(a){return c.isObject(a)?c.isArray(a)?a.slice():c.extend({},a):a};c.tap=function(a,b){b(a);return a};var H=function(a,b,d,r){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof c&&(a=a._wrapped);b instanceof c&&(b=b._wrapped);var g=f.call(a);if(g!=f.call(b))return!1;switch(g){case "[object String]":return a==
String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var m=d.length;m--;)if(d[m]==a)return r[m]==b;var m=a.constructor,e=b.constructor;if(m!==e&&!(c.isFunction(m)&&m instanceof m&&c.isFunction(e)&&e instanceof e))return!1;d.push(a);r.push(b);m=0;
e=!0;if("[object Array]"==g){if(m=a.length,e=m==b.length)for(;m--&&(e=H(a[m],b[m],d,r)););}else{for(var k in a)if(c.has(a,k)&&(m++,!(e=c.has(b,k)&&H(a[k],b[k],d,r))))break;if(e){for(k in b)if(c.has(b,k)&&!m--)break;e=!m}}d.pop();r.pop();return e};c.isEqual=function(a,b){return H(a,b,[],[])};c.isEmpty=function(a){if(null==a)return!0;if(c.isArray(a)||c.isString(a))return 0===a.length;for(var b in a)if(c.has(a,b))return!1;return!0};c.isElement=function(a){return!(!a||1!==a.nodeType)};c.isArray=n||function(a){return"[object Array]"==
f.call(a)};c.isObject=function(a){return a===Object(a)};z("Arguments Function String Number Date RegExp".split(" "),function(a){c["is"+a]=function(b){return f.call(b)=="[object "+a+"]"}});c.isArguments(arguments)||(c.isArguments=function(a){return!(!a||!c.has(a,"callee"))});"function"!==typeof/./&&(c.isFunction=function(a){return"function"===typeof a});c.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};c.isNaN=function(a){return c.isNumber(a)&&a!=+a};c.isBoolean=function(a){return!0===
a||!1===a||"[object Boolean]"==f.call(a)};c.isNull=function(a){return null===a};c.isUndefined=function(a){return void 0===a};c.has=function(a,b){return A.call(a,b)};c.noConflict=function(){x._=q;return this};c.identity=function(a){return a};c.times=function(a,b,d){for(var c=Array(Math.max(0,a)),r=0;r<a;r++)c[r]=b.call(d,r);return c};c.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
I.unescape=c.invert(I.escape);var M={escape:RegExp("["+c.keys(I.escape).join("")+"]","g"),unescape:RegExp("("+c.keys(I.unescape).join("|")+")","g")};c.each(["escape","unescape"],function(a){c[a]=function(b){return null==b?"":(""+b).replace(M[a],function(b){return I[a][b]})}});c.result=function(a,b){if(null!=a){var d=a[b];return c.isFunction(d)?d.call(a):d}};c.mixin=function(a){z(c.functions(a),function(b){var d=c[b]=a[b];c.prototype[b]=function(){var a=[this._wrapped];l.apply(a,arguments);a=d.apply(c,
a);return this._chain?c(a).chain():a}})};var P=0;c.uniqueId=function(a){var b=++P+"";return a?a+b:b};c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,Q={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;c.template=function(a,b,d){var r;d=c.defaults({},d,c.templateSettings);var g=RegExp([(d.escape||N).source,(d.interpolate||N).source,(d.evaluate||N).source].join("|")+
"|$","g"),m=0,f="__p+='";a.replace(g,function(b,d,c,r,h){f+=a.slice(m,h).replace(L,function(a){return"\\"+Q[a]});d&&(f+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'");c&&(f+="'+\n((__t=("+c+"))==null?'':__t)+\n'");r&&(f+="';\n"+r+"\n__p+='");m=h+b.length;return b});f+="';\n";d.variable||(f="with(obj||{}){\n"+f+"}\n");f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{r=new Function(d.variable||"obj","_",f)}catch(e){throw e.source=
f,e;}if(b)return r(b,c);b=function(a){return r.call(this,a,c)};b.source="function("+(d.variable||"obj")+"){\n"+f+"}";return b};c.chain=function(a){return c(a).chain()};c.mixin(c);z("pop push reverse shift sort splice unshift".split(" "),function(a){var b=e[a];c.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);"shift"!=a&&"splice"!=a||0!==d.length||delete d[0];return this._chain?c(d).chain():d}});z(["concat","join","slice"],function(a){var b=e[a];c.prototype[a]=function(){var a=b.apply(this._wrapped,
arguments);return this._chain?c(a).chain():a}});c.extend(c.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var x=[].slice,q=function(e,n,l){var k;e=-1;var t=n.length;switch(l.length){case 0:for(;++e<t;)(k=n[e]).callback.call(k.ctx);break;case 1:for(;++e<t;)(k=n[e]).callback.call(k.ctx,l[0]);break;case 2:for(;++e<t;)(k=n[e]).callback.call(k.ctx,l[0],l[1]);break;case 3:for(;++e<t;)(k=n[e]).callback.call(k.ctx,l[0],l[1],l[2]);break;default:for(;++e<t;)(k=n[e]).callback.apply(k.ctx,l)}},p=Backbone.Events={on:function(e,n,l){this._events||(this._events={});(this._events[e]||(this._events[e]=[])).push({callback:n,
context:l,ctx:l||this});return this},once:function(e,n,l){var k=this,t=_.once(function(){k.off(e,t);n.apply(this,arguments)});t._callback=n;this.on(e,t,l);return this},off:function(e,n,l){var k,t,f,p,q,u,w,s;if(!this._events)return this;if(!e&&!n&&!l)return this._events={},this;p=e?[e]:_.keys(this._events);q=0;for(u=p.length;q<u;q++)if(e=p[q],k=this._events[e]){f=[];if(n||l)for(w=0,s=k.length;w<s;w++)t=k[w],(n&&n!==(t.callback._callback||t.callback)||l&&l!==t.context)&&f.push(t);this._events[e]=f}return this},
trigger:function(e){if(!this._events)return this;var n=x.call(arguments,1),l=this._events[e],k=this._events.all;l&&q(this,l,n);k&&q(this,k,arguments);return this},listenTo:function(e,n,l){var k=this._listeners||(this._listeners={}),t=e._listenerId||(e._listenerId=_.uniqueId("l"));k[t]=e;e.on(n,l||this,this);return this},stopListening:function(e,n,l){var k=this._listeners;if(k){if(e)e.off(n,l,this),n||l||delete k[e._listenerId];else{for(var t in k)k[t].off(null,null,this);this._listeners={}}return this}}};
p.bind=p.on;p.unbind=p.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=p),exports.Backbone=exports.Backbone||Backbone)})();(function(){function x(e,k){var t=(new Date).getTime(),f=Math.max(0,16-(t-p)),n=q.setTimeout(function(){e(t+f)},f);p=t+f;return n}var q=this,p=0,e=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=x),exports.requestAnimationFrame=x;else{for(var n=0;n<e.length&&!q.requestAnimationFrame;++n)q.requestAnimationFrame=q[e[n]+"RequestAnimationFrame"],q.cancelAnimationFrame=q[e[n]+"CancelAnimationFrame"]||q[e[n]+"CancelRequestAnimationFrame"];
q.requestAnimationFrame||(q.requestAnimationFrame=x);q.cancelAnimationFrame||(q.cancelAnimationFrame=function(e){clearTimeout(e)})}})();(function(){function x(){var d=document.body.getBoundingClientRect(),b=this.width=d.width,d=this.height=d.height;this.renderer.setSize(b,d,this.ratio);this.trigger(g.Events.resize,b,d)}var q=this,p=q.Two||{},e=Math.sin,n=Math.cos,l=Math.atan2,k=Math.sqrt,t=Math.abs,f=Math.PI,A=2*f,E=f/2,u=Math.pow,w=Math.max,s=0,C={hasEventListeners:_.isFunction(q.addEventListener),bind:function(d,b,c,g){this.hasEventListeners?d.addEventListener(b,c,!!g):d.attachEvent("on"+b,c);return this},unbind:function(d,b,c,
g){this.hasEventListeners?d.removeEventListeners(b,c,!!g):d.detachEvent("on"+b,c);return this}},g=q.Two=function(d){d=_.defaults(d||{},{fullscreen:!1,width:640,height:480,type:g.Types.svg,autostart:!1});_.each(d,function(b,d){"fullscreen"!==d&&("width"!==d&&"height"!==d&&"autostart"!==d)&&(this[d]=b)},this);_.isElement(d.domElement)&&(this.type=g.Types[d.domElement.tagName.toLowerCase()]);this.renderer=new g[this.type](this);g.Utils.setPlaying.call(this,d.autostart);this.frameCount=0;d.fullscreen?
(d=_.bind(x,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),C.bind(q,"resize",d),d()):_.isElement(d.domElement)||(this.renderer.setSize(d.width,d.height,this.ratio),this.width=d.width,this.height=d.height);this.scene=this.renderer.scene;g.Instances.push(this)};_.extend(g,{Array:q.Float32Array||Array,Types:{webgl:"WebGLRenderer",
svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){q.Two=p;return this},uniqueId:function(){var d=s;s++;return d},Utils:{Curve:{CollinearityEpsilon:u(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,
angle:0,epsilon:0.01}},devicePixelRatio:q.devicePixelRatio||1,getBackingStoreRatio:function(d){return d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1},getRatio:function(d){return g.Utils.devicePixelRatio/c(d)},setPlaying:function(d){this.playing=!!d;return this},getComputedMatrix:function(d,b){b=b&&b.identity()||new g.Matrix;for(var c=d;c&&c._matrix;){var m=c._matrix.elements;b.multiply(m[0],m[1],m[2],
m[3],m[4],m[5],m[6],m[7],m[8],m[9]);c=c.parent}return b},applySvgAttributes:function(d,b){b.cap="butt";b.join="bevel";_.each(d.attributes,function(d,c){switch(d.nodeName){case "visibility":b.visible=!!d.nodeValue;break;case "stroke-linecap":b.cap=d.nodeValue;break;case "stroke-linejoin":b.join=d.nodeValue;break;case "stroke-miterlimit":b.miter=d.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(d.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=d.nodeValue;break;case "fill":b.fill=
d.nodeValue;break;case "stroke":b.stroke=d.nodeValue}});return b},read:{svg:function(){return g.Utils.read.g.apply(this,arguments)},g:function(d){var b=new g.Group;this.add(b);_.each(d.childNodes,function(d){var c=d.nodeName;c&&(c=c.replace(/svg\:/ig,"").toLowerCase(),c in g.Utils.read&&(d=g.Utils.read[c].call(this,d),b.add(d)))},this);return g.Utils.applySvgAttributes(d,b)},polygon:function(d,b){var c=[];d.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,function(b,d,m){c.push(new g.Anchor(parseFloat(d),
parseFloat(m)))});var m=(new g.Polygon(c,!b)).noStroke();return g.Utils.applySvgAttributes(d,m)},polyline:function(d){return g.Utils.read.polygon(d,!0)},path:function(d){var b,c,m,f=!1,e=!1,k=d.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),t=k.length-1,k=_.flatten(_.map(k,function(d,k){var l,n,a=d[0],h=a.toLowerCase();m=d.slice(1).trim();m=m.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,d){return parseFloat(b)*Math.pow(10,d)});m=m.split(/[\s,]+|(?=\s?[+\-])/);f=a===h;var p,s,A,q;switch(h){case "z":k>=
t?e=!0:(n=b.x,l=b.y,l=new g.Anchor(n,l,void 0,void 0,void 0,void 0,g.Commands.close));break;case "m":case "l":n=parseFloat(m[0]);l=parseFloat(m[1]);l=new g.Anchor(n,l,void 0,void 0,void 0,void 0,"m"===h?g.Commands.move:g.Commands.line);f&&l.addSelf(b);b=l;break;case "h":case "v":n="h"===h?"x":"y";a="x"===n?"y":"x";l=new g.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,g.Commands.line);l[n]=parseFloat(m[0]);l[a]=b[a];f&&(l[n]+=b[n]);b=l;break;case "s":case "c":l=b.x;a=b.y;c||(c=(new g.Vector).copy(b));
"c"===h?(p=parseFloat(m[0]),n=parseFloat(m[1]),h=parseFloat(m[2]),s=parseFloat(m[3]),A=parseFloat(m[4]),q=parseFloat(m[5])):(s=g.Utils.getReflection(b,c,f),p=s.x,n=s.y,h=parseFloat(m[0]),s=parseFloat(m[1]),A=parseFloat(m[2]),q=parseFloat(m[3]));f&&(p+=l,n+=a,h+=l,s+=a,A+=l,q+=a);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(p,n);b=l=new g.Anchor(A,q,h,s,void 0,void 0,g.Commands.curve);c=l.controls.left;break;case "t":case "q":l=b.x;a=b.y;c||(c=(new g.Vector).copy(b));
c.isZero()?(p=l,n=a):(p=c.x,a=c.y);"q"===h?(h=parseFloat(m[0]),s=parseFloat(m[1]),A=parseFloat(m[1]),q=parseFloat(m[2])):(s=g.Utils.getReflection(b,c,f),h=s.x,s=s.y,A=parseFloat(m[0]),q=parseFloat(m[1]));f&&(p+=l,n+=a,h+=l,s+=a,A+=l,q+=a);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(p,n);b=l=new g.Anchor(A,q,h,s,void 0,void 0,g.Commands.curve);c=l.controls.left;break;case "a":throw new g.Utils.Error("not yet able to interpret Elliptical Arcs.");}return l}));if(!(1>=
k.length))return k=_.compact(k),k=(new g.Polygon(k,e,void 0,!0)).noStroke(),g.Utils.applySvgAttributes(d,k)},circle:function(d){var b=parseFloat(d.getAttribute("cx")),c=parseFloat(d.getAttribute("cy")),m=parseFloat(d.getAttribute("r")),f=g.Resolution,k=_.map(_.range(f),function(b){var d=b/f*A;b=m*n(d);d=m*e(d);return new g.Anchor(b,d)},this),k=(new g.Polygon(k,!0,!0)).noStroke();k.translation.set(b,c);return g.Utils.applySvgAttributes(d,k)},ellipse:function(d){var b=parseFloat(d.getAttribute("cx")),
c=parseFloat(d.getAttribute("cy")),m=parseFloat(d.getAttribute("rx")),f=parseFloat(d.getAttribute("ry")),k=g.Resolution,l=_.map(_.range(k),function(b){var d=b/k*A;b=m*n(d);d=f*e(d);return new g.Anchor(b,d)},this),l=(new g.Polygon(l,!0,!0)).noStroke();l.translation.set(b,c);return g.Utils.applySvgAttributes(d,l)},rect:function(d){var b=parseFloat(d.getAttribute("x")),c=parseFloat(d.getAttribute("y")),m=parseFloat(d.getAttribute("width")),f=parseFloat(d.getAttribute("height")),m=m/2,f=f/2,e=[new g.Anchor(m,
f),new g.Anchor(-m,f),new g.Anchor(-m,-f),new g.Anchor(m,-f)],e=(new g.Polygon(e,!0)).noStroke();e.translation.set(b+m,c+f);return g.Utils.applySvgAttributes(d,e)},line:function(d){var b=parseFloat(d.getAttribute("x1")),c=parseFloat(d.getAttribute("y1")),m=parseFloat(d.getAttribute("x2")),f=parseFloat(d.getAttribute("y2")),m=(m-b)/2,f=(f-c)/2,e=[new g.Anchor(-m,-f),new g.Anchor(m,f)],e=(new g.Polygon(e)).noFill();e.translation.set(b+m,c+f);return g.Utils.applySvgAttributes(d,e)}},subdivide:function(d,
b,c,m,e,k,n,p,s,q){var u=g.Utils.Curve.CollinearityEpsilon;q=q||g.Utils.Curve.RecursionLimit;var y=g.Utils.Curve.CuspLimit,a=g.Utils.Curve.Tolerance,h,E,v,x;s=s||0;if(s>q)return[];if(z(c,m,d,b,n,p)&&z(e,k,d,b,n,p))return v=n-d,x=p-b,c=w(q-s,1),E=c-1,_.map(_.range(c),function(a){a/=E;return new g.Anchor(v*a+d,x*a+b)});var B=(d+c)/2,C=(b+m)/2,D=(c+e)/2,F=(m+k)/2,X=(e+n)/2,Y=(k+p)/2,Z=(B+D)/2,$=(C+F)/2,D=(D+X)/2,F=(F+Y)/2,R=(Z+D)/2,S=($+F)/2;v=n-d;x=p-b;h=t((c-n)*x-(m-p)*v);var O=t((e-n)*x-(k-p)*v);
if(0<s){if(h>u&&O>u&&(h+O)*(h+O)<=a.distance*(v*v+x*x)){if(a.angle<a.epsilon)return[new g.Anchor(R,S)];h=l(k-m,e-c);u=t(h-l(m-b,c-d));h=t(l(p-k,n-e)-h);u>=f&&(u=A-u);h>=f&&(h=A-h);if(u+h<a.angle)return[new g.Anchor(R,S)];if(0!==y){if(u>y)return[new g.Anchor(c,m)];if(h>y)return[new g.Anchor(e,k)]}}}else if(h>u)if(h*h<=a.distance*(v*v+x*x)){if(a.angle<a.epsilon)return[new g.Anchor(R,S)];u=t(l(k-m,e-c)-l(m-b,c-d));u>=f&&(u=A-u);if(u<a.angle)return[new g.Anchor(c,m),new g.Anchor(e,k)];if(0!==y&&u>y)return[new g.Anchor(c,
m)]}else if(O>u){if(O*O<=a.distance*(v*v+x*x)){if(a.angle<a.epsilon)return[new g.Anchor(R,S)];u=t(l(p-k,n-e)-l(k-m,e-c));u>=f&&(u=A-u);if(u<a.angle)return[new g.Anchor(c,m),new g.Anchor(e,k)];if(0!==y&&u>y)return[new g.Anchor(e,k)]}}else if(v=R-(d+n)/2,x=S-(b+p)/2,v*v+x*x<=a.distance)return[new g.Anchor(R,S)];return g.Utils.subdivide(d,b,B,C,Z,$,R,S,s+1,q).concat(g.Utils.subdivide(R,S,D,F,X,Y,n,p,s+1,q))},pointOnLine:function(d,b,c,m,f,e){var k=g.Utils.Curve.Tolerance.epsilon;if(t((b-m)*(f-c)-(d-
c)*(e-m))>k)return!1;d=(d-c)*(f-c)+(b-m)*(e-m);return 0>d||d>(f-c)*(f-c)+(e-m)*(e-m)?!1:!0},getCurveFromPoints:function(d,b){for(var c=d.length,m=c-1,f=0;f<c;f++){var e=d[f];_.isObject(e.controls)||g.Anchor.AppendCurveProperties(e);var k=b?F(f-1,c):Math.max(f-1,0),l=b?F(f+1,c):Math.min(f+1,m);D(d[k],e,d[l]);e._command=0===f?g.Commands.move:g.Commands.curve;e.controls.left.x=_.isNumber(e.controls.left.x)?e.controls.left.x:e.x;e.controls.left.y=_.isNumber(e.controls.left.y)?e.controls.left.y:e.y;e.controls.right.x=
_.isNumber(e.controls.right.x)?e.controls.right.x:e.x;e.controls.right.y=_.isNumber(e.controls.right.y)?e.controls.right.y:e.y}},getControlPoints:function(d,b,c){var m=v(d,b),k=v(c,b);d=B(d,b);c=B(c,b);var l=(m+k)/2;b.u=_.isObject(b.controls.left)?b.controls.left:new g.Vector(b.x,b.y);b.v=_.isObject(b.controls.right)?b.controls.right:new g.Vector(b.x,b.y);if(1E-4>d||1E-4>c)return b.controls.left.copy(b),b.controls.right.copy(b),b;d*=0.33;c*=0.33;l=k<m?l+E:l-E;b.controls.left.x=b.x+n(l)*d;b.controls.left.y=
b.y+e(l)*d;l-=f;b.controls.right.x=b.x+n(l)*c;b.controls.right.y=b.y+e(l)*c;return b},getReflection:function(d,b,c){var f=d.distanceTo(b);if(1E-4>=f)return c?new g.Vector:d.clone();b=v(d,b);return new g.Vector(f*Math.cos(b)+(c?0:d.x),f*Math.sin(b)+(c?0:d.y))},angleBetween:function(d,b){var c,g;if(4<=arguments.length)return c=arguments[0]-arguments[2],g=arguments[1]-arguments[3],l(g,c);c=d.x-b.x;g=d.y-b.y;return l(g,c)},distanceBetweenSquared:function(c,b){var g=c.x-b.x,f=c.y-b.y;return g*g+f*f},distanceBetween:function(c,
b){return k(y(c,b))},mod:function(c,b){for(;0>c;)c+=b;return c%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(c){this.name="two.js";this.message=c}}});g.Utils.Error.prototype=Error();g.Utils.Error.prototype.constructor=g.Utils.Error;g.Utils.Collection.prototype=[];g.Utils.Collection.constructor=g.Utils.Collection;_.extend(g.Utils.Collection.prototype,
Backbone.Events,{pop:function(){var c=Array.prototype.pop.apply(this,arguments);this.trigger(g.Events.remove,[c]);return c},shift:function(){var c=Array.prototype.shift.apply(this,arguments);this.trigger(g.Events.remove,[c]);return c},push:function(){var c=Array.prototype.push.apply(this,arguments);this.trigger(g.Events.insert,arguments);return c},unshift:function(){var c=Array.prototype.unshift.apply(this,arguments);this.trigger(g.Events.insert,arguments);return c},splice:function(){var c=Array.prototype.splice.apply(this,
arguments),b;this.trigger(g.Events.remove,c);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(g.Events.insert,b));return c}});var B=g.Utils.distanceBetween,y=g.Utils.distanceBetweenSquared,v=g.Utils.angleBetween,D=g.Utils.getControlPoints,F=g.Utils.mod,c=g.Utils.getBackingStoreRatio,z=g.Utils.pointOnLine;_.extend(g.prototype,Backbone.Events,{appendTo:function(c){c.appendChild(this.renderer.domElement);return this},play:function(){g.Utils.setPlaying.call(this,!0);return this.trigger(g.Events.play)},
pause:function(){this.playing=!1;return this.trigger(g.Events.pause)},update:function(){var c=!!this._lastFrame,b=(q.performance&&q.performance.now?q.performance:Date).now();this.frameCount++;c&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var c=this.width,b=this.height,f=this.renderer;c===f.width&&b===f.height||f.setSize(c,b,this.ratio);this.trigger(g.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(g.Events.render,
this.frameCount)},add:function(c){var b=c;_.isArray(c)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(c){var b=c;_.isArray(c)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));return this},makeLine:function(c,b,f,e){f=(f-c)/2;e=(e-b)/2;var k=[new g.Anchor(-f,-e),new g.Anchor(f,e)],k=(new g.Polygon(k)).noFill();k.translation.set(c+f,b+e);this.scene.add(k);return k},makeRectangle:function(c,b,f,e){f/=
2;e/=2;e=[new g.Anchor(f,e),new g.Anchor(-f,e),new g.Anchor(-f,-e),new g.Anchor(f,-e)];e=new g.Polygon(e,!0);e.translation.set(c,b);this.scene.add(e);return e},makeCircle:function(c,b,f){return this.makeEllipse(c,b,f,f)},makeEllipse:function(c,b,f,k){var l=g.Resolution,p=_.map(_.range(l),function(b){var c=b/l*A;b=f*n(c);c=k*e(c);return new g.Anchor(b,c)},this),p=new g.Polygon(p,!0,!0);p.translation.set(c,b);this.scene.add(p);return p},makeCurve:function(c){var b=arguments.length,f=c;if(!_.isArray(c))for(var f=
[],e=0;e<b;e+=2){var k=arguments[e];if(!_.isNumber(k))break;f.push(new g.Anchor(k,arguments[e+1]))}var b=arguments[b-1],f=new g.Polygon(f,!(_.isBoolean(b)&&b),!0),b=f.getBoundingClientRect(),l=b.left+b.width/2,n=b.top+b.height/2;_.each(f.vertices,function(b){b.x-=l;b.y-=n});f.translation.set(l,n);this.scene.add(f);return f},makePolygon:function(c){var b=arguments.length,f=c;if(!_.isArray(c))for(var f=[],e=0;e<b;e+=2){var k=arguments[e];if(!_.isNumber(k))break;f.push(new g.Anchor(k,arguments[e+1]))}b=
arguments[b-1];f=new g.Polygon(f,!(_.isBoolean(b)&&b));b=f.getBoundingClientRect();f.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(f);return f},makeGroup:function(c){var b=c;_.isArray(c)||(b=_.toArray(arguments));var f=new g.Group;this.scene.add(f);f.add(b);return f},interpret:function(c){var b=c.tagName.toLowerCase();if(!(b in g.Utils.read))return null;c=g.Utils.read[b].call(this,c);this.add(c);return c}});(function(){requestAnimationFrame(arguments.callee);_.each(g.Instances,
function(c){c.playing&&c.update()})})();"function"===typeof define&&define.amd?define(function(){return g}):"undefined"!=typeof module&&module.exports&&(module.exports=g)})();(function(){var x,q,p,e,n=Two.Vector=function(f,e){this.x=f||0;this.y=e||0};_.extend(n.prototype,Backbone.Events,{set:function(f,e){this.x=f;this.y=e;return this},copy:function(f){this.x=f.x;this.y=f.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new n(this.x,this.y)},add:function(f,e){this.x=f.x+e.x;this.y=f.y+e.y;return this},addSelf:function(f){this.x+=f.x;this.y+=f.y;return this},sub:function(f,e){this.x=f.x-e.x;this.y=f.y-e.y;return this},subSelf:function(f){this.x-=
f.x;this.y-=f.y;return this},multiplySelf:function(f){this.x*=f.x;this.y*=f.y;return this},multiplyScalar:function(f){this.x*=f;this.y*=f;return this},divideScalar:function(f){f?(this.x/=f,this.y/=f):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(f){return this.x*f.x+this.y*f.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(f){return Math.sqrt(this.distanceToSquared(f))},distanceToSquared:function(f){p=this.x-f.x;e=this.y-f.y;return p*p+e*e},setLength:function(f){return this.normalize().multiplyScalar(f)},equals:function(f){return 1E-4>this.distanceTo(f)},lerp:function(f,e){x=(f.x-this.x)*e+this.x;q=(f.y-this.y)*e+this.y;return this.set(x,q)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var l={set:function(f,
e){this._x=f;this._y=e;return this.trigger(Two.Events.change)},copy:function(f){this._x=f.x;this._y=f.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new n(this._x,this._y)},add:function(f,e){this._x=f.x+e.x;this._y=f.y+e.y;return this.trigger(Two.Events.change)},addSelf:function(f){this._x+=f.x;this._y+=f.y;return this.trigger(Two.Events.change)},sub:function(f,e){this._x=f.x-e.x;this._y=f.y-e.y;return this.trigger(Two.Events.change)},
subSelf:function(f){this._x-=f.x;this._y-=f.y;return this.trigger(Two.Events.change)},multiplySelf:function(f){this._x*=f.x;this._y*=f.y;return this.trigger(Two.Events.change)},multiplyScalar:function(f){this._x*=f;this._y*=f;return this.trigger(Two.Events.change)},divideScalar:function(f){return f?(this._x/=f,this._y/=f,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(f){return this._x*f.x+this._y*f.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(f){return Math.sqrt(this.distanceToSquared(f))},distanceToSquared:function(f){p=this._x-f.x;e=this._y-f.y;return p*p+e*e},setLength:function(f){return this.normalize().multiplyScalar(f)},equals:function(f){return 1E-4>this.distanceTo(f)},lerp:function(f,e){x=(f.x-this._x)*e+this._x;q=(f.y-this._y)*e+this._y;return this.set(x,q)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},k={get:function(){return this._x},set:function(f){this._x=f;this.trigger(Two.Events.change,"x")}},t={get:function(){return this._y},set:function(f){this._y=f;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",k),Object.defineProperty(this,"y",t),_.extend(this,l),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var x=Two.Commands,q,p,e,n=Two.Anchor=function(e,k,p,f,q,E,u){Two.Vector.call(this,e,k);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(e){this._command=e;this._command!==x.curve||_.isObject(this.controls)||n.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=u||x.move;if(!u)return this;n.AppendCurveProperties(this);_.isNumber(p)&&(this.controls.left.x=
p);_.isNumber(f)&&(this.controls.left.y=f);_.isNumber(q)&&(this.controls.right.x=q);_.isNumber(E)&&(this.controls.right.y=E)};_.extend(n,{AppendCurveProperties:function(e){q=e._x||e.x;p=e._y||e.y;e.controls={left:new Two.Vector(q,p),right:new Two.Vector(q,p)}}});_.extend(n.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||n.AppendCurveProperties(this);_.each(this.controls,function(e){e.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(e){e.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){e=this.controls;return new Two.Anchor(this.x,this.y,e&&e.left.x,e&&e.left.y,e&&e.right.x,e&&e.right.y,this.command)}})})();(function(){_.range(6);var x=Math.cos,q=Math.sin,p=Math.tan,e,n,l,k,t,f,A,E,u,w,s,C,g,B,y,v,D,F,c,z,d,b,r,m,G,H,I,M,P,N,Q,L,a,h,K,ea,V,W,ca,da,aa,X,Y,Z,$,R,S,O,T,ba=[],fa=Two.Matrix=function(a,b,c,d,e,f){this.elements=new Two.Array(9);var h=a;_.isArray(h)||(h=_.toArray(arguments));this.identity().set(h)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(a,f,h){if(3>=f.length)return C,g,B,e=f[0]||0,n=f[1]||0,l=f[2]||0,t=a,C=t[0]*e+t[1]*n+t[2]*l,g=t[3]*e+t[4]*n+t[5]*l,B=t[6]*e+t[7]*n+t[8]*
l,{x:C,y:g,z:B};y=a[0];v=a[1];D=a[2];F=a[3];c=a[4];z=a[5];d=a[6];b=a[7];r=a[8];m=f[0];G=f[1];H=f[2];I=f[3];M=f[4];P=f[5];N=f[6];Q=f[7];L=f[8];h=h||new Two.Array(9);h[0]=y*m+v*I+D*N;h[1]=y*G+v*M+D*Q;h[2]=y*H+v*P+D*L;h[3]=F*m+c*I+z*N;h[4]=F*G+c*M+z*Q;h[5]=F*H+c*P+z*L;h[6]=d*m+b*I+r*N;h[7]=d*G+b*M+r*Q;h[8]=d*H+b*P+r*L;return h}});_.extend(fa.prototype,Backbone.Events,{set:function(a,b,c,d,f,e){s=a;K=arguments.length;_.isArray(s)||(s=_.toArray(arguments));_.each(s,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(f,e,k,l,n,p,t,q,ma){s=arguments;K=s.length;if(1>=K)return _.each(this.elements,function(a,b){this.elements[b]=a*f},this),this.trigger(Two.Events.change);if(3>=K)return C,g,B,f=f||0,e=e||0,k=k||0,n=this.elements,C=n[0]*f+n[1]*e+n[2]*k,g=n[3]*f+n[4]*e+n[5]*k,B=n[6]*f+n[7]*e+n[8]*k,{x:C,y:g,z:B};a=this.elements;h=s;y=a[0];v=a[1];D=a[2];F=a[3];c=a[4];z=a[5];d=a[6];b=a[7];r=a[8];m=
h[0];G=h[1];H=h[2];I=h[3];M=h[4];P=h[5];N=h[6];Q=h[7];L=h[8];this.elements[0]=y*m+v*I+D*N;this.elements[1]=y*G+v*M+D*Q;this.elements[2]=y*H+v*P+D*L;this.elements[3]=F*m+c*I+z*N;this.elements[4]=F*G+c*M+z*Q;this.elements[5]=F*H+c*P+z*L;this.elements[6]=d*m+b*I+r*N;this.elements[7]=d*G+b*M+r*Q;this.elements[8]=d*H+b*P+r*L;return this.trigger(Two.Events.change)},inverse:function(a){e=this.elements;a=a||new Two.Matrix;V=e[0];W=e[1];ca=e[2];da=e[3];aa=e[4];X=e[5];Y=e[6];Z=e[7];$=e[8];R=$*aa-X*Z;S=-$*da+
X*Y;O=Z*da-aa*Y;T=V*R+W*S+ca*O;if(!T)return null;T=1/T;a.elements[0]=R*T;a.elements[1]=(-$*W+ca*Z)*T;a.elements[2]=(X*W-ca*aa)*T;a.elements[3]=S*T;a.elements[4]=($*V-ca*Y)*T;a.elements[5]=(-X*V+ca*da)*T;a.elements[6]=O*T;a.elements[7]=(-Z*V+W*Y)*T;a.elements[8]=(aa*V-W*da)*T;return a},scale:function(a,b){K=arguments.length;1>=K&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){l=x(a);ea=q(a);return this.multiply(l,-ea,0,ea,l,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){e=p(a);return this.multiply(1,e,0,0,1,0,0,0,1)},skewY:function(a){e=p(a);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(a){this.toArray(a,ba);return ba.join(" ")},toArray:function(a,b){s=this.elements;w=!!b;e=parseFloat(s[0].toFixed(3));n=parseFloat(s[1].toFixed(3));l=parseFloat(s[2].toFixed(3));k=parseFloat(s[3].toFixed(3));t=parseFloat(s[4].toFixed(3));f=parseFloat(s[5].toFixed(3));if(a){A=parseFloat(s[6].toFixed(3));E=parseFloat(s[7].toFixed(3));
u=parseFloat(s[8].toFixed(3));if(w){b[0]=e;b[1]=k;b[2]=A;b[3]=n;b[4]=t;b[5]=E;b[6]=l;b[7]=f;b[8]=u;return}return[e,k,A,n,t,E,l,f,u]}if(w)b[0]=e,b[1]=k,b[2]=n,b[3]=t,b[4]=l,b[5]=f;else return[e,k,n,t,l,f]},clone:function(){e=this.elements[0];n=this.elements[1];l=this.elements[2];k=this.elements[3];t=this.elements[4];f=this.elements[5];A=this.elements[6];E=this.elements[7];u=this.elements[8];return new Two.Matrix(e,n,l,k,t,f,A,E,u)}})})();(function(){var x=Two.Utils.mod,q,p,e,n={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(k,l){e=k;p=document.createElementNS(this.ns,e);"svg"===e&&(l=_.defaults(l||{},{version:this.version}));_.isObject(l)&&n.setAttributes(p,l);return p},setAttribute:function(e,l){this.setAttribute(l,e)},setAttributes:function(e,l){_.each(l,n.setAttribute,e);return this},removeAttribute:function(e,l){this.removeAttribute(l)},removeAttributes:function(e,l){_.each(l,
n.removeAttribute,e);return this},toString:function(e,l){var f=e.length,n=f-1;return _.map(e,function(p,q){var w,s=l?x(q-1,f):Math.max(q-1,0),C=l?x(q+1,f):Math.min(q+1,n),s=e[s],C=e[C],g,B,y,v,D;D=p.x.toFixed(3);v=p.y.toFixed(3);switch(p._command){case Two.Commands.close:w=Two.Commands.close;break;case Two.Commands.curve:g=s.controls&&s.controls.right||s;w=p.controls&&p.controls.left||p;s=g.x.toFixed(3);g=g.y.toFixed(3);B=w.x.toFixed(3);y=w.y.toFixed(3);w=(0===q?Two.Commands.move:Two.Commands.curve)+
" "+s+" "+g+" "+B+" "+y+" "+D+" "+v;break;default:w=(0===q?Two.Commands.move:p._command)+" "+D+" "+v}q>=n&&l&&(p._command===Two.Commands.curve&&(v=p.controls&&p.controls.right||p,D=C.controls&&C.controls.left||C,s=v.x.toFixed(3),g=v.y.toFixed(3),B=D.x.toFixed(3),y=D.y.toFixed(3),D=C.x.toFixed(3),v=C.y.toFixed(3),w+=" C "+s+" "+g+" "+B+" "+y+" "+D+" "+v),w+=" Z");return w}).join(" ")},group:{appendChild:function(e){(p=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.appendChild(p)},
removeChild:function(e){(p=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.removeChild(p)},renderChild:function(e){n[e._renderer.type].render.call(e,this)},render:function(e){this.update();this._renderer.elem||(this._renderer.elem=n.createElement("g",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));q=this._matrix.manual||this._flagMatrix;var l={domElement:e,elem:this._renderer.elem};q&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");
_.each(this.children,n.group.renderChild,e);this._flagAdditions&&_.each(this.additions,n.group.appendChild,l);this._flagSubtractions&&_.each(this.subtractions,n.group.removeChild,l);return this.flagReset()}},polygon:{render:function(e){this.update();this._renderer.elem||(this._renderer.elem=n.createElement("path",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));p=this._renderer.elem;(q=this._matrix.manual||this._flagMatrix)&&p.setAttribute("transform","matrix("+this._matrix.toString()+
")");this._flagVertices&&(vertices=n.toString(this._vertices,this._closed),p.setAttribute("d",vertices));this._flagFill&&p.setAttribute("fill",this._fill);this._flagStroke&&p.setAttribute("stroke",this._stroke);this._flagLinewidth&&p.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(p.setAttribute("stroke-opacity",this._opacity),p.setAttribute("fill-opacity",this._opacity));this._flagVisible&&p.setAttribute("visibility",this._visible?"visible":"hidden");this._flagCap&&p.setAttribute("stroke-linecap",
this._cap);this._flagJoin&&p.setAttribute("stroke-linejoin",this._join);this._flagMiter&&p.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},l=Two[Two.Types.svg]=function(e){this.domElement=e.domElement||n.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(l,{Utils:n});_.extend(l.prototype,Backbone.Events,{setSize:function(e,l){this.width=e;this.height=l;n.setAttributes(this.domElement,{width:e,height:l});return this},render:function(){n.group.render.call(this.scene,
this.domElement);return this}})})();(function(){var x=Two.Utils.mod,q=Two.Utils.getRatio,p,e,n,l,k,t,f,A,E,u,w,s,C,g,B,y,v,D,F,c,z,d,b,r,m,G,H,I={group:{renderChild:function(b){I[b._renderer.type].render.call(b,this)},render:function(b){this.update();p=this._matrix.elements;b.save();b.transform(p[0],p[3],p[1],p[4],p[2],p[5]);_.each(this.children,I.group.renderChild,b);b.restore();return this.flagReset()}},polygon:{render:function(q){this.update();p=this._matrix.elements;e=this.stroke;n=this.linewidth;l=this.fill;k=this.opacity;t=this.visible;
f=this.cap;A=this.join;E=this.miter;u=this.closed;w=this._vertices;s=w.length;C=s-1;if(!t)return this;q.save();p&&q.transform(p[0],p[3],p[1],p[4],p[2],p[5]);l&&(q.fillStyle=l);e&&(q.strokeStyle=e);n&&(q.lineWidth=n);E&&(q.miterLimit=E);A&&(q.lineJoin=A);f&&(q.lineCap=f);_.isNumber(k)&&(q.globalAlpha=k);q.beginPath();_.each(w,function(e,f){G=e.x.toFixed(3);H=e.y.toFixed(3);switch(e._command){case Two.Commands.close:q.closePath();break;case Two.Commands.curve:B=u?x(f-1,s):Math.max(f-1,0);g=u?x(f+1,
s):Math.min(f+1,C);y=w[B];v=w[g];d=y.controls&&y.controls.right||y;b=e.controls&&e.controls.left||e;c=d.x.toFixed(3);z=d.y.toFixed(3);D=b.x.toFixed(3);F=b.y.toFixed(3);q.bezierCurveTo(c,z,D,F,G,H);f>=C&&u&&(r=e.controls&&e.controls.right||e,m=v.controls&&v.controls.left||v,c=r.x.toFixed(3),z=r.y.toFixed(3),D=m.x.toFixed(3),F=m.y.toFixed(3),G=v.x.toFixed(3),H=v.y.toFixed(3),q.bezierCurveTo(c,z,D,F,G,H));break;case Two.Commands.line:q.lineTo(G,H);break;case Two.Commands.move:q.moveTo(G,H)}});u&&q.closePath();
q.fill();q.stroke();q.restore();return this.flagReset()}}},M=Two[Two.Types.canvas]=function(b){this.domElement=b.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.scene=new Two.Group;this.scene.parent=this};_.extend(M,{Utils:I});_.extend(M.prototype,Backbone.Events,{setSize:function(b,c,d){this.width=b;this.height=c;this.ratio=_.isUndefined(d)?q(this.ctx):d;this.domElement.width=b*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,
{width:b+"px",height:c+"px"});return this},render:function(){var b=1===this.ratio;b||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);I.group.render.call(this.scene,this.ctx);b||this.ctx.restore();return this}})})();(function(){var x=Two.Matrix.Multiply,q=Two.Utils.mod,p=[1,0,0,0,1,0,0,0,1],e=new Two.Array(9),n=Two.Utils.getRatio,l,k,t,f,A,E,u,w,s,C,g,B,y,v,D,F,c,z,d,b,r,m,G,H,I,M,P,N,Q,L,a,h,K,ea,V,W,ca,da,aa,X,Y,Z,$,R,S,O,T,ba,fa,ga,J,ia,ja,ka,ha,U={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){U[a._renderer.type].render.call(a,this.gl,this.program)},render:function(a,b){this.update();l=this.parent;k=l._matrix&&l._matrix.manual||l._flagMatrix;
t=this._matrix.manual||this._flagMatrix;if(k||t)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,e),x(e,l._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*l._renderer.scale,k&&(this._flagMatrix=!0);_.each(this.children,U.group.renderChild,{gl:a,program:b});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;l=this.parent;k=l._matrix.manual||l._flagMatrix;t=this._matrix.manual||this._flagMatrix;
f=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this.update();if(k||t)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,e),x(e,l._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*l._renderer.scale;f&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),
U.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),U.getTriangles(this._renderer.rect,this._renderer.triangles),U.updateBuffer(a,this,b),U.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,
!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(a,b,e){A=Infinity;E=-Infinity;u=Infinity;w=-Infinity;_.each(a,function(a,b){s=a.x;C=a.y;g;B;y;v;D=a.controls;u=Math.min(C,u);A=Math.min(s,A);E=Math.max(s,E);w=Math.max(C,w);a.controls&&(F=D.left,c=D.right,F&&c&&(g=F.x,B=F.y,y=c.x,v=c.y,g&&(B&&y&&v)&&(u=Math.min(B,v,u),A=Math.min(g,y,A),E=Math.max(g,y,E),w=Math.max(B,v,w))))});_.isNumber(b)&&(u-=b,A-=b,E+=b,w+=b);z=E-A;d=w-u;e.top=u;e.left=A;e.right=E;e.bottom=
w;e.width=z;e.height=d;e.centroid||(e.centroid={});e.centroid.x=-A;e.centroid.y=-u},getTriangles:function(a,b){u=a.top;A=a.left;E=a.right;w=a.bottom;b[0]=A;b[1]=u;b[2]=E;b[3]=u;b[4]=A;b[5]=w;b[6]=A;b[7]=w;b[8]=E;b[9]=u;b[10]=E;b[11]=w},updateCanvas:function(c){b=c._vertices;r=this.canvas;m=this.ctx;G=c._renderer.scale;H=c._stroke;I=c._linewidth*G;M=c._fill;P=c._opacity;N=c._cap;Q=c._join;L=c._miter;a=c._closed;h=b.length;K=h-1;r.width=Math.max(Math.ceil(c._renderer.rect.width*G),1);r.height=Math.max(Math.ceil(c._renderer.rect.height*
G),1);ea=c._renderer.rect.centroid;V=ea.x*G;W=ea.y*G;m.clearRect(0,0,r.width,r.height);M&&(m.fillStyle=M);H&&(m.strokeStyle=H);I&&(m.lineWidth=I);L&&(m.miterLimit=L);Q&&(m.lineJoin=Q);N&&(m.lineCap=N);_.isNumber(P)&&(m.globalAlpha=P);m.beginPath();_.each(b,function(c,d){ca;da;g;y;aa;X;Y;Z;$;R;S;F;s=(c.x*G+V).toFixed(3);C=(c.y*G+W).toFixed(3);switch(c._command){case Two.Commands.close:m.closePath();break;case Two.Commands.curve:da=a?q(d-1,h):Math.max(d-1,0);ca=a?q(d+1,h):Math.min(d+1,K);g=b[da];y=
b[ca];$=g.controls&&g.controls.right||g;R=c.controls&&c.controls.left||c;Y=($.x*G+V).toFixed(3);Z=($.y*G+W).toFixed(3);aa=(R.x*G+V).toFixed(3);X=(R.y*G+W).toFixed(3);m.bezierCurveTo(Y,Z,aa,X,s,C);d>=K&&a&&(S=c.controls&&c.controls.right||c,F=y.controls&&y.controls.left||y,Y=(S.x*G+V).toFixed(3),Z=(S.y*G+W).toFixed(3),aa=(F.x*G+V).toFixed(3),X=(F.y*G+W).toFixed(3),s=(y.x*G+V).toFixed(3),C=(y.y*G+W).toFixed(3),m.bezierCurveTo(Y,Z,aa,X,s,C));break;case Two.Commands.line:m.lineTo(s,C);break;case Two.Commands.move:m.moveTo(s,
C)}});a&&m.closePath();m.fill();m.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||
0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=
a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){O=a.createProgram();_.each(b,function(b){a.attachShader(O,b)});a.linkProgram(O);T=a.getProgramParameter(O,a.LINK_STATUS);if(!T)throw ga=a.getProgramInfoLog(O),a.deleteProgram(O),new Two.Utils.Error("unable to link program: "+ga);return O}},shaders:{create:function(a,b,c){ba=a.createShader(a[c]);a.shaderSource(ba,
b);a.compileShader(ba);fa=a.getShaderParameter(ba,a.COMPILE_STATUS);if(!fa)throw ga=a.getShaderInfoLog(ba),a.deleteShader(ba),new Two.Utils.Error("unable to compile shader "+ba+": "+ga);return ba},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};U.ctx=U.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(p),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;J=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=U.shaders.create(J,U.shaders.vertex,U.shaders.types.vertex);ja=U.shaders.create(J,U.shaders.fragment,U.shaders.types.fragment);this.program=U.program.create(J,[ka,ja]);J.useProgram(this.program);this.program.position=J.getAttribLocation(this.program,
"a_position");this.program.matrix=J.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=J.getAttribLocation(this.program,"a_textureCoords");J.disable(J.DEPTH_TEST);J.enable(J.BLEND);J.blendEquationSeparate(J.FUNC_ADD,J.FUNC_ADD);J.blendFuncSeparate(J.SRC_ALPHA,J.ONE_MINUS_SRC_ALPHA,J.ONE,J.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?n(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){J=this.ctx;this.overdraw||J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT);U.group.render.call(this.scene,J,this.program);this._flagMatrix=!1;return this}})})();(function(){new Two.Vector;var x,q=Two.Shape=function(p){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(q.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(q,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(p){Object.defineProperty(p,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e;this._flagMatrix=!0}});Object.defineProperty(p,
"scale",{get:function(){return this._scale},set:function(e){this._scale=e;this._flagScale=this._flagMatrix=!0}})}});_.extend(q.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(p){p.add(this);return this},clone:function(){x=new q;x.translation.copy(this.translation);x.rotation=this.rotation;x.scale=this.scale;_.each(q.Properties,function(p){x[p]=this[p]},this);return x.update()},update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});q.MakeObservable(q.prototype)})();(function(){var x=Math.min,q=Math.max,p=Math.round,e=Two.Utils.getComputedMatrix,n,l,k,t,f,A,E,u,w,s,C,g,B,y,v,D,F,c,z,d,b,r,m,G,H,I,M,P,N,Q,L=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!c;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4;this._vertices=[];this.vertices=a;this.automatic=!d};_.extend(L,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),
FlagVertices:function(){this._flagVertices=!0},MakeObservable:function(a){Two.Shape.MakeObservable(a);_.each(L.Properties.slice(0,8),function(b){var c="_"+b,d="_flag"+b.charAt(0).toUpperCase()+b.slice(1);Object.defineProperty(a,b,{get:function(){return this[c]},set:function(a){this[c]=a;this[d]=!0}})});Object.defineProperty(a,"closed",{get:function(){return this._closed},set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(a,"curved",{get:function(){return this._curved},
set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(L.prototype,"automatic",{get:function(){return this._automatic},set:function(a){a!==this._automatic&&(method=(this._automatic=!!a)?"ignore":"listen",_.each(this.vertices,function(a){a[method]()}))}});Object.defineProperty(a,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=x(q(a,0),1);this._flagVertices=!0}});Object.defineProperty(a,"ending",{get:function(){return this._ending},set:function(a){this._ending=
x(q(a,0),1);this._flagVertices=!0}});Object.defineProperty(a,"vertices",{get:function(){return this._collection},set:function(a){var b=_.bind(L.FlagVertices,this),c=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,b)},this);b()},this),d=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,b)},this);b()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(a.slice(0));this._collection.bind(Two.Events.insert,c);this._collection.bind(Two.Events.remove,
d);verticesChanged=!0;c(this._collection)}})}});_.extend(L.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;u=_.map(this.vertices,function(a){return a.clone()});w=new L(u,this.closed,this.curved,
!this.automatic);_.each(Two.Shape.Properties,function(a){w[a]=this[a]},this);w.translation.copy(this.translation);w.rotation=this.rotation;w.scale=this.scale;a.add(w);return w},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){s=this.getBoundingClientRect(!0);s.centroid={x:s.left+s.width/2,y:s.top+s.height/2};_.each(this.vertices,function(a){a.addSelf(s.centroid)});return this},center:function(){s=this.getBoundingClientRect(!0);
s.centroid={x:s.left+s.width/2,y:s.top+s.height/2};_.each(this.vertices,function(a){a.subSelf(s.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(a){this.update();C=this.linewidth/2;void 0;g=Infinity;B=-Infinity;y=Infinity;v=-Infinity;_.each(this._vertices,function(a){D=a.x;F=a.y;y=x(F,y);g=x(D,g);B=q(D,B);v=q(F,v)});y-=C;g-=C;B+=C;v+=C;r=a?this._matrix:e(this);c=r.multiply(g,y,1);z=r.multiply(B,y,1);d=r.multiply(B,
v,1);b=r.multiply(g,v,1);y=x(c.y,z.y,d.y,b.y);g=x(c.x,z.x,d.x,b.x);B=q(c.x,z.x,d.x,b.x);v=q(c.y,z.y,d.y,b.y);return{top:y,left:g,right:B,bottom:v,width:B-g,height:v-y}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this.vertices,this.closed),this;_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(a){this.update();t=this.vertices.length-1;z=this.vertices[t];f=this._closed||this.vertices[t].command===Two.Commands.close;
u=[];_.each(this.vertices,function(b,c){if(!(0>=c&&!f||b.command===Two.Commands.move)){B=z.controls&&z.controls.right;g=b.controls&&b.controls.left;m=z.x;G=z.y;H=(B||z).x;I=(B||z).y;M=(g||b).x;P=(g||b).y;N=b.x;Q=b.y;var d=_.flatten(Two.Utils.subdivide(m,G,H,I,M,P,N,Q,0,a));u=u.concat(d);_.each(d,function(a,b){a.command=0>=b&&z.command===Two.Commands.move?Two.Commands.move:Two.Commands.line})}z=b},this);this._curved=this._automatic=!1;this.vertices=_.flatten(u);return this},update:function(){if(this._flagVertices)for(this._automatic&&
this.plot(),n=this.vertices.length,t=n-1,l=p(this._beginning*t),k=p(this._ending*t),this._vertices.length=0,E=l;E<k+1;E++)A=this.vertices[E],this._vertices.push(A);Two.Shape.prototype.update.call(this);return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});L.MakeObservable(L.prototype)})();(function(){var x=Math.min,q=Math.max,p,e,n,l,k,t,f,A,E,u,w,s,C,g,B,y,v,D,F,c,z,d=Two.Group=function(b){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(d,{MakeObservable:function(b){Two.Shape.MakeObservable(b);d.MakeGetterSetter(b,Two.Polygon.Properties)},MakeGetterSetter:function(b,c){_.isArray(c)||(c=[c]);_.each(c,function(c){p="_"+c;Object.defineProperty(b,c,{get:function(){return this[p]},set:function(b){this[p]=b;_.each(this.children,
function(d){d[c]=b})}})})}});_.extend(d.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(b){b=b||this.parent;n=_.map(this.children,function(b){return b.clone()});l=new d;b.add(l);l.add(n);l.translation.copy(this.translation);l.rotation=this.rotation;l.scale=this.scale;return l},corner:function(){k=this.getBoundingClientRect(!0);
t={x:k.left,y:k.top};_.each(this.children,function(b){b.translation.subSelf(t)});return this},center:function(){k=this.getBoundingClientRect(!0);k.centroid={x:k.left+k.width/2,y:k.top+k.height/2};_.each(this.children,function(b){b.translation.subSelf(k.centroid)});return this},add:function(b){f=arguments.length;A=b;n=this.children;E=this.parent;u=this.additions;_.isArray(b)||(A=_.toArray(arguments));_.each(A,function(b){b&&(w=b.id,e=b.parent,_.isUndefined(n[w])&&(e&&(delete e.children[w],z=_.indexOf(e.additions,
w),0<=z&&e.additions.splice(z,1)),n[w]=b,b.parent=this,u.push(w),this._flagAdditions=!0))},this);return this},remove:function(b){f=arguments.length;A=b;n=this.children;E=this.parent;u=this.subtractions;if(0>=f&&E)return E.remove(this),this;_.isArray(b)||(A=_.toArray(arguments));_.each(A,function(b){w=b.id;grandchildren=b.children;e=b.parent;w in n&&(delete n[w],delete b.parent,z=_.indexOf(e.additions,w),0<=z&&e.additions.splice(z,1),u.push(w),this._flagSubtractions=!0)},this);return this},getBoundingClientRect:function(b){this.update();
s=Infinity;C=-Infinity;g=Infinity;B=-Infinity;_.each(this.children,function(b){k=b.getBoundingClientRect(!0);_.isNumber(k.top)&&(_.isNumber(k.left)&&_.isNumber(k.right)&&_.isNumber(k.bottom))&&(g=x(k.top,g),s=x(k.left,s),C=q(k.right,C),B=q(k.bottom,B))},this);y=b?this._matrix:Two.Utils.getComputedMatrix(this);v=y.multiply(s,g,1);D=y.multiply(C,g,1);F=y.multiply(C,B,1);c=y.multiply(s,B,1);g=x(v.y,D.y,F.y,c.y);s=x(v.x,D.x,F.x,c.x);C=q(v.x,D.x,F.x,c.x);B=q(v.y,D.y,F.y,c.y);return{top:g,left:s,right:C,
bottom:B,width:C-s,height:B-g}},noFill:function(){_.each(this.children,function(b){b.noFill()});return this},noStroke:function(){_.each(this.children,function(b){b.noStroke()});return this},subdivide:function(){var b=arguments;_.each(this.children,function(c){c.subdivide.apply(c,b)});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);
return this}});d.MakeObservable(d.prototype)})();
