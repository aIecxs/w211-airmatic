(function(){var D=this,q=D._,n={},f=Array.prototype,m=Object.prototype,l=f.push,e=f.slice,u=f.concat,p=m.toString,A=m.hasOwnProperty,y=f.forEach,z=f.map,w=f.reduce,t=f.reduceRight,F=f.filter,g=f.every,E=f.some,s=f.indexOf,v=f.lastIndexOf,m=Array.isArray,B=Object.keys,H=Function.prototype.bind,c=function(a){if(a instanceof c)return a;if(!(this instanceof c))return new c(a);this._wrapped=a};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=c),exports._=
c):D._=c;c.VERSION="1.5.1";var C=c.each=c.forEach=function(a,k,x){if(null!=a)if(y&&a.forEach===y)a.forEach(k,x);else if(a.length===+a.length)for(var b=0,d=a.length;b<d&&k.call(x,a[b],b,a)!==n;b++);else for(b in a)if(c.has(a,b)&&k.call(x,a[b],b,a)===n)break};c.map=c.collect=function(a,k,x){var b=[];if(null==a)return b;if(z&&a.map===z)return a.map(k,x);C(a,function(a,c,d){b.push(k.call(x,a,c,d))});return b};c.reduce=c.foldl=c.inject=function(a,k,x,b){var d=2<arguments.length;null==a&&(a=[]);if(w&&a.reduce===
w)return b&&(k=c.bind(k,b)),d?a.reduce(k,x):a.reduce(k);C(a,function(a,c,r){d?x=k.call(b,x,a,c,r):(x=a,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return x};c.reduceRight=c.foldr=function(a,k,x,b){var d=2<arguments.length;null==a&&(a=[]);if(t&&a.reduceRight===t)return b&&(k=c.bind(k,b)),d?a.reduceRight(k,x):a.reduceRight(k);var r=a.length;if(r!==+r)var h=c.keys(a),r=h.length;C(a,function(c,g,p){g=h?h[--r]:--r;d?x=k.call(b,x,a[g],g,p):(x=a[g],d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");
return x};c.find=c.detect=function(a,k,x){var b;d(a,function(a,c,d){if(k.call(x,a,c,d))return b=a,!0});return b};c.filter=c.select=function(a,k,x){var b=[];if(null==a)return b;if(F&&a.filter===F)return a.filter(k,x);C(a,function(a,c,d){k.call(x,a,c,d)&&b.push(a)});return b};c.reject=function(a,k,x){return c.filter(a,function(a,b,c){return!k.call(x,a,b,c)},x)};c.every=c.all=function(a,k,x){k||(k=c.identity);var b=!0;if(null==a)return b;if(g&&a.every===g)return a.every(k,x);C(a,function(a,c,d){if(!(b=
b&&k.call(x,a,c,d)))return n});return!!b};var d=c.some=c.any=function(a,k,x){k||(k=c.identity);var b=!1;if(null==a)return b;if(E&&a.some===E)return a.some(k,x);C(a,function(a,c,d){if(b||(b=k.call(x,a,c,d)))return n});return!!b};c.contains=c.include=function(a,k){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(k):d(a,function(a){return a===k})};c.invoke=function(a,k){var b=e.call(arguments,2),d=c.isFunction(k);return c.map(a,function(a){return(d?k:a[k]).apply(a,b)})};c.pluck=function(a,k){return c.map(a,
function(a){return a[k]})};c.where=function(a,k,b){return c.isEmpty(k)?b?void 0:[]:c[b?"find":"filter"](a,function(a){for(var b in k)if(k[b]!==a[b])return!1;return!0})};c.findWhere=function(a,k){return c.where(a,k,!0)};c.max=function(a,k,b){if(!k&&c.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!k&&c.isEmpty(a))return-Infinity;var d={computed:-Infinity,value:-Infinity};C(a,function(a,c,r){c=k?k.call(b,a,c,r):a;c>d.computed&&(d={value:a,computed:c})});return d.value};c.min=
function(a,k,b){if(!k&&c.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!k&&c.isEmpty(a))return Infinity;var d={computed:Infinity,value:Infinity};C(a,function(a,c,r){c=k?k.call(b,a,c,r):a;c<d.computed&&(d={value:a,computed:c})});return d.value};c.shuffle=function(a){var k,b=0,d=[];C(a,function(a){k=c.random(b++);d[b-1]=d[k];d[k]=a});return d};var b=function(a){return c.isFunction(a)?a:function(k){return k[a]}};c.sortBy=function(a,k,x){var d=b(k);return c.pluck(c.map(a,function(a,
k,b){return{value:a,index:k,criteria:d.call(x,a,k,b)}}).sort(function(a,k){var b=a.criteria,c=k.criteria;if(b!==c){if(b>c||void 0===b)return 1;if(b<c||void 0===c)return-1}return a.index<k.index?-1:1}),"value")};var r=function(a,k,x,d){var r={},h=b(null==k?c.identity:k);C(a,function(k,b){var c=h.call(x,k,b,a);d(r,c,k)});return r};c.groupBy=function(a,k,b){return r(a,k,b,function(a,k,b){(c.has(a,k)?a[k]:a[k]=[]).push(b)})};c.countBy=function(a,k,b){return r(a,k,b,function(a,k){c.has(a,k)||(a[k]=0);
a[k]++})};c.sortedIndex=function(a,k,d,r){d=null==d?c.identity:b(d);k=d.call(r,k);for(var h=0,g=a.length;h<g;){var p=h+g>>>1;d.call(r,a[p])<k?h=p+1:g=p}return h};c.toArray=function(a){return a?c.isArray(a)?e.call(a):a.length===+a.length?c.map(a,c.identity):c.values(a):[]};c.size=function(a){return null==a?0:a.length===+a.length?a.length:c.keys(a).length};c.first=c.head=c.take=function(a,k,b){return null==a?void 0:null==k||b?a[0]:e.call(a,0,k)};c.initial=function(a,k,b){return e.call(a,0,a.length-
(null==k||b?1:k))};c.last=function(a,k,b){return null==a?void 0:null==k||b?a[a.length-1]:e.call(a,Math.max(a.length-k,0))};c.rest=c.tail=c.drop=function(a,k,b){return e.call(a,null==k||b?1:k)};c.compact=function(a){return c.filter(a,c.identity)};var h=function(a,k,b){if(k&&c.every(a,c.isArray))return u.apply(b,a);C(a,function(a){c.isArray(a)||c.isArguments(a)?k?l.apply(b,a):h(a,k,b):b.push(a)});return b};c.flatten=function(a,k){return h(a,k,[])};c.without=function(a){return c.difference(a,e.call(arguments,
1))};c.uniq=c.unique=function(a,k,b,d){c.isFunction(k)&&(d=b,b=k,k=!1);b=b?c.map(a,b,d):a;var r=[],h=[];C(b,function(b,d){(k?d&&h[h.length-1]===b:c.contains(h,b))||(h.push(b),r.push(a[d]))});return r};c.union=function(){return c.uniq(c.flatten(arguments,!0))};c.intersection=function(a){var k=e.call(arguments,1);return c.filter(c.uniq(a),function(a){return c.every(k,function(k){return 0<=c.indexOf(k,a)})})};c.difference=function(a){var k=u.apply(f,e.call(arguments,1));return c.filter(a,function(a){return!c.contains(k,
a)})};c.zip=function(){for(var a=c.max(c.pluck(arguments,"length").concat(0)),k=Array(a),b=0;b<a;b++)k[b]=c.pluck(arguments,""+b);return k};c.object=function(a,k){if(null==a)return{};for(var b={},c=0,d=a.length;c<d;c++)k?b[a[c]]=k[c]:b[a[c][0]]=a[c][1];return b};c.indexOf=function(a,b,d){if(null==a)return-1;var r=0,h=a.length;if(d)if("number"==typeof d)r=0>d?Math.max(0,h+d):d;else return r=c.sortedIndex(a,b),a[r]===b?r:-1;if(s&&a.indexOf===s)return a.indexOf(b,d);for(;r<h;r++)if(a[r]===b)return r;
return-1};c.lastIndexOf=function(a,b,d){if(null==a)return-1;var c=null!=d;if(v&&a.lastIndexOf===v)return c?a.lastIndexOf(b,d):a.lastIndexOf(b);for(d=c?d:a.length;d--;)if(a[d]===b)return d;return-1};c.range=function(a,b,d){1>=arguments.length&&(b=a||0,a=0);d=arguments[2]||1;for(var c=Math.max(Math.ceil((b-a)/d),0),r=0,h=Array(c);r<c;)h[r++]=a,a+=d;return h};var G=function(){};c.bind=function(a,b){var d,r;if(H&&a.bind===H)return H.apply(a,e.call(arguments,1));if(!c.isFunction(a))throw new TypeError;
d=e.call(arguments,2);return r=function(){if(!(this instanceof r))return a.apply(b,d.concat(e.call(arguments)));G.prototype=a.prototype;var c=new G;G.prototype=null;var h=a.apply(c,d.concat(e.call(arguments)));return Object(h)===h?h:c}};c.partial=function(a){var b=e.call(arguments,1);return function(){return a.apply(this,b.concat(e.call(arguments)))}};c.bindAll=function(a){var b=e.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");C(b,function(b){a[b]=c.bind(a[b],
a)});return a};c.memoize=function(a,b){var d={};b||(b=c.identity);return function(){var r=b.apply(this,arguments);return c.has(d,r)?d[r]:d[r]=a.apply(this,arguments)}};c.delay=function(a,b){var d=e.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},b)};c.defer=function(a){return c.delay.apply(c,[a,1].concat(e.call(arguments,1)))};c.throttle=function(a,b,d){var c,r,h,g=null,p=0;d||(d={});var f=function(){p=!1===d.leading?0:new Date;g=null;h=a.apply(c,r)};return function(){var e=
new Date;p||!1!==d.leading||(p=e);var G=b-(e-p);c=this;r=arguments;0>=G?(clearTimeout(g),g=null,p=e,h=a.apply(c,r)):g||!1===d.trailing||(g=setTimeout(f,G));return h}};c.debounce=function(a,b,d){var c,r=null;return function(){var h=this,g=arguments,p=d&&!r;clearTimeout(r);r=setTimeout(function(){r=null;d||(c=a.apply(h,g))},b);p&&(c=a.apply(h,g));return c}};c.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;d=a.apply(this,arguments);a=null;return d}};c.wrap=function(a,b){return function(){var d=
[a];l.apply(d,arguments);return b.apply(this,d)}};c.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,b)];return b[0]}};c.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};c.keys=B||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)c.has(a,d)&&b.push(d);return b};c.values=function(a){var b=[],d;for(d in a)c.has(a,d)&&b.push(a[d]);return b};c.pairs=function(a){var b=
[],d;for(d in a)c.has(a,d)&&b.push([d,a[d]]);return b};c.invert=function(a){var b={},d;for(d in a)c.has(a,d)&&(b[a[d]]=d);return b};c.functions=c.methods=function(a){var b=[],d;for(d in a)c.isFunction(a[d])&&b.push(d);return b.sort()};c.extend=function(a){C(e.call(arguments,1),function(b){if(b)for(var d in b)a[d]=b[d]});return a};c.pick=function(a){var b={},d=u.apply(f,e.call(arguments,1));C(d,function(d){d in a&&(b[d]=a[d])});return b};c.omit=function(a){var b={},d=u.apply(f,e.call(arguments,1)),
r;for(r in a)c.contains(d,r)||(b[r]=a[r]);return b};c.defaults=function(a){C(e.call(arguments,1),function(b){if(b)for(var d in b)void 0===a[d]&&(a[d]=b[d])});return a};c.clone=function(a){return c.isObject(a)?c.isArray(a)?a.slice():c.extend({},a):a};c.tap=function(a,b){b(a);return a};var I=function(a,b,d,r){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof c&&(a=a._wrapped);b instanceof c&&(b=b._wrapped);var h=p.call(a);if(h!=p.call(b))return!1;switch(h){case "[object String]":return a==
String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var g=d.length;g--;)if(d[g]==a)return r[g]==b;var g=a.constructor,f=b.constructor;if(g!==f&&!(c.isFunction(g)&&g instanceof g&&c.isFunction(f)&&f instanceof f))return!1;d.push(a);r.push(b);g=0;
f=!0;if("[object Array]"==h){if(g=a.length,f=g==b.length)for(;g--&&(f=I(a[g],b[g],d,r)););}else{for(var e in a)if(c.has(a,e)&&(g++,!(f=c.has(b,e)&&I(a[e],b[e],d,r))))break;if(f){for(e in b)if(c.has(b,e)&&!g--)break;f=!g}}d.pop();r.pop();return f};c.isEqual=function(a,b){return I(a,b,[],[])};c.isEmpty=function(a){if(null==a)return!0;if(c.isArray(a)||c.isString(a))return 0===a.length;for(var b in a)if(c.has(a,b))return!1;return!0};c.isElement=function(a){return!(!a||1!==a.nodeType)};c.isArray=m||function(a){return"[object Array]"==
p.call(a)};c.isObject=function(a){return a===Object(a)};C("Arguments Function String Number Date RegExp".split(" "),function(a){c["is"+a]=function(b){return p.call(b)=="[object "+a+"]"}});c.isArguments(arguments)||(c.isArguments=function(a){return!(!a||!c.has(a,"callee"))});"function"!==typeof/./&&(c.isFunction=function(a){return"function"===typeof a});c.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};c.isNaN=function(a){return c.isNumber(a)&&a!=+a};c.isBoolean=function(a){return!0===
a||!1===a||"[object Boolean]"==p.call(a)};c.isNull=function(a){return null===a};c.isUndefined=function(a){return void 0===a};c.has=function(a,b){return A.call(a,b)};c.noConflict=function(){D._=q;return this};c.identity=function(a){return a};c.times=function(a,b,d){for(var c=Array(Math.max(0,a)),r=0;r<a;r++)c[r]=b.call(d,r);return c};c.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var J={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};
J.unescape=c.invert(J.escape);var L={escape:RegExp("["+c.keys(J.escape).join("")+"]","g"),unescape:RegExp("("+c.keys(J.unescape).join("|")+")","g")};c.each(["escape","unescape"],function(a){c[a]=function(b){return null==b?"":(""+b).replace(L[a],function(b){return J[a][b]})}});c.result=function(a,b){if(null!=a){var d=a[b];return c.isFunction(d)?d.call(a):d}};c.mixin=function(a){C(c.functions(a),function(b){var d=c[b]=a[b];c.prototype[b]=function(){var a=[this._wrapped];l.apply(a,arguments);a=d.apply(c,
a);return this._chain?c(a).chain():a}})};var O=0;c.uniqueId=function(a){var b=++O+"";return a?a+b:b};c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},Q=/\\|'|\r|\n|\t|\u2028|\u2029/g;c.template=function(a,b,d){var r;d=c.defaults({},d,c.templateSettings);var h=RegExp([(d.escape||M).source,(d.interpolate||M).source,(d.evaluate||M).source].join("|")+
"|$","g"),g=0,p="__p+='";a.replace(h,function(b,d,c,r,h){p+=a.slice(g,h).replace(Q,function(a){return"\\"+P[a]});d&&(p+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'");c&&(p+="'+\n((__t=("+c+"))==null?'':__t)+\n'");r&&(p+="';\n"+r+"\n__p+='");g=h+b.length;return b});p+="';\n";d.variable||(p="with(obj||{}){\n"+p+"}\n");p="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+p+"return __p;\n";try{r=new Function(d.variable||"obj","_",p)}catch(f){throw f.source=
p,f;}if(b)return r(b,c);b=function(a){return r.call(this,a,c)};b.source="function("+(d.variable||"obj")+"){\n"+p+"}";return b};c.chain=function(a){return c(a).chain()};c.mixin(c);C("pop push reverse shift sort splice unshift".split(" "),function(a){var b=f[a];c.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);"shift"!=a&&"splice"!=a||0!==d.length||delete d[0];return this._chain?c(d).chain():d}});C(["concat","join","slice"],function(a){var b=f[a];c.prototype[a]=function(){var a=b.apply(this._wrapped,
arguments);return this._chain?c(a).chain():a}});c.extend(c.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var D=[].slice,q=function(f,m,l){var e;f=-1;var u=m.length;switch(l.length){case 0:for(;++f<u;)(e=m[f]).callback.call(e.ctx);break;case 1:for(;++f<u;)(e=m[f]).callback.call(e.ctx,l[0]);break;case 2:for(;++f<u;)(e=m[f]).callback.call(e.ctx,l[0],l[1]);break;case 3:for(;++f<u;)(e=m[f]).callback.call(e.ctx,l[0],l[1],l[2]);break;default:for(;++f<u;)(e=m[f]).callback.apply(e.ctx,l)}},n=Backbone.Events={on:function(f,m,l){this._events||(this._events={});(this._events[f]||(this._events[f]=[])).push({callback:m,
context:l,ctx:l||this});return this},once:function(f,m,l){var e=this,u=_.once(function(){e.off(f,u);m.apply(this,arguments)});u._callback=m;this.on(f,u,l);return this},off:function(f,m,l){var e,u,p,n,q,z,w,t;if(!this._events)return this;if(!f&&!m&&!l)return this._events={},this;n=f?[f]:_.keys(this._events);q=0;for(z=n.length;q<z;q++)if(f=n[q],e=this._events[f]){p=[];if(m||l)for(w=0,t=e.length;w<t;w++)u=e[w],(m&&m!==(u.callback._callback||u.callback)||l&&l!==u.context)&&p.push(u);this._events[f]=p}return this},
trigger:function(f){if(!this._events)return this;var m=D.call(arguments,1),l=this._events[f],e=this._events.all;l&&q(this,l,m);e&&q(this,e,arguments);return this},listenTo:function(f,m,l){var e=this._listeners||(this._listeners={}),u=f._listenerId||(f._listenerId=_.uniqueId("l"));e[u]=f;f.on(m,l||this,this);return this},stopListening:function(f,m,l){var e=this._listeners;if(e){if(f)f.off(m,l,this),m||l||delete e[f._listenerId];else{for(var u in e)e[u].off(null,null,this);this._listeners={}}return this}}};
n.bind=n.on;n.unbind=n.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=n),exports.Backbone=exports.Backbone||Backbone)})();(function(){function D(f,e){var u=(new Date).getTime(),p=Math.max(0,16-(u-n)),m=q.setTimeout(function(){f(u+p)},p);n=u+p;return m}var q=this,n=0,f=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=D),exports.requestAnimationFrame=D;else{for(var m=0;m<f.length&&!q.requestAnimationFrame;++m)q.requestAnimationFrame=q[f[m]+"RequestAnimationFrame"],q.cancelAnimationFrame=q[f[m]+"CancelAnimationFrame"]||q[f[m]+"CancelRequestAnimationFrame"];
q.requestAnimationFrame||(q.requestAnimationFrame=D);q.cancelAnimationFrame||(q.cancelAnimationFrame=function(f){clearTimeout(f)})}})();(function(){function D(){var d=document.body.getBoundingClientRect(),b=this.width=d.width,d=this.height=d.height;this.renderer.setSize(b,d,this.ratio);this.trigger(g.Events.resize,b,d)}var q=this,n=q.Two||{},f=Math.sin,m=Math.cos,l=Math.atan2,e=Math.sqrt,u=Math.abs,p=Math.PI,A=2*p,y=p/2,z=Math.pow,w=Math.max,t=0,F={hasEventListeners:_.isFunction(q.addEventListener),bind:function(d,b,c,h){this.hasEventListeners?d.addEventListener(b,c,!!h):d.attachEvent("on"+b,c);return this},unbind:function(d,b,c,
h){this.hasEventListeners?d.removeEventListeners(b,c,!!h):d.detachEvent("on"+b,c);return this}},g=q.Two=function(d){d=_.defaults(d||{},{fullscreen:!1,width:640,height:480,type:g.Types.svg,autostart:!1});_.each(d,function(b,d){"fullscreen"!==d&&("width"!==d&&"height"!==d&&"autostart"!==d)&&(this[d]=b)},this);_.isElement(d.domElement)&&(this.type=g.Types[d.domElement.tagName.toLowerCase()]);this.renderer=new g[this.type](this);g.Utils.setPlaying.call(this,d.autostart);this.frameCount=0;d.fullscreen?
(d=_.bind(D,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),F.bind(q,"resize",d),d()):_.isElement(d.domElement)||(this.renderer.setSize(d.width,d.height,this.ratio),this.width=d.width,this.height=d.height);this.scene=this.renderer.scene;g.Instances.push(this)};_.extend(g,{Array:q.Float32Array||Array,Types:{webgl:"WebGLRenderer",
svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){q.Two=n;return this},uniqueId:function(){var d=t;t++;return d},Utils:{Curve:{CollinearityEpsilon:z(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,
angle:0,epsilon:0.01}},devicePixelRatio:q.devicePixelRatio||1,getBackingStoreRatio:function(d){return d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1},getRatio:function(d){return g.Utils.devicePixelRatio/c(d)},setPlaying:function(d){this.playing=!!d;return this},getComputedMatrix:function(d,b){b=b&&b.identity()||new g.Matrix;for(var c=d;c&&c._matrix;){var h=c._matrix.elements;b.multiply(h[0],h[1],h[2],
h[3],h[4],h[5],h[6],h[7],h[8],h[9]);c=c.parent}return b},applySvgAttributes:function(d,b){b.cap="butt";b.join="bevel";_.each(d.attributes,function(d,c){switch(d.nodeName){case "visibility":b.visible=!!d.nodeValue;break;case "stroke-linecap":b.cap=d.nodeValue;break;case "stroke-linejoin":b.join=d.nodeValue;break;case "stroke-miterlimit":b.miter=d.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(d.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=d.nodeValue;break;case "fill":b.fill=
d.nodeValue;break;case "stroke":b.stroke=d.nodeValue}});return b},read:{svg:function(){return g.Utils.read.g.apply(this,arguments)},g:function(d){var b=new g.Group;this.add(b);_.each(d.childNodes,function(d){var c=d.nodeName;c&&(c=c.replace(/svg\:/ig,"").toLowerCase(),c in g.Utils.read&&(d=g.Utils.read[c].call(this,d),b.add(d)))},this);return g.Utils.applySvgAttributes(d,b)},polygon:function(d,b){var c=[];d.getAttribute("points").replace(/([\d\.?]+),([\d\.?]+)/g,function(b,d,h){c.push(new g.Anchor(parseFloat(d),
parseFloat(h)))});var h=(new g.Polygon(c,!b)).noStroke();return g.Utils.applySvgAttributes(d,h)},polyline:function(d){return g.Utils.read.polygon(d,!0)},path:function(d){var b,c,h,p=!1,f=!1,e=d.getAttribute("d").match(/[a-df-z][^a-df-z]*/ig),u=e.length-1,e=_.flatten(_.map(e,function(d,e){var l,m,a=d[0],k=a.toLowerCase();h=d.slice(1).trim();h=h.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(a,b,d){return parseFloat(b)*Math.pow(10,d)});h=h.split(/[\s,]+|(?=\s?[+\-])/);p=a===k;var x,n,A,q;switch(k){case "z":e>=
u?f=!0:(m=b.x,l=b.y,l=new g.Anchor(m,l,void 0,void 0,void 0,void 0,g.Commands.close));break;case "m":case "l":m=parseFloat(h[0]);l=parseFloat(h[1]);l=new g.Anchor(m,l,void 0,void 0,void 0,void 0,"m"===k?g.Commands.move:g.Commands.line);p&&l.addSelf(b);b=l;break;case "h":case "v":m="h"===k?"x":"y";a="x"===m?"y":"x";l=new g.Anchor(void 0,void 0,void 0,void 0,void 0,void 0,g.Commands.line);l[m]=parseFloat(h[0]);l[a]=b[a];p&&(l[m]+=b[m]);b=l;break;case "s":case "c":l=b.x;a=b.y;c||(c=(new g.Vector).copy(b));
"c"===k?(x=parseFloat(h[0]),m=parseFloat(h[1]),k=parseFloat(h[2]),n=parseFloat(h[3]),A=parseFloat(h[4]),q=parseFloat(h[5])):(n=g.Utils.getReflection(b,c,p),x=n.x,m=n.y,k=parseFloat(h[0]),n=parseFloat(h[1]),A=parseFloat(h[2]),q=parseFloat(h[3]));p&&(x+=l,m+=a,k+=l,n+=a,A+=l,q+=a);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(x,m);b=l=new g.Anchor(A,q,k,n,void 0,void 0,g.Commands.curve);c=l.controls.left;break;case "t":case "q":l=b.x;a=b.y;c||(c=(new g.Vector).copy(b));
c.isZero()?(x=l,m=a):(x=c.x,a=c.y);"q"===k?(k=parseFloat(h[0]),n=parseFloat(h[1]),A=parseFloat(h[1]),q=parseFloat(h[2])):(n=g.Utils.getReflection(b,c,p),k=n.x,n=n.y,A=parseFloat(h[0]),q=parseFloat(h[1]));p&&(x+=l,m+=a,k+=l,n+=a,A+=l,q+=a);_.isObject(b.controls)||g.Anchor.AppendCurveProperties(b);b.controls.right.set(x,m);b=l=new g.Anchor(A,q,k,n,void 0,void 0,g.Commands.curve);c=l.controls.left;break;case "a":throw new g.Utils.Error("not yet able to interpret Elliptical Arcs.");}return l}));if(!(1>=
e.length))return e=_.compact(e),e=(new g.Polygon(e,f,void 0,!0)).noStroke(),g.Utils.applySvgAttributes(d,e)},circle:function(d){var b=parseFloat(d.getAttribute("cx")),c=parseFloat(d.getAttribute("cy")),h=parseFloat(d.getAttribute("r")),p=g.Resolution,e=_.map(_.range(p),function(b){var d=b/p*A;b=h*m(d);d=h*f(d);return new g.Anchor(b,d)},this),e=(new g.Polygon(e,!0,!0)).noStroke();e.translation.set(b,c);return g.Utils.applySvgAttributes(d,e)},ellipse:function(d){var b=parseFloat(d.getAttribute("cx")),
c=parseFloat(d.getAttribute("cy")),h=parseFloat(d.getAttribute("rx")),p=parseFloat(d.getAttribute("ry")),e=g.Resolution,l=_.map(_.range(e),function(b){var d=b/e*A;b=h*m(d);d=p*f(d);return new g.Anchor(b,d)},this),l=(new g.Polygon(l,!0,!0)).noStroke();l.translation.set(b,c);return g.Utils.applySvgAttributes(d,l)},rect:function(d){var b=parseFloat(d.getAttribute("x")),c=parseFloat(d.getAttribute("y")),h=parseFloat(d.getAttribute("width")),p=parseFloat(d.getAttribute("height")),h=h/2,p=p/2,e=[new g.Anchor(h,
p),new g.Anchor(-h,p),new g.Anchor(-h,-p),new g.Anchor(h,-p)],e=(new g.Polygon(e,!0)).noStroke();e.translation.set(b+h,c+p);return g.Utils.applySvgAttributes(d,e)},line:function(d){var b=parseFloat(d.getAttribute("x1")),c=parseFloat(d.getAttribute("y1")),h=parseFloat(d.getAttribute("x2")),p=parseFloat(d.getAttribute("y2")),h=(h-b)/2,p=(p-c)/2,e=[new g.Anchor(-h,-p),new g.Anchor(h,p)],e=(new g.Polygon(e)).noFill();e.translation.set(b+h,c+p);return g.Utils.applySvgAttributes(d,e)}},subdivide:function(d,
b,c,h,e,f,m,n,q,t){var s=g.Utils.Curve.CollinearityEpsilon;t=t||g.Utils.Curve.RecursionLimit;var z=g.Utils.Curve.CuspLimit,a=g.Utils.Curve.Tolerance,k,x,y,v;q=q||0;if(q>t)return[];if(C(c,h,d,b,m,n)&&C(e,f,d,b,m,n))return y=m-d,v=n-b,c=w(t-q,1),x=c-1,_.map(_.range(c),function(a){a/=x;return new g.Anchor(y*a+d,v*a+b)});var D=(d+c)/2,E=(b+h)/2,B=(c+e)/2,F=(h+f)/2,H=(e+m)/2,X=(f+n)/2,Y=(D+B)/2,Z=(E+F)/2,B=(B+H)/2,F=(F+X)/2,R=(Y+B)/2,S=(Z+F)/2;y=m-d;v=n-b;k=u((c-m)*v-(h-n)*y);var N=u((e-m)*v-(f-n)*y);
if(0<q){if(k>s&&N>s&&(k+N)*(k+N)<=a.distance*(y*y+v*v)){if(a.angle<a.epsilon)return[new g.Anchor(R,S)];k=l(f-h,e-c);s=u(k-l(h-b,c-d));k=u(l(n-f,m-e)-k);s>=p&&(s=A-s);k>=p&&(k=A-k);if(s+k<a.angle)return[new g.Anchor(R,S)];if(0!==z){if(s>z)return[new g.Anchor(c,h)];if(k>z)return[new g.Anchor(e,f)]}}}else if(k>s)if(k*k<=a.distance*(y*y+v*v)){if(a.angle<a.epsilon)return[new g.Anchor(R,S)];s=u(l(f-h,e-c)-l(h-b,c-d));s>=p&&(s=A-s);if(s<a.angle)return[new g.Anchor(c,h),new g.Anchor(e,f)];if(0!==z&&s>z)return[new g.Anchor(c,
h)]}else if(N>s){if(N*N<=a.distance*(y*y+v*v)){if(a.angle<a.epsilon)return[new g.Anchor(R,S)];s=u(l(n-f,m-e)-l(f-h,e-c));s>=p&&(s=A-s);if(s<a.angle)return[new g.Anchor(c,h),new g.Anchor(e,f)];if(0!==z&&s>z)return[new g.Anchor(e,f)]}}else if(y=R-(d+m)/2,v=S-(b+n)/2,y*y+v*v<=a.distance)return[new g.Anchor(R,S)];return g.Utils.subdivide(d,b,D,E,Y,Z,R,S,q+1,t).concat(g.Utils.subdivide(R,S,B,F,H,X,m,n,q+1,t))},pointOnLine:function(d,b,c,h,p,e){var f=g.Utils.Curve.Tolerance.epsilon;if(u((b-h)*(p-c)-(d-
c)*(e-h))>f)return!1;d=(d-c)*(p-c)+(b-h)*(e-h);return 0>d||d>(p-c)*(p-c)+(e-h)*(e-h)?!1:!0},getCurveFromPoints:function(d,b){for(var c=d.length,h=c-1,p=0;p<c;p++){var e=d[p];_.isObject(e.controls)||g.Anchor.AppendCurveProperties(e);var f=b?H(p-1,c):Math.max(p-1,0),l=b?H(p+1,c):Math.min(p+1,h);B(d[f],e,d[l]);e._command=0===p?g.Commands.move:g.Commands.curve;e.controls.left.x=_.isNumber(e.controls.left.x)?e.controls.left.x:e.x;e.controls.left.y=_.isNumber(e.controls.left.y)?e.controls.left.y:e.y;e.controls.right.x=
_.isNumber(e.controls.right.x)?e.controls.right.x:e.x;e.controls.right.y=_.isNumber(e.controls.right.y)?e.controls.right.y:e.y}},getControlPoints:function(d,b,c){var h=v(d,b),e=v(c,b);d=E(d,b);c=E(c,b);var l=(h+e)/2;b.u=_.isObject(b.controls.left)?b.controls.left:new g.Vector(b.x,b.y);b.v=_.isObject(b.controls.right)?b.controls.right:new g.Vector(b.x,b.y);if(1E-4>d||1E-4>c)return b.controls.left.copy(b),b.controls.right.copy(b),b;d*=0.33;c*=0.33;l=e<h?l+y:l-y;b.controls.left.x=b.x+m(l)*d;b.controls.left.y=
b.y+f(l)*d;l-=p;b.controls.right.x=b.x+m(l)*c;b.controls.right.y=b.y+f(l)*c;return b},getReflection:function(d,b,c){var h=d.distanceTo(b);if(1E-4>=h)return c?new g.Vector:d.clone();b=v(d,b);return new g.Vector(h*Math.cos(b)+(c?0:d.x),h*Math.sin(b)+(c?0:d.y))},angleBetween:function(d,b){var c,h;if(4<=arguments.length)return c=arguments[0]-arguments[2],h=arguments[1]-arguments[3],l(h,c);c=d.x-b.x;h=d.y-b.y;return l(h,c)},distanceBetweenSquared:function(d,b){var c=d.x-b.x,h=d.y-b.y;return c*c+h*h},distanceBetween:function(d,
b){return e(s(d,b))},mod:function(d,b){for(;0>d;)d+=b;return d%b},Collection:function(){Array.call(this);1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(d){this.name="two.js";this.message=d}}});g.Utils.Error.prototype=Error();g.Utils.Error.prototype.constructor=g.Utils.Error;g.Utils.Collection.prototype=[];g.Utils.Collection.constructor=g.Utils.Collection;_.extend(g.Utils.Collection.prototype,
Backbone.Events,{pop:function(){var d=Array.prototype.pop.apply(this,arguments);this.trigger(g.Events.remove,[d]);return d},shift:function(){var d=Array.prototype.shift.apply(this,arguments);this.trigger(g.Events.remove,[d]);return d},push:function(){var d=Array.prototype.push.apply(this,arguments);this.trigger(g.Events.insert,arguments);return d},unshift:function(){var d=Array.prototype.unshift.apply(this,arguments);this.trigger(g.Events.insert,arguments);return d},splice:function(){var d=Array.prototype.splice.apply(this,
arguments),b;this.trigger(g.Events.remove,d);2<arguments.length&&(b=this.slice(arguments[0],arguments.length-2),this.trigger(g.Events.insert,b));return d}});var E=g.Utils.distanceBetween,s=g.Utils.distanceBetweenSquared,v=g.Utils.angleBetween,B=g.Utils.getControlPoints,H=g.Utils.mod,c=g.Utils.getBackingStoreRatio,C=g.Utils.pointOnLine;_.extend(g.prototype,Backbone.Events,{appendTo:function(d){d.appendChild(this.renderer.domElement);return this},play:function(){g.Utils.setPlaying.call(this,!0);return this.trigger(g.Events.play)},
pause:function(){this.playing=!1;return this.trigger(g.Events.pause)},update:function(){var d=!!this._lastFrame,b=(q.performance&&q.performance.now?q.performance:Date).now();this.frameCount++;d&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var d=this.width,b=this.height,c=this.renderer;d===c.width&&b===c.height||c.setSize(d,b,this.ratio);this.trigger(g.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(g.Events.render,
this.frameCount)},add:function(d){var b=d;_.isArray(d)||(b=_.toArray(arguments));this.scene.add(b);return this},remove:function(d){var b=d;_.isArray(d)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));return this},makeLine:function(d,b,c,h){c=(c-d)/2;h=(h-b)/2;var e=[new g.Anchor(-c,-h),new g.Anchor(c,h)],e=(new g.Polygon(e)).noFill();e.translation.set(d+c,b+h);this.scene.add(e);return e},makeRectangle:function(d,b,c,h){c/=
2;h/=2;h=[new g.Anchor(c,h),new g.Anchor(-c,h),new g.Anchor(-c,-h),new g.Anchor(c,-h)];h=new g.Polygon(h,!0);h.translation.set(d,b);this.scene.add(h);return h},makeCircle:function(d,b,c){return this.makeEllipse(d,b,c,c)},makeEllipse:function(d,b,c,h){var e=g.Resolution,p=_.map(_.range(e),function(b){var d=b/e*A;b=c*m(d);d=h*f(d);return new g.Anchor(b,d)},this),p=new g.Polygon(p,!0,!0);p.translation.set(d,b);this.scene.add(p);return p},makeCurve:function(d){var b=arguments.length,c=d;if(!_.isArray(d))for(var c=
[],e=0;e<b;e+=2){var p=arguments[e];if(!_.isNumber(p))break;c.push(new g.Anchor(p,arguments[e+1]))}var b=arguments[b-1],c=new g.Polygon(c,!(_.isBoolean(b)&&b),!0),b=c.getBoundingClientRect(),f=b.left+b.width/2,l=b.top+b.height/2;_.each(c.vertices,function(b){b.x-=f;b.y-=l});c.translation.set(f,l);this.scene.add(c);return c},makePolygon:function(d){var b=arguments.length,c=d;if(!_.isArray(d))for(var c=[],e=0;e<b;e+=2){var p=arguments[e];if(!_.isNumber(p))break;c.push(new g.Anchor(p,arguments[e+1]))}b=
arguments[b-1];c=new g.Polygon(c,!(_.isBoolean(b)&&b));b=c.getBoundingClientRect();c.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(c);return c},makeGroup:function(c){var b=c;_.isArray(c)||(b=_.toArray(arguments));var e=new g.Group;this.scene.add(e);e.add(b);return e},interpret:function(c){var b=c.tagName.toLowerCase();if(!(b in g.Utils.read))return null;c=g.Utils.read[b].call(this,c);this.add(c);return c}});(function(){requestAnimationFrame(arguments.callee);_.each(g.Instances,
function(c){c.playing&&c.update()})})();"function"===typeof define&&define.amd?define(function(){return g}):"undefined"!=typeof module&&module.exports&&(module.exports=g)})();(function(){var D,q,n,f,m=Two.Vector=function(e,f){this.x=e||0;this.y=f||0};_.extend(m.prototype,Backbone.Events,{set:function(e,f){this.x=e;this.y=f;return this},copy:function(e){this.x=e.x;this.y=e.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new m(this.x,this.y)},add:function(e,f){this.x=e.x+f.x;this.y=e.y+f.y;return this},addSelf:function(e){this.x+=e.x;this.y+=e.y;return this},sub:function(e,f){this.x=e.x-f.x;this.y=e.y-f.y;return this},subSelf:function(e){this.x-=
e.x;this.y-=e.y;return this},multiplySelf:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divideScalar:function(e){e?(this.x/=e,this.y/=e):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},
distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){n=this.x-e.x;f=this.y-e.y;return n*n+f*f},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,f){D=(e.x-this.x)*f+this.x;q=(e.y-this.y)*f+this.y;return this.set(D,q)},isZero:function(){return 1E-4>this.length()},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var l={set:function(e,
f){this._x=e;this._y=f;return this.trigger(Two.Events.change)},copy:function(e){this._x=e.x;this._y=e.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new m(this._x,this._y)},add:function(e,f){this._x=e.x+f.x;this._y=e.y+f.y;return this.trigger(Two.Events.change)},addSelf:function(e){this._x+=e.x;this._y+=e.y;return this.trigger(Two.Events.change)},sub:function(e,f){this._x=e.x-f.x;this._y=e.y-f.y;return this.trigger(Two.Events.change)},
subSelf:function(e){this._x-=e.x;this._y-=e.y;return this.trigger(Two.Events.change)},multiplySelf:function(e){this._x*=e.x;this._y*=e.y;return this.trigger(Two.Events.change)},multiplyScalar:function(e){this._x*=e;this._y*=e;return this.trigger(Two.Events.change)},divideScalar:function(e){return e?(this._x/=e,this._y/=e,this.trigger(Two.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this._x*e.x+this._y*e.y},lengthSquared:function(){return this._x*
this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){n=this._x-e.x;f=this._y-e.y;return n*n+f*f},setLength:function(e){return this.normalize().multiplyScalar(e)},equals:function(e){return 1E-4>this.distanceTo(e)},lerp:function(e,f){D=(e.x-this._x)*f+this._x;q=(e.y-this._y)*f+this._y;return this.set(D,q)},isZero:function(){return 1E-4>
this.length()},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},e={get:function(){return this._x},set:function(e){this._x=e;this.trigger(Two.Events.change,"x")}},u={get:function(){return this._y},set:function(e){this._y=e;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",e),Object.defineProperty(this,"y",u),_.extend(this,l),this._bound=
!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var D=Two.Commands,q,n,f,m=Two.Anchor=function(f,e,n,p,q,y,z){Two.Vector.call(this,f,e);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(e){this._command=e;this._command!==D.curve||_.isObject(this.controls)||m.AppendCurveProperties(this);return this.trigger(Two.Events.change)}});this._command=z||D.move;if(!z)return this;m.AppendCurveProperties(this);_.isNumber(n)&&(this.controls.left.x=
n);_.isNumber(p)&&(this.controls.left.y=p);_.isNumber(q)&&(this.controls.right.x=q);_.isNumber(y)&&(this.controls.right.y=y)};_.extend(m,{AppendCurveProperties:function(f){q=f._x||f.x;n=f._y||f.y;f.controls={left:new Two.Vector(q,n),right:new Two.Vector(q,n)}}});_.extend(m.prototype,Two.Vector.prototype,{listen:function(){_.isObject(this.controls)||m.AppendCurveProperties(this);_.each(this.controls,function(f){f.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,
function(f){f.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){f=this.controls;return new Two.Anchor(this.x,this.y,f&&f.left.x,f&&f.left.y,f&&f.right.x,f&&f.right.y,this.command)}})})();(function(){_.range(6);var D=Math.cos,q=Math.sin,n=Math.tan,f,m,l,e,u,p,A,y,z,w,t,F,g,E,s,v,B,H,c,C,d,b,r,h,G,I,J,L,O,M,P,Q,a,k,x,ea,V,W,ca,da,$,aa,X,Y,Z,R,S,N,T,ba=[],fa=Two.Matrix=function(b,a,c,d,e,g){this.elements=new Two.Array(9);var f=b;_.isArray(f)||(f=_.toArray(arguments));this.identity().set(f)};_.extend(fa,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(a,e,k){if(3>=e.length)return F,g,E,f=e[0]||0,m=e[1]||0,l=e[2]||0,u=a,F=u[0]*f+u[1]*m+u[2]*l,g=u[3]*f+u[4]*m+u[5]*l,E=u[6]*f+u[7]*m+u[8]*
l,{x:F,y:g,z:E};s=a[0];v=a[1];B=a[2];H=a[3];c=a[4];C=a[5];d=a[6];b=a[7];r=a[8];h=e[0];G=e[1];I=e[2];J=e[3];L=e[4];O=e[5];M=e[6];P=e[7];Q=e[8];k=k||new Two.Array(9);k[0]=s*h+v*J+B*M;k[1]=s*G+v*L+B*P;k[2]=s*I+v*O+B*Q;k[3]=H*h+c*J+C*M;k[4]=H*G+c*L+C*P;k[5]=H*I+c*O+C*Q;k[6]=d*h+b*J+r*M;k[7]=d*G+b*L+r*P;k[8]=d*I+b*O+r*Q;return k}});_.extend(fa.prototype,Backbone.Events,{set:function(a,b,c,d,e,f){t=a;x=arguments.length;_.isArray(t)||(t=_.toArray(arguments));_.each(t,function(a,b){_.isNumber(a)&&(this.elements[b]=
a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(fa.Identity);return this},multiply:function(e,f,l,p,m,n,u,q,ma){t=arguments;x=t.length;if(1>=x)return _.each(this.elements,function(a,b){this.elements[b]=a*e},this),this.trigger(Two.Events.change);if(3>=x)return F,g,E,e=e||0,f=f||0,l=l||0,m=this.elements,F=m[0]*e+m[1]*f+m[2]*l,g=m[3]*e+m[4]*f+m[5]*l,E=m[6]*e+m[7]*f+m[8]*l,{x:F,y:g,z:E};a=this.elements;k=t;s=a[0];v=a[1];B=a[2];H=a[3];c=a[4];C=a[5];d=a[6];b=a[7];r=a[8];h=
k[0];G=k[1];I=k[2];J=k[3];L=k[4];O=k[5];M=k[6];P=k[7];Q=k[8];this.elements[0]=s*h+v*J+B*M;this.elements[1]=s*G+v*L+B*P;this.elements[2]=s*I+v*O+B*Q;this.elements[3]=H*h+c*J+C*M;this.elements[4]=H*G+c*L+C*P;this.elements[5]=H*I+c*O+C*Q;this.elements[6]=d*h+b*J+r*M;this.elements[7]=d*G+b*L+r*P;this.elements[8]=d*I+b*O+r*Q;return this.trigger(Two.Events.change)},inverse:function(a){f=this.elements;a=a||new Two.Matrix;V=f[0];W=f[1];ca=f[2];da=f[3];$=f[4];aa=f[5];X=f[6];Y=f[7];Z=f[8];R=Z*$-aa*Y;S=-Z*da+
aa*X;N=Y*da-$*X;T=V*R+W*S+ca*N;if(!T)return null;T=1/T;a.elements[0]=R*T;a.elements[1]=(-Z*W+ca*Y)*T;a.elements[2]=(aa*W-ca*$)*T;a.elements[3]=S*T;a.elements[4]=(Z*V-ca*X)*T;a.elements[5]=(-aa*V+ca*da)*T;a.elements[6]=N*T;a.elements[7]=(-Y*V+W*X)*T;a.elements[8]=($*V-W*da)*T;return a},scale:function(a,b){x=arguments.length;1>=x&&(b=a);return this.multiply(a,0,0,0,b,0,0,0,1)},rotate:function(a){l=D(a);ea=q(a);return this.multiply(l,-ea,0,ea,l,0,0,0,1)},translate:function(a,b){return this.multiply(1,
0,a,0,1,b,0,0,1)},skewX:function(a){f=n(a);return this.multiply(1,f,0,0,1,0,0,0,1)},skewY:function(a){f=n(a);return this.multiply(1,0,0,f,1,0,0,0,1)},toString:function(a){this.toArray(a,ba);return ba.join(" ")},toArray:function(a,b){t=this.elements;w=!!b;f=parseFloat(t[0].toFixed(3));m=parseFloat(t[1].toFixed(3));l=parseFloat(t[2].toFixed(3));e=parseFloat(t[3].toFixed(3));u=parseFloat(t[4].toFixed(3));p=parseFloat(t[5].toFixed(3));if(a){A=parseFloat(t[6].toFixed(3));y=parseFloat(t[7].toFixed(3));
z=parseFloat(t[8].toFixed(3));if(w){b[0]=f;b[1]=e;b[2]=A;b[3]=m;b[4]=u;b[5]=y;b[6]=l;b[7]=p;b[8]=z;return}return[f,e,A,m,u,y,l,p,z]}if(w)b[0]=f,b[1]=e,b[2]=m,b[3]=u,b[4]=l,b[5]=p;else return[f,e,m,u,l,p]},clone:function(){f=this.elements[0];m=this.elements[1];l=this.elements[2];e=this.elements[3];u=this.elements[4];p=this.elements[5];A=this.elements[6];y=this.elements[7];z=this.elements[8];return new Two.Matrix(f,m,l,e,u,p,A,y,z)}})})();(function(){var D=Two.Utils.mod,q,n,f,m={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(e,l){f=e;n=document.createElementNS(this.ns,f);"svg"===f&&(l=_.defaults(l||{},{version:this.version}));_.isObject(l)&&m.setAttributes(n,l);return n},setAttribute:function(e,f){this.setAttribute(f,e)},setAttributes:function(e,f){_.each(f,m.setAttribute,e);return this},removeAttribute:function(e,f){this.removeAttribute(f)},removeAttributes:function(e,f){_.each(f,
m.removeAttribute,e);return this},toString:function(e,f){var l=e.length,m=l-1;return _.map(e,function(n,q){var w,t=f?D(q-1,l):Math.max(q-1,0),F=f?D(q+1,l):Math.min(q+1,m),t=e[t],F=e[F],g,E,s,v,B;B=n.x.toFixed(3);v=n.y.toFixed(3);switch(n._command){case Two.Commands.close:w=Two.Commands.close;break;case Two.Commands.curve:g=t.controls&&t.controls.right||t;w=n.controls&&n.controls.left||n;t=g.x.toFixed(3);g=g.y.toFixed(3);E=w.x.toFixed(3);s=w.y.toFixed(3);w=(0===q?Two.Commands.move:Two.Commands.curve)+
" "+t+" "+g+" "+E+" "+s+" "+B+" "+v;break;default:w=(0===q?Two.Commands.move:n._command)+" "+B+" "+v}q>=m&&f&&(n._command===Two.Commands.curve&&(v=n.controls&&n.controls.right||n,B=F.controls&&F.controls.left||F,t=v.x.toFixed(3),g=v.y.toFixed(3),E=B.x.toFixed(3),s=B.y.toFixed(3),B=F.x.toFixed(3),v=F.y.toFixed(3),w+=" C "+t+" "+g+" "+E+" "+s+" "+B+" "+v),w+=" Z");return w}).join(" ")},group:{appendChild:function(e){(n=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.appendChild(n)},
removeChild:function(e){(n=this.domElement.querySelector("#"+Two.Identifier+e))&&this.elem.removeChild(n)},renderChild:function(e){m[e._renderer.type].render.call(e,this)},render:function(e){this.update();this._renderer.elem||(this._renderer.elem=m.createElement("g",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));q=this._matrix.manual||this._flagMatrix;var f={domElement:e,elem:this._renderer.elem};q&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");
_.each(this.children,m.group.renderChild,e);this._flagAdditions&&_.each(this.additions,m.group.appendChild,f);this._flagSubtractions&&_.each(this.subtractions,m.group.removeChild,f);return this.flagReset()}},polygon:{render:function(e){this.update();this._renderer.elem||(this._renderer.elem=m.createElement("path",{id:Two.Identifier+this.id}),e.appendChild(this._renderer.elem));n=this._renderer.elem;(q=this._matrix.manual||this._flagMatrix)&&n.setAttribute("transform","matrix("+this._matrix.toString()+
")");this._flagVertices&&(vertices=m.toString(this._vertices,this._closed),n.setAttribute("d",vertices));this._flagFill&&n.setAttribute("fill",this._fill);this._flagStroke&&n.setAttribute("stroke",this._stroke);this._flagLinewidth&&n.setAttribute("stroke-width",this._linewidth);this._flagOpacity&&(n.setAttribute("stroke-opacity",this._opacity),n.setAttribute("fill-opacity",this._opacity));this._flagVisible&&n.setAttribute("visibility",this._visible?"visible":"hidden");this._flagCap&&n.setAttribute("stroke-linecap",
this._cap);this._flagJoin&&n.setAttribute("stroke-linejoin",this._join);this._flagMiter&&n.setAttribute("stroke-miterlimit",this.miter);return this.flagReset()}}},l=Two[Two.Types.svg]=function(e){this.domElement=e.domElement||m.createElement("svg");this.scene=new Two.Group;this.scene.parent=this};_.extend(l,{Utils:m});_.extend(l.prototype,Backbone.Events,{setSize:function(e,f){this.width=e;this.height=f;m.setAttributes(this.domElement,{width:e,height:f});return this},render:function(){m.group.render.call(this.scene,
this.domElement);return this}})})();(function(){var D=Two.Utils.mod,q=Two.Utils.getRatio,n,f,m,l,e,u,p,A,y,z,w,t,F,g,E,s,v,B,H,c,C,d,b,r,h,G,I,J={group:{renderChild:function(b){J[b._renderer.type].render.call(b,this)},render:function(b){this.update();n=this._matrix.elements;b.save();b.transform(n[0],n[3],n[1],n[4],n[2],n[5]);_.each(this.children,J.group.renderChild,b);b.restore();return this.flagReset()}},polygon:{render:function(q){this.update();n=this._matrix.elements;f=this.stroke;m=this.linewidth;l=this.fill;e=this.opacity;u=this.visible;
p=this.cap;A=this.join;y=this.miter;z=this.closed;w=this._vertices;t=w.length;F=t-1;if(!u)return this;q.save();n&&q.transform(n[0],n[3],n[1],n[4],n[2],n[5]);l&&(q.fillStyle=l);f&&(q.strokeStyle=f);m&&(q.lineWidth=m);y&&(q.miterLimit=y);A&&(q.lineJoin=A);p&&(q.lineCap=p);_.isNumber(e)&&(q.globalAlpha=e);q.beginPath();_.each(w,function(e,f){G=e.x.toFixed(3);I=e.y.toFixed(3);switch(e._command){case Two.Commands.close:q.closePath();break;case Two.Commands.curve:E=z?D(f-1,t):Math.max(f-1,0);g=z?D(f+1,
t):Math.min(f+1,F);s=w[E];v=w[g];d=s.controls&&s.controls.right||s;b=e.controls&&e.controls.left||e;c=d.x.toFixed(3);C=d.y.toFixed(3);B=b.x.toFixed(3);H=b.y.toFixed(3);q.bezierCurveTo(c,C,B,H,G,I);f>=F&&z&&(r=e.controls&&e.controls.right||e,h=v.controls&&v.controls.left||v,c=r.x.toFixed(3),C=r.y.toFixed(3),B=h.x.toFixed(3),H=h.y.toFixed(3),G=v.x.toFixed(3),I=v.y.toFixed(3),q.bezierCurveTo(c,C,B,H,G,I));break;case Two.Commands.line:q.lineTo(G,I);break;case Two.Commands.move:q.moveTo(G,I)}});z&&q.closePath();
q.fill();q.stroke();q.restore();return this.flagReset()}}},L=Two[Two.Types.canvas]=function(b){this.domElement=b.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=!1;this.scene=new Two.Group;this.scene.parent=this};_.extend(L,{Utils:J});_.extend(L.prototype,Backbone.Events,{setSize:function(b,c,d){this.width=b;this.height=c;this.ratio=_.isUndefined(d)?q(this.ctx):d;this.domElement.width=b*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,
{width:b+"px",height:c+"px"});return this},render:function(){var b=1===this.ratio;b||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);J.group.render.call(this.scene,this.ctx);b||this.ctx.restore();return this}})})();(function(){var D=Two.Matrix.Multiply,q=Two.Utils.mod,n=[1,0,0,0,1,0,0,0,1],f=new Two.Array(9),m=Two.Utils.getRatio,l,e,u,p,A,y,z,w,t,F,g,E,s,v,B,H,c,C,d,b,r,h,G,I,J,L,O,M,P,Q,a,k,x,ea,V,W,ca,da,$,aa,X,Y,Z,R,S,N,T,ba,fa,ga,K,ia,ja,ka,ha,U={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){U[a._renderer.type].render.call(a,this.gl,this.program)},render:function(a,b){this.update();l=this.parent;e=l._matrix&&l._matrix.manual||l._flagMatrix;
u=this._matrix.manual||this._flagMatrix;if(e||u)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,f),D(f,l._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*l._renderer.scale,e&&(this._flagMatrix=!0);_.each(this.children,U.group.renderChild,{gl:a,program:b});return this.flagReset()}},polygon:{render:function(a,b){if(!this._visible||!this._opacity)return this;l=this.parent;e=l._matrix.manual||l._flagMatrix;u=this._matrix.manual||this._flagMatrix;
p=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this.update();if(e||u)this._renderer.matrix||(this._renderer.matrix=new Two.Array(9)),this._matrix.toArray(!0,f),D(f,l._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*l._renderer.scale;p&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new Two.Array(12)),
U.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),U.getTriangles(this._renderer.rect,this._renderer.triangles),U.updateBuffer(a,this,b),U.updateTexture(a,this));a.bindBuffer(a.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this._renderer.texture);a.uniformMatrix3fv(b.matrix,!1,this._renderer.matrix);a.bindBuffer(a.ARRAY_BUFFER,this._renderer.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,
!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(a,b,e){A=Infinity;y=-Infinity;z=Infinity;w=-Infinity;_.each(a,function(a,b){t=a.x;F=a.y;g;E;s;v;B=a.controls;z=Math.min(F,z);A=Math.min(t,A);y=Math.max(t,y);w=Math.max(F,w);a.controls&&(H=B.left,c=B.right,H&&c&&(g=H.x,E=H.y,s=c.x,v=c.y,g&&(E&&s&&v)&&(z=Math.min(E,v,z),A=Math.min(g,s,A),y=Math.max(g,s,y),w=Math.max(E,v,w))))});_.isNumber(b)&&(z-=b,A-=b,y+=b,w+=b);C=y-A;d=w-z;e.top=z;e.left=A;e.right=y;e.bottom=
w;e.width=C;e.height=d;e.centroid||(e.centroid={});e.centroid.x=-A;e.centroid.y=-z},getTriangles:function(a,b){z=a.top;A=a.left;y=a.right;w=a.bottom;b[0]=A;b[1]=z;b[2]=y;b[3]=z;b[4]=A;b[5]=w;b[6]=A;b[7]=w;b[8]=y;b[9]=z;b[10]=y;b[11]=w},updateCanvas:function(c){b=c._vertices;r=this.canvas;h=this.ctx;G=c._renderer.scale;I=c._stroke;J=c._linewidth*G;L=c._fill;O=c._opacity;M=c._cap;P=c._join;Q=c._miter;a=c._closed;k=b.length;x=k-1;r.width=Math.max(Math.ceil(c._renderer.rect.width*G),1);r.height=Math.max(Math.ceil(c._renderer.rect.height*
G),1);ea=c._renderer.rect.centroid;V=ea.x*G;W=ea.y*G;h.clearRect(0,0,r.width,r.height);L&&(h.fillStyle=L);I&&(h.strokeStyle=I);J&&(h.lineWidth=J);Q&&(h.miterLimit=Q);P&&(h.lineJoin=P);M&&(h.lineCap=M);_.isNumber(O)&&(h.globalAlpha=O);h.beginPath();_.each(b,function(c,d){ca;da;g;s;$;aa;X;Y;Z;R;S;H;t=(c.x*G+V).toFixed(3);F=(c.y*G+W).toFixed(3);switch(c._command){case Two.Commands.close:h.closePath();break;case Two.Commands.curve:da=a?q(d-1,k):Math.max(d-1,0);ca=a?q(d+1,k):Math.min(d+1,x);g=b[da];s=
b[ca];Z=g.controls&&g.controls.right||g;R=c.controls&&c.controls.left||c;X=(Z.x*G+V).toFixed(3);Y=(Z.y*G+W).toFixed(3);$=(R.x*G+V).toFixed(3);aa=(R.y*G+W).toFixed(3);h.bezierCurveTo(X,Y,$,aa,t,F);d>=x&&a&&(S=c.controls&&c.controls.right||c,H=s.controls&&s.controls.left||s,X=(S.x*G+V).toFixed(3),Y=(S.y*G+W).toFixed(3),$=(H.x*G+V).toFixed(3),aa=(H.y*G+W).toFixed(3),t=(s.x*G+V).toFixed(3),F=(s.y*G+W).toFixed(3),h.bezierCurveTo(X,Y,$,aa,t,F));break;case Two.Commands.line:h.lineTo(t,F);break;case Two.Commands.move:h.moveTo(t,
F)}});a&&h.closePath();h.fill();h.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b._renderer.texture&&a.deleteTexture(b._renderer.texture);a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);b._renderer.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b._renderer.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||
0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b._renderer.buffer)&&a.deleteBuffer(b._renderer.buffer);b._renderer.buffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b._renderer.triangles,a.STATIC_DRAW);_.isObject(b._renderer.textureCoordsBuffer)&&a.deleteBuffer(b._renderer.textureCoordsBuffer);b._renderer.textureCoordsBuffer=
a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){N=a.createProgram();_.each(b,function(b){a.attachShader(N,b)});a.linkProgram(N);T=a.getProgramParameter(N,a.LINK_STATUS);if(!T)throw ga=a.getProgramInfoLog(N),a.deleteProgram(N),new Two.Utils.Error("unable to link program: "+ga);return N}},shaders:{create:function(a,b,c){ba=a.createShader(a[c]);a.shaderSource(ba,
b);a.compileShader(ba);fa=a.getShaderParameter(ba,a.COMPILE_STATUS);if(!fa)throw ga=a.getShaderInfoLog(ba),a.deleteShader(ba),new Two.Utils.Error("unable to compile shader "+ba+": "+ga);return ba},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};U.ctx=U.canvas.getContext("2d");var la=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group;this.scene.parent=this;this._renderer={matrix:new Two.Array(n),scale:1};this._flagMatrix=!0;ha=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,
preserveDrawingBuffer:!0,overdraw:!1});this.overdraw=ha.overdraw;K=this.ctx=this.domElement.getContext("webgl",ha)||this.domElement.getContext("experimental-webgl",ha);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");ka=U.shaders.create(K,U.shaders.vertex,U.shaders.types.vertex);ja=U.shaders.create(K,U.shaders.fragment,U.shaders.types.fragment);this.program=U.program.create(K,[ka,ja]);K.useProgram(this.program);this.program.position=K.getAttribLocation(this.program,
"a_position");this.program.matrix=K.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=K.getAttribLocation(this.program,"a_textureCoords");K.disable(K.DEPTH_TEST);K.enable(K.BLEND);K.blendEquationSeparate(K.FUNC_ADD,K.FUNC_ADD);K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA)};_.extend(la.prototype,Backbone.Events,{setSize:function(a,b,c){this.width=a;this.height=b;this.ratio=_.isUndefined(c)?m(this.ctx):c;this.domElement.width=a*this.ratio;this.domElement.height=
b*this.ratio;_.extend(this.domElement.style,{width:a+"px",height:b+"px"});a*=this.ratio;b*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=!0;this.ctx.viewport(0,0,a,b);ia=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ia,a,b);return this},render:function(){K=this.ctx;this.overdraw||K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT);U.group.render.call(this.scene,K,this.program);this._flagMatrix=!1;return this}})})();(function(){new Two.Vector;var D,q=Two.Shape=function(n){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix;this.translation=new Two.Vector;this.translation.bind(Two.Events.change,_.bind(q.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(q,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(n){Object.defineProperty(n,"rotation",{get:function(){return this._rotation},set:function(f){this._rotation=f;this._flagMatrix=!0}});Object.defineProperty(n,
"scale",{get:function(){return this._scale},set:function(f){this._scale=f;this._flagScale=this._flagMatrix=!0}})}});_.extend(q.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(n){n.add(this);return this},clone:function(){D=new q;D.translation.copy(this.translation);D.rotation=this.rotation;D.scale=this.scale;_.each(q.Properties,function(n){D[n]=this[n]},this);return D.update()},update:function(){!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,
this.translation.y).scale(this.scale).rotate(this.rotation);return this},flagReset:function(){this._flagScale=this._flagMatrix=!1;return this}});q.MakeObservable(q.prototype)})();(function(){var D=Math.min,q=Math.max,n=Math.round,f=Two.Utils.getComputedMatrix,m,l,e,u,p,A,y,z,w,t,F,g,E,s,v,B,H,c,C,d,b,r,h,G,I,J,L,O,M,P,Q,a=Two.Polygon=function(a,b,c,d){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!c;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=4;this._vertices=[];this.vertices=a;this.automatic=!d};_.extend(a,{Properties:"fill stroke linewidth opacity visible cap join miter closed curved automatic beginning ending".split(" "),
FlagVertices:function(){this._flagVertices=!0},MakeObservable:function(b){Two.Shape.MakeObservable(b);_.each(a.Properties.slice(0,8),function(a){var c="_"+a,d="_flag"+a.charAt(0).toUpperCase()+a.slice(1);Object.defineProperty(b,a,{get:function(){return this[c]},set:function(a){this[c]=a;this[d]=!0}})});Object.defineProperty(b,"closed",{get:function(){return this._closed},set:function(a){this._closed=!!a;this._flagVertices=!0}});Object.defineProperty(b,"curved",{get:function(){return this._curved},
set:function(a){this._curved=!!a;this._flagVertices=!0}});Object.defineProperty(a.prototype,"automatic",{get:function(){return this._automatic},set:function(a){a!==this._automatic&&(method=(this._automatic=!!a)?"ignore":"listen",_.each(this.vertices,function(a){a[method]()}))}});Object.defineProperty(b,"beginning",{get:function(){return this._beginning},set:function(a){this._beginning=D(q(a,0),1);this._flagVertices=!0}});Object.defineProperty(b,"ending",{get:function(){return this._ending},set:function(a){this._ending=
D(q(a,0),1);this._flagVertices=!0}});Object.defineProperty(b,"vertices",{get:function(){return this._collection},set:function(b){var c=_.bind(a.FlagVertices,this),d=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,c)},this);c()},this),e=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,c)},this);c()},this);this._collection&&this._collection.unbind();this._collection=new Two.Utils.Collection(b.slice(0));this._collection.bind(Two.Events.insert,d);this._collection.bind(Two.Events.remove,
e);verticesChanged=!0;d(this._collection)}})}});_.extend(a.prototype,Two.Shape.prototype,{_flagVertices:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(b){b=b||this.parent;z=_.map(this.vertices,function(a){return a.clone()});w=new a(z,this.closed,this.curved,
!this.automatic);_.each(Two.Shape.Properties,function(a){w[a]=this[a]},this);w.translation.copy(this.translation);w.rotation=this.rotation;w.scale=this.scale;b.add(w);return w},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){t=this.getBoundingClientRect(!0);F={x:t.left,y:t.top};_.each(this.vertices,function(a){a.subSelf(F)});return this},center:function(){t=this.getBoundingClientRect(!0);t.centroid={x:t.left+t.width/
2,y:t.top+t.height/2};_.each(this.vertices,function(a){a.subSelf(t.centroid)});return this},remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(a){this.update();g=this.linewidth/2;void 0;E=Infinity;s=-Infinity;v=Infinity;B=-Infinity;_.each(this._vertices,function(a){H=a.x;c=a.y;v=D(c,v);E=D(H,E);s=q(H,s);B=q(c,B)});v-=g;E-=g;s+=g;B+=g;h=a?this._matrix:f(this);C=h.multiply(E,v,1);d=h.multiply(s,v,1);b=h.multiply(s,B,1);r=h.multiply(E,B,
1);v=D(C.y,d.y,b.y,r.y);E=D(C.x,d.x,b.x,r.x);s=q(C.x,d.x,b.x,r.x);B=q(C.y,d.y,b.y,r.y);return{top:v,left:E,right:s,bottom:B,width:s-E,height:B-v}},plot:function(){if(this.curved)return Two.Utils.getCurveFromPoints(this.vertices,this.closed),this;_.each(this.vertices,function(a,b){a._command=0===b?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(a){u=this.vertices.length-1;d=this.vertices[u];p=this._closed||this.vertices[u].command===Two.Commands.close;z=[];_.each(this.vertices,
function(b,c){if(!(0>=c&&!p||b.command===Two.Commands.move)){s=d.controls&&d.controls.right;E=b.controls&&b.controls.left;G=d.x;I=d.y;J=(s||d).x;L=(s||d).y;O=(E||b).x;M=(E||b).y;P=b.x;Q=b.y;var e=_.flatten(Two.Utils.subdivide(G,I,J,L,O,M,P,Q,0,a));z=z.concat(e);_.each(e,function(a,b){a.command=0>=b&&d.command===Two.Commands.move?Two.Commands.move:Two.Commands.line})}d=b},this);this._curved=this._automatic=!1;this.vertices=_.flatten(z);return this},update:function(){if(this._flagVertices)for(this._automatic&&
this.plot(),m=this.vertices.length,u=m-1,l=n(this._beginning*u),e=n(this._ending*u),this._vertices.length=0,y=l;y<e+1;y++)A=this.vertices[y],this._vertices.push(A);Two.Shape.prototype.update.call(this);return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=!1;Two.Shape.prototype.flagReset.call(this);return this}});a.MakeObservable(a.prototype)})();(function(){var D=Math.min,q=Math.max,n,f,m,l,e,u,p,A,y,z,w,t,F,g,E,s,v,B,H,c,C,d=Two.Group=function(b){Two.Shape.call(this,!0);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(d,{MakeObservable:function(b){Two.Shape.MakeObservable(b);d.MakeGetterSetter(b,Two.Polygon.Properties)},MakeGetterSetter:function(b,c){_.isArray(c)||(c=[c]);_.each(c,function(c){n="_"+c;Object.defineProperty(b,c,{get:function(){return this[n]},set:function(b){this[n]=b;_.each(this.children,
function(d){d[c]=b})}})})}});_.extend(d.prototype,Two.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,clone:function(b){b=b||this.parent;m=_.map(this.children,function(b){return b.clone()});l=new d;b.add(l);l.add(m);l.translation.copy(this.translation);l.rotation=this.rotation;l.scale=this.scale;return l},corner:function(){e=this.getBoundingClientRect(!0);
u={x:e.left,y:e.top};_.each(this.children,function(b){b.translation.subSelf(u)});return this},center:function(){e=this.getBoundingClientRect(!0);e.centroid={x:e.left+e.width/2,y:e.top+e.height/2};_.each(this.children,function(b){b.translation.subSelf(e.centroid)});return this},add:function(b){p=arguments.length;A=b;m=this.children;y=this.parent;z=this.additions;_.isArray(b)||(A=_.toArray(arguments));_.each(A,function(b){b&&(w=b.id,f=b.parent,_.isUndefined(m[w])&&(f&&(delete f.children[w],C=_.indexOf(f.additions,
w),0<=C&&f.additions.splice(C,1)),m[w]=b,b.parent=this,z.push(w),this._flagAdditions=!0))},this);return this},remove:function(b){p=arguments.length;A=b;m=this.children;y=this.parent;z=this.subtractions;if(0>=p&&y)return y.remove(this),this;_.isArray(b)||(A=_.toArray(arguments));_.each(A,function(b){w=b.id;grandchildren=b.children;f=b.parent;w in m&&(delete m[w],delete b.parent,C=_.indexOf(f.additions,w),0<=C&&f.additions.splice(C,1),z.push(w),this._flagSubtractions=!0)});return this},getBoundingClientRect:function(b){this.update();
t=Infinity;F=-Infinity;g=Infinity;E=-Infinity;_.each(this.children,function(b){e=b.getBoundingClientRect(!0);_.isNumber(e.top)&&(_.isNumber(e.left)&&_.isNumber(e.right)&&_.isNumber(e.bottom))&&(g=D(e.top,g),t=D(e.left,t),F=q(e.right,F),E=q(e.bottom,E))},this);s=b?this._matrix:Two.Utils.getComputedMatrix(this);v=s.multiply(t,g,1);B=s.multiply(F,g,1);H=s.multiply(F,E,1);c=s.multiply(t,E,1);g=D(v.y,B.y,H.y,c.y);t=D(v.x,B.x,H.x,c.x);F=q(v.x,B.x,H.x,c.x);E=q(v.y,B.y,H.y,c.y);return{top:g,left:t,right:F,
bottom:E,width:F-t,height:E-g}},noFill:function(){_.each(this.children,function(b){b.noFill()});return this},noStroke:function(){_.each(this.children,function(b){b.noStroke()});return this},subdivide:function(){var b=arguments;_.each(this.children,function(c){c.subdivide.apply(c,b)});return this},flagReset:function(){this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1);this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1);Two.Shape.prototype.flagReset.call(this);
return this}});d.MakeObservable(d.prototype)})();
