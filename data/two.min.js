(function(){var m=this,k=m._,f={},j=Array.prototype,d=Object.prototype,b=j.push,c=j.slice,n=j.concat,a=d.toString,p=d.hasOwnProperty,l=j.forEach,w=j.map,u=j.reduce,g=j.reduceRight,t=j.filter,z=j.every,v=j.some,s=j.indexOf,y=j.lastIndexOf,d=Array.isArray,r=Object.keys,q=Function.prototype.bind,e=function(h){if(h instanceof e)return h;if(!(this instanceof e))return new e(h);this._wrapped=h};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports._=
e):m._=e;e.VERSION="1.5.1";var x=e.each=e.forEach=function(h,a,b){if(null!=h)if(l&&h.forEach===l)h.forEach(a,b);else if(h.length===+h.length)for(var c=0,d=h.length;c<d&&a.call(b,h[c],c,h)!==f;c++);else for(c in h)if(e.has(h,c)&&a.call(b,h[c],c,h)===f)break};e.map=e.collect=function(h,e,a){var b=[];if(null==h)return b;if(w&&h.map===w)return h.map(e,a);x(h,function(h,c,d){b.push(e.call(a,h,c,d))});return b};e.reduce=e.foldl=e.inject=function(h,a,b,c){var d=2<arguments.length;null==h&&(h=[]);if(u&&h.reduce===
u)return c&&(a=e.bind(a,c)),d?h.reduce(a,b):h.reduce(a);x(h,function(h,e,g){d?b=a.call(c,b,h,e,g):(b=h,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return b};e.reduceRight=e.foldr=function(h,a,b,c){var d=2<arguments.length;null==h&&(h=[]);if(g&&h.reduceRight===g)return c&&(a=e.bind(a,c)),d?h.reduceRight(a,b):h.reduceRight(a);var r=h.length;if(r!==+r)var q=e.keys(h),r=q.length;x(h,function(e,g,p){g=q?q[--r]:--r;d?b=a.call(c,b,h[g],g,p):(b=h[g],d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");
return b};e.find=e.detect=function(h,e,a){var b;A(h,function(h,c,d){if(e.call(a,h,c,d))return b=h,!0});return b};e.filter=e.select=function(h,e,a){var b=[];if(null==h)return b;if(t&&h.filter===t)return h.filter(e,a);x(h,function(h,c,d){e.call(a,h,c,d)&&b.push(h)});return b};e.reject=function(h,a,b){return e.filter(h,function(h,e,c){return!a.call(b,h,e,c)},b)};e.every=e.all=function(h,a,b){a||(a=e.identity);var c=!0;if(null==h)return c;if(z&&h.every===z)return h.every(a,b);x(h,function(h,e,d){if(!(c=
c&&a.call(b,h,e,d)))return f});return!!c};var A=e.some=e.any=function(h,a,b){a||(a=e.identity);var c=!1;if(null==h)return c;if(v&&h.some===v)return h.some(a,b);x(h,function(h,e,d){if(c||(c=a.call(b,h,e,d)))return f});return!!c};e.contains=e.include=function(h,e){return null==h?!1:s&&h.indexOf===s?-1!=h.indexOf(e):A(h,function(h){return h===e})};e.invoke=function(h,a){var b=c.call(arguments,2),d=e.isFunction(a);return e.map(h,function(h){return(d?a:h[a]).apply(h,b)})};e.pluck=function(h,a){return e.map(h,
function(h){return h[a]})};e.where=function(h,a,b){return e.isEmpty(a)?b?void 0:[]:e[b?"find":"filter"](h,function(h){for(var e in a)if(a[e]!==h[e])return!1;return!0})};e.findWhere=function(h,a){return e.where(h,a,!0)};e.max=function(h,a,b){if(!a&&e.isArray(h)&&h[0]===+h[0]&&65535>h.length)return Math.max.apply(Math,h);if(!a&&e.isEmpty(h))return-Infinity;var c={computed:-Infinity,value:-Infinity};x(h,function(h,e,d){e=a?a.call(b,h,e,d):h;e>c.computed&&(c={value:h,computed:e})});return c.value};e.min=
function(h,a,b){if(!a&&e.isArray(h)&&h[0]===+h[0]&&65535>h.length)return Math.min.apply(Math,h);if(!a&&e.isEmpty(h))return Infinity;var c={computed:Infinity,value:Infinity};x(h,function(h,e,d){e=a?a.call(b,h,e,d):h;e<c.computed&&(c={value:h,computed:e})});return c.value};e.shuffle=function(h){var a,b=0,c=[];x(h,function(h){a=e.random(b++);c[b-1]=c[a];c[a]=h});return c};var C=function(h){return e.isFunction(h)?h:function(e){return e[h]}};e.sortBy=function(h,a,b){var c=C(a);return e.pluck(e.map(h,function(h,
e,a){return{value:h,index:e,criteria:c.call(b,h,e,a)}}).sort(function(h,e){var a=h.criteria,b=e.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(a<b||void 0===b)return-1}return h.index<e.index?-1:1}),"value")};var Q=function(h,a,b,c){var d={},g=C(null==a?e.identity:a);x(h,function(e,a){var r=g.call(b,e,a,h);c(d,r,e)});return d};e.groupBy=function(h,a,b){return Q(h,a,b,function(h,a,b){(e.has(h,a)?h[a]:h[a]=[]).push(b)})};e.countBy=function(h,a,b){return Q(h,a,b,function(h,a){e.has(h,a)||(h[a]=0);
h[a]++})};e.sortedIndex=function(h,a,b,c){b=null==b?e.identity:C(b);a=b.call(c,a);for(var d=0,g=h.length;d<g;){var r=d+g>>>1;b.call(c,h[r])<a?d=r+1:g=r}return d};e.toArray=function(h){return!h?[]:e.isArray(h)?c.call(h):h.length===+h.length?e.map(h,e.identity):e.values(h)};e.size=function(h){return null==h?0:h.length===+h.length?h.length:e.keys(h).length};e.first=e.head=e.take=function(h,e,a){return null==h?void 0:null!=e&&!a?c.call(h,0,e):h[0]};e.initial=function(h,e,a){return c.call(h,0,h.length-
(null==e||a?1:e))};e.last=function(h,e,a){return null==h?void 0:null!=e&&!a?c.call(h,Math.max(h.length-e,0)):h[h.length-1]};e.rest=e.tail=e.drop=function(e,a,b){return c.call(e,null==a||b?1:a)};e.compact=function(h){return e.filter(h,e.identity)};var R=function(h,a,c){if(a&&e.every(h,e.isArray))return n.apply(c,h);x(h,function(h){e.isArray(h)||e.isArguments(h)?a?b.apply(c,h):R(h,a,c):c.push(h)});return c};e.flatten=function(h,e){return R(h,e,[])};e.without=function(h){return e.difference(h,c.call(arguments,
1))};e.uniq=e.unique=function(h,a,b,c){e.isFunction(a)&&(c=b,b=a,a=!1);b=b?e.map(h,b,c):h;var d=[],g=[];x(b,function(b,c){if(a?!c||g[g.length-1]!==b:!e.contains(g,b))g.push(b),d.push(h[c])});return d};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=function(a){var b=c.call(arguments,1);return e.filter(e.uniq(a),function(a){return e.every(b,function(h){return 0<=e.indexOf(h,a)})})};e.difference=function(a){var b=n.apply(j,c.call(arguments,1));return e.filter(a,function(a){return!e.contains(b,
a)})};e.zip=function(){for(var a=e.max(e.pluck(arguments,"length").concat(0)),b=Array(a),c=0;c<a;c++)b[c]=e.pluck(arguments,""+c);return b};e.object=function(a,e){if(null==a)return{};for(var b={},c=0,d=a.length;c<d;c++)e?b[a[c]]=e[c]:b[a[c][0]]=a[c][1];return b};e.indexOf=function(a,b,c){if(null==a)return-1;var d=0,g=a.length;if(c)if("number"==typeof c)d=0>c?Math.max(0,g+c):c;else return d=e.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b,c);for(;d<g;d++)if(a[d]===b)return d;
return-1};e.lastIndexOf=function(a,e,b){if(null==a)return-1;var c=null!=b;if(y&&a.lastIndexOf===y)return c?a.lastIndexOf(e,b):a.lastIndexOf(e);for(b=c?b:a.length;b--;)if(a[b]===e)return b;return-1};e.range=function(a,e,b){1>=arguments.length&&(e=a||0,a=0);b=arguments[2]||1;for(var c=Math.max(Math.ceil((e-a)/b),0),d=0,g=Array(c);d<c;)g[d++]=a,a+=b;return g};var J=function(){};e.bind=function(a,b){var d,g;if(q&&a.bind===q)return q.apply(a,c.call(arguments,1));if(!e.isFunction(a))throw new TypeError;
d=c.call(arguments,2);return g=function(){if(!(this instanceof g))return a.apply(b,d.concat(c.call(arguments)));J.prototype=a.prototype;var e=new J;J.prototype=null;var r=a.apply(e,d.concat(c.call(arguments)));return Object(r)===r?r:e}};e.partial=function(a){var e=c.call(arguments,1);return function(){return a.apply(this,e.concat(c.call(arguments)))}};e.bindAll=function(a){var b=c.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");x(b,function(b){a[b]=e.bind(a[b],
a)});return a};e.memoize=function(a,b){var c={};b||(b=e.identity);return function(){var d=b.apply(this,arguments);return e.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};e.delay=function(a,e){var b=c.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},e)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(c.call(arguments,1)))};e.throttle=function(a,e,b){var c,d,g,r=null,q=0;b||(b={});var p=function(){q=!1===b.leading?0:new Date;r=null;g=a.apply(c,d)};return function(){var f=
new Date;!q&&!1===b.leading&&(q=f);var j=e-(f-q);c=this;d=arguments;0>=j?(clearTimeout(r),r=null,q=f,g=a.apply(c,d)):!r&&!1!==b.trailing&&(r=setTimeout(p,j));return g}};e.debounce=function(a,e,b){var c,d=null;return function(){var g=this,r=arguments,q=b&&!d;clearTimeout(d);d=setTimeout(function(){d=null;b||(c=a.apply(g,r))},e);q&&(c=a.apply(g,r));return c}};e.once=function(a){var e=!1,b;return function(){if(e)return b;e=!0;b=a.apply(this,arguments);a=null;return b}};e.wrap=function(a,e){return function(){var c=
[a];b.apply(c,arguments);return e.apply(this,c)}};e.compose=function(){var a=arguments;return function(){for(var e=arguments,b=a.length-1;0<=b;b--)e=[a[b].apply(this,e)];return e[0]}};e.after=function(a,e){return function(){if(1>--a)return e.apply(this,arguments)}};e.keys=r||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)e.has(a,c)&&b.push(c);return b};e.values=function(a){var b=[],c;for(c in a)e.has(a,c)&&b.push(a[c]);return b};e.pairs=function(a){var b=
[],c;for(c in a)e.has(a,c)&&b.push([c,a[c]]);return b};e.invert=function(a){var b={},c;for(c in a)e.has(a,c)&&(b[a[c]]=c);return b};e.functions=e.methods=function(a){var b=[],c;for(c in a)e.isFunction(a[c])&&b.push(c);return b.sort()};e.extend=function(a){x(c.call(arguments,1),function(e){if(e)for(var b in e)a[b]=e[b]});return a};e.pick=function(a){var e={},b=n.apply(j,c.call(arguments,1));x(b,function(b){b in a&&(e[b]=a[b])});return e};e.omit=function(a){var b={},d=n.apply(j,c.call(arguments,1)),
g;for(g in a)e.contains(d,g)||(b[g]=a[g]);return b};e.defaults=function(a){x(c.call(arguments,1),function(e){if(e)for(var b in e)void 0===a[b]&&(a[b]=e[b])});return a};e.clone=function(a){return!e.isObject(a)?a:e.isArray(a)?a.slice():e.extend({},a)};e.tap=function(a,e){e(a);return a};var K=function(b,c,d,g){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;b instanceof e&&(b=b._wrapped);c instanceof e&&(c=c._wrapped);var r=a.call(b);if(r!=a.call(c))return!1;switch(r){case "[object String]":return b==
String(c);case "[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case "[object Date]":case "[object Boolean]":return+b==+c;case "[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var q=d.length;q--;)if(d[q]==b)return g[q]==c;var q=b.constructor,p=c.constructor;if(q!==p&&(!e.isFunction(q)||!(q instanceof q&&e.isFunction(p)&&p instanceof p)))return!1;d.push(b);g.push(c);q=
0;p=!0;if("[object Array]"==r){if(q=b.length,p=q==c.length)for(;q--&&(p=K(b[q],c[q],d,g)););}else{for(var f in b)if(e.has(b,f)&&(q++,!(p=e.has(c,f)&&K(b[f],c[f],d,g))))break;if(p){for(f in c)if(e.has(c,f)&&!q--)break;p=!q}}d.pop();g.pop();return p};e.isEqual=function(a,e){return K(a,e,[],[])};e.isEmpty=function(a){if(null==a)return!0;if(e.isArray(a)||e.isString(a))return 0===a.length;for(var b in a)if(e.has(a,b))return!1;return!0};e.isElement=function(a){return!!(a&&1===a.nodeType)};e.isArray=d||
function(e){return"[object Array]"==a.call(e)};e.isObject=function(a){return a===Object(a)};x("Arguments Function String Number Date RegExp".split(" "),function(b){e["is"+b]=function(e){return a.call(e)=="[object "+b+"]"}});e.isArguments(arguments)||(e.isArguments=function(a){return!(!a||!e.has(a,"callee"))});"function"!==typeof/./&&(e.isFunction=function(a){return"function"===typeof a});e.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};e.isNaN=function(a){return e.isNumber(a)&&a!=
+a};e.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==a.call(e)};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.has=function(a,e){return p.call(a,e)};e.noConflict=function(){m._=k;return this};e.identity=function(a){return a};e.times=function(a,e,b){for(var c=Array(Math.max(0,a)),d=0;d<a;d++)c[d]=e.call(b,d);return c};e.random=function(a,e){null==e&&(e=a,a=0);return a+Math.floor(Math.random()*(e-a+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",
'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=e.invert(I.escape);var S={escape:RegExp("["+e.keys(I.escape).join("")+"]","g"),unescape:RegExp("("+e.keys(I.unescape).join("|")+")","g")};e.each(["escape","unescape"],function(a){e[a]=function(e){return null==e?"":(""+e).replace(S[a],function(e){return I[a][e]})}});e.result=function(a,b){if(null!=a){var c=a[b];return e.isFunction(c)?c.call(a):c}};e.mixin=function(a){x(e.functions(a),function(c){var d=e[c]=a[c];e.prototype[c]=function(){var a=[this._wrapped];
b.apply(a,arguments);a=d.apply(e,a);return this._chain?e(a).chain():a}})};var T=0;e.uniqueId=function(a){var e=++T+"";return a?a+e:e};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\t|\u2028|\u2029/g;e.template=function(a,b,c){var d;c=e.defaults({},c,e.templateSettings);var g=RegExp([(c.escape||L).source,(c.interpolate||L).source,(c.evaluate||
L).source].join("|")+"|$","g"),r=0,q="__p+='";a.replace(g,function(e,b,c,d,g){q+=a.slice(r,g).replace(F,function(a){return"\\"+U[a]});b&&(q+="'+\n((__t=("+b+"))==null?'':_.escape(__t))+\n'");c&&(q+="'+\n((__t=("+c+"))==null?'':__t)+\n'");d&&(q+="';\n"+d+"\n__p+='");r=g+e.length;return e});q+="';\n";c.variable||(q="with(obj||{}){\n"+q+"}\n");q="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+q+"return __p;\n";try{d=new Function(c.variable||"obj","_",q)}catch(p){throw p.source=
q,p;}if(b)return d(b,e);b=function(a){return d.call(this,a,e)};b.source="function("+(c.variable||"obj")+"){\n"+q+"}";return b};e.chain=function(a){return e(a).chain()};e.mixin(e);x("pop push reverse shift sort splice unshift".split(" "),function(a){var b=j[a];e.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);("shift"==a||"splice"==a)&&0===c.length&&delete c[0];return this._chain?e(c).chain():c}});x(["concat","join","slice"],function(a){var b=j[a];e.prototype[a]=function(){var a=b.apply(this._wrapped,
arguments);return this._chain?e(a).chain():a}});e.extend(e.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};
(function(){var m=[].slice,k=function(f,d,b){var c;f=-1;var n=d.length;switch(b.length){case 0:for(;++f<n;)(c=d[f]).callback.call(c.ctx);break;case 1:for(;++f<n;)(c=d[f]).callback.call(c.ctx,b[0]);break;case 2:for(;++f<n;)(c=d[f]).callback.call(c.ctx,b[0],b[1]);break;case 3:for(;++f<n;)(c=d[f]).callback.call(c.ctx,b[0],b[1],b[2]);break;default:for(;++f<n;)(c=d[f]).callback.apply(c.ctx,b)}},f=Backbone.Events={on:function(f,d,b){this._events||(this._events={});(this._events[f]||(this._events[f]=[])).push({callback:d,
context:b,ctx:b||this});return this},once:function(f,d,b){var c=this,n=_.once(function(){c.off(f,n);d.apply(this,arguments)});n._callback=d;this.on(f,n,b);return this},off:function(f,d,b){var c,n,a,p,l,w,u,g;if(!this._events)return this;if(!f&&!d&&!b)return this._events={},this;p=f?[f]:_.keys(this._events);l=0;for(w=p.length;l<w;l++)if(f=p[l],c=this._events[f]){a=[];if(d||b){u=0;for(g=c.length;u<g;u++)n=c[u],(d&&d!==(n.callback._callback||n.callback)||b&&b!==n.context)&&a.push(n)}this._events[f]=
a}return this},trigger:function(f){if(!this._events)return this;var d=m.call(arguments,1),b=this._events[f],c=this._events.all;b&&k(this,b,d);c&&k(this,c,arguments);return this},listenTo:function(f,d,b){var c=this._listeners||(this._listeners={}),n=f._listenerId||(f._listenerId=_.uniqueId("l"));c[n]=f;f.on(d,b||this,this);return this},stopListening:function(f,d,b){var c=this._listeners;if(c){if(f)f.off(d,b,this),!d&&!b&&delete c[f._listenerId];else{for(var n in c)c[n].off(null,null,this);this._listeners=
{}}return this}}};f.bind=f.on;f.unbind=f.off;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports&&(exports=module.exports=f),exports.Backbone=exports.Backbone||Backbone)})();(function(){function m(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-f)),a=k.setTimeout(function(){b(c+d)},d);f=c+d;return a}var k=this,f=0,j=["ms","moz","webkit","o"];if("undefined"!==typeof exports)"undefined"!==typeof module&&module.exports&&(exports=module.exports=m),exports.requestAnimationFrame=m;else{for(var d=0;d<j.length&&!k.requestAnimationFrame;++d)k.requestAnimationFrame=k[j[d]+"RequestAnimationFrame"],k.cancelAnimationFrame=k[j[d]+"CancelAnimationFrame"]||k[j[d]+"CancelRequestAnimationFrame"];
k.requestAnimationFrame||(k.requestAnimationFrame=m);k.cancelAnimationFrame||(k.cancelAnimationFrame=function(b){clearTimeout(b)})}})();(function(){function m(){var a=document.body.getBoundingClientRect(),b=this.width=a.width,a=this.height=a.height;this.renderer.setSize(b,a);this.trigger(g.Events.resize,b,a)}var k=this,f=k.Two||{},j=Math.sin,d=Math.cos,b=Math.atan2,c=Math.sqrt,n=Math.abs,a=Math.PI,p=2*a,l=a/2,w=Math.pow,u={hasEventListeners:_.isFunction(k.addEventListener),bind:function(a,b,e,c){this.hasEventListeners?a.addEventListener(b,e,!!c):a.attachEvent("on"+b,e);return this},unbind:function(a,b,e,c){this.hasEventListeners?
a.removeEventListeners(b,e,!!c):a.detachEvent("on"+b,e);return this}},g=k.Two=function(a){a=_.defaults(a||{},{fullscreen:!1,width:640,height:480,type:g.Types.svg,autostart:!1});this.type=a.type;this.renderer=new g[this.type](this);g.Utils.setPlaying.call(this,a.autostart);this.frameCount=0;a.fullscreen?(a=_.bind(m,this),_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),_.extend(this.renderer.domElement.style,{display:"block",top:0,
left:0,right:0,bottom:0,position:"fixed"}),u.bind(k,"resize",a),a()):(this.renderer.setSize(a.width,a.height),this.width=a.width,this.height=a.height);this.scene=new g.Group;this.renderer.add(this.scene);g.Instances.push(this)};_.extend(g,{Array:k.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.2.1",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",
remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C"},Resolution:8,Instances:[],noConflict:function(){k.Two=f;return this},Utils:{Curve:{CollinearityEpsilon:w(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},setPlaying:function(a){_.defer(_.bind(function(){this.playing=!!a},this))},getComputedMatrix:function(a){for(var b=new g.Matrix;a&&a._matrix;){var e=a._matrix.elements;b.multiply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9]);a=a.parent}return b},
applySvgAttributes:function(a,b){b.cap="butt";b.join="bevel";_.each(a.attributes,function(a){switch(a.nodeName){case "visibility":b.visible=!!a.nodeValue;break;case "stroke-linecap":b.cap=a.nodeValue;break;case "stroke-linejoin":b.join=a.nodeValue;break;case "stroke-miterlimit":b.miter=a.nodeValue;break;case "stroke-width":b.linewidth=parseFloat(a.nodeValue);break;case "stroke-opacity":case "fill-opacity":b.opacity=a.nodeValue;break;case "fill":b.fill=a.nodeValue;break;case "stroke":b.stroke=a.nodeValue}});
return b},read:{svg:function(){return g.Utils.read.g.apply(this,arguments)},g:function(a){var b=new g.Group;this.add(b);_.each(a.childNodes,function(a){if(a.localName){var c=a.localName.toLowerCase();c in g.Utils.read&&(a=g.Utils.read[c].call(this,a),b.add(a))}},this);return g.Utils.applySvgAttributes(a,b)},polygon:function(a,b){var e=a.points;if(e){var c=_.map(_.range(e.numberOfItems),function(a){a=e.getItem(a);return new g.Point(a.x,a.y)}),c=(new g.Polygon(c,!b)).noStroke();return g.Utils.applySvgAttributes(a,
c)}},polyline:function(a){return g.Utils.read.polygon(a,!0)},path:function(a){var b=a.getAttribute("d"),b=_.flatten(_.map(_.compact(b.split(/M/g)),function(a){a=_.map(_.compact(a.split(/m/g)),function(a,b){return 0>=b?a:"m"+a});a[0]="M"+a[0];return a})),e=new g.Vector,c=new g.Vector,b=_.map(b,function(b){var d,f=!1,p=!1;b=_.flatten(_.map(b.match(/[a-z][^a-z]*/ig),function(a){var b,q,r=a[0],l=r.toLowerCase();d=a.slice(1).trim().split(/[\s,]+|(?=[+\-])/);f=r===l;var n,j,w;switch(l){case "z":p=!0;break;
case "m":case "l":q=parseFloat(d[0]);b=parseFloat(d[1]);b=new g.Point(q,b);f&&b.addSelf(e);e.copy(b);break;case "h":case "v":q="h"===l?"x":"y";a="x"===q?"y":"x";b=new g.Point;b[q]=parseFloat(d[0]);b[a]=e[a];f&&(b[q]+=e[q]);e.copy(b);break;case "s":case "c":b=e.x;a=e.y;"c"===l?(r=parseFloat(d[0]),q=parseFloat(d[1]),l=parseFloat(d[2]),n=parseFloat(d[3]),j=parseFloat(d[4]),w=parseFloat(d[5])):(n=g.Utils.getReflection(e,c,f),r=n.x,q=n.y,l=parseFloat(d[0]),n=parseFloat(d[1]),j=parseFloat(d[2]),w=parseFloat(d[3]));
f&&(r+=b,q+=a,l+=b,n+=a,j+=b,w+=a);b=g.Utils.subdivide(b,a,r,q,l,n,j,w);e.set(j,w);c.set(l,n);(q=b[b.length-1])&&!q.equals(e)&&b.push(e.clone());break;case "t":case "q":b=e.x;a=e.y;c.isZero()?(r=b,q=a):(r=c.x,a=c.y);"q"===l?(l=parseFloat(d[0]),n=parseFloat(d[1]),j=parseFloat(d[1]),w=parseFloat(d[2])):(n=g.Utils.getReflection(e,c,f),l=n.x,n=n.y,j=parseFloat(d[0]),w=parseFloat(d[1]));f&&(r+=b,q+=a,l+=b,n+=a,j+=b,w+=a);b=g.Utils.subdivide(b,a,r,q,l,n,j,w);e.set(j,w);c.set(l,n);q=b[b.length-1];q.equals(e)||
b.push(e.clone());break;case "a":throw new g.Utils.Error("not yet able to interpret Elliptical Arcs.");}return b}));if(!(1>=b.length))return b=_.compact(b),b=(new g.Polygon(b,p)).noStroke(),g.Utils.applySvgAttributes(a,b)});return _.compact(b)},circle:function(a){var b=parseFloat(a.getAttribute("cx")),e=parseFloat(a.getAttribute("cy")),c=parseFloat(a.getAttribute("r")),f=g.Resolution,l=_.map(_.range(f),function(a){var b=a/f*p;a=c*d(b);b=c*j(b);return new g.Point(a,b)},this),l=(new g.Polygon(l,!0,
!0)).noStroke();l.translation.set(b,e);return g.Utils.applySvgAttributes(a,l)},ellipse:function(a){var b=parseFloat(a.getAttribute("cx")),e=parseFloat(a.getAttribute("cy")),c=parseFloat(a.getAttribute("rx")),f=parseFloat(a.getAttribute("ry")),l=g.Resolution,n=_.map(_.range(l),function(a){var b=a/l*p;a=c*d(b);b=f*j(b);return new g.Point(a,b)},this),n=(new g.Polygon(n,!0,!0)).noStroke();n.translation.set(b,e);return g.Utils.applySvgAttributes(a,n)},rect:function(a){var b=parseFloat(a.getAttribute("x")),
e=parseFloat(a.getAttribute("y")),c=parseFloat(a.getAttribute("width")),d=parseFloat(a.getAttribute("height")),c=c/2,d=d/2,f=[new g.Point(c,d),new g.Point(-c,d),new g.Point(-c,-d),new g.Point(c,-d)],f=(new g.Polygon(f,!0)).noStroke();f.translation.set(b+c,e+d);return g.Utils.applySvgAttributes(a,f)},line:function(a){var b=parseFloat(a.getAttribute("x1")),e=parseFloat(a.getAttribute("y1")),c=parseFloat(a.getAttribute("x2")),d=parseFloat(a.getAttribute("y2")),c=(c-b)/2,d=(d-e)/2,f=[new g.Point(-c,-d),
new g.Point(c,d)],f=(new g.Polygon(f)).noFill();f.translation.set(b+c,e+d);return g.Utils.applySvgAttributes(a,f)}},subdivide:function(c,d,e,f,l,j,w,u,k){var t=g.Utils.Curve.CollinearityEpsilon,z=g.Utils.Curve.RecursionLimit,v=g.Utils.Curve.CuspLimit,s=g.Utils.Curve.Tolerance,m;k=k||0;if(k>z)return[];var z=(c+e)/2,y=(d+f)/2,F=(e+l)/2,h=(f+j)/2,M=(l+w)/2,N=(j+u)/2,O=(z+F)/2,P=(y+h)/2,F=(F+M)/2,h=(h+N)/2,D=(O+F)/2,E=(P+h)/2;m=w-c;var B=u-d,G=n((e-w)*B-(f-u)*m),H=n((l-w)*B-(j-u)*m);if(0<k){if(G>t&&H>
t&&(G+H)*(G+H)<=s.distance*(m*m+B*B)){if(s.angle<s.epsilon)return[new g.Vector(D,E)];m=b(j-f,l-e);t=n(m-b(f-d,e-c));m=n(b(u-j,w-l)-m);t>=a&&(t=p-t);m>=a&&(m=p-m);if(t+m<s.angle)return[new g.Vector(D,E)];if(0!==v){if(t>v)return[new g.Vector(e,f)];if(m>v)return[new g.Vector(l,j)]}}}else if(G>t)if(G*G<=s.distance*(m*m+B*B)){if(s.angle<s.epsilon)return[new g.Vector(D,E)];t=n(b(j-f,l-e)-b(f-d,e-c));t>=a&&(t=p-t);if(t<s.angle)return[new g.Vector(e,f),new g.Vector(l,j)];if(0!==v&&t>v)return[new g.Vector(e,
f)]}else if(H>t){if(H*H<=s.distance*(m*m+B*B)){if(s.angle<s.epsilon)return[new g.Vector(D,E)];t=n(b(u-j,w-l)-b(j-f,l-e));t>=a&&(t=p-t);if(t<s.angle)return[new g.Vector(e,f),new g.Vector(l,j)];if(0!==v&&t>v)return[new g.Vector2(l,j)]}}else if(m=D-(c+w)/2,B=E-(d+u)/2,m*m+B*B<=s.distance)return[new g.Vector(D,E)];return g.Utils.subdivide(c,d,z,y,O,P,D,E,k+1).concat(g.Utils.subdivide(D,E,F,h,M,N,w,u,k+1))},getCurveFromPoints:function(a,b){for(var e=a.length,c=e-1,d=0;d<e;d++){var f=a[d],p=b?y(d-1,e):
Math.max(d-1,0),l=b?y(d+1,e):Math.min(d+1,c);s(a[p],f,a[l]);f._command=0===d?g.Commands.move:g.Commands.curve;f.u.x=_.isNumber(f.u.x)?f.u.x:f.x;f.u.y=_.isNumber(f.u.y)?f.u.y:f.y;f.v.x=_.isNumber(f.v.x)?f.v.x:f.x;f.v.y=_.isNumber(f.v.y)?f.v.y:f.y}},getControlPoints:function(b,c,e){var f=v(b,c),p=v(e,c);b=t(b,c);e=t(e,c);var n=(f+p)/2;c.u=_.isObject(c.u)?c.u:new g.Vector(c.x,c.y);c.v=_.isObject(c.v)?c.v:new g.Vector(c.x,c.y);if(1E-4>b||1E-4>e)return c.u.copy(c),c.v.copy(c),c;b*=0.33;e*=0.33;n=p<f?n+
l:n-l;c.u.x=c.x+d(n)*b;c.u.y=c.y+j(n)*b;n-=a;c.v.x=c.x+d(n)*e;c.v.y=c.y+j(n)*e;return c},getReflection:function(a,b,e){var c=a.distanceTo(b);if(1E-4>=c)return e?new g.Vector:a.clone();b=v(a,b);return new g.Vector(c*Math.cos(b)+(e?0:a.x),c*Math.sin(b)+(e?0:a.y))},angleBetween:function(a,c){return b(a.y-c.y,a.x-c.x)},distanceBetweenSquared:function(a,b){var e=a.x-b.x,c=a.y-b.y;return e*e+c*c},distanceBetween:function(a,b){return c(z(a,b))},mod:function(a,b){for(;0>a;)a+=b;return a%b},Collection:function(){Array.call(this);
1<arguments.length?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(a){this.name="two.js";this.message=a}}});g.Utils.Error.prototype=Error();g.Utils.Error.prototype.constructor=g.Utils.Error;g.Utils.Collection.prototype=[];g.Utils.Collection.constructor=g.Utils.Collection;_.extend(g.Utils.Collection.prototype,Backbone.Events,{pop:function(){var a=Array.prototype.pop.apply(this,arguments);this.trigger(g.Events.remove,
[a]);return a},shift:function(){var a=Array.prototype.shift.apply(this,arguments);this.trigger(g.Events.remove,[a]);return a},push:function(){var a=Array.prototype.push.apply(this,arguments);this.trigger(g.Events.insert,arguments);return a},unshift:function(){var a=Array.prototype.unshift.apply(this,arguments);this.trigger(g.Events.insert,arguments);return a},splice:function(){var a=Array.prototype.splice.apply(this,arguments),b;this.trigger(g.Events.remove,a);2<arguments.length&&(b=this.slice(arguments[0],
arguments.length-2),this.trigger(g.Events.insert,b));return a}});var t=g.Utils.distanceBetween,z=g.Utils.distanceBetweenSquared,v=g.Utils.angleBetween,s=g.Utils.getControlPoints,y=g.Utils.mod;_.extend(g.prototype,Backbone.Events,{appendTo:function(a){a.appendChild(this.renderer.domElement);return this},play:function(){g.Utils.setPlaying.call(this,!0);return this.trigger(g.Events.play)},pause:function(){this.playing=!1;return this.trigger(g.Events.pause)},update:function(){_.defer(_.bind(function(){var a=
!!this._lastFrame,b=(k.performance&&k.performance.now?k.performance:Date).now();this.frameCount++;a&&(this.timeDelta=parseFloat((b-this._lastFrame).toFixed(3)));this._lastFrame=b;var a=this.width,b=this.height,c=this.renderer;(a!==c.width||b!==c.height)&&c.setSize(a,b);this.trigger(g.Events.update,this.frameCount,this.timeDelta);this.render()},this));return this},render:function(){this.renderer.render();return this.trigger(g.Events.render,this.frameCount)},add:function(a){var b=a;_.isArray(a)||(b=
_.toArray(arguments));this.scene.add(b);return this},remove:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));this.scene.remove(b);return this},clear:function(){_.each(this.scene.children,function(a){a.remove()});return this},makeLine:function(a,b,c,d){c=(c-a)/2;d=(d-b)/2;var f=[new g.Point(-c,-d),new g.Point(c,d)],f=(new g.Polygon(f)).noFill();f.translation.set(a+c,b+d);this.scene.add(f);return f},makeRectangle:function(a,b,c,d){c/=2;d/=2;d=[new g.Point(c,d),new g.Point(-c,d),new g.Point(-c,
-d),new g.Point(c,-d)];d=new g.Polygon(d,!0);d.translation.set(a,b);this.scene.add(d);return d},makeCircle:function(a,b,c){return this.makeEllipse(a,b,c,c)},makeEllipse:function(a,b,c,f){var l=g.Resolution,n=_.map(_.range(l),function(a){var b=a/l*p;a=c*d(b);b=f*j(b);return new g.Point(a,b)},this),n=new g.Polygon(n,!0,!0);n.translation.set(a,b);this.scene.add(n);return n},makeCurve:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],d=0;d<b;d+=2){var f=arguments[d];if(!_.isNumber(f))break;
c.push(new g.Point(f,arguments[d+1]))}var b=arguments[b-1],c=new g.Polygon(c,!(_.isBoolean(b)&&b),!0),b=c.getBoundingClientRect(),p=b.left+b.width/2,l=b.top+b.height/2;_.each(c.vertices,function(a){a.x-=p;a.y-=l});c.translation.set(p,l);this.scene.add(c);return c},makePolygon:function(a){var b=arguments.length,c=a;if(!_.isArray(a))for(var c=[],d=0;d<b;d+=2){var f=arguments[d];if(!_.isNumber(f))break;c.push(new g.Point(f,arguments[d+1]))}b=arguments[b-1];c=new g.Polygon(c,!(_.isBoolean(b)&&b));b=c.getBoundingClientRect();
c.center().translation.set(b.left+b.width/2,b.top+b.height/2);this.scene.add(c);return c},makeGroup:function(a){var b=a;_.isArray(a)||(b=_.toArray(arguments));var c=new g.Group;this.scene.add(c);c.add(b);return c},interpret:function(a){var b=a.tagName.toLowerCase();if(!(b in g.Utils.read))return null;a=g.Utils.read[b].call(this,a);this.add(a);return a}});(function(){_.each(g.Instances,function(a){a.playing&&a.update()});requestAnimationFrame(arguments.callee)})();"function"===typeof define&&define.amd?
define(function(){return g}):"undefined"!=typeof module&&module.exports&&(module.exports=g)})();(function(){var m=Two.Vector=function(f,j){this.x=f||0;this.y=j||0};_.extend(m,{MakeGetterSetter:function(f,j,d){var b="_"+j;Object.defineProperty(f,j,{get:function(){return this[b]},set:function(c){this[b]=c;this.trigger(Two.Events.change,j)}});f[b]=d}});_.extend(m.prototype,Backbone.Events,{set:function(f,j){this.x=f;this.y=j;return this},copy:function(f){this.x=f.x;this.y=f.y;return this},clear:function(){this.y=this.x=0;return this},clone:function(){return new m(this.x,this.y)},add:function(f,
j){this.x=f.x+j.x;this.y=f.y+j.y;return this},addSelf:function(f){this.x+=f.x;this.y+=f.y;return this},sub:function(f,j){this.x=f.x-j.x;this.y=f.y-j.y;return this},subSelf:function(f){this.x-=f.x;this.y-=f.y;return this},multiplySelf:function(f){this.x*=f.x;this.y*=f.y;return this},multiplyScalar:function(f){this.x*=f;this.y*=f;return this},divideScalar:function(f){f?(this.x/=f,this.y/=f):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(f){return this.x*f.x+
this.y*f.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(f){return Math.sqrt(this.distanceToSquared(f))},distanceToSquared:function(f){var j=this.x-f.x;f=this.y-f.y;return j*j+f*f},setLength:function(f){return this.normalize().multiplyScalar(f)},equals:function(f){return 1E-4>this.distanceTo(f)},lerp:function(f,j){return this.set((f.x-this.x)*
j+this.x,(f.y-this.y)*j+this.y)},isZero:function(){return 1E-4>this.length()}});var k={set:function(f,j){this._x=f;this._y=j;return this.trigger(Two.Events.change)},copy:function(f){this._x=f.x;this._y=f.y;return this.trigger(Two.Events.change)},clear:function(){this._y=this._x=0;return this.trigger(Two.Events.change)},clone:function(){return new m(this._x,this._y)},add:function(f,j){this._x=f.x+j.x;this._y=f.y+j.y;return this.trigger(Two.Events.change)},addSelf:function(f){this._x+=f.x;this._y+=
f.y;return this.trigger(Two.Events.change)},sub:function(f,j){this._x=f.x-j.x;this._y=f.y-j.y;return this.trigger(Two.Events.change)},subSelf:function(f){this._x-=f.x;this._y-=f.y;return this.trigger(Two.Events.change)},multiplySelf:function(f){this._x*=f.x;this._y*=f.y;return this.trigger(Two.Events.change)},multiplyScalar:function(f){this._x*=f;this._y*=f;return this.trigger(Two.Events.change)},divideScalar:function(f){return f?(this._x/=f,this._y/=f,this.trigger(Two.Events.change)):this.clear()},
negate:function(){return this.multiplyScalar(-1)},dot:function(f){return this._x*f.x+this._y*f.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(f){return Math.sqrt(this.distanceToSquared(f))},distanceToSquared:function(f){var j=this._x-f.x;f=this._y-f.y;return j*j+f*f},setLength:function(f){return this.normalize().multiplyScalar(f)},equals:function(f){return 1E-4>
this.distanceTo(f)},lerp:function(f,j){return this.set((f.x-this._x)*j+this._x,(f.y-this._y)*j+this._y)},isZero:function(){return 1E-4>this.length()}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){this._bound||(Two.Vector.MakeGetterSetter(this,"x",this.x),Two.Vector.MakeGetterSetter(this,"y",this.y),_.extend(this,k),this._bound=!0);Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var m=Two.Point=function(k,f,j,d,b,c){Two.Vector.call(this,k,f);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(b){this._command=b;return this.trigger(Two.Events.change)}});this.command=Two.Commands.move;this.u=new Two.Vector(_.isNumber(j)?j:k,_.isNumber(d)?d:f);this.v=new Two.Vector(_.isNumber(b)?b:k,_.isNumber(c)?c:f)};_.extend(m.prototype,Two.Vector.prototype,{})})();(function(){_.range(6);var m=Math.cos,k=Math.sin,f=Math.tan,j=Two.Matrix=function(d,b,c,f,a,p){this.elements=new Two.Array(9);var l=d;_.isArray(l)||(l=_.toArray(arguments));this.identity().set(l)};_.extend(j,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(d,b){if(3>=b.length){var c=b[0]||0,f=b[1]||0,a=b[2]||0;return{x:d[0]*c+d[1]*f+d[2]*a,y:d[3]*c+d[4]*f+d[5]*a,z:d[6]*c+d[7]*f+d[8]*a}}var c=d[0],f=d[1],a=d[2],p=d[3],l=d[4],j=d[5],u=d[6],g=d[7],k=d[8],m=b[0],v=b[1],s=b[2],y=b[3],r=b[4],q=b[5],e=b[6],
x=b[7],A=b[8];return[c*m+f*y+a*e,c*v+f*r+a*x,c*s+f*q+a*A,p*m+l*y+j*e,p*v+l*r+j*x,p*s+l*q+j*A,u*m+g*y+k*e,u*v+g*r+k*x,u*s+g*q+k*A]}});_.extend(j.prototype,Backbone.Events,{set:function(d,b,c,f,a,p){var l=d;_.isArray(l)||(l=_.toArray(arguments));_.each(l,function(a,b){_.isNumber(a)&&(this.elements[b]=a)},this);return this.trigger(Two.Events.change)},identity:function(){this.set(j.Identity);return this},multiply:function(d,b,c,f,a,p,l,j,u){var g=arguments,k=g.length;if(1>=k)return _.each(this.elements,
function(a,b){this.elements[b]=a*d},this),this.trigger(Two.Events.change);if(3>=k)return d=d||0,b=b||0,c=c||0,a=this.elements,{x:a[0]*d+a[1]*b+a[2]*c,y:a[3]*d+a[4]*b+a[5]*c,z:a[6]*d+a[7]*b+a[8]*c};k=this.elements;A0=k[0];A1=k[1];A2=k[2];A3=k[3];A4=k[4];A5=k[5];A6=k[6];A7=k[7];A8=k[8];B0=g[0];B1=g[1];B2=g[2];B3=g[3];B4=g[4];B5=g[5];B6=g[6];B7=g[7];B8=g[8];this.elements[0]=A0*B0+A1*B3+A2*B6;this.elements[1]=A0*B1+A1*B4+A2*B7;this.elements[2]=A0*B2+A1*B5+A2*B8;this.elements[3]=A3*B0+A4*B3+A5*B6;this.elements[4]=
A3*B1+A4*B4+A5*B7;this.elements[5]=A3*B2+A4*B5+A5*B8;this.elements[6]=A6*B0+A7*B3+A8*B6;this.elements[7]=A6*B1+A7*B4+A8*B7;this.elements[8]=A6*B2+A7*B5+A8*B8;return this.trigger(Two.Events.change)},inverse:function(d){var b=this.elements;d=d||new Two.Matrix;var c=b[0],f=b[1],a=b[2],p=b[3],l=b[4],j=b[5],k=b[6],g=b[7],b=b[8],t=b*l-j*g,m=-b*p+j*k,v=g*p-l*k,s=c*t+f*m+a*v;if(!s)return null;s=1/s;d.elements[0]=t*s;d.elements[1]=(-b*f+a*g)*s;d.elements[2]=(j*f-a*l)*s;d.elements[3]=m*s;d.elements[4]=(b*c-
a*k)*s;d.elements[5]=(-j*c+a*p)*s;d.elements[6]=v*s;d.elements[7]=(-g*c+f*k)*s;d.elements[8]=(l*c-f*p)*s;return d},scale:function(d,b){1>=arguments.length&&(b=d);return this.multiply(d,0,0,0,b,0,0,0,1)},rotate:function(d){var b=m(d);d=k(d);return this.multiply(b,-d,0,d,b,0,0,0,1)},translate:function(d,b){return this.multiply(1,0,d,0,1,b,0,0,1)},skewX:function(d){d=f(d);return this.multiply(1,d,0,0,1,0,0,0,1)},skewY:function(d){d=f(d);return this.multiply(1,0,0,d,1,0,0,0,1)},toString:function(){return this.toArray().join(" ")},
toArray:function(d){var b=this.elements,c=parseFloat(b[0].toFixed(3)),f=parseFloat(b[1].toFixed(3)),a=parseFloat(b[2].toFixed(3)),p=parseFloat(b[3].toFixed(3)),l=parseFloat(b[4].toFixed(3)),j=parseFloat(b[5].toFixed(3));if(d){d=parseFloat(b[6].toFixed(3));var k=parseFloat(b[7].toFixed(3)),b=parseFloat(b[8].toFixed(3));return[c,p,d,f,l,k,a,j,b]}return[c,p,f,l,a,j]},clone:function(){return new Two.Matrix(this.elements[0],this.elements[1],this.elements[2],this.elements[3],this.elements[4],this.elements[5],
this.elements[6],this.elements[7],this.elements[8])}})})();(function(){function m(d){var b={},c=d.id,n=d.translation,a=d.rotation,p=d.scale,l=d.stroke,k=d.linewidth,u=d.fill,g=d.opacity,t=d.visible,m=d.cap,v=d.join,s=d.miter,y=d.closed,r=d.vertices;c&&(b.id=j.Identifier+c);n&&(_.isNumber(p)&&_.isNumber(a))&&(b.transform="matrix("+d._matrix.toString()+")");l&&(b.stroke=l);u&&(b.fill=u);g&&(b["stroke-opacity"]=b["fill-opacity"]=g);b.visibility=t?"visible":"hidden";m&&(b["stroke-linecap"]=m);v&&(b["stroke-linejoin"]=v);s&&(b["stroke-miterlimit"]=s);k&&(b["stroke-width"]=
k);r&&(b.d=f.toString(r,y));return b}var k=Two.Utils.mod,f={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(d,b){var c=document.createElementNS(this.ns,d);"svg"===d&&(b=_.defaults(b||{},{version:this.version}));_.isObject(b)&&this.setAttributes(c,b);return c},setAttributes:function(d,b){_.each(b,function(b,d){this.setAttribute(d,b)},d);return this},removeAttributes:function(d,b){_.each(b,function(b){this.removeAttribute(b)},d);return this},toString:function(d,
b){var c=d.length,f=c-1;return _.map(d,function(a,p){var l,j=b?k(p-1,c):Math.max(p-1,0),u=b?k(p+1,c):Math.min(p+1,f);l=d[j];var u=d[u],g,t,m,v=a.x.toFixed(3),s=a.y.toFixed(3);switch(a._command){case Two.Commands.curve:j=l.v.x.toFixed(3);g=l.v.y.toFixed(3);t=a.u.x.toFixed(3);m=a.u.y.toFixed(3);l=a._command+" "+j+" "+g+" "+t+" "+m+" "+v+" "+s;break;default:l=(a._command||(0===p?Two.Commands.move:Two.Commands.line))+" "+v+" "+s}p>=f&&b&&(a._command===Two.Commands.curve&&(j=a.v.x.toFixed(3),g=a.v.y.toFixed(3),
t=u.u.x.toFixed(3),m=u.u.y.toFixed(3),v=u.x.toFixed(3),s=u.y.toFixed(3),l+=" C "+j+" "+g+" "+t+" "+m+" "+v+" "+s),l+=" Z");return l}).join(" ")}},j=Two[Two.Types.svg]=function(){this.count=0;this.domElement=f.createElement("svg");this.elements=[];this.domElement.style.visibility="hidden";this.unveil=_.once(_.bind(function(){this.domElement.style.visibility="visible"},this))};_.extend(j,{Identifier:"two-",Utils:f});_.extend(j.prototype,Backbone.Events,{setSize:function(d,b){this.width=d;this.height=
b;f.setAttributes(this.domElement,{width:d,height:b});return this},add:function(d){var b=d,c=this.elements,j=this.domElement;_.isArray(d)||(b=_.map(arguments,function(a){return a}));_.each(b,function(a){var b;b=a instanceof Two.Group;if(_.isUndefined(a.id)){var d=this.count;this.count++;a.id=d}b?(b="g",_.isUndefined(a.parent)&&(a.parent=this,a.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this))),a=m(a),delete a.stroke,delete a.fill,delete a["fill-opacity"],delete a["stroke-opacity"],
delete a["stroke-linecap"],delete a["stroke-linejoin"],delete a["stroke-miterlimit"],delete a["stroke-width"]):(b="path",a=m(a));a=f.createElement(b,a);j.appendChild(a);c.push(a)},this);return this},update:function(d,b,c,j){var a=this.elements,p=a[d];switch(b){case Two.Properties.hierarchy:_.each(c,function(b){p.appendChild(a[b])});break;case Two.Properties.demotion:_.each(c,function(b){p.removeChild(a[b])});break;default:a:{d=b;switch(d){case "matrix":d="transform";c="matrix("+c.toString()+")";break;
case "visible":d="visibility";c=c?"visible":"hidden";break;case "cap":d="stroke-linecap";break;case "join":d="stroke-linejoin";break;case "miter":d="stroke-miterlimit";break;case "linewidth":d="stroke-width";break;case "vertices":d="d";c=f.toString(c,j);break;case "opacity":f.setAttributes(p,{"stroke-opacity":c,"fill-opacity":c});break a}p.setAttribute(d,c)}}return this},render:function(){this.unveil();return this}})})();(function(){var m=Two.Utils.mod,k=function(b){_.each(b,function(b,d){this[d]=b},this);this.children=[]};_.extend(k.prototype,{appendChild:function(b){var c=b.parent;_.isUndefined(c)||c.removeChild(b);this.children.push(b);b.parent=this;return this},removeChild:function(b){b=_.indexOf(this.children,b);return 0>b?this:this.children.splice(b,1)[0]},render:function(b){var c=this.matrix;b.save();b.transform(c[0],c[1],c[2],c[3],c[4],c[5]);_.each(this.children,function(c){c.render(b)});b.restore();return this}});
var f=function(b){_.each(b,function(b,d){this[d]=b},this)};_.extend(f.prototype,{render:function(b){var c=this.matrix,d=this.stroke,a=this.linewidth,f=this.fill,l=this.opacity,j=this.cap,k=this.join,g=this.miter,t=this.closed,z=this.commands,v=z.length,s=v-1;if(!this.visible)return this;b.save();c&&b.transform(c[0],c[1],c[2],c[3],c[4],c[5]);f&&(b.fillStyle=f);d&&(b.strokeStyle=d);a&&(b.lineWidth=a);g&&(b.miterLimit=g);k&&(b.lineJoin=k);j&&(b.lineCap=j);_.isNumber(l)&&(b.globalAlpha=l);b.beginPath();
_.each(z,function(a,c){var d,e,f,g,p,l=a.x.toFixed(3),j=a.y.toFixed(3);switch(a._command){case Two.Commands.curve:e=t?m(c-1,v):Math.max(c-1,0);d=t?m(c+1,v):Math.min(c+1,s);f=z[e];d=z[d];e=f.v.x.toFixed(3);p=f.v.y.toFixed(3);f=a.u.x.toFixed(3);g=a.u.y.toFixed(3);b.bezierCurveTo(e,p,f,g,l,j);c>=s&&t&&(e=a.v.x.toFixed(3),p=a.v.y.toFixed(3),f=d.u.x.toFixed(3),g=d.u.y.toFixed(3),l=d.x.toFixed(3),j=d.y.toFixed(3),b.bezierCurveTo(e,p,f,g,l,j));break;case Two.Commands.line:b.lineTo(l,j);break;case Two.Commands.move:b.moveTo(l,
j)}});t&&b.closePath();b.fill();b.stroke();b.restore()}});var j={devicePixelRatio:this.devicePixelRatio||1,getBackingStoreRatio:function(b){return b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1},getRatio:function(b){return this.devicePixelRatio/this.getBackingStoreRatio(b)}},d=Two[Two.Types.canvas]=function(){this.count=0;this.domElement=document.createElement("canvas");this.ctx=this.domElement.getContext("2d");
this.overdraw=!1;this.elements=[];this.stage=null};_.extend(d,{Group:k,Element:f,getStyles:function(b){var c={},d=b.id,a=b._matrix,f=b.stroke,l=b.linewidth,j=b.fill,k=b.opacity,g=b.visible,m=b.cap,z=b.join,v=b.miter,s=b.closed;b=b.vertices;d&&(c.id=d);_.isObject(a)&&(c.matrix=a.toArray());f&&(c.stroke=f);j&&(c.fill=j);_.isNumber(k)&&(c.opacity=k);m&&(c.cap=m);z&&(c.join=z);v&&(c.miter=v);l&&(c.linewidth=l);b&&(c.commands=b);c.visible=!!g;c.closed=!!s;return c},setStyles:function(b,c,d,a){switch(c){case "matrix":c=
"matrix";d=d.toArray();break;case "vertices":c="commands",b.closed=a}b[c]=d},Utils:j});_.extend(d.prototype,Backbone.Events,{setSize:function(b,c,d){this.width=b;this.height=c;this.ratio=_.isUndefined(d)?j.getRatio(this.ctx):d;this.domElement.width=b*this.ratio;this.domElement.height=c*this.ratio;_.extend(this.domElement.style,{width:b+"px",height:c+"px"});return this},add:function(b){constructor=Object.getPrototypeOf(this).constructor;var c=b,d=this.elements,a=constructor.Group,f=constructor.Element,
l=constructor.getStyles;_.isArray(b)||(c=_.map(arguments,function(a){return a}));_.each(c,function(b){var c;c=b instanceof Two.Group;var g=_.isNull(this.stage);if(_.isUndefined(b.id)){var j=this.count;this.count++;b.id=j}c?(c=l.call(this,b),delete c.stroke,delete c.fill,delete c.opacity,delete c.cap,delete c.join,delete c.miter,delete c.linewidth,c=new a(c),g&&(this.stage=c,this.stage.object=b,b.parent=this,b.unbind(Two.Events.change).bind(Two.Events.change,_.bind(this.update,this)))):c=new f(l.call(this,
b));d.push(c);g||this.stage.appendChild(c)},this);return this},update:function(b,c,d,a,f){var l=Object.getPrototypeOf(this).constructor,j=this.elements,k=j[b];switch(c){case Two.Properties.hierarchy:_.each(d,function(a){k.appendChild(j[a])});break;case Two.Properties.demotion:_.each(d,function(a){k.removeChild(j[a]);this.elements[a]=null},this);break;default:l.setStyles.call(this,k,c,d,a,f)}return this},render:function(){if(_.isNull(this.stage))return this;1!==this.ratio&&(this.ctx.save(),this.ctx.scale(this.ratio,
this.ratio));this.overdraw||this.ctx.clearRect(0,0,this.width,this.height);this.stage.render(this.ctx);1!==this.ratio&&this.ctx.restore();return this}})})();(function(){function m(a,b){var c=Math.min(a.top,b.top),d=Math.min(a.left,b.left),f=Math.max(a.right,b.right),g=Math.max(a.bottom,b.bottom);return{top:c,left:d,right:f,bottom:g,width:f-d,height:g-c,centroid:{x:-d,y:-c}}}var k=Two[Two.Types.canvas],f=Two.Matrix.Multiply,j=Two.Utils.mod,d=function(a){k.Group.call(this,a)};_.extend(d.prototype,k.Group.prototype,{appendChild:function(){k.Group.prototype.appendChild.apply(this,arguments);this.updateMatrix();return this},updateTexture:function(a){_.each(this.children,
function(b){b.updateTexture(a)});return this},updateMatrix:function(a){var b=a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=f(this.matrix,b);this._scale=this.scale*a;_.each(this.children,function(a){a.updateMatrix(this)},this);return this},render:function(a,b){_.each(this.children,function(c){c.render(a,b)})}});var b=function(a){k.Element.call(this,a)};_.extend(b.prototype,k.Element.prototype,{updateMatrix:function(a){var b=
a&&a._matrix||this.parent&&this.parent._matrix;a=a&&a._scale||this.parent&&this.parent._scale;if(!b)return this;this._matrix=f(this.matrix,b);this._scale=this.scale*a;return this},updateTexture:function(a){c.updateTexture(a,this);return this},render:function(a,b){if(!this.visible||!this.opacity||!this.buffer)return this;a.bindBuffer(a.ARRAY_BUFFER,this.textureCoordsBuffer);a.vertexAttribPointer(b.textureCoords,2,a.FLOAT,!1,0,0);a.bindTexture(a.TEXTURE_2D,this.texture);a.uniformMatrix3fv(b.matrix,
!1,this._matrix);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.vertexAttribPointer(b.position,2,a.FLOAT,!1,0,0);a.drawArrays(a.TRIANGLES,0,6);return this}});var c={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),getBoundingClientRect:function(a,b){var c=Infinity,d=-Infinity,f=Infinity,g=-Infinity;_.each(a,function(a){var b=a.x,j=a.y,p;f=Math.min(j,f);c=Math.min(b,c);d=Math.max(b,d);g=Math.max(j,g);b=a.u&&a.u.x;j=a.u&&a.u.y;p=a.v&&a.v.x;a=a.v&&a.v.y;b&&(j&&p&&a)&&(f=
Math.min(j,a,f),c=Math.min(b,p,c),d=Math.max(b,p,d),g=Math.max(j,a,g))});_.isNumber(b)&&(f-=b,c-=b,d+=b,g+=b);return{top:f,left:c,right:d,bottom:g,width:d-c,height:g-f,centroid:{x:-c,y:-f}}},getTriangles:function(a){var b=a.top,c=a.left,d=a.right;a=a.bottom;return new Two.Array([c,b,d,b,c,a,c,a,d,b,d,a])},updateCanvas:function(a){var b=a.commands,c=this.canvas,d=this.ctx,f=a._scale,g=a.stroke,k=a.linewidth*f,n=a.fill,m=a.opacity,s=a.cap,y=a.join,r=a.miter,q=a.closed,e=b.length,x=e-1;c.width=Math.max(Math.ceil(a.rect.width*
f),1);c.height=Math.max(Math.ceil(a.rect.height*f),1);a=a.rect.centroid;var A=a.x*f,C=a.y*f;d.clearRect(0,0,c.width,c.height);n&&(d.fillStyle=n);g&&(d.strokeStyle=g);k&&(d.lineWidth=k);r&&(d.miterLimit=r);y&&(d.lineJoin=y);s&&(d.lineCap=s);_.isNumber(m)&&(d.globalAlpha=m);d.beginPath();_.each(b,function(a,c){var g,l,k,n,m,r=(a.x*f+A).toFixed(3),s=(a.y*f+C).toFixed(3);switch(a._command){case Two.Commands.curve:l=q?j(c-1,e):Math.max(c-1,0);g=q?j(c+1,e):Math.min(c+1,x);k=b[l];g=b[g];l=(k.v.x*f+A).toFixed(3);
m=(k.v.y*f+C).toFixed(3);k=(a.u.x*f+A).toFixed(3);n=(a.u.y*f+C).toFixed(3);d.bezierCurveTo(l,m,k,n,r,s);c>=x&&q&&(l=(a.v.x*f+A).toFixed(3),m=(a.v.y*f+C).toFixed(3),k=(g.u.x*f+A).toFixed(3),n=(g.u.y*f+C).toFixed(3),r=(g.x*f+A).toFixed(3),s=(g.y*f+C).toFixed(3),d.bezierCurveTo(l,m,k,n,r,s));break;case Two.Commands.line:d.lineTo(r,s);break;case Two.Commands.move:d.moveTo(r,s)}});q&&d.closePath();d.fill();d.stroke()},updateTexture:function(a,b){this.updateCanvas(b);b.texture&&a.deleteTexture(b.texture);
a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);b.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,b.texture);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);0>=this.canvas.width||0>=this.canvas.height||a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(a,b,c){_.isObject(b.buffer)&&a.deleteBuffer(b.buffer);b.buffer=
a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.buffer);a.enableVertexAttribArray(c.position);a.bufferData(a.ARRAY_BUFFER,b.triangles,a.STATIC_DRAW);_.isObject(b.textureCoordsBuffer)&&a.deleteBuffer(b.textureCoordsBuffer);b.textureCoordsBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b.textureCoordsBuffer);a.enableVertexAttribArray(c.textureCoords);a.bufferData(a.ARRAY_BUFFER,this.uv,a.STATIC_DRAW)},program:{create:function(a,b){var c=a.createProgram();_.each(b,function(b){a.attachShader(c,b)});
a.linkProgram(c);if(!a.getProgramParameter(c,a.LINK_STATUS))throw error=a.getProgramInfoLog(c),a.deleteProgram(c),new Two.Utils.Error("unable to link program: "+error);return c}},shaders:{create:function(a,b,c){c=a.createShader(a[c]);a.shaderSource(c,b);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))throw b=a.getShaderInfoLog(c),a.deleteShader(c),new Two.Utils.Error("unable to compile shader "+c+": "+b);return c},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:"attribute vec2 a_position;\nattribute vec2 a_textureCoords;\n\nuniform mat3 u_matrix;\nuniform vec2 u_resolution;\n\nvarying vec2 v_textureCoords;\n\nvoid main() {\n   vec2 projected = (u_matrix * vec3(a_position, 1)).xy;\n   vec2 normal = projected / u_resolution;\n   vec2 clipspace = (normal * 2.0) - 1.0;\n\n   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);\n   v_textureCoords = a_textureCoords;\n}",
fragment:"precision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_textureCoords;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_textureCoords);\n}"}};c.ctx=c.canvas.getContext("2d");var n=Two[Two.Types.webgl]=function(a){this.count=0;this.domElement=document.createElement("canvas");this.elements=[];this.stage=null;a=_.defaults(a||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!1});a=this.ctx=this.domElement.getContext("webgl",a)||this.domElement.getContext("experimental-webgl",
a);if(!this.ctx)throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.");var b=c.shaders.create(a,c.shaders.vertex,c.shaders.types.vertex),d=c.shaders.create(a,c.shaders.fragment,c.shaders.types.fragment);this.program=c.program.create(a,[b,d]);a.useProgram(this.program);this.program.position=a.getAttribLocation(this.program,"a_position");this.program.matrix=a.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=a.getAttribLocation(this.program,"a_textureCoords");
a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)};_.extend(n,{Group:d,Element:b,getStyles:function(a){var d={},f=a.id,j=a._matrix,k=a.stroke,g=a.linewidth,n=a.fill,m=a.opacity,v=a.visible,s=a.cap,y=a.join,r=a.miter,q=a.closed,e=a.vertices;f&&(d.id=f);_.isObject(j)&&(d.matrix=d._matrix=j.toArray(!0),d.scale=d._scale=1);k&&(d.stroke=k);n&&(d.fill=n);_.isNumber(m)&&(d.opacity=m);
s&&(d.cap=s);y&&(d.join=y);r&&(d.miter=r);g&&(d.linewidth=g);e&&(d.vertices=e,d.commands=d.vertices,d.rect=c.getBoundingClientRect(d.commands,d.linewidth),d.triangles=c.getTriangles(d.rect));d.visible=!!v;d.closed=!!q;a instanceof Two.Polygon&&(c.updateBuffer(this.ctx,d,this.program),b.prototype.updateTexture.call(d,this.ctx));return d},setStyles:function(a,b,d,f,j){var g=!1;/matrix/.test(b)?(a[b]=d.toArray(!0),_.isNumber(f)&&(g=a.scale!==f,a.scale=f),a.updateMatrix()):/(stroke|fill|opacity|cap|join|miter|linewidth)/.test(b)?
(a[b]=d,a.rect=m(c.getBoundingClientRect(a.commands,a.linewidth),a.rect),a.triangles=c.getTriangles(a.rect),c.updateBuffer(this.ctx,a,this.program),g=!0):"vertices"===b?(_.isUndefined(f)||(a.closed=f),j?a.commands=d:(a.vertices=d,a.commands=a.vertices),a.rect=m(c.getBoundingClientRect(a.vertices,a.linewidth),a.rect),a.triangles=c.getTriangles(a.rect),c.updateBuffer(this.ctx,a,this.program),g=!0):a[b]=d;g&&a.updateTexture(this.ctx)}});_.extend(n.prototype,Backbone.Events,k.prototype,{setSize:function(a,
b){k.prototype.setSize.apply(this,arguments);this.ratio=1;this.domElement.width=a;this.domElement.height=b;this.ctx.viewport(0,0,a,b);var c=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(c,a,b);return this},render:function(){if(_.isNull(this.stage))return this;this.stage.render(this.ctx,this.program);return this}})})();(function(){var m=Two.Shape=function(k){this._matrix=new Two.Matrix;var f=_.debounce(_.bind(function(){var f=this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation);this.trigger(Two.Events.change,this.id,"matrix",f,this.scale)},this),0);this._rotation=0;Object.defineProperty(this,"rotation",{get:function(){return this._rotation},set:function(j){this._rotation=j;f()}});this._scale="scale";Object.defineProperty(this,"scale",{get:function(){return this._scale},
set:function(j){this._scale=j;f()}});this.translation=new Two.Vector;this.rotation=0;this.scale=1;this.translation.bind(Two.Events.change,f);if(k)return this;m.MakeGetterSetter(this,m.Properties);this.fill="#fff";this.stroke="#000";this.opacity=this.linewidth=1;this.visible=!0;this.join=this.cap="round";this.miter=1};_.extend(m,{Properties:"fill stroke linewidth opacity visible cap join miter".split(" "),MakeGetterSetter:function(k,f){_.isArray(f)||(f=[f]);_.each(f,function(f){var d="_"+f;Object.defineProperty(k,
f,{get:function(){return this[d]},set:function(b){this[d]=b;this.trigger(Two.Events.change,this.id,f,b,this)}})})}});_.extend(m.prototype,Backbone.Events,{addTo:function(k){k.add(this);return this},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},clone:function(){var k=new m;k.translation.copy(this.translation);_.each(m.Properties,function(f){k[f]=this[f]},this);return this}})})();(function(){var m=Two.Group=function(){Two.Shape.call(this,!0);delete this.stroke;delete this.fill;delete this.linewidth;delete this.opacity;delete this.cap;delete this.join;delete this.miter;m.MakeGetterSetter(this,Two.Shape.Properties);this.children={}};_.extend(m,{MakeGetterSetter:function(k,f){_.isArray(f)||(f=[f]);_.each(f,function(f){var d="_"+f;Object.defineProperty(k,f,{get:function(){return this[d]},set:function(b){this[d]=b;_.each(this.children,function(c){c[f]=b})}})})}});_.extend(m.prototype,
Two.Shape.prototype,{clone:function(k){k=k||this.parent;var f=_.map(this.children,function(d){return d.clone(k)}),j=new m;k.add(j);j.add(f);j.translation.copy(this.translation);j.rotation=this.rotation;j.scale=this.scale;return j},corner:function(){var k=this.getBoundingClientRect(!0),f={x:k.left,y:k.top};_.each(this.children,function(j){j.translation.subSelf(f)});return this},center:function(){var k=this.getBoundingClientRect(!0);k.centroid={x:k.left+k.width/2,y:k.top+k.height/2};_.each(this.children,
function(f){f.translation.subSelf(k.centroid)});return this},add:function(k){var f=k,j=this.children,d=this.parent,b=[];_.isArray(k)||(f=_.toArray(arguments));var c=_.bind(function(b,a,c,d,f){this.trigger(Two.Events.change,b,a,c,d,f)},this);_.each(f,function(f){if(f){var a=f.id,k=f.parent;_.isUndefined(a)&&(d.add(f),a=f.id);_.isUndefined(j[a])&&(k&&delete k.children[a],j[a]=f,f.parent=this,f.unbind(Two.Events.change).bind(Two.Events.change,c),b.push(a))}},this);0<b.length&&this.trigger(Two.Events.change,
this.id,Two.Properties.hierarchy,b);return this},remove:function(k){var f=k,j=this.children,d=this.parent,b=[];if(0>=arguments.length&&d)return d.remove(this),this;_.isArray(k)||(f=_.toArray(arguments));_.each(f,function(c){var d=c.id;d in j&&(delete j[d],delete c.parent,c.unbind(Two.Events.change),b.push(d))});0<b.length&&this.trigger(Two.Events.change,this.id,Two.Properties.demotion,b);return this},getBoundingClientRect:function(k){var f=Infinity,j=-Infinity,d=Infinity,b=-Infinity;_.each(this.children,
function(c){c=c.getBoundingClientRect(!0);d&&(f&&j&&b)&&(d=Math.min(c.top,d),f=Math.min(c.left,f),j=Math.max(c.right,j),b=Math.max(c.bottom,b))},this);var c=k?this._matrix:Two.Utils.getComputedMatrix(this);k=c.multiply(f,d,1);c=c.multiply(j,b,1);return{top:k.y,left:k.x,right:c.x,bottom:c.y,width:c.x-k.x,height:c.y-k.y}},noFill:function(){_.each(this.children,function(k){k.noFill()});return this},noStroke:function(){_.each(this.children,function(k){k.noStroke()});return this}})})();(function(){var m=Math.min,k=Math.max,f=Math.round,j=Two.Polygon=function(d,b,c,j){Two.Shape.call(this);this._closed=!!b;this._curved=!!c;this._automatic=!j;var a=0,p=1,l=!1,w=!1,u,g=[],t=_.debounce(_.bind(function(){var b,c;this._automatic&&this.plot();if(l||w){b=u.length;c=b-1;b=f(a*c);c=f(p*c);for(g.length=0;b<c+1;b++)g.push(u[b])}this.trigger(Two.Events.change,this.id,"vertices",g,this._closed,l);w=l=!1},this),0);Object.defineProperty(this,"closed",{get:function(){return this._closed},set:function(a){this._closed=
!!a;t()}});Object.defineProperty(this,"curved",{get:function(){return this._curved},set:function(a){this._curved=!!a;t()}});Object.defineProperty(this,"automatic",{get:function(){return this._automatic},set:function(a){this._automatic=!!a;t()}});Object.defineProperty(this,"beginning",{get:function(){return a},set:function(b){a=m(k(b,0),1);l=!0;t()}});Object.defineProperty(this,"ending",{get:function(){return p},set:function(a){p=m(k(a,0),1);l=!0;t()}});Object.defineProperty(this,"vertices",{get:function(){return u},
set:function(a){var b=_.bind(function(a){_.each(a,function(a){a.bind(Two.Events.change,t)},this);w=!0;t()},this),c=_.bind(function(a){_.each(a,function(a){a.unbind(Two.Events.change,t)},this);w=!0;t()},this);u&&u.unbind();u=new Two.Utils.Collection(a.slice(0));u.bind(Two.Events.insert,b);u.bind(Two.Events.remove,c);w=!0;b(u)}});this.vertices=d;this._automatic&&this.plot()};_.extend(j.prototype,Two.Shape.prototype,{clone:function(){var d=_.map(this.vertices,function(b){return new Two.Vector(b.x,b.y)}),
b=new j(d,this._closed,this._curved);_.each(Two.Shape.Properties,function(c){b[c]=this[c]},this);b.translation.copy(this.translation);b.rotation=this.rotation;b.scale=this.scale;return b},corner:function(){var d=this.getBoundingClientRect(!0),b={x:d.left,y:d.top};_.each(this.vertices,function(c){c.subSelf(b)});return this},center:function(){var d=this.getBoundingClientRect(!0);d.centroid={x:d.left+d.width/2,y:d.top+d.height/2};_.each(this.vertices,function(b){b.subSelf(d.centroid)});return this},
remove:function(){if(!this.parent)return this;this.parent.remove(this);return this},getBoundingClientRect:function(d){var b=this.linewidth,c=Infinity,f=-Infinity,a=Infinity,j=-Infinity;_.each(this.vertices,function(b){var d=b.x;b=b.y;a=Math.min(b,a);c=Math.min(d,c);f=Math.max(d,f);j=Math.max(b,j)});a-=b;c-=b;f+=b;j+=b;b=d?this._matrix:Two.Utils.getComputedMatrix(this);d=b.multiply(c,a,1);b=b.multiply(f,j,1);return{top:d.y,left:d.x,right:b.x,bottom:b.y,width:b.x-d.x,height:b.y-d.y}},plot:function(){if(this._curved)return Two.Utils.getCurveFromPoints(this.vertices,
this._closed),this;_.each(this.vertices,function(d,b){d._command=0===b?Two.Commands.move:Two.Commands.line;d.u instanceof Two.Vector&&d.u.copy(d);d.v instanceof Two.Vector&&d.v.copy(d)},this);return this}})})();
